/*! For license information please see main.c1a7a781.js.LICENSE.txt */
!function(){var e={2509:function(e,t,n){(function(){"use strict";var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var a=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var n=a;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in n))break e;n=n[o]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function o(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}function u(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}i("Symbol",(function(e){function t(e,t){this.h=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+a++,r)}})),i("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),i=0;i<n.length;i++){var s=a[n[i]];"function"===typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return o(t(this))}})}return e}));var c="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};i("Object.assign",(function(e){return e||c}));var l,h="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var d;e:{var f={};try{f.__proto__={a:!0},d=f.a;break e}catch(xn){}d=!1}l=d?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=l;function m(e,t){if(e.prototype=h(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.za=t.prototype}function v(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function y(e,t){e.l={ma:t,na:!0},e.h=e.s||e.v}function b(e,t,n){return e.h=n,{value:t}}function x(e){this.h=new v,this.i=e}function w(e,t,n,r){try{var a=t.call(e.h.j,n);if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");if(!a.done)return e.h.m=!1,a;var i=a.value}catch(o){return e.h.j=null,y(e.h,o),k(e)}return e.h.j=null,r.call(e.h,i),k(e)}function k(e){for(;e.h.h;)try{var t=e.i(e.h);if(t)return e.h.m=!1,{value:t.value,done:!1}}catch(n){e.h.i=void 0,y(e.h,n)}if(e.h.m=!1,e.h.l){if(t=e.h.l,e.h.l=null,t.na)throw t.ma;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function S(e){this.next=function(t){return g(e.h),e.h.j?t=w(e,e.h.j.next,t,e.h.u):(e.h.u(t),t=k(e)),t},this.throw=function(t){return g(e.h),e.h.j?t=w(e,e.h.j.throw,t,e.h.u):(y(e.h,t),t=k(e)),t},this.return=function(t){return function(e,t){g(e.h);var n=e.h.j;return n?w(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.h.return):(e.h.return(t),k(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function C(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,a){!function e(i){i.done?r(i.value):Promise.resolve(i.value).then(t,n).then(e,a)}(e.next())}))}(new S(new x(e)))}function I(e){return e||Array.prototype.fill}v.prototype.u=function(e){this.i=e},v.prototype.return=function(e){this.l={return:e},this.h=this.v},i("Promise",(function(e){function t(e){this.i=0,this.j=void 0,this.h=[],this.u=!1;var t=this.l();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.h=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.i=function(e){if(null==this.h){this.h=[];var t=this;this.j((function(){t.m()}))}this.h.push(e)};var i=a.setTimeout;n.prototype.j=function(e){i(e,0)},n.prototype.m=function(){for(;this.h&&this.h.length;){var e=this.h;this.h=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.l(r)}}}this.h=null},n.prototype.l=function(e){this.j((function(){throw e}))},t.prototype.l=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.I),reject:e(this.m)}},t.prototype.I=function(e){if(e===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.L(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.F(e):this.s(e)}},t.prototype.F=function(e){var t=void 0;try{t=e.then}catch(n){return void this.m(n)}"function"==typeof t?this.M(t,e):this.s(e)},t.prototype.m=function(e){this.v(2,e)},t.prototype.s=function(e){this.v(1,e)},t.prototype.v=function(e,t){if(0!=this.i)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.i);this.i=e,this.j=t,2===this.i&&this.K(),this.H()},t.prototype.K=function(){var e=this;i((function(){if(e.D()){var t=a.console;"undefined"!==typeof t&&t.error(e.j)}}),1)},t.prototype.D=function(){if(this.u)return!1;var e=a.CustomEvent,t=a.Event,n=a.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=a.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.j,n(e))},t.prototype.H=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)o.i(this.h[e]);this.h=null}};var o=new n;return t.prototype.L=function(e){var t=this.l();e.T(t.resolve,t.reject)},t.prototype.M=function(e,t){var n=this.l();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{a(e(t))}catch(n){i(n)}}:t}var a,i,o=new t((function(e,t){a=e,i=t}));return this.T(r(e,a),r(n,i)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.T=function(e,t){function n(){switch(r.i){case 1:e(r.j);break;case 2:t(r.j);break;default:throw Error("Unexpected state: "+r.i)}}var r=this;null==this.h?o.i(n):this.h.push(n),this.u=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var a=s(e),i=a.next();!i.done;i=a.next())r(i.value).T(t,n)}))},t.all=function(e){var n=s(e),a=n.next();return a.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,r(a.value).T(i(o.length-1),t),a=n.next()}while(!a.done)}))},t})),i("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e){return e}))}})),i("Array.prototype.fill",(function(e){return e||function(e,t,n){var r=this.length||0;for(0>t&&(t=Math.max(0,r+t)),(null==n||n>r)&&(n=r),0>(n=Number(n))&&(n=Math.max(0,r+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}})),i("Int8Array.prototype.fill",I),i("Uint8Array.prototype.fill",I),i("Uint8ClampedArray.prototype.fill",I),i("Int16Array.prototype.fill",I),i("Uint16Array.prototype.fill",I),i("Int32Array.prototype.fill",I),i("Uint32Array.prototype.fill",I),i("Float32Array.prototype.fill",I),i("Float64Array.prototype.fill",I),i("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}})),i("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var a=n[t];if(a===e||Object.is(a,e))return!0}return!1}})),i("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}}));var T=this||self;function _(e,t){e=e.split(".");var n,r=T;e[0]in r||"undefined"==typeof r.execScript||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function E(e){var t;return(t=T.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}var N=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),a="string"===typeof e?e.split(""):e,i=0;i<n;i++)i in a&&(r[i]=t.call(void 0,a[i],i,e));return r},R={},A=null;function O(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),a=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),a=A[n];if(null!=a)return a;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}D();for(var r=0;;){var a=n(-1),i=n(0),o=n(64),s=n(64);if(64===s&&-1===a)break;t(a<<2|i>>4),64!=o&&(t(i<<4&240|o>>2),64!=s&&t(o<<6&192|s))}}(e,(function(e){r[a++]=e})),a!==n?r.subarray(0,a):r}function D(){if(!A){A={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));R[n]=r;for(var a=0;a<r.length;a++){var i=r[a];void 0===A[i]&&(A[i]=a)}}}}var P="undefined"!==typeof Uint8Array,M=!(E("Trident")||E("MSIE"))&&"function"===typeof T.btoa;function L(e){if(!M){var t;void 0===t&&(t=0),D(),t=R[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",a=0,i=0;a<e.length-2;a+=3){var o=e[a],s=e[a+1],u=e[a+2],c=t[o>>2];o=t[(3&o)<<4|s>>4],s=t[(15&s)<<2|u>>6],u=t[63&u],n[i++]=c+o+s+u}switch(c=0,u=r,e.length-a){case 2:u=t[(15&(c=e[a+1]))<<2]||r;case 1:e=e[a],n[i]=t[e>>2]+t[(3&e)<<4|c>>4]+u+r}return n.join("")}for(t="";10240<e.length;)t+=String.fromCharCode.apply(null,e.subarray(0,10240)),e=e.subarray(10240);return t+=String.fromCharCode.apply(null,e),btoa(t)}var F,z=RegExp("[-_.]","g");function B(e){switch(e){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function V(e){if(!M)return O(e);z.test(e)&&(e=e.replace(z,B)),e=atob(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function U(){return F||(F=new Uint8Array(0))}var W={},j="function"===typeof Uint8Array.prototype.slice,G=0,H=0;function K(e){var t=0>e,n=(e=Math.abs(e))>>>0;e=Math.floor((e-n)/4294967296),t&&(t=(n=s(X(n,e))).next().value,e=n.next().value,n=t),G=n>>>0,H=e>>>0}var q,Z="function"===typeof BigInt;function X(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function Y(e,t){this.i=e>>>0,this.h=t>>>0}function Q(e){if(!e)return q||(q=new Y(0,0));if(!/^-?\d+$/.test(e))return null;if(16>e.length)K(Number(e));else if(Z)e=BigInt(e),G=Number(e&BigInt(4294967295))>>>0,H=Number(e>>BigInt(32)&BigInt(4294967295));else{var t=+("-"===e[0]);H=G=0;for(var n=e.length,r=t,a=(n-t)%6+t;a<=n;r=a,a+=6)r=Number(e.slice(r,a)),H*=1e6,4294967296<=(G=1e6*G+r)&&(H+=G/4294967296|0,G%=4294967296);t&&(e=(t=s(X(G,H))).next().value,t=t.next().value,G=e,H=t)}return new Y(G,H)}function $(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function J(){return Error("Failed to read varint, encoding is invalid.")}function ee(e,t){return Error("Tried to read past the end of the data "+t+" > "+e)}function te(){throw Error("Invalid UTF8")}function ne(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var re,ae,ie,oe=void 0,se="undefined"!==typeof TextDecoder,ue="undefined"!==typeof TextEncoder;function ce(e){if(e!==W)throw Error("illegal external caller")}function le(e,t){if(ce(t),this.V=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}function he(){return ie||(ie=new le(null,W))}function de(e){ce(W);var t=e.V;return null==(t=null==t||P&&null!=t&&t instanceof Uint8Array?t:"string"===typeof t?V(t):null)?t:e.V=t}function fe(e,t){this.i=null,this.m=!1,this.h=this.j=this.l=0,pe(this,e,t)}function pe(e,t,n){n=void 0===n?{}:n,e.S=void 0!==n.S&&n.S,t&&(t=function(e){if("string"===typeof e)return{buffer:V(e),C:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),C:!1};if(e.constructor===Uint8Array)return{buffer:e,C:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),C:!1};if(e.constructor===le)return{buffer:de(e)||U(),C:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(t),e.i=t.buffer,e.m=t.C,e.l=0,e.j=e.i.length,e.h=e.l)}function me(e,t){if(e.h=t,t>e.j)throw ee(e.j,t)}function ve(e){var t=e.i,n=e.h,r=t[n++],a=127&r;if(128&r&&(a|=(127&(r=t[n++]))<<7,128&r&&(a|=(127&(r=t[n++]))<<14,128&r&&(a|=(127&(r=t[n++]))<<21,128&r&&(a|=(r=t[n++])<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw J();return me(e,n),a}function ge(e,t){if(0>t)throw Error("Tried to read a negative byte length: "+t);var n=e.h,r=n+t;if(r>e.j)throw ee(t,e.j-n);return e.h=r,n}fe.prototype.reset=function(){this.h=this.l};var ye=[];function be(){this.h=[]}function xe(e,t,n){for(;0<n||127<t;)e.h.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.h.push(t)}function we(e,t){for(;127<t;)e.h.push(127&t|128),t>>>=7;e.h.push(t)}function ke(e,t){if(ye.length){var n=ye.pop();pe(n,e,t),e=n}else e=new fe(e,t);this.h=e,this.j=this.h.h,this.i=this.l=-1,this.setOptions(t)}function Se(e){var t=e.h;if(t.h==t.j)return!1;e.j=e.h.h;var n=ve(e.h)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw $(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.l=t,e.i=n,!0}function Ce(e){switch(e.i){case 0:if(0!=e.i)Ce(e);else e:{for(var t=(e=e.h).h,n=t+10,r=e.i;t<n;)if(0===(128&r[t++])){me(e,t);break e}throw J()}break;case 1:me(e=e.h,e.h+8);break;case 2:2!=e.i?Ce(e):(t=ve(e.h)>>>0,me(e=e.h,e.h+t));break;case 5:me(e=e.h,e.h+4);break;case 3:for(t=e.l;;){if(!Se(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.i){if(e.l!=t)throw Error("Unmatched end-group tag");break}Ce(e)}break;default:throw $(e.i,e.j)}}be.prototype.length=function(){return this.h.length},be.prototype.end=function(){var e=this.h;return this.h=[],e},ke.prototype.setOptions=function(e){e=void 0===e?{}:e,this.ca=void 0!==e.ca&&e.ca},ke.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Ie=[];function Te(){this.j=[],this.i=0,this.h=new be}function _e(e,t){0!==t.length&&(e.j.push(t),e.i+=t.length)}var Ee="function"===typeof Symbol&&"symbol"===typeof Symbol()?Symbol():void 0;function Ne(e,t){return Ee?e[Ee]|=t:void 0!==e.A?e.A|=t:(Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}}),t)}function Re(e,t){Ee?e[Ee]&&(e[Ee]&=~t):void 0!==e.A&&(e.A&=~t)}function Ae(e){var t;return null==(t=Ee?e[Ee]:e.A)?0:t}function Oe(e,t){Ee?e[Ee]=t:void 0!==e.A?e.A=t:Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}})}function De(e){return Ne(e,1),e}function Pe(e,t){Oe(t,-51&(0|e))}function Me(e,t){Oe(t,-41&(18|e))}var Le={};function Fe(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)&&e.constructor===Object}var ze,Be,Ve=[];function Ue(e){if(2&Ae(e.o))throw Error("Cannot mutate an immutable Message")}function We(e){var t=e.length;(t=t?e[t-1]:void 0)&&Fe(t)?t.g=1:(t={},e.push((t.g=1,t)))}function je(e){var t=e.i+e.G;return e.B||(e.B=e.o[t]={})}function Ge(e,t){return-1===t?null:t>=e.i?e.B?e.B[t]:void 0:e.o[t+e.G]}function He(e,t,n,r){Ue(e),Ke(e,t,n,r)}function Ke(e,t,n,r){e.j&&(e.j=void 0),t>=e.i||r?je(e)[t]=n:(e.o[t+e.G]=n,(e=e.B)&&t in e&&delete e[t])}function qe(e,t,n,r){var a=Ge(e,t);Array.isArray(a)||(a=ze);var i=Ae(a);if(1&i||De(a),r)2&i||Ne(a,2),1&n||Object.freeze(a);else{r=!(2&n);var o=2&i;1&n||!o?r&&16&i&&!o&&Re(a,16):Ke(e,t,a=De(Array.prototype.slice.call(a)))}return a}function Ze(e,t){var n=Ge(e,t),r=null==n?n:"number"===typeof n||"NaN"===n||"Infinity"===n||"-Infinity"===n?Number(n):void 0;return null!=r&&r!==n&&Ke(e,t,r),r}function Xe(e,t,n,r,a){e.h||(e.h={});var i=e.h[n],o=qe(e,n,3,a);if(!i){var s=o;i=[];var u=!!(16&Ae(e.o));o=!!(2&Ae(s));var c=s;!a&&o&&(s=Array.prototype.slice.call(s));for(var l=o,h=0;h<s.length;h++){var d=s[h],f=t,p=!1;if(p=void 0!==p&&p,void 0!==(d=Array.isArray(d)?new f(d):p?new f:void 0)){var m=p=Ae(f=d.o);o&&(m|=2),u&&(m|=16),m!=p&&Oe(f,m),f=m,l=l||!!(2&f),i.push(d)}}return e.h[n]=i,t=33|(u=Ae(s)),u!=(t=l?-9&t:8|t)&&(l=s,Object.isFrozen(l)&&(l=Array.prototype.slice.call(l)),Oe(l,t),s=l),c!==s&&Ke(e,n,s),(a||r&&o)&&Ne(i,2),r&&Object.freeze(i),i}return a||(a=Object.isFrozen(i),r&&!a?Object.freeze(i):!r&&a&&(i=Array.prototype.slice.call(i),e.h[n]=i)),i}function Ye(e,t,n){var r=!!(2&Ae(e.o));if(t=Xe(e,t,n,r,r),e=qe(e,n,3,r),!(r||8&Ae(e))){for(r=0;r<t.length;r++){if(2&Ae((n=t[r]).o)){var a=ut(n,!1);a.j=n}else a=n;n!==a&&(t[r]=a,e[r]=a.o)}Ne(e,8)}return t}function Qe(e,t,n){if(null!=n&&"number"!==typeof n)throw Error("Value of float/double field must be a number|null|undefined, found "+typeof n+": "+n);He(e,t,n)}function $e(e,t,n,r,a){Ue(e);var i=Xe(e,n,t,!1,!1);return n=null!=r?r:new n,e=qe(e,t,2,!1),void 0!=a?(i.splice(a,0,n),e.splice(a,0,n.o)):(i.push(n),e.push(n.o)),n.C()&&Re(e,8),n}function Je(e,t){return null==e?t:e}function et(e,t,n){return n=void 0===n?0:n,Je(Ze(e,t),n)}function tt(e,t,n,r){if(null!=e){if(Array.isArray(e))e=nt(e,t,n,void 0!==r);else if(Fe(e)){var a,i={};for(a in e)i[a]=tt(e[a],t,n,r);e=i}else e=t(e,r);return e}}function nt(e,t,n,r){var a=Ae(e);r=r?!!(16&a):void 0,e=Array.prototype.slice.call(e);for(var i=0;i<e.length;i++)e[i]=tt(e[i],t,n,r);return n(a,e),e}function rt(e){return e.ja===Le?e.toJSON():function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e)if(Array.isArray(e)){if(0!==(128&Ae(e)))return We(e=Array.prototype.slice.call(e)),e}else{if(P&&null!=e&&e instanceof Uint8Array)return L(e);if(e instanceof le){var t=e.V;return null==t?"":"string"===typeof t?t:e.V=L(t)}}}return e}(e)}function at(e,t){128&e&&We(t)}function it(e,t,n){if(n=void 0===n?Me:n,null!=e){if(P&&e instanceof Uint8Array)return e.length?new le(new Uint8Array(e),W):he();if(Array.isArray(e)){var r=Ae(e);return 2&r?e:!t||32&r||!(16&r||0===r)?(4&(t=Ae(e=nt(e,it,4&r?Me:n,!0)))&&2&t&&Object.freeze(e),e):(Oe(e,2|r),e)}return e.ja===Le?st(e):e}}function ot(e,t,n,r,a,i,o){if(e=e.h&&e.h[n]){if(2&(r=Ae(e))?r=e:(Me(r,i=N(e,st)),Object.freeze(i),r=i),Ue(t),o=null==r?ze:De([]),null!=r){for(i=!!r.length,e=0;e<r.length;e++){var s=r[e];i=i&&!(2&Ae(s.o)),o[e]=s.o}i=1|(i?8:0),((e=Ae(o))&i)!==i&&(Object.isFrozen(o)&&(o=Array.prototype.slice.call(o)),Oe(o,e|i)),t.h||(t.h={}),t.h[n]=r}else t.h&&(t.h[n]=void 0);Ke(t,n,o,a)}else He(t,n,it(r,i,o),a)}function st(e){return 2&Ae(e.o)||Ne((e=ut(e,!0)).o,2),e}function ut(e,t){var n=e.o,r=[];Ne(r,16);var a=e.constructor.h;if(a&&r.push(a),a=e.B){r.length=n.length,r.fill(void 0,r.length,n.length);var i={};r[r.length-1]=i}0!==(128&Ae(n))&&We(r),t=t||e.C()?Me:Pe,i=e.constructor,Be=r,r=new i(r),Be=void 0,e.R&&(r.R=e.R.slice()),i=!!(16&Ae(n));for(var o=a?n.length-1:n.length,s=0;s<o;s++)ot(e,r,s-e.G,n[s],!1,i,t);if(a)for(var u in a)ot(e,r,+u,a[u],!0,i,t);return r}function ct(e,t,n){null==e&&(e=Be),Be=void 0;var r,a=this.constructor.i||0,i=0<a,o=this.constructor.h,s=!1;if(null==e){var u=48,c=!0;i&&(a=0,u|=128),Oe(e=o?[o]:[],u)}else{if(!Array.isArray(e))throw Error();if(o&&o!==e[0])throw Error();var l=u=Ne(e,0);if((c=0!==(16&l))&&((s=0!==(32&l))||(l|=32)),i){if(128&l)a=0;else if(0<e.length){var h=e[e.length-1];if(Fe(h)&&"g"in h){a=0,l|=128,delete h.g;var d,f=!0;for(d in h){f=!1;break}f&&e.pop()}}}else if(128&l)throw Error();u!==l&&Oe(e,l)}if(this.G=(o?0:-1)-a,this.h=void 0,this.o=e,a=(o=this.o.length)-1,o&&Fe(o=this.o[a])?(this.B=o,this.i=a-this.G):void 0!==t&&-1<t?(this.i=Math.max(t,a+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!i&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(n)for(t=c&&!s&&!0,i=this.i,c=0;c<n.length;c++)(s=n[c])<i?(a=e[s+=this.G])?lt(a,t):e[s]=ze:(r||(r=je(this)),(a=r[s])?lt(a,t):r[s]=ze)}function lt(e,t){if(Array.isArray(e)){var n=Ae(e),r=1;!t||2&n||(r|=16),(n&r)!==r&&Oe(e,n|r)}}function ht(e,t,n){if(n){var r,a={};for(r in n){var i=n[r],o=i.ra;o||(a.J=i.xa||i.oa.W,i.ia?(a.aa=bt(i.ia),o=function(e){return function(t,n,r){return e.J(t,n,r,e.aa)}}(a)):i.ka?(a.Z=xt(i.da.P,i.ka),o=function(e){return function(t,n,r){return e.J(t,n,r,e.Z)}}(a)):o=a.J,i.ra=o),o(t,e,i.da),a={J:a.J,aa:a.aa,Z:a.Z}}}!function(e,t){if(t=t.R){_e(e,e.h.end());for(var n=0;n<t.length;n++)_e(e,de(t[n])||U())}}(t,e)}Oe(Ve,23),ze=Object.freeze(Ve),ct.prototype.toJSON=function(){return nt(this.o,rt,at)},ct.prototype.C=function(){return!!(2&Ae(this.o))},ct.prototype.ja=Le,ct.prototype.toString=function(){return this.o.toString()};var dt=Symbol();function ft(e,t,n){return e[dt]||(e[dt]=function(e,r){return t(e,r,n)})}function pt(e){var t=e[dt];if(!t){var n=Ot(e);t=function(e,t){return Dt(e,t,n)},e[dt]=t}return t}function mt(e){var t=function(e){var t=e.ia;return t?pt(t):(t=e.wa)?ft(e.da.P,t,e.ka):void 0}(e),n=e.da,r=e.oa.U;return t?function(e,a){return r(e,a,n,t)}:function(e,t){return r(e,t,n)}}function vt(e,t){var n=e[t];return"function"==typeof n&&0===n.length&&(n=n(),e[t]=n),Array.isArray(n)&&(_t in n||wt in n||0<n.length&&"function"==typeof n[0])?n:void 0}function gt(e,t,n,r,a,i){t.P=e[0];var o=1;if(e.length>o&&"number"!==typeof e[o]){var s=e[o++];n(t,s)}for(;o<e.length;){n=e[o++];for(var u=o+1;u<e.length&&"number"!==typeof e[u];)u++;switch(s=e[o++],u-=o){case 0:r(t,n,s);break;case 1:(u=vt(e,o))?(o++,a(t,n,s,u)):r(t,n,s,e[o++]);break;case 2:a(t,n,s,u=vt(e,u=o++),e[o++]);break;case 3:i(t,n,s,e[o++],e[o++],e[o++]);break;case 4:i(t,n,s,e[o++],e[o++],e[o++],e[o++]);break;default:throw Error("unexpected number of binary field arguments: "+u)}}return t}var yt=Symbol();function bt(e){var t=e[yt];if(!t){var n=Tt(e);t=function(e,t){return Pt(e,t,n)},e[yt]=t}return t}function xt(e,t){var n=e[yt];return n||(n=function(e,n){return ht(e,n,t)},e[yt]=n),n}var wt=Symbol();function kt(e,t){e.push(t)}function St(e,t,n){e.push(t,n.W)}function Ct(e,t,n,r){var a=bt(r),i=Tt(r).P,o=n.W;e.push(t,(function(e,t,n){return o(e,t,n,i,a)}))}function It(e,t,n,r,a,i){var o=xt(r,i),s=n.W;e.push(t,(function(e,t,n){return s(e,t,n,r,o)}))}function Tt(e){var t=e[wt];return t||(t=gt(e,e[wt]=[],kt,St,Ct,It),_t in e&&wt in e&&(e.length=0),t)}var _t=Symbol();function Et(e,t){e[0]=t}function Nt(e,t,n,r){var a=n.U;e[t]=r?function(e,t,n){return a(e,t,n,r)}:a}function Rt(e,t,n,r,a){var i=n.U,o=pt(r),s=Ot(r).P;e[t]=function(e,t,n){return i(e,t,n,s,o,a)}}function At(e,t,n,r,a,i,o){var s=n.U,u=ft(r,a,i);e[t]=function(e,t,n){return s(e,t,n,r,u,o)}}function Ot(e){var t=e[_t];return t||(t=gt(e,e[_t]={},Et,Nt,Rt,At),_t in e&&wt in e&&(e.length=0),t)}function Dt(e,t,n){for(;Se(t)&&4!=t.i;){var r=t.l,a=n[r];if(!a){var i=n[0];i&&(i=i[r])&&(a=n[r]=mt(i))}if(!a||!a(t,e,r)){r=e,i=(a=t).j,Ce(a);var o=a;if(!o.ca){if(a=o.h.h-i,o.h.h=i,o=o.h,0==a)a=he();else{if(i=ge(o,a),o.S&&o.m)a=o.i.subarray(i,i+a);else{o=o.i;var s=i;a=s===(a=i+a)?U():j?o.slice(s,a):new Uint8Array(o.subarray(s,a))}a=0==a.length?he():new le(a,W)}(i=r.R)?i.push(a):r.R=[a]}}}return e}function Pt(e,t,n){for(var r=n.length,a=1==r%2,i=a?1:0;i<r;i+=2)(0,n[i+1])(t,e,n[i]);ht(e,t,a?n[0]:void 0)}function Mt(e,t){return{U:e,W:t}}var Lt=Mt((function(e,t,n){if(5!==e.i)return!1;var r=(e=e.h).i,a=e.h,i=r[a],o=r[a+1],s=r[a+2];return r=r[a+3],me(e,e.h+4),e=2*((o=(i<<0|o<<8|s<<16|r<<24)>>>0)>>31)+1,i=o>>>23&255,o&=8388607,He(t,n,255==i?o?NaN:1/0*e:0==i?e*Math.pow(2,-149)*o:e*Math.pow(2,i-150)*(o+Math.pow(2,23))),!0}),(function(e,t,n){if(null!=(t=Ze(t,n))){we(e.h,8*n+5),e=e.h;var r=+t;0===r?0<1/r?G=H=0:(H=0,G=2147483648):isNaN(r)?(H=0,G=2147483647):34028234663852886e22<(r=(n=0>r?-2147483648:0)?-r:r)?(H=0,G=(2139095040|n)>>>0):11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),H=0,G=(n|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,H=0,G=(n|t+127<<23|8388607&r)>>>0),n=G,e.h.push(n>>>0&255),e.h.push(n>>>8&255),e.h.push(n>>>16&255),e.h.push(n>>>24&255)}})),Ft=Mt((function(e,t,n){if(0!==e.i)return!1;var r=e.h,a=0,i=e=0,o=r.i,s=r.h;do{var u=o[s++];a|=(127&u)<<i,i+=7}while(32>i&&128&u);for(32<i&&(e|=(127&u)>>4),i=3;32>i&&128&u;i+=7)e|=(127&(u=o[s++]))<<i;if(me(r,s),!(128>u))throw J();return r=a>>>0,(e=2147483648&(u=e>>>0))&&(u=~u>>>0,0==(r=1+~r>>>0)&&(u=u+1>>>0)),r=4294967296*u+(r>>>0),He(t,n,e?-r:r),!0}),(function(e,t,n){null!=(t=Ge(t,n))&&("string"===typeof t&&Q(t),null!=t&&(we(e.h,8*n),"number"===typeof t?(e=e.h,K(t),xe(e,G,H)):(n=Q(t),xe(e.h,n.i,n.h))))})),zt=Mt((function(e,t,n){return 0===e.i&&(He(t,n,ve(e.h)),!0)}),(function(e,t,n){if(null!=(t=Ge(t,n))&&null!=t)if(we(e.h,8*n),e=e.h,0<=(n=t))we(e,n);else{for(t=0;9>t;t++)e.h.push(127&n|128),n>>=7;e.h.push(1)}})),Bt=Mt((function(e,t,n){if(2!==e.i)return!1;var r=ve(e.h)>>>0,a=ge(e=e.h,r);if(e=e.i,se){var i,o=e;(i=re)||(i=re=new TextDecoder("utf-8",{fatal:!0})),e=a+r,o=0===a&&e===o.length?o:o.subarray(a,e);try{var s=i.decode(o)}catch(h){if(void 0===oe){try{i.decode(new Uint8Array([128]))}catch(d){}try{i.decode(new Uint8Array([97])),oe=!0}catch(d){oe=!1}}throw!oe&&(re=void 0),h}}else{r=(s=a)+r,a=[];for(var u,c,l=null;s<r;)128>(u=e[s++])?a.push(u):224>u?s>=r?te():(c=e[s++],194>u||128!==(192&c)?(s--,te()):a.push((31&u)<<6|63&c)):240>u?s>=r-1?te():128!==(192&(c=e[s++]))||224===u&&160>c||237===u&&160<=c||128!==(192&(o=e[s++]))?(s--,te()):a.push((15&u)<<12|(63&c)<<6|63&o):244>=u?s>=r-2?te():128!==(192&(c=e[s++]))||0!==c-144+(u<<28)>>30||128!==(192&(o=e[s++]))||128!==(192&(i=e[s++]))?(s--,te()):(u=(7&u)<<18|(63&c)<<12|(63&o)<<6|63&i,u-=65536,a.push(55296+(u>>10&1023),56320+(1023&u))):te(),8192<=a.length&&(l=ne(l,a),a.length=0);s=ne(l,a)}return He(t,n,s),!0}),(function(e,t,n){if(null!=(t=Ge(t,n))){var r=!1;if(r=void 0!==r&&r,ue){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(ae||(ae=new TextEncoder)).encode(t)}else{for(var a=0,i=new Uint8Array(3*t.length),o=0;o<t.length;o++){var s=t.charCodeAt(o);if(128>s)i[a++]=s;else{if(2048>s)i[a++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&o<t.length){var u=t.charCodeAt(++o);if(56320<=u&&57343>=u){s=1024*(s-55296)+u-56320+65536,i[a++]=s>>18|240,i[a++]=s>>12&63|128,i[a++]=s>>6&63|128,i[a++]=63&s|128;continue}o--}if(r)throw Error("Found an unpaired surrogate");s=65533}i[a++]=s>>12|224,i[a++]=s>>6&63|128}i[a++]=63&s|128}}t=a===i.length?i:i.subarray(0,a)}we(e.h,8*n+2),we(e.h,t.length),_e(e,e.h.end()),_e(e,t)}})),Vt=Mt((function(e,t,n,r,a){if(2!==e.i)return!1;t=$e(t,n,r),n=e.h.j,r=ve(e.h)>>>0;var i=e.h.h+r,o=i-n;if(0>=o&&(e.h.j=i,a(t,e,void 0,void 0,void 0),o=i-e.h.h),o)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-o)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.h.h=i,e.h.j=n,!0}),(function(e,t,n,r,a){if(null!=(t=Ye(t,r,n)))for(r=0;r<t.length;r++){var i=e;we(i.h,8*n+2);var o=i.h.end();_e(i,o),o.push(i.i),i=o,a(t[r],e),o=e;var s=i.pop();for(s=o.i+o.h.length()-s;127<s;)i.push(127&s|128),s>>>=7,o.i++;i.push(s),o.i++}}));function Ut(e){return function(t,n){e:{if(Ie.length){var r=Ie.pop();r.setOptions(n),pe(r.h,t,n),t=r}else t=new ke(t,n);try{var a=Ot(e),i=Dt(new a.P,t,a);break e}finally{(a=t.h).i=null,a.m=!1,a.l=0,a.j=0,a.h=0,a.S=!1,t.l=-1,t.i=-1,100>Ie.length&&Ie.push(t)}i=void 0}return i}}function Wt(e){return function(){var t=new Te;Pt(this,t,Tt(e)),_e(t,t.h.end());for(var n=new Uint8Array(t.i),r=t.j,a=r.length,i=0,o=0;o<a;o++){var s=r[o];n.set(s,i),i+=s.length}return t.j=[n],n}}function jt(e){ct.call(this,e)}m(jt,ct);var Gt=[jt,1,zt,2,Lt,3,Bt,4,Bt];function Ht(e){ct.call(this,e,-1,Kt)}jt.prototype.l=Wt(Gt),m(Ht,ct),Ht.prototype.addClassification=function(e,t){return $e(this,1,jt,e,t),this};var Kt=[1],qt=Ut([Ht,1,Vt,Gt]);function Zt(e){ct.call(this,e)}m(Zt,ct);var Xt=[Zt,1,Lt,2,Lt,3,Lt,4,Lt,5,Lt];function Yt(e){ct.call(this,e,-1,Qt)}Zt.prototype.l=Wt(Xt),m(Yt,ct);var Qt=[1],$t=Ut([Yt,1,Vt,Xt]);function Jt(e){ct.call(this,e)}m(Jt,ct);var en=[Jt,1,Lt,2,Lt,3,Lt,4,Lt,5,Lt,6,Ft],tn=Ut(en);function nn(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function rn(e){return Ye(e,jt,1).map((function(e){var t=Ge(e,1);return{index:null==t?0:t,qa:et(e,2),label:null!=Ge(e,3)?Je(Ge(e,3),""):void 0,displayName:null!=Ge(e,4)?Je(Ge(e,4),""):void 0}}))}function an(e){return{x:et(e,1),y:et(e,2),z:et(e,3),visibility:null!=Ze(e,4)?et(e,4):void 0}}function on(e){return Ye($t(e),Zt,1).map(an)}function sn(e,t){this.i=e,this.h=t,this.m=0}function un(e,t,n){return function(e,t){var n=e.h;if(void 0===e.s){var r=nn(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),a=nn(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),i=n.createProgram();if(n.attachShader(i,r),n.attachShader(i,a),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(i));r=e.s=i,n.useProgram(r),a=n.getUniformLocation(r,"sampler0"),e.l={O:n.getAttribLocation(r,"aVertex"),N:n.getAttribLocation(r,"aTex"),ya:a},e.v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.enableVertexAttribArray(e.l.O),n.vertexAttribPointer(e.l.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.l.N),n.vertexAttribPointer(e.l.N,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(a,0)}r=e.l,n.useProgram(e.s),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.i.bindTexture2d(t.glName),n.enableVertexAttribArray(r.O),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.vertexAttribPointer(r.O,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.N,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.O),n.disableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,null),e.i.bindTexture2d(0)}(e,t),"function"===typeof e.h.canvas.transferToImageBitmap?Promise.resolve(e.h.canvas.transferToImageBitmap()):n?Promise.resolve(e.h.canvas):"function"===typeof createImageBitmap?createImageBitmap(e.h.canvas):(void 0===e.j&&(e.j=document.createElement("canvas")),new Promise((function(t){e.j.height=e.h.canvas.height,e.j.width=e.h.canvas.width,e.j.getContext("2d",{}).drawImage(e.h.canvas,0,0,e.h.canvas.width,e.h.canvas.height),t(e.j)})))}function cn(e){this.h=e}Jt.prototype.l=Wt(en);var ln=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function hn(e,t){return t+e}function dn(e,t){window[e]=t}function fn(e){if(this.h=e,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=e&&e.locateFile||hn,"object"===typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"===typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=t,e.options)for(var n=(t=s(Object.keys(e.options))).next();!n.done;n=t.next()){n=n.value;var r=e.options[n].default;void 0!==r&&(this.l[n]="function"===typeof r?r():r)}}function pn(e){var t,n,r,a,i,o,s,c,l,h,d;return C((function(f){switch(f.h){case 1:return e.ga?(t=void 0===e.h.files?[]:"function"===typeof e.h.files?e.h.files(e.l):e.h.files,b(f,C((function(e){switch(e.h){case 1:return e.s=2,b(e,WebAssembly.instantiate(ln),4);case 4:e.h=3,e.s=0;break;case 2:return e.s=0,e.l=null,e.return(!1);case 3:return e.return(!0)}})),2)):f.return();case 2:if(n=f.i,"object"===typeof window)return dn("createMediapipeSolutionsWasm",{locateFile:e.locateFile}),dn("createMediapipeSolutionsPackedAssets",{locateFile:e.locateFile}),o=t.filter((function(e){return void 0!==e.data})),s=t.filter((function(e){return void 0===e.data})),c=Promise.all(o.map((function(t){var n=mn(e,t.url);if(void 0!==t.path){var r=t.path;n=n.then((function(t){return e.overrideFile(r,t),Promise.resolve(t)}))}return n}))),l=Promise.all(s.map((function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((function(e){t.addEventListener("load",(function(){e()}),!1),t.addEventListener("error",(function(){e()}),!1),document.body.appendChild(t)}))}(e.locateFile(t.url,e.ha)):Promise.resolve()}))).then((function(){var t,n,r;return C((function(a){if(1==a.h)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=e,b(a,t(n),2);r.i=a.i,a.h=0}))})),h=C((function(t){return e.h.graph&&e.h.graph.url?t=b(t,mn(e,e.h.graph.url),0):(t.h=0,t=void 0),t})),b(f,Promise.all([l,c,h]),7);if("function"!==typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=t.filter((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n})).map((function(t){return e.locateFile(t.url,e.ha)})),importScripts.apply(null,u(r)),a=e,b(f,createMediapipeSolutionsWasm(Module),6);case 6:a.i=f.i,e.m=new OffscreenCanvas(1,1),e.i.canvas=e.m,i=e.i.GL.createContext(e.m,{antialias:!1,alpha:!1,va:"undefined"!==typeof WebGL2RenderingContext?2:1}),e.i.GL.makeContextCurrent(i),f.h=4;break;case 7:if(e.m=document.createElement("canvas"),!(d=e.m.getContext("webgl2",{}))&&!(d=e.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),f.return();e.K=d,e.i.canvas=e.m,e.i.createContext(e.m,!0,!0,{});case 4:e.j=new e.i.SolutionWasm,e.ga=!1,f.h=0}}))}function mn(e,t){var n,r;return C((function(a){return t in e.L?a.return(e.L[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.L[t]=r,a.return(r))}))}function vn(e,t,n){var r,a,i,o,u,c,l,h,d,f,p,m,v,g;return C((function(y){switch(y.h){case 1:if(!n)return y.return(t);for(r={},a=0,i=s(Object.keys(n)),o=i.next();!o.done;o=i.next())u=o.value,"string"!==typeof(c=n[u])&&"texture"===c.type&&void 0!==t[c.stream]&&++a;1<a&&(e.M=!1),l=s(Object.keys(n)),o=l.next();case 2:if(o.done){y.h=4;break}if(h=o.value,"string"===typeof(d=n[h]))return v=r,g=h,b(y,function(e,t,n){var r;return C((function(a){return"number"===typeof n||n instanceof Uint8Array||n instanceof e.i.Uint8BlobList?a.return(n):n instanceof e.i.Texture2dDataOut?((r=e.v[t])||(r=new sn(e.i,e.K),e.v[t]=r),a.return(un(r,n,e.M))):a.return(void 0)}))}(e,h,t[d]),14);if(f=t[d.stream],"detection_list"===d.type){if(f){for(var x=f.getRectList(),w=f.getLandmarksList(),k=f.getClassificationsList(),S=[],I=0;I<x.size();++I){var T=tn(x.get(I)),_=void 0;_=void 0===_?0:_,T={la:{sa:et(T,1),ta:et(T,2),height:et(T,3),width:et(T,4),rotation:et(T,5,0),pa:Je(Ge(T,6),_)},ea:on(w.get(I)),ba:rn(qt(k.get(I)))},S.push(T)}x=S}else x=[];r[h]=x,y.h=7;break}if("proto_list"===d.type){if(f){for(x=Array(f.size()),w=0;w<f.size();w++)x[w]=f.get(w);f.delete()}else x=[];r[h]=x,y.h=7;break}if(void 0===f){y.h=3;break}if("float_list"===d.type){r[h]=f,y.h=7;break}if("proto"===d.type){r[h]=f,y.h=7;break}if("texture"!==d.type)throw Error("Unknown output config type: '"+d.type+"'");return(p=e.v[h])||(p=new sn(e.i,e.K),e.v[h]=p),b(y,un(p,f,e.M),13);case 13:m=y.i,r[h]=m;case 7:d.transform&&r[h]&&(r[h]=d.transform(r[h])),y.h=3;break;case 14:v[g]=y.i;case 3:o=l.next(),y.h=2;break;case 4:return y.return(r)}}))}function gn(e,t){for(var n=t.name||"$",r=[].concat(u(t.wants)),a=new e.i.StringList,i=s(t.wants),o=i.next();!o.done;o=i.next())a.push_back(o.value);i=e.i.PacketListener.implement({onResults:function(a){for(var i={},o=0;o<t.wants.length;++o)i[r[o]]=a.get(o);var s=e.listeners[n];s&&(e.I=vn(e,i,t.outs).then((function(n){n=s(n);for(var a=0;a<t.wants.length;++a){var o=i[r[a]];"object"===typeof o&&o.hasOwnProperty&&o.hasOwnProperty("delete")&&o.delete()}n&&(e.I=n)})))}}),e.j.attachMultiListener(a,i),a.delete()}function yn(e){switch(void 0===e&&(e=0),e){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function bn(e){var t=this;e=e||{},this.h=new fn({locateFile:e.locateFile,files:function(e){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:yn(e.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:on},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:on},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"===typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){var n,r,a;return C((function(i){return 1==i.h?(n=yn(e),r="third_party/mediapipe/modules/pose_landmark/"+n,b(i,mn(t.h,n),2)):(a=i.i,t.h.overrideFile(r,a),i.return(!0))}))}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}(e=fn.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},e.reset=function(){var e=this;return C((function(t){e.j&&(e.j.reset(),e.s={},e.v={}),t.h=0}))},e.setOptions=function(e,t){var n=this;if(t=t||this.h.options){for(var r=[],a=[],i={},o=s(Object.keys(e)),u=o.next();!u.done;i={X:i.X,Y:i.Y},u=o.next())if(!((u=u.value)in this.l)||this.l[u]!==e[u]){this.l[u]=e[u];var c=t[u];void 0!==c&&(c.onChange&&(i.X=c.onChange,i.Y=e[u],r.push(function(e){return function(){return C((function(t){if(1==t.h)return b(t,e.X(e.Y),2);!0===t.i&&(n.u=!0),t.h=0}))}}(i))),c.graphOptionXref&&(u=Object.assign({},{calculatorName:"",calculatorIndex:0},c.graphOptionXref,{valueNumber:1===c.type?e[u]:0,valueBoolean:0===c.type&&e[u],valueString:2===c.type?e[u]:""}),a.push(u)))}0===r.length&&0===a.length||(this.u=!0,this.H=(void 0===this.H?[]:this.H).concat(a),this.F=(void 0===this.F?[]:this.F).concat(r))}},e.initialize=function(){var e=this;return C((function(t){return 1==t.h?b(t,pn(e),2):3!=t.h?b(t,function(e){var t,n,r,a,i,o,u,c;return C((function(l){if(1==l.h)return e.h.graph&&e.h.graph.url&&e.fa===e.h.graph.url?l.return():(e.u=!0,e.h.graph&&e.h.graph.url?(e.fa=e.h.graph.url,b(l,mn(e,e.h.graph.url),3)):void(l.h=2));for(2!=l.h&&(t=l.i,e.j.loadGraph(t)),n=s(Object.keys(e.D)),r=n.next();!r.done;r=n.next())a=r.value,e.j.overrideFile(a,e.D[a]);if(e.D={},e.h.listeners)for(i=s(e.h.listeners),o=i.next();!o.done;o=i.next())u=o.value,gn(e,u);c=e.l,e.l={},e.setOptions(c),l.h=0}))}(e),3):b(t,function(e){var t,n,r,a,i,o;return C((function(u){switch(u.h){case 1:if(!e.u)return u.return();if(!e.F){u.h=2;break}t=s(e.F),n=t.next();case 3:if(n.done){u.h=5;break}return b(u,(0,n.value)(),4);case 4:n=t.next(),u.h=3;break;case 5:e.F=void 0;case 2:if(e.H){for(r=new e.i.GraphOptionChangeRequestList,a=s(e.H),i=a.next();!i.done;i=a.next())o=i.value,r.push_back(o);e.j.changeOptions(r),r.delete(),e.H=void 0}e.u=!1,u.h=0}}))}(e),0)}))},e.overrideFile=function(e,t){this.j?this.j.overrideFile(e,t):this.D[e]=t},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(e,t){var n,r,a,i,o,u,c,l,h,d=this;return C((function(f){switch(f.h){case 1:return d.h.inputs?(n=1e3*(void 0===t||null===t?performance.now():t),b(f,d.I,2)):f.return();case 2:return b(f,d.initialize(),3);case 3:for(r=new d.i.PacketDataList,a=s(Object.keys(e)),i=a.next();!i.done;i=a.next())if(o=i.value,u=d.h.inputs[o]){e:{var p=e[o];switch(u.type){case"video":var m=d.s[u.stream];if(m||(m=new sn(d.i,d.K),d.s[u.stream]=m),0===m.m&&(m.m=m.i.createTexture()),"undefined"!==typeof HTMLVideoElement&&p instanceof HTMLVideoElement)var v=p.videoWidth,g=p.videoHeight;else"undefined"!==typeof HTMLImageElement&&p instanceof HTMLImageElement?(v=p.naturalWidth,g=p.naturalHeight):(v=p.width,g=p.height);g={glName:m.m,width:v,height:g},(v=m.h).canvas.width=g.width,v.canvas.height=g.height,v.activeTexture(v.TEXTURE0),m.i.bindTexture2d(m.m),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,p),m.i.bindTexture2d(0),m=g;break e;case"detections":for((m=d.s[u.stream])||(m=new cn(d.i),d.s[u.stream]=m),m.data||(m.data=new m.h.DetectionListData),m.data.reset(p.length),g=0;g<p.length;++g){v=p[g];var y=m.data,x=y.setBoundingBox,w=g,k=v.la,S=new Jt;if(Qe(S,1,k.sa),Qe(S,2,k.ta),Qe(S,3,k.height),Qe(S,4,k.width),Qe(S,5,k.rotation),He(S,6,k.pa),k=S.l(),x.call(y,w,k),v.ea)for(y=0;y<v.ea.length;++y){S=v.ea[y],w=(x=m.data).addNormalizedLandmark,k=g,S=Object.assign({},S,{visibility:S.visibility?S.visibility:0});var C=new Zt;Qe(C,1,S.x),Qe(C,2,S.y),Qe(C,3,S.z),S.visibility&&Qe(C,4,S.visibility),S=C.l(),w.call(x,k,S)}if(v.ba)for(y=0;y<v.ba.length;++y)w=(x=m.data).addClassification,k=g,S=v.ba[y],Qe(C=new jt,2,S.qa),S.index&&He(C,1,S.index),S.label&&He(C,3,S.label),S.displayName&&He(C,4,S.displayName),S=C.l(),w.call(x,k,S)}m=m.data;break e;default:m={}}}switch(c=m,l=u.stream,u.type){case"video":r.pushTexture2d(Object.assign({},c,{stream:l,timestamp:n}));break;case"detections":(h=c).stream=l,h.timestamp=n,r.pushDetectionList(h);break;default:throw Error("Unknown input config type: '"+u.type+"'")}}return d.j.send(r),b(f,d.I,4);case 4:r.delete(),f.h=0}}))},e.onResults=function(e,t){this.listeners[t||"$"]=e},_("Solution",fn),_("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=bn.prototype).reset=function(){this.h.reset()},e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(e){this.h.onResults(e)},e.initialize=function(){var e=this;return C((function(t){return b(t,e.h.initialize(),0)}))},e.send=function(e,t){var n=this;return C((function(r){return b(r,n.h.send(e,t),0)}))},e.setOptions=function(e){this.h.setOptions(e)},_("Pose",bn),_("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),_("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),_("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),_("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),_("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),_("VERSION","0.5.1675469404")}).call(this)},5545:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z"}),"AccountCircle");t.Z=o},4853:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"}),"BarChart");t.Z=o},772:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM9 14H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2zm-8 4H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z"}),"CalendarMonth");t.Z=o},7541:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");t.Z=o},5397:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight");t.Z=o},7122:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");t.Z=o},2946:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(5649)),i=n(184),o=(0,a.default)((0,i.jsx)("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"}),"Videocam");t.Z=o},5649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(9525)},9525:function(e,t,n){"use strict";n.r(t),n.d(t,{capitalize:function(){return s},createChainedFunction:function(){return u},createSvgIcon:function(){return rr},debounce:function(){return ar},deprecatedPropType:function(){return ir},isMuiElement:function(){return or},ownerDocument:function(){return ur},ownerWindow:function(){return cr},requirePropFactory:function(){return lr},setRef:function(){return dr},unstable_ClassNameGenerator:function(){return Or},unstable_useEnhancedEffect:function(){return pr},unstable_useId:function(){return gr},unsupportedProp:function(){return yr},useControlled:function(){return br},useEventCallback:function(){return wr},useForkRef:function(){return Sr},useIsFocusVisible:function(){return Ar}});var r=function(e){return e},a=function(){var e=r;return{configure:function(t){e=t},generate:function(t){return e(t)},reset:function(){e=r}}}();function i(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function o(e){if("string"!==typeof e)throw new Error(i(7));return e.charAt(0).toUpperCase()+e.slice(1)}var s=o;var u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return null==t?e:function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e.apply(this,r),t.apply(this,r)}}),(function(){}))},c=n(7462),l=n(2791),h=n.t(l,2),d=n(3366);function f(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=f(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}var p=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=f(e))&&(r&&(r+=" "),r+=t);return r};function m(e,t){var n=(0,c.Z)({},t);return Object.keys(e).forEach((function(r){if(r.toString().match(/^(components|slots)$/))n[r]=(0,c.Z)({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){var a=e[r]||{},i=t[r];n[r]={},i&&Object.keys(i)?a&&Object.keys(a)?(n[r]=(0,c.Z)({},i),Object.keys(a).forEach((function(e){n[r][e]=m(a[e],i[e])}))):n[r]=i:n[r]=a}else void 0===n[r]&&(n[r]=e[r])})),n}function v(e){var t=e.theme,n=e.name,r=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?m(t.components[n].defaultProps,r):r}function g(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function y(e){if(!g(e))return e;var t={};return Object.keys(e).forEach((function(n){t[n]=y(e[n])})),t}function b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=n.clone?(0,c.Z)({},e):e;return g(e)&&g(t)&&Object.keys(t).forEach((function(a){"__proto__"!==a&&(g(t[a])&&a in e&&g(e[a])?r[a]=b(e[a],t[a],n):n.clone?r[a]=g(t[a])?y(t[a]):t[a]:r[a]=t[a])})),r}var x=n(4942),w=["values","unit","step"],k=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return(0,c.Z)({},e,(0,x.Z)({},t.key,t.val))}),{})};var S={borderRadius:4},C=n(885),I={xs:0,sm:600,md:900,lg:1200,xl:1536},T={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(I[e],"px)")}};function _(e,t,n){var r=e.theme||{};if(Array.isArray(t)){var a=r.breakpoints||T;return t.reduce((function(e,r,i){return e[a.up(a.keys[i])]=n(t[i]),e}),{})}if("object"===typeof t){var i=r.breakpoints||T;return Object.keys(t).reduce((function(e,r){if(-1!==Object.keys(i.values||I).indexOf(r)){e[i.up(r)]=n(t[r],r)}else{var a=r;e[a]=t[a]}return e}),{})}return n(t)}function E(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{}))||{}}function N(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function R(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){var r="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=r)return r}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function A(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||a:R(e,n)||a,t&&(r=t(r,a,e)),r}var O=function(e){var t=e.prop,n=e.cssProperty,r=void 0===n?e.prop:n,a=e.themeKey,i=e.transform,s=function(e){if(null==e[t])return null;var n=e[t],s=R(e.theme,a)||{};return _(e,n,(function(e){var n=A(s,i,e);return e===n&&"string"===typeof e&&(n=A(s,i,"".concat(t).concat("default"===e?"":o(e)),e)),!1===r?n:(0,x.Z)({},r,n)}))};return s.propTypes={},s.filterProps=[t],s};var D=function(e,t){return t?b(e,t,{clone:!1}):e};var P={m:"margin",p:"padding"},M={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},L={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},F=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!L[e])return[e];e=L[e]}var t=e.split(""),n=(0,C.Z)(t,2),r=n[0],a=n[1],i=P[r],o=M[a]||"";return Array.isArray(o)?o.map((function(e){return i+e})):[i+o]})),z=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],B=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],V=[].concat(z,B);function U(e,t,n,r){var a,i=null!=(a=R(e,t,!1))?a:n;return"number"===typeof i?function(e){return"string"===typeof e?e:i*e}:Array.isArray(i)?function(e){return"string"===typeof e?e:i[e]}:"function"===typeof i?i:function(){}}function W(e){return U(e,"spacing",8)}function j(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function G(e,t,n,r){if(-1===t.indexOf(n))return null;var a=function(e,t){return function(n){return e.reduce((function(e,r){return e[r]=j(t,n),e}),{})}}(F(n),r);return _(e,e[n],a)}function H(e,t){var n=W(e.theme);return Object.keys(e).map((function(r){return G(e,t,r,n)})).reduce(D,{})}function K(e){return H(e,z)}function q(e){return H(e,B)}function Z(e){return H(e,V)}K.propTypes={},K.filterProps=z,q.propTypes={},q.filterProps=B,Z.propTypes={},Z.filterProps=V;var X=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),a=function(e){return Object.keys(e).reduce((function(t,n){return r[n]?D(t,r[n](e)):t}),{})};return a.propTypes={},a.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),a};function Y(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var Q=O({prop:"border",themeKey:"borders",transform:Y}),$=O({prop:"borderTop",themeKey:"borders",transform:Y}),J=O({prop:"borderRight",themeKey:"borders",transform:Y}),ee=O({prop:"borderBottom",themeKey:"borders",transform:Y}),te=O({prop:"borderLeft",themeKey:"borders",transform:Y}),ne=O({prop:"borderColor",themeKey:"palette"}),re=O({prop:"borderTopColor",themeKey:"palette"}),ae=O({prop:"borderRightColor",themeKey:"palette"}),ie=O({prop:"borderBottomColor",themeKey:"palette"}),oe=O({prop:"borderLeftColor",themeKey:"palette"}),se=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=U(e.theme,"shape.borderRadius",4);return _(e,e.borderRadius,(function(e){return{borderRadius:j(t,e)}}))}return null};se.propTypes={},se.filterProps=["borderRadius"];X(Q,$,J,ee,te,ne,re,ae,ie,oe,se);var ue=function(e){if(void 0!==e.gap&&null!==e.gap){var t=U(e.theme,"spacing",8);return _(e,e.gap,(function(e){return{gap:j(t,e)}}))}return null};ue.propTypes={},ue.filterProps=["gap"];var ce=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=U(e.theme,"spacing",8);return _(e,e.columnGap,(function(e){return{columnGap:j(t,e)}}))}return null};ce.propTypes={},ce.filterProps=["columnGap"];var le=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=U(e.theme,"spacing",8);return _(e,e.rowGap,(function(e){return{rowGap:j(t,e)}}))}return null};le.propTypes={},le.filterProps=["rowGap"];X(ue,ce,le,O({prop:"gridColumn"}),O({prop:"gridRow"}),O({prop:"gridAutoFlow"}),O({prop:"gridAutoColumns"}),O({prop:"gridAutoRows"}),O({prop:"gridTemplateColumns"}),O({prop:"gridTemplateRows"}),O({prop:"gridTemplateAreas"}),O({prop:"gridArea"}));function he(e,t){return"grey"===t?t:e}X(O({prop:"color",themeKey:"palette",transform:he}),O({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:he}),O({prop:"backgroundColor",themeKey:"palette",transform:he}));function de(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var fe=O({prop:"width",transform:de}),pe=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return _(e,e.maxWidth,(function(t){var n;return{maxWidth:(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||I[t]||de(t)}}))}return null};pe.filterProps=["maxWidth"];var me=O({prop:"minWidth",transform:de}),ve=O({prop:"height",transform:de}),ge=O({prop:"maxHeight",transform:de}),ye=O({prop:"minHeight",transform:de}),be=(O({prop:"size",cssProperty:"width",transform:de}),O({prop:"size",cssProperty:"height",transform:de}),X(fe,pe,me,ve,ge,ye,O({prop:"boxSizing"})),{border:{themeKey:"borders",transform:Y},borderTop:{themeKey:"borders",transform:Y},borderRight:{themeKey:"borders",transform:Y},borderBottom:{themeKey:"borders",transform:Y},borderLeft:{themeKey:"borders",transform:Y},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:se},color:{themeKey:"palette",transform:he},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:he},backgroundColor:{themeKey:"palette",transform:he},p:{style:q},pt:{style:q},pr:{style:q},pb:{style:q},pl:{style:q},px:{style:q},py:{style:q},padding:{style:q},paddingTop:{style:q},paddingRight:{style:q},paddingBottom:{style:q},paddingLeft:{style:q},paddingX:{style:q},paddingY:{style:q},paddingInline:{style:q},paddingInlineStart:{style:q},paddingInlineEnd:{style:q},paddingBlock:{style:q},paddingBlockStart:{style:q},paddingBlockEnd:{style:q},m:{style:K},mt:{style:K},mr:{style:K},mb:{style:K},ml:{style:K},mx:{style:K},my:{style:K},margin:{style:K},marginTop:{style:K},marginRight:{style:K},marginBottom:{style:K},marginLeft:{style:K},marginX:{style:K},marginY:{style:K},marginInline:{style:K},marginInlineStart:{style:K},marginInlineEnd:{style:K},marginBlock:{style:K},marginBlockStart:{style:K},marginBlockEnd:{style:K},displayPrint:{cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:ue},rowGap:{style:le},columnGap:{style:ce},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:de},maxWidth:{style:pe},minWidth:{transform:de},height:{transform:de},maxHeight:{transform:de},minHeight:{transform:de},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});var xe=function(){function e(e,t,n,r){var a,i=(a={},(0,x.Z)(a,e,t),(0,x.Z)(a,"theme",n),a),s=r[e];if(!s)return(0,x.Z)({},e,t);var u=s.cssProperty,c=void 0===u?e:u,l=s.themeKey,h=s.transform,d=s.style;if(null==t)return null;if("typography"===l&&"inherit"===t)return(0,x.Z)({},e,t);var f=R(n,l)||{};if(d)return d(i);return _(i,t,(function(t){var n=A(f,h,t);return t===n&&"string"===typeof t&&(n=A(f,h,"".concat(e).concat("default"===t?"":o(t)),t)),!1===c?n:(0,x.Z)({},c,n)}))}return function t(n){var r,a=n||{},i=a.sx,o=a.theme,s=void 0===o?{}:o;if(!i)return null;var u=null!=(r=s.unstable_sxConfig)?r:be;function c(n){var r=n;if("function"===typeof n)r=n(s);else if("object"!==typeof n)return n;if(!r)return null;var a=E(s.breakpoints),i=Object.keys(a),o=a;return Object.keys(r).forEach((function(n){var a,i,c=(a=r[n],i=s,"function"===typeof a?a(i):a);if(null!==c&&void 0!==c)if("object"===typeof c)if(u[n])o=D(o,e(n,c,s,u));else{var l=_({theme:s},c,(function(e){return(0,x.Z)({},n,e)}));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),a=new Set(r);return t.every((function(e){return a.size===Object.keys(e).length}))}(l,c)?o=D(o,l):o[n]=t({sx:c,theme:s})}else o=D(o,e(n,c,s,u))})),N(i,o)}return Array.isArray(i)?i.map(c):c(i)}}();xe.filterProps=["sx"];var we=xe,ke=["breakpoints","palette","spacing","shape"];var Se=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,i=e.spacing,o=e.shape,s=void 0===o?{}:o,u=(0,d.Z)(e,ke),l=function(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,r=e.unit,a=void 0===r?"px":r,i=e.step,o=void 0===i?5:i,s=(0,d.Z)(e,w),u=k(n),l=Object.keys(u);function h(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function f(e){var t="number"===typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-o/100).concat(a,")")}function p(e,t){var r=l.indexOf(t);return"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(a,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[l[r]]?n[l[r]]:t)-o/100).concat(a,")")}return(0,c.Z)({keys:l,values:u,up:h,down:f,between:p,only:function(e){return l.indexOf(e)+1<l.length?p(e,l[l.indexOf(e)+1]):h(e)},not:function(e){var t=l.indexOf(e);return 0===t?h(l[1]):t===l.length-1?f(l[t]):p(e,l[l.indexOf(e)+1]).replace("@media","@media not all and")},unit:a},s)}(n),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=W({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((function(e){var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}(i),f=b({breakpoints:l,direction:"ltr",components:{},palette:(0,c.Z)({mode:"light"},a),spacing:h,shape:(0,c.Z)({},S,s)},u),p=arguments.length,m=new Array(p>1?p-1:0),v=1;v<p;v++)m[v-1]=arguments[v];return(f=m.reduce((function(e,t){return b(e,t)}),f)).unstable_sxConfig=(0,c.Z)({},be,null==u?void 0:u.unstable_sxConfig),f.unstable_sx=function(e){return we({sx:e,theme:this})},f};var Ce=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Ie=Math.abs,Te=String.fromCharCode,_e=Object.assign;function Ee(e){return e.trim()}function Ne(e,t,n){return e.replace(t,n)}function Re(e,t){return e.indexOf(t)}function Ae(e,t){return 0|e.charCodeAt(t)}function Oe(e,t,n){return e.slice(t,n)}function De(e){return e.length}function Pe(e){return e.length}function Me(e,t){return t.push(e),e}var Le=1,Fe=1,ze=0,Be=0,Ve=0,Ue="";function We(e,t,n,r,a,i,o){return{value:e,root:t,parent:n,type:r,props:a,children:i,line:Le,column:Fe,length:o,return:""}}function je(e,t){return _e(We("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ge(){return Ve=Be>0?Ae(Ue,--Be):0,Fe--,10===Ve&&(Fe=1,Le--),Ve}function He(){return Ve=Be<ze?Ae(Ue,Be++):0,Fe++,10===Ve&&(Fe=1,Le++),Ve}function Ke(){return Ae(Ue,Be)}function qe(){return Be}function Ze(e,t){return Oe(Ue,e,t)}function Xe(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ye(e){return Le=Fe=1,ze=De(Ue=e),Be=0,[]}function Qe(e){return Ue="",e}function $e(e){return Ee(Ze(Be-1,tt(91===e?e+2:40===e?e+1:e)))}function Je(e){for(;(Ve=Ke())&&Ve<33;)He();return Xe(e)>2||Xe(Ve)>3?"":" "}function et(e,t){for(;--t&&He()&&!(Ve<48||Ve>102||Ve>57&&Ve<65||Ve>70&&Ve<97););return Ze(e,qe()+(t<6&&32==Ke()&&32==He()))}function tt(e){for(;He();)switch(Ve){case e:return Be;case 34:case 39:34!==e&&39!==e&&tt(Ve);break;case 40:41===e&&tt(e);break;case 92:He()}return Be}function nt(e,t){for(;He()&&e+Ve!==57&&(e+Ve!==84||47!==Ke()););return"/*"+Ze(t,Be-1)+"*"+Te(47===e?e:He())}function rt(e){for(;!Xe(Ke());)He();return Ze(e,Be)}var at="-ms-",it="-moz-",ot="-webkit-",st="comm",ut="rule",ct="decl",lt="@keyframes";function ht(e,t){for(var n="",r=Pe(e),a=0;a<r;a++)n+=t(e[a],a,e,t)||"";return n}function dt(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case ct:return e.return=e.return||e.value;case st:return"";case lt:return e.return=e.value+"{"+ht(e.children,r)+"}";case ut:e.value=e.props.join(",")}return De(n=ht(e.children,r))?e.return=e.value+"{"+n+"}":""}function ft(e){return Qe(pt("",null,null,null,[""],e=Ye(e),0,[0],e))}function pt(e,t,n,r,a,i,o,s,u){for(var c=0,l=0,h=o,d=0,f=0,p=0,m=1,v=1,g=1,y=0,b="",x=a,w=i,k=r,S=b;v;)switch(p=y,y=He()){case 40:if(108!=p&&58==Ae(S,h-1)){-1!=Re(S+=Ne($e(y),"&","&\f"),"&\f")&&(g=-1);break}case 34:case 39:case 91:S+=$e(y);break;case 9:case 10:case 13:case 32:S+=Je(p);break;case 92:S+=et(qe()-1,7);continue;case 47:switch(Ke()){case 42:case 47:Me(vt(nt(He(),qe()),t,n),u);break;default:S+="/"}break;case 123*m:s[c++]=De(S)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:v=0;case 59+l:-1==g&&(S=Ne(S,/\f/g,"")),f>0&&De(S)-h&&Me(f>32?gt(S+";",r,n,h-1):gt(Ne(S," ","")+";",r,n,h-2),u);break;case 59:S+=";";default:if(Me(k=mt(S,t,n,c,l,a,s,b,x=[],w=[],h),i),123===y)if(0===l)pt(S,t,k,k,x,i,h,s,w);else switch(99===d&&110===Ae(S,3)?100:d){case 100:case 108:case 109:case 115:pt(e,k,k,r&&Me(mt(e,k,k,0,0,a,s,b,a,x=[],h),w),a,w,h,s,r?x:w);break;default:pt(S,k,k,k,[""],w,0,s,w)}}c=l=f=0,m=g=1,b=S="",h=o;break;case 58:h=1+De(S),f=p;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==Ge())continue;switch(S+=Te(y),y*m){case 38:g=l>0?1:(S+="\f",-1);break;case 44:s[c++]=(De(S)-1)*g,g=1;break;case 64:45===Ke()&&(S+=$e(He())),d=Ke(),l=h=De(b=S+=rt(qe())),y++;break;case 45:45===p&&2==De(S)&&(m=0)}}return i}function mt(e,t,n,r,a,i,o,s,u,c,l){for(var h=a-1,d=0===a?i:[""],f=Pe(d),p=0,m=0,v=0;p<r;++p)for(var g=0,y=Oe(e,h+1,h=Ie(m=o[p])),b=e;g<f;++g)(b=Ee(m>0?d[g]+" "+y:Ne(y,/&\f/g,d[g])))&&(u[v++]=b);return We(e,t,n,0===a?ut:s,u,c,l)}function vt(e,t,n){return We(e,t,n,st,Te(Ve),Oe(e,2,-2),0)}function gt(e,t,n,r){return We(e,t,n,ct,Oe(e,0,r),Oe(e,r+1,-1),r)}var yt=function(e,t,n){for(var r=0,a=0;r=a,a=Ke(),38===r&&12===a&&(t[n]=1),!Xe(a);)He();return Ze(e,Be)},bt=function(e,t){return Qe(function(e,t){var n=-1,r=44;do{switch(Xe(r)){case 0:38===r&&12===Ke()&&(t[n]=1),e[n]+=yt(Be-1,t,n);break;case 2:e[n]+=$e(r);break;case 4:if(44===r){e[++n]=58===Ke()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Te(r)}}while(r=He());return e}(Ye(e),t))},xt=new WeakMap,wt=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||xt.get(n))&&!r){xt.set(e,!0);for(var a=[],i=bt(t,a),o=n.props,s=0,u=0;s<i.length;s++)for(var c=0;c<o.length;c++,u++)e.props[u]=a[s]?i[s].replace(/&\f/g,o[c]):o[c]+" "+i[s]}}},kt=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function St(e,t){switch(function(e,t){return 45^Ae(e,0)?(((t<<2^Ae(e,0))<<2^Ae(e,1))<<2^Ae(e,2))<<2^Ae(e,3):0}(e,t)){case 5103:return ot+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ot+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ot+e+it+e+at+e+e;case 6828:case 4268:return ot+e+at+e+e;case 6165:return ot+e+at+"flex-"+e+e;case 5187:return ot+e+Ne(e,/(\w+).+(:[^]+)/,ot+"box-$1$2"+at+"flex-$1$2")+e;case 5443:return ot+e+at+"flex-item-"+Ne(e,/flex-|-self/,"")+e;case 4675:return ot+e+at+"flex-line-pack"+Ne(e,/align-content|flex-|-self/,"")+e;case 5548:return ot+e+at+Ne(e,"shrink","negative")+e;case 5292:return ot+e+at+Ne(e,"basis","preferred-size")+e;case 6060:return ot+"box-"+Ne(e,"-grow","")+ot+e+at+Ne(e,"grow","positive")+e;case 4554:return ot+Ne(e,/([^-])(transform)/g,"$1"+ot+"$2")+e;case 6187:return Ne(Ne(Ne(e,/(zoom-|grab)/,ot+"$1"),/(image-set)/,ot+"$1"),e,"")+e;case 5495:case 3959:return Ne(e,/(image-set\([^]*)/,ot+"$1$`$1");case 4968:return Ne(Ne(e,/(.+:)(flex-)?(.*)/,ot+"box-pack:$3"+at+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ot+e+e;case 4095:case 3583:case 4068:case 2532:return Ne(e,/(.+)-inline(.+)/,ot+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(De(e)-1-t>6)switch(Ae(e,t+1)){case 109:if(45!==Ae(e,t+4))break;case 102:return Ne(e,/(.+:)(.+)-([^]+)/,"$1"+ot+"$2-$3$1"+it+(108==Ae(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Re(e,"stretch")?St(Ne(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Ae(e,t+1))break;case 6444:switch(Ae(e,De(e)-3-(~Re(e,"!important")&&10))){case 107:return Ne(e,":",":"+ot)+e;case 101:return Ne(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ot+(45===Ae(e,14)?"inline-":"")+"box$3$1"+ot+"$2$3$1"+at+"$2box$3")+e}break;case 5936:switch(Ae(e,t+11)){case 114:return ot+e+at+Ne(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ot+e+at+Ne(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ot+e+at+Ne(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ot+e+at+e+e}return e}var Ct=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case ct:e.return=St(e.value,e.length);break;case lt:return ht([je(e,{value:Ne(e.value,"@","@"+ot)})],r);case ut:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ht([je(e,{props:[Ne(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return ht([je(e,{props:[Ne(t,/:(plac\w+)/,":"+ot+"input-$1")]}),je(e,{props:[Ne(t,/:(plac\w+)/,":-moz-$1")]}),je(e,{props:[Ne(t,/:(plac\w+)/,at+"input-$1")]})],r)}return""}))}}],It=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||Ct;var a,i,o={},s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;s.push(e)}));var u,c,l=[dt,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=Pe(e);return function(n,r,a,i){for(var o="",s=0;s<t;s++)o+=e[s](n,r,a,i)||"";return o}}([wt,kt].concat(r,l));i=function(e,t,n,r){u=n,ht(ft(e?e+"{"+t.styles+"}":t.styles),h),r&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new Ce({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:i};return d.sheet.hydrate(s),d};var Tt={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function _t(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var Et=/[A-Z]|^ms/g,Nt=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Rt=function(e){return 45===e.charCodeAt(1)},At=function(e){return null!=e&&"boolean"!==typeof e},Ot=_t((function(e){return Rt(e)?e:e.replace(Et,"-$&").toLowerCase()})),Dt=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Nt,(function(e,t,n){return Mt={name:t,styles:n,next:Mt},t}))}return 1===Tt[e]||Rt(e)||"number"!==typeof t||0===t?t:t+"px"};function Pt(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Mt={name:n.name,styles:n.styles,next:Mt},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Mt={name:r.name,styles:r.styles,next:Mt},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=Pt(e,t,n[a])+";";else for(var i in n){var o=n[i];if("object"!==typeof o)null!=t&&void 0!==t[o]?r+=i+"{"+t[o]+"}":At(o)&&(r+=Ot(i)+":"+Dt(i,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=Pt(e,t,o);switch(i){case"animation":case"animationName":r+=Ot(i)+":"+s+";";break;default:r+=i+"{"+s+"}"}}else for(var u=0;u<o.length;u++)At(o[u])&&(r+=Ot(i)+":"+Dt(i,o[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=Mt,i=n(e);return Mt=a,Pt(e,t,i)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var Mt,Lt=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var Ft=!!h.useInsertionEffect&&h.useInsertionEffect,zt=Ft||function(e){return e()},Bt=(Ft||l.useLayoutEffect,l.createContext("undefined"!==typeof HTMLElement?It({key:"css"}):null));Bt.Provider;var Vt=function(e){return(0,l.forwardRef)((function(t,n){var r=(0,l.useContext)(Bt);return e(t,r,n)}))};var Ut=l.createContext({});var Wt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=l.useContext(Ut);return n&&(e=n,0!==Object.keys(e).length)?n:t},jt=Se();var Gt=function(){return Wt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt)};function Ht(e,t){var n;return(0,c.Z)({toolbar:(n={minHeight:56},(0,x.Z)(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),(0,x.Z)(n,e.up("sm"),{minHeight:64}),n)},t)}function Kt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function qt(e){if(e.type)return e;if("#"===e.charAt(0))return qt(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(i(9,e));var r,a=e.substring(t+1,e.length-1);if("color"===n){if(r=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(i(10,r))}else a=a.split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)})),colorSpace:r}}function Zt(e){var t=e.type,n=e.colorSpace,r=e.values;return-1!==t.indexOf("rgb")?r=r.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function Xt(e){var t="hsl"===(e=qt(e)).type||"hsla"===e.type?qt(function(e){var t=(e=qt(e)).values,n=t[0],r=t[1]/100,a=t[2]/100,i=r*Math.min(a,1-a),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return a-i*Math.max(Math.min(t-3,9-t,1),-1)},s="rgb",u=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(s+="a",u.push(t[3])),Zt({type:s,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Yt(e,t){if(e=qt(e),t=Kt(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return Zt(e)}function Qt(e,t){if(e=qt(e),t=Kt(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Zt(e)}var $t={black:"#000",white:"#fff"},Jt={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},en={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},tn={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},nn={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},rn={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},an={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},on={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},sn=["mode","contrastThreshold","tonalOffset"],un={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:$t.white,default:$t.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},cn={text:{primary:$t.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:$t.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function ln(e,t,n,r){var a=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=Qt(e.main,a):"dark"===t&&(e.dark=Yt(e.main,i)))}function hn(e){var t=e.mode,n=void 0===t?"light":t,r=e.contrastThreshold,a=void 0===r?3:r,o=e.tonalOffset,s=void 0===o?.2:o,u=(0,d.Z)(e,sn),l=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:rn[200],light:rn[50],dark:rn[400]}:{main:rn[700],light:rn[400],dark:rn[800]}}(n),h=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:en[200],light:en[50],dark:en[400]}:{main:en[500],light:en[300],dark:en[700]}}(n),f=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:tn[500],light:tn[300],dark:tn[700]}:{main:tn[700],light:tn[400],dark:tn[800]}}(n),p=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:an[400],light:an[300],dark:an[700]}:{main:an[700],light:an[500],dark:an[900]}}(n),m=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:on[400],light:on[300],dark:on[700]}:{main:on[800],light:on[500],dark:on[900]}}(n),v=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:nn[400],light:nn[300],dark:nn[700]}:{main:"#ed6c02",light:nn[500],dark:nn[900]}}(n);function g(e){var t=function(e,t){var n=Xt(e),r=Xt(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,cn.text.primary)>=a?cn.text.primary:un.text.primary;return t}var y=function(e){var t=e.color,n=e.name,r=e.mainShade,a=void 0===r?500:r,o=e.lightShade,u=void 0===o?300:o,l=e.darkShade,h=void 0===l?700:l;if(!(t=(0,c.Z)({},t)).main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error(i(11,n?" (".concat(n,")"):"",a));if("string"!==typeof t.main)throw new Error(i(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return ln(t,"light",u,s),ln(t,"dark",h,s),t.contrastText||(t.contrastText=g(t.main)),t},x={dark:cn,light:un};return b((0,c.Z)({common:(0,c.Z)({},$t),mode:n,primary:y({color:l,name:"primary"}),secondary:y({color:h,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:y({color:f,name:"error"}),warning:y({color:v,name:"warning"}),info:y({color:p,name:"info"}),success:y({color:m,name:"success"}),grey:Jt,contrastThreshold:a,getContrastText:g,augmentColor:y,tonalOffset:s},x[n]),u)}var dn=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var fn={textTransform:"uppercase"},pn='"Roboto", "Helvetica", "Arial", sans-serif';function mn(e,t){var n="function"===typeof t?t(e):t,r=n.fontFamily,a=void 0===r?pn:r,i=n.fontSize,o=void 0===i?14:i,s=n.fontWeightLight,u=void 0===s?300:s,l=n.fontWeightRegular,h=void 0===l?400:l,f=n.fontWeightMedium,p=void 0===f?500:f,m=n.fontWeightBold,v=void 0===m?700:m,g=n.htmlFontSize,y=void 0===g?16:g,x=n.allVariants,w=n.pxToRem,k=(0,d.Z)(n,dn);var S=o/14,C=w||function(e){return"".concat(e/y*S,"rem")},I=function(e,t,n,r,i){return(0,c.Z)({fontFamily:a,fontWeight:e,fontSize:C(t),lineHeight:n},a===pn?{letterSpacing:"".concat((o=r/t,Math.round(1e5*o)/1e5),"em")}:{},i,x);var o},T={h1:I(u,96,1.167,-1.5),h2:I(u,60,1.2,-.5),h3:I(h,48,1.167,0),h4:I(h,34,1.235,.25),h5:I(h,24,1.334,0),h6:I(p,20,1.6,.15),subtitle1:I(h,16,1.75,.15),subtitle2:I(p,14,1.57,.1),body1:I(h,16,1.5,.15),body2:I(h,14,1.43,.15),button:I(p,14,1.75,.4,fn),caption:I(h,12,1.66,.4),overline:I(h,12,2.66,1,fn),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return b((0,c.Z)({htmlFontSize:y,pxToRem:C,fontFamily:a,fontSize:o,fontWeightLight:u,fontWeightRegular:h,fontWeightMedium:p,fontWeightBold:v},T),k,{clone:!1})}function vn(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var gn=["none",vn(0,2,1,-1,0,1,1,0,0,1,3,0),vn(0,3,1,-2,0,2,2,0,0,1,5,0),vn(0,3,3,-2,0,3,4,0,0,1,8,0),vn(0,2,4,-1,0,4,5,0,0,1,10,0),vn(0,3,5,-1,0,5,8,0,0,1,14,0),vn(0,3,5,-1,0,6,10,0,0,1,18,0),vn(0,4,5,-2,0,7,10,1,0,2,16,1),vn(0,5,5,-3,0,8,10,1,0,3,14,2),vn(0,5,6,-3,0,9,12,1,0,3,16,2),vn(0,6,6,-3,0,10,14,1,0,4,18,3),vn(0,6,7,-4,0,11,15,1,0,4,20,3),vn(0,7,8,-4,0,12,17,2,0,5,22,4),vn(0,7,8,-4,0,13,19,2,0,5,24,4),vn(0,7,9,-4,0,14,21,2,0,5,26,4),vn(0,8,9,-5,0,15,22,2,0,6,28,5),vn(0,8,10,-5,0,16,24,2,0,6,30,5),vn(0,8,11,-5,0,17,26,2,0,6,32,5),vn(0,9,11,-5,0,18,28,2,0,7,34,6),vn(0,9,12,-6,0,19,29,2,0,7,36,6),vn(0,10,13,-6,0,20,31,3,0,8,38,7),vn(0,10,13,-6,0,21,33,3,0,8,40,7),vn(0,10,14,-6,0,22,35,3,0,8,42,7),vn(0,11,14,-7,0,23,36,3,0,9,44,8),vn(0,11,15,-7,0,24,38,3,0,9,46,8)],yn=["duration","easing","delay"],bn={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},xn={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function wn(e){return"".concat(Math.round(e),"ms")}function kn(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function Sn(e){var t=(0,c.Z)({},bn,e.easing),n=(0,c.Z)({},xn,e.duration);return(0,c.Z)({getAutoHeightDuration:kn,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.duration,i=void 0===a?n.standard:a,o=r.easing,s=void 0===o?t.easeInOut:o,u=r.delay,c=void 0===u?0:u;(0,d.Z)(r,yn);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof i?i:wn(i)," ").concat(s," ").concat("string"===typeof c?c:wn(c))})).join(",")}},e,{easing:t,duration:n})}var Cn={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},In=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,o=e.transitions,s=void 0===o?{}:o,u=e.typography,l=void 0===u?{}:u,h=(0,d.Z)(e,In);if(e.vars)throw new Error(i(18));var f=hn(a),p=Se(e),m=b(p,{mixins:Ht(p.breakpoints,n),palette:f,shadows:gn.slice(),typography:mn(f,l),transitions:Sn(s),zIndex:(0,c.Z)({},Cn)});m=b(m,h);for(var v=arguments.length,g=new Array(v>1?v-1:0),y=1;y<v;y++)g[y-1]=arguments[y];return(m=g.reduce((function(e,t){return b(e,t)}),m)).unstable_sxConfig=(0,c.Z)({},be,null==h?void 0:h.unstable_sxConfig),m.unstable_sx=function(e){return we({sx:e,theme:this})},m}var _n=Tn(),En="$$material";function Nn(e){return function(e){var t=e.props,n=e.name,r=e.defaultTheme,a=e.themeId,i=Gt(r);return a&&(i=i[a]||i),v({theme:i,name:n,props:t})}({props:e.props,name:e.name,defaultTheme:_n,themeId:En})}var Rn=n(2982),An=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/;var On=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},Dn=_t((function(e){return An.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),Pn=function(e){return"theme"!==e},Mn=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Dn:Pn},Ln=function(e,t,n){var r;if(t){var a=t.shouldForwardProp;r=e.__emotion_forwardProp&&a?function(t){return e.__emotion_forwardProp(t)&&a(t)}:a}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},Fn=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return On(t,n,r),zt((function(){return function(e,t,n){On(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+r:"",a,e.sheet,!0),a=a.next}while(void 0!==a)}}(t,n,r)})),null},zn=function e(t,n){var r,a,i=t.__emotion_real===t,o=i&&t.__emotion_base||t;void 0!==n&&(r=n.label,a=n.target);var s=Ln(t,n,i),u=s||Mn(o),h=!u("as");return function(){var d=arguments,f=i&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==r&&f.push("label:"+r+";"),null==d[0]||void 0===d[0].raw)f.push.apply(f,d);else{0,f.push(d[0][0]);for(var p=d.length,m=1;m<p;m++)f.push(d[m],d[0][m])}var v=Vt((function(e,t,n){var r=h&&e.as||o,i="",c=[],d=e;if(null==e.theme){for(var p in d={},e)d[p]=e[p];d.theme=l.useContext(Ut)}"string"===typeof e.className?i=function(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}(t.registered,c,e.className):null!=e.className&&(i=e.className+" ");var m=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,a="";Mt=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,a+=Pt(n,t,i)):a+=i[0];for(var o=1;o<e.length;o++)a+=Pt(n,t,e[o]),r&&(a+=i[o]);Lt.lastIndex=0;for(var s,u="";null!==(s=Lt.exec(a));)u+="-"+s[1];var c=function(e){for(var t,n=0,r=0,a=e.length;a>=4;++r,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(a){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(a)+u;return{name:c,styles:a,next:Mt}}(f.concat(c),t.registered,d);i+=t.key+"-"+m.name,void 0!==a&&(i+=" "+a);var v=h&&void 0===s?Mn(r):u,g={};for(var y in e)h&&"as"===y||v(y)&&(g[y]=e[y]);return g.className=i,g.ref=n,l.createElement(l.Fragment,null,l.createElement(Fn,{cache:t,serialized:m,isStringTag:"string"===typeof r}),l.createElement(r,g))}));return v.displayName=void 0!==r?r:"Styled("+("string"===typeof o?o:o.displayName||o.name||"Component")+")",v.defaultProps=t.defaultProps,v.__emotion_real=v,v.__emotion_base=o,v.__emotion_styles=f,v.__emotion_forwardProp=s,Object.defineProperty(v,"toString",{value:function(){return"."+a}}),v.withComponent=function(t,r){return e(t,(0,c.Z)({},n,r,{shouldForwardProp:Ln(v,r,!0)})).apply(void 0,f)},v}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){zn[e]=zn(e)}));var Bn=["variant"];function Vn(e){return 0===e.length}function Un(e){var t=e.variant,n=(0,d.Z)(e,Bn),r=t||"";return Object.keys(n).sort().forEach((function(t){r+="color"===t?Vn(r)?e[t]:o(e[t]):"".concat(Vn(r)?t:o(t)).concat(o(e[t].toString()))})),r}var Wn=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function jn(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var Gn=Se();function Hn(e){var t,n=e.defaultTheme,r=e.theme,a=e.themeId;return t=r,0===Object.keys(t).length?n:r[a]||r}var Kn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.themeId,n=e.defaultTheme,r=void 0===n?Gn:n,a=e.rootShouldForwardProp,i=void 0===a?jn:a,o=e.slotShouldForwardProp,s=void 0===o?jn:o,u=function(e){return we((0,c.Z)({},e,{theme:Hn((0,c.Z)({},e,{defaultTheme:r,themeId:t}))}))};return u.__mui_systemSx=!0,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,(function(e){return e.filter((function(e){return!(null!=e&&e.__mui_systemSx)}))}));var a,o,l=n.name,h=n.slot,f=n.skipVariantsResolver,p=n.skipSx,m=n.overridesResolver,v=void 0===m?(a=(o=h)?o.charAt(0).toLowerCase()+o.slice(1):o)?function(e,t){return t[a]}:null:m,g=(0,d.Z)(n,Wn),y=void 0!==f?f:h&&"Root"!==h&&"root"!==h||!1,b=p||!1;var x=jn;"Root"===h||"root"===h?x=i:h?x=s:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(x=void 0);var w=function(e,t){return zn(e,t)}(e,(0,c.Z)({shouldForwardProp:x,label:undefined},g)),k=function(n){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];var s=i?i.map((function(e){return"function"===typeof e&&e.__emotion_real!==e?function(n){return e((0,c.Z)({},n,{theme:Hn((0,c.Z)({},n,{defaultTheme:r,themeId:t}))}))}:e})):[],h=n;l&&v&&s.push((function(e){var n=Hn((0,c.Z)({},e,{defaultTheme:r,themeId:t})),a=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null}(l,n);if(a){var i={};return Object.entries(a).forEach((function(t){var r=(0,C.Z)(t,2),a=r[0],o=r[1];i[a]="function"===typeof o?o((0,c.Z)({},e,{theme:n})):o})),v(e,i)}return null})),l&&!y&&s.push((function(e){var n=Hn((0,c.Z)({},e,{defaultTheme:r,themeId:t}));return function(e,t,n,r){var a,i=e.ownerState,o=void 0===i?{}:i,s=[],u=null==n||null==(a=n.components)||null==(a=a[r])?void 0:a.variants;return u&&u.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(t){o[t]!==n.props[t]&&e[t]!==n.props[t]&&(r=!1)})),r&&s.push(t[Un(n.props)])})),s}(e,function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var r={};return n.forEach((function(e){var t=Un(e.props);r[t]=e.style})),r}(l,n),n,l)})),b||s.push(u);var d=s.length-i.length;if(Array.isArray(n)&&d>0){var f=new Array(d).fill("");(h=[].concat((0,Rn.Z)(n),(0,Rn.Z)(f))).raw=[].concat((0,Rn.Z)(n.raw),(0,Rn.Z)(f))}else"function"===typeof n&&n.__emotion_real!==n&&(h=function(e){return n((0,c.Z)({},e,{theme:Hn((0,c.Z)({},e,{defaultTheme:r,themeId:t}))}))});var p=w.apply(void 0,[h].concat((0,Rn.Z)(s)));return e.muiName&&(p.muiName=e.muiName),p};return w.withConfig&&(k.withConfig=w.withConfig),k}}({themeId:En,defaultTheme:_n,rootShouldForwardProp:function(e){return jn(e)&&"classes"!==e}}),qn=Kn,Zn={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Xn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r=Zn[t];return r?"".concat(n,"-").concat(r):"".concat(a.generate(e),"-").concat(t)}function Yn(e){return Xn("MuiSvgIcon",e)}!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r={};t.forEach((function(t){r[t]=Xn(e,t,n)}))}("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var Qn=n(184),$n=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Jn=function(e){var t=e.color,n=e.fontSize,r=e.classes;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r={};return Object.keys(e).forEach((function(a){r[a]=e[a].reduce((function(e,r){if(r){var a=t(r);""!==a&&e.push(a),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}({root:["root","inherit"!==t&&"color".concat(s(t)),"fontSize".concat(s(n))]},Yn,r)},er=qn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,"inherit"!==n.color&&t["color".concat(s(n.color))],t["fontSize".concat(s(n.fontSize))]]}})((function(e){var t,n,r,a,i,o,s,u,c,l,h,d,f,p=e.theme,m=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:m.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(t=p.transitions)||null==(n=t.create)?void 0:n.call(t,"fill",{duration:null==(r=p.transitions)||null==(r=r.duration)?void 0:r.shorter}),fontSize:{inherit:"inherit",small:(null==(a=p.typography)||null==(i=a.pxToRem)?void 0:i.call(a,20))||"1.25rem",medium:(null==(o=p.typography)||null==(s=o.pxToRem)?void 0:s.call(o,24))||"1.5rem",large:(null==(u=p.typography)||null==(c=u.pxToRem)?void 0:c.call(u,35))||"2.1875rem"}[m.fontSize],color:null!=(l=null==(h=(p.vars||p).palette)||null==(h=h[m.color])?void 0:h.main)?l:{action:null==(d=(p.vars||p).palette)||null==(d=d.action)?void 0:d.active,disabled:null==(f=(p.vars||p).palette)||null==(f=f.action)?void 0:f.disabled,inherit:void 0}[m.color]}})),tr=l.forwardRef((function(e,t){var n=Nn({props:e,name:"MuiSvgIcon"}),r=n.children,a=n.className,i=n.color,o=void 0===i?"inherit":i,s=n.component,u=void 0===s?"svg":s,h=n.fontSize,f=void 0===h?"medium":h,m=n.htmlColor,v=n.inheritViewBox,g=void 0!==v&&v,y=n.titleAccess,b=n.viewBox,x=void 0===b?"0 0 24 24":b,w=(0,d.Z)(n,$n),k=l.isValidElement(r)&&"svg"===r.type,S=(0,c.Z)({},n,{color:o,component:u,fontSize:f,instanceFontSize:e.fontSize,inheritViewBox:g,viewBox:x,hasSvgAsChild:k}),C={};g||(C.viewBox=x);var I=Jn(S);return(0,Qn.jsxs)(er,(0,c.Z)({as:u,className:p(I.root,a),focusable:"false",color:m,"aria-hidden":!y||void 0,role:y?"img":void 0,ref:t},C,w,k&&r.props,{ownerState:S,children:[k?r.props.children:r,y?(0,Qn.jsx)("title",{children:y}):null]}))}));tr.muiName="SvgIcon";var nr=tr;function rr(e,t){function n(n,r){return(0,Qn.jsx)(nr,(0,c.Z)({"data-testid":"".concat(t,"Icon"),ref:r},n,{children:e}))}return n.muiName=nr.muiName,l.memo(l.forwardRef(n))}var ar=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];clearTimeout(t),t=setTimeout((function(){e.apply(r,i)}),n)}return r.clear=function(){clearTimeout(t)},r};var ir=function(e,t){return function(){return null}};var or=function(e,t){return l.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)};function sr(e){return e&&e.ownerDocument||document}var ur=sr;var cr=function(e){return sr(e).defaultView||window};var lr=function(e,t){return function(){return null}};function hr(e,t){"function"===typeof e?e(t):e&&(e.current=t)}var dr=hr,fr="undefined"!==typeof window?l.useLayoutEffect:l.useEffect,pr=fr,mr=0;var vr=h["useId".toString()];var gr=function(e){if(void 0!==vr){var t=vr();return null!=e?e:t}return function(e){var t=l.useState(e),n=(0,C.Z)(t,2),r=n[0],a=n[1],i=e||r;return l.useEffect((function(){null==r&&a("mui-".concat(mr+=1))}),[r]),i}(e)};var yr=function(e,t,n,r,a){return null};var br=function(e){var t=e.controlled,n=e.default,r=(e.name,e.state,l.useRef(void 0!==t).current),a=l.useState(n),i=(0,C.Z)(a,2),o=i[0],s=i[1];return[r?t:o,l.useCallback((function(e){r||s(e)}),[])]};var xr=function(e){var t=l.useRef(e);return fr((function(){t.current=e})),l.useCallback((function(){return t.current.apply(void 0,arguments)}),[])},wr=xr;var kr,Sr=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo((function(){return t.every((function(e){return null==e}))?null:function(e){t.forEach((function(t){hr(t,e)}))}}),t)},Cr=!0,Ir=!1,Tr={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function _r(e){e.metaKey||e.altKey||e.ctrlKey||(Cr=!0)}function Er(){Cr=!1}function Nr(){"hidden"===this.visibilityState&&Ir&&(Cr=!0)}function Rr(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return Cr||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!Tr[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}var Ar=function(){var e=l.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",_r,!0),t.addEventListener("mousedown",Er,!0),t.addEventListener("pointerdown",Er,!0),t.addEventListener("touchstart",Er,!0),t.addEventListener("visibilitychange",Nr,!0))}),[]),t=l.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!Rr(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(Ir=!0,window.clearTimeout(kr),kr=window.setTimeout((function(){Ir=!1}),100),t.current=!1,!0)},ref:e}},Or={configure:function(e){a.configure(e)}}},8097:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(I){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?g:v;if(t){if(e<0)return g;if(e>=f)return k}else{if(e<=-p)return S;if(e+1>=p)return w}return e<0?s(-e,t).neg():u(e%d|0,e/d|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=v,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),h=parseInt(e.substring(o,o+u),n);if(u<8){var d=s(c(n,u));i=i.mul(d).add(s(h))}else i=(i=i.mul(a)).add(s(h))}return i.unsigned=t,i}function h(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?l(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,m=o(1<<24),v=o(0);n.ZERO=v;var g=o(0,!0);n.UZERO=g;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=u(-1,2147483647,!1);n.MAX_VALUE=w;var k=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=u(0,-2147483648,!1);n.MIN_VALUE=S;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(e);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1===(1&this.low)},C.isEven=function(){return 0===(1&this.low)},C.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},C.neg=C.negate,C.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,d=0,f=0,p=0;return f+=(p+=i+(65535&e.low))>>>16,d+=(f+=a+c)>>>16,l+=(d+=n+s)>>>16,l+=t+o,u((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return v;if(r(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(S))return e.isOdd()?S:v;if(e.eq(S))return this.isOdd()?S:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,g=0,y=0,b=0;return y+=(b+=o*f)>>>16,g+=(y+=i*f)>>>16,y&=65535,g+=(y+=o*d)>>>16,p+=(g+=a*f)>>>16,g&=65535,p+=(g+=i*d)>>>16,g&=65535,p+=(g+=o*l)>>>16,p+=n*f+a*d+i*l+o*c,u((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(g&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return b;i=g}else{if(this.eq(S))return e.eq(y)||e.eq(x)?S:e.eq(S)?y:(n=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?y:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(S))return this.unsigned?g:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=v}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),d=s(n),f=d.mul(e);f.isNegative()||f.gt(a);)f=(d=s(n-=l,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),a=a.sub(f)}return i},C.div=C.divide,C.modulo=function(e){return r(e)||(e=h(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return u(~this.low,~this.high,this.unsigned)},C.and=function(e){return r(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return r(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return r(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7892:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",a="second",i="minute",o="hour",s="day",u="week",c="month",l="quarter",h="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},g=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:g,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),a=n%60;return(t<=0?"+":"-")+g(r,2,"0")+":"+g(a,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),a=t.clone().add(r,c),i=n-a<0,o=t.clone().add(r+(i?-1:1),c);return+(-(r+(n-a)/(i?a-o:o-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:h,w:u,d:s,D:d,h:o,m:i,s:a,ms:r,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",x={};x[b]=v;var w=function(e){return e instanceof I},k=function e(t,n,r){var a;if(!t)return b;if("string"==typeof t){var i=t.toLowerCase();x[i]&&(a=i),n&&(x[i]=n,a=i);var o=t.split("-");if(!a&&o.length>1)return e(o[0])}else{var s=t.name;x[s]=t,a=s}return!r&&a&&(b=a),a||!r&&b},S=function(e,t){if(w(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new I(n)},C=y;C.l=k,C.i=w,C.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var I=function(){function v(e){this.$L=k(e.locale,null,!0),this.parse(e)}var g=v.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var a=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return C},g.isValid=function(){return!(this.$d.toString()===f)},g.isSame=function(e,t){var n=S(e);return this.startOf(t)<=n&&n<=this.endOf(t)},g.isAfter=function(e,t){return S(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<S(e)},g.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var n=this,r=!!C.u(t)||t,l=C.p(e),f=function(e,t){var a=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?a:a.endOf(s)},p=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,v=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(l){case h:return r?f(1,0):f(31,11);case c:return r?f(1,v):f(0,v+1);case u:var b=this.$locale().weekStart||0,x=(m<b?m+7:m)-b;return f(r?g-x:g+(6-x),v);case s:case d:return p(y+"Hours",0);case o:return p(y+"Minutes",1);case i:return p(y+"Seconds",2);case a:return p(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var n,u=C.p(e),l="set"+(this.$u?"UTC":""),f=(n={},n[s]=l+"Date",n[d]=l+"Date",n[c]=l+"Month",n[h]=l+"FullYear",n[o]=l+"Hours",n[i]=l+"Minutes",n[a]=l+"Seconds",n[r]=l+"Milliseconds",n)[u],p=u===s?this.$D+(t-this.$W):t;if(u===c||u===h){var m=this.clone().set(d,1);m.$d[f](p),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[C.p(e)]()},g.add=function(r,l){var d,f=this;r=Number(r);var p=C.p(l),m=function(e){var t=S(f);return C.w(t.date(t.date()+Math.round(e*r)),f)};if(p===c)return this.set(c,this.$M+r);if(p===h)return this.set(h,this.$y+r);if(p===s)return m(1);if(p===u)return m(7);var v=(d={},d[i]=t,d[o]=n,d[a]=e,d)[p]||1,g=this.$d.getTime()+r*v;return C.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",a=C.z(this),i=this.$H,o=this.$m,s=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,h=function(e,n,a,i){return e&&(e[n]||e(t,r))||a[n].slice(0,i)},d=function(e){return C.s(i%12||12,e,"0")},p=l||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(m,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return C.s(t.$y,4,"0");case"M":return s+1;case"MM":return C.s(s+1,2,"0");case"MMM":return h(n.monthsShort,s,c,3);case"MMMM":return h(c,s);case"D":return t.$D;case"DD":return C.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,u,2);case"ddd":return h(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return C.s(i,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return p(i,o,!0);case"A":return p(i,o,!1);case"m":return String(o);case"mm":return C.s(o,2,"0");case"s":return String(t.$s);case"ss":return C.s(t.$s,2,"0");case"SSS":return C.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(r,d,f){var p,m=this,v=C.p(d),g=S(r),y=(g.utcOffset()-this.utcOffset())*t,b=this-g,x=function(){return C.m(m,g)};switch(v){case h:p=x()/12;break;case c:p=x();break;case l:p=x()/3;break;case u:p=(b-y)/6048e5;break;case s:p=(b-y)/864e5;break;case o:p=b/n;break;case i:p=b/t;break;case a:p=b/e;break;default:p=b}return f?p:C.a(p)},g.daysInMonth=function(){return this.endOf(c).$D},g.$locale=function(){return x[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=k(e,t,!0);return r&&(n.$L=r),n},g.clone=function(){return C.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},v}(),T=I.prototype;return S.prototype=T,[["$ms",r],["$s",a],["$m",i],["$H",o],["$W",s],["$M",c],["$y",h],["$D",d]].forEach((function(e){T[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,I,S),e.$i=!0),S},S.locale=k,S.isDayjs=w,S.unix=function(e){return S(1e3*e)},S.en=x[b],S.Ls=x,S.p={},S}()},5884:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"ja",weekdays:"\u65e5\u66dc\u65e5_\u6708\u66dc\u65e5_\u706b\u66dc\u65e5_\u6c34\u66dc\u65e5_\u6728\u66dc\u65e5_\u91d1\u66dc\u65e5_\u571f\u66dc\u65e5".split("_"),weekdaysShort:"\u65e5_\u6708_\u706b_\u6c34_\u6728_\u91d1_\u571f".split("_"),weekdaysMin:"\u65e5_\u6708_\u706b_\u6c34_\u6728_\u91d1_\u571f".split("_"),months:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(e){return e+"\u65e5"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5e74M\u6708D\u65e5",LLL:"YYYY\u5e74M\u6708D\u65e5 HH:mm",LLLL:"YYYY\u5e74M\u6708D\u65e5 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY\u5e74M\u6708D\u65e5",lll:"YYYY\u5e74M\u6708D\u65e5 HH:mm",llll:"YYYY\u5e74M\u6708D\u65e5(ddd) HH:mm"},meridiem:function(e){return e<12?"\u5348\u524d":"\u5348\u5f8c"},relativeTime:{future:"%s\u5f8c",past:"%s\u524d",s:"\u6570\u79d2",m:"1\u5206",mm:"%d\u5206",h:"1\u6642\u9593",hh:"%d\u6642\u9593",d:"1\u65e5",dd:"%d\u65e5",M:"1\u30f6\u6708",MM:"%d\u30f6\u6708",y:"1\u5e74",yy:"%d\u5e74"}};return n.default.locale(r,null,!0),r}(n(7892))},2110:function(e,t,n){"use strict";var r=n(8309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var a=f(n);a&&a!==p&&e(t,a,r)}var o=l(n);h&&(o=o.concat(h(n)));for(var s=u(t),m=u(n),v=0;v<o.length;++v){var g=o[v];if(!i[g]&&(!r||!r[g])&&(!m||!m[g])&&(!s||!s[g])){var y=d(n,g);try{c(t,g,y)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case h:case i:case s:case o:case f:return e;default:switch(e=e&&e.$$typeof){case c:case d:case v:case m:case u:return e;default:return t}}case a:return t}}}function k(e){return w(e)===h}t.AsyncMode=l,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=d,t.Fragment=i,t.Lazy=v,t.Memo=m,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=f,t.isAsyncMode=function(e){return k(e)||w(e)===l},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===d},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===v},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===a},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===h||e===s||e===o||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===u||e.$$typeof===c||e.$$typeof===d||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===g)},t.typeOf=w},8309:function(e,t,n){"use strict";e.exports=n(746)},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=v.hasOwnProperty(t)?v[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var L,F=Object.assign;function z(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function V(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function U(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case I:return"Profiler";case C:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){Q(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ie(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ge=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ce=null;function Ie(e){if(e=ba(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Te(e){Se?Ce?Ce.push(e):Ce=[e]:Se=e}function _e(){if(Se){var e=Se,t=Ce;if(Ce=Se=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ee(e,t){return e(t)}function Ne(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ee(e,t,n)}finally{Re=!1,(null!==Se||null!==Ce)&&(Ne(),_e())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(l)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(le){De=!1}function Me(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Le=!1,Fe=null,ze=!1,Be=null,Ve={onError:function(e){Le=!0,Fe=e}};function Ue(e,t,n,r,a,i,o,s,u){Le=!1,Fe=null,Me.apply(Ve,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(We(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ge(a),e;if(o===r)return Ge(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,Ze=a.unstable_cancelCallback,Xe=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Qe=a.unstable_now,$e=a.unstable_getCurrentPriorityLevel,Je=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ht(s):0!==(i&=o)&&(r=ht(i))}else 0!==(o=n&~a)?r=ht(o):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,Ct,It,Tt=!1,_t=[],Et=null,Nt=null,Rt=null,At=new Map,Ot=new Map,Dt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Lt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ya(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void It(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){zt(e)&&n.delete(t)}function Vt(){Tt=!1,null!==Et&&zt(Et)&&(Et=null),null!==Nt&&zt(Nt)&&(Nt=null),null!==Rt&&zt(Rt)&&(Rt=null),At.forEach(Bt),Ot.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function Wt(e){function t(t){return Ut(t,e)}if(0<_t.length){Ut(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Ut(Et,e),null!==Nt&&Ut(Nt,e),null!==Rt&&Ut(Rt,e),At.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var jt=x.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=a,jt.transition=i}}function Kt(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=a,jt.transition=i}}function qt(e,t,n,r){if(Gt){var a=Xt(e,t,n,r);if(null===a)Gr(e,t,r,Zt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Lt(Et,e,t,n,r,a),!0;case"dragenter":return Nt=Lt(Nt,e,t,n,r,a),!0;case"mouseover":return Rt=Lt(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Lt(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ot.set(i,Lt(Ot.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=Xt(e,t,n,r))&&Gr(e,t,r,Zt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Zt=null;function Xt(e,t,n,r){if(Zt=null,null!==(e=ya(e=we(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,$t=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=$t,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Jt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),hn=F({},cn,{view:0,detail:0}),dn=an(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(fn),mn=an(F({},fn,{dataTransfer:0})),vn=an(F({},hn,{relatedTarget:0})),gn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function In(){return Cn}var Tn=F({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(Tn),En=an(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),Rn=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(An),Dn=[9,13,27,32],Pn=l&&"CompositionEvent"in window,Mn=null;l&&"documentMode"in document&&(Mn=document.documentMode);var Ln=l&&"TextEvent"in window&&!Mn,Fn=l&&(!Pn||Mn&&8<Mn&&11>=Mn),zn=String.fromCharCode(32),Bn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Hn(e,t,n,r){Te(r),0<(t=Kr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,qn=null;function Zn(e){zr(e,0)}function Xn(e){if(q(xa(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(l){var $n;if(l){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}$n=Jn}else $n=!1;Qn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),qn=Kn=null)}function nr(e){if("value"===e.propertyName&&Xn(qn)){var t=[];Hn(t,qn,e,we(e)),Ae(Zn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(qn)}function ir(e,t){if("click"===e)return Xn(t)}function or(e,t){if("input"===e||"change"===e)return Xn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=l&&"documentMode"in document&&11>=document.documentMode,vr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==vr||vr!==Z(r)||("selectionStart"in(r=vr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Kr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Cr={};function Ir(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return Sr[e]=n[t];return e}l&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Tr=Ir("animationend"),_r=Ir("animationiteration"),Er=Ir("animationstart"),Nr=Ir("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Rr.set(e,t),u(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Pr=Ar[Dr];Or(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Or(Tr,"onAnimationEnd"),Or(_r,"onAnimationIteration"),Or(Er,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(Ue.apply(this,arguments),Le){if(!Le)throw Error(i(198));var l=Fe;Le=!1,Fe=null,ze||(ze=!0,Be=l)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Fr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Fr(a,s,c),i=u}}}if(ze)throw e=Be,ze=!1,Be=null,e}function Br(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Ur]){e[Ur]=!0,o.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Vr("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Yt(t)){case 1:var a=Ht;break;case 4:a=Kt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=we(n),o=[];e:{var s=Rr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=_n;break;case"focusin":c="focus",u=vn;break;case"focusout":c="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Nn;break;case Tr:case _r:case Er:u=gn;break;case Nr:u=Rn;break;case"scroll":u=dn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=En}var l=0!==(4&t),h=!l&&"scroll"===e,d=l?null!==s?s+"Capture":null:s;l=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Oe(p,d))&&l.push(Hr(p,m,f)))),h)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(h=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=En,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==u?s:xa(u),f=null==c?s:xa(c),(s=new l(m,p+"leave",u,n,a)).target=h,s.relatedTarget=f,m=null,ya(a)===r&&((l=new l(d,p+"enter",c,n,a)).target=f,l.relatedTarget=h,m=l),h=m,u&&c)e:{for(d=c,p=0,f=l=u;f;f=qr(f))p++;for(f=0,m=d;m;m=qr(m))f++;for(;0<p-f;)l=qr(l),p--;for(;0<f-p;)d=qr(d),f--;for(;p--;){if(l===d||null!==d&&l===d.alternate)break e;l=qr(l),d=qr(d)}l=null}else l=null;null!==u&&Zr(o,s,u,l,!1),null!==c&&null!==h&&Zr(o,h,c,l,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=Yn;else if(Gn(s))if(Qn)v=or;else{v=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=ir);switch(v&&(v=v(e,r))?Hn(o,v,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?xa(r):window,e){case"focusin":(Gn(g)||"true"===g.contentEditable)&&(vr=g,gr=r,yr=null);break;case"focusout":yr=gr=vr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=en()):($t="value"in(Qt=a)?Qt.value:Qt.textContent,Wn=!0)),0<(g=Kr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,zn);case"textInput":return(e=t.data)===zn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Pn&&Vn(e,t)?(e=en(),Jt=$t=Qt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}zr(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(Hr(e,i,a)),null!=(i=Oe(e,t))&&r.push(Hr(e,i,a))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Oe(n,i))&&o.unshift(Hr(n,u,s)):a||null!=(u=Oe(n,i))&&o.push(Hr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function $r(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function Jr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Wt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ma="__reactEvents$"+ha,va="__reactListeners$"+ha,ga="__reactHandles$"+ha;function ya(e){var t=e[da];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[da]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[da])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[fa]||null}var ka=[],Sa=-1;function Ca(e){return{current:e}}function Ia(e){0>Sa||(e.current=ka[Sa],ka[Sa]=null,Sa--)}function Ta(e,t){Sa++,ka[Sa]=e.current,e.current=t}var _a={},Ea=Ca(_a),Na=Ca(!1),Ra=_a;function Aa(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ia(Na),Ia(Ea)}function Pa(e,t,n){if(Ea.current!==_a)throw Error(i(168));Ta(Ea,t),Ta(Na,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,j(e)||"Unknown",a));return F({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Ra=Ea.current,Ta(Ea,e),Ta(Na,Na.current),!0}function Fa(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ma(e,t,Ra),r.__reactInternalMemoizedMergedChildContext=e,Ia(Na),Ia(Ea),Ta(Ea,e)):Ia(Na),Ta(Na,n)}var za=null,Ba=!1,Va=!1;function Ua(e){null===za?za=[e]:za.push(e)}function Wa(){if(!Va&&null!==za){Va=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,Ba=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),qe(Je,Wa),a}finally{bt=t,Va=!1}}return null}var ja=[],Ga=0,Ha=null,Ka=0,qa=[],Za=0,Xa=null,Ya=1,Qa="";function $a(e,t){ja[Ga++]=Ka,ja[Ga++]=Ha,Ha=e,Ka=t}function Ja(e,t,n){qa[Za++]=Ya,qa[Za++]=Qa,qa[Za++]=Xa,Xa=e;var r=Ya;e=Qa;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ya=1<<32-ot(t)+a|n<<a|r,Qa=i+e}else Ya=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&($a(e,1),Ja(e,1,0))}function ti(e){for(;e===Ha;)Ha=ja[--Ga],ja[Ga]=null,Ka=ja[--Ga],ja[Ga]=null;for(;e===Xa;)Xa=qa[--Za],qa[Za]=null,Qa=qa[--Za],qa[Za]=null,Ya=qa[--Za],qa[Za]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xa?{id:Ya,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function hi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw di(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ri;e;)e=ca(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var mi=x.ReactCurrentBatchConfig;function vi(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gi=Ca(null),yi=null,bi=null,xi=null;function wi(){xi=bi=yi=null}function ki(e){var t=gi.current;Ia(gi),e._currentValue=t}function Si(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ii(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ti=null;function _i(e){null===Ti?Ti=[e]:Ti.push(e)}function Ei(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,_i(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ni(e,r)}function Ni(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function Ai(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ni(e,n)}return null===(a=r.interleaved)?(t.next=t,_i(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ni(e,n)}function Mi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Li(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fi(e,t,n,r){var a=e.updateQueue;Ri=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var h=a.baseState;for(o=0,l=c=u=null,s=i;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Ri=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=f,u=h):l=l.next=f,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===l&&(u=h),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Fu|=o,e.lanes=o,e.memoizedState=h}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Bi=(new r.Component).refs;function Vi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,a))&&(rc(t,e,a,r),Mi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,a))&&(rc(t,e,a,r),Mi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Pi(e,a,r))&&(rc(t,e,r,n),Mi(t,e,r))}};function Wi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function ji(e,t,n){var r=!1,a=_a,i=t.contextType;return"object"===typeof i&&null!==i?i=Ii(i):(a=Oa(t)?Ra:Ea.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):_a),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Gi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function Hi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Bi,Ai(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ii(i):(i=Oa(t)?Ra:Ea.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Vi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Ui.enqueueReplaceState(a,a.state,null),Fi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Ki(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Bi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zi(e){return(0,e._init)(e._payload)}function Xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=zc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Zi(i)===t.type)?((r=a(t,n.props)).ref=Ki(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=Ki(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=zc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=Ki(e,null,t),n.return=e,n;case k:return(t=Bc(t,e.mode,n)).return=e,t;case O:return d(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Lc(t,e.mode,n,null)).return=e,t;qi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?l(e,t,n,r):null;case O:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:h(e,t,n,r,null);qi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return h(t,e=e.get(n)||null,r,a,null);qi(t,r)}return null}function m(a,i,s,u){for(var c=null,l=null,h=i,m=i=0,v=null;null!==h&&m<s.length;m++){h.index>m?(v=h,h=null):v=h.sibling;var g=f(a,h,s[m],u);if(null===g){null===h&&(h=v);break}e&&h&&null===g.alternate&&t(a,h),i=o(g,i,m),null===l?c=g:l.sibling=g,l=g,h=v}if(m===s.length)return n(a,h),ai&&$a(a,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(a,s[m],u))&&(i=o(h,i,m),null===l?c=h:l.sibling=h,l=h);return ai&&$a(a,m),c}for(h=r(a,h);m<s.length;m++)null!==(v=p(h,a,m,s[m],u))&&(e&&null!==v.alternate&&h.delete(null===v.key?m:v.key),i=o(v,i,m),null===l?c=v:l.sibling=v,l=v);return e&&h.forEach((function(e){return t(a,e)})),ai&&$a(a,m),c}function v(a,s,u,c){var l=M(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var h=l=null,m=s,v=s=0,g=null,y=u.next();null!==m&&!y.done;v++,y=u.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=f(a,m,y.value,c);if(null===b){null===m&&(m=g);break}e&&m&&null===b.alternate&&t(a,m),s=o(b,s,v),null===h?l=b:h.sibling=b,h=b,m=g}if(y.done)return n(a,m),ai&&$a(a,v),l;if(null===m){for(;!y.done;v++,y=u.next())null!==(y=d(a,y.value,c))&&(s=o(y,s,v),null===h?l=y:h.sibling=y,h=y);return ai&&$a(a,v),l}for(m=r(a,m);!y.done;v++,y=u.next())null!==(y=p(m,a,v,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?v:y.key),s=o(y,s,v),null===h?l=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(a,e)})),ai&&$a(a,v),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===S){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Zi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Ki(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===S?((i=Lc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Mc(o.type,o.key,o.props,null,r.mode,u)).ref=Ki(r,i,o),u.return=r,r=u)}return s(r);case k:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bc(o,r.mode,u)).return=r,r=i}return s(r);case O:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return m(r,i,o,u);if(M(o))return v(r,i,o,u);qi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=zc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Yi=Xi(!0),Qi=Xi(!1),$i={},Ji=Ca($i),eo=Ca($i),to=Ca($i);function no(e){if(e===$i)throw Error(i(174));return e}function ro(e,t){switch(Ta(to,t),Ta(eo,e),Ta(Ji,$i),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ia(Ji),Ta(Ji,t)}function ao(){Ia(Ji),Ia(eo),Ia(to)}function io(e){no(to.current);var t=no(Ji.current),n=ue(t,e.type);t!==n&&(Ta(eo,e),Ta(Ji,n))}function oo(e){eo.current===e&&(Ia(Ji),Ia(eo))}var so=Ca(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=x.ReactCurrentDispatcher,fo=x.ReactCurrentBatchConfig,po=0,mo=null,vo=null,go=null,yo=!1,bo=!1,xo=0,wo=0;function ko(){throw Error(i(321))}function So(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Co(e,t,n,r,a,o){if(po=o,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,go=vo=null,t.updateQueue=null,ho.current=cs,e=n(r,a)}while(bo)}if(ho.current=os,t=null!==vo&&null!==vo.next,po=0,go=vo=mo=null,yo=!1,t)throw Error(i(300));return e}function Io(){var e=0!==xo;return xo=0,e}function To(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?mo.memoizedState=go=e:go=go.next=e,go}function _o(){if(null===vo){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=vo.next;var t=null===go?mo.memoizedState:go.next;if(null!==t)go=t,vo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(vo=e).memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},null===go?mo.memoizedState=go=e:go=go.next=e}return go}function Eo(e,t){return"function"===typeof t?t(e):t}function No(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=vo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var h=l.lane;if((po&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=d,s=r):c=c.next=d,mo.lanes|=h,Fu|=h}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,mo.lanes|=o,Fu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Oo(e,t){var n=mo,r=_o(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Go(Mo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Bo(9,Po.bind(null,n,r,a,t),void 0,null),null===Ru)throw Error(i(349));0!==(30&po)||Do(n,t,a)}return a}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Po(e,t,n,r){t.value=n,t.getSnapshot=r,Lo(t)&&Fo(e)}function Mo(e,t,n){return n((function(){Lo(t)&&Fo(e)}))}function Lo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Fo(e){var t=Ni(e,1);null!==t&&rc(t,e,1,-1)}function zo(e){var t=To();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,mo,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Vo(){return _o().memoizedState}function Uo(e,t,n,r){var a=To();mo.flags|=e,a.memoizedState=Bo(1|t,n,void 0,void 0===r?null:r)}function Wo(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==vo){var o=vo.memoizedState;if(i=o.destroy,null!==r&&So(r,o.deps))return void(a.memoizedState=Bo(t,n,i,r))}mo.flags|=e,a.memoizedState=Bo(1|t,n,i,r)}function jo(e,t){return Uo(8390656,8,e,t)}function Go(e,t){return Wo(2048,8,e,t)}function Ho(e,t){return Wo(4,2,e,t)}function Ko(e,t){return Wo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wo(4,4,qo.bind(null,t,e),n)}function Xo(){}function Yo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $o(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),mo.lanes|=n,Fu|=n,e.baseState=!0),t)}function Jo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{bt=n,fo.transition=r}}function es(){return _o().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ei(e,t,n,r))){rc(n,e,r,tc()),is(n,t,r)}}function ns(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,_i(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ei(e,t,a,r))&&(rc(n,e,r,a=tc()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function as(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ii,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},ss={readContext:Ii,useCallback:function(e,t){return To().memoizedState=[e,void 0===t?null:t],e},useContext:Ii,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uo(4,2,e,t)},useMemo:function(e,t){var n=To();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=To();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,mo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},To().memoizedState=e},useState:zo,useDebugValue:Xo,useDeferredValue:function(e){return To().memoizedState=e},useTransition:function(){var e=zo(!1),t=e[0];return e=Jo.bind(null,e[1]),To().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=mo,a=To();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ru)throw Error(i(349));0!==(30&po)||Do(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,jo(Mo.bind(null,r,o,e),[e]),r.flags|=2048,Bo(9,Po.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=To(),t=Ru.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Ya&~(1<<32-ot(Ya)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ii,useCallback:Yo,useContext:Ii,useEffect:Go,useImperativeHandle:Zo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:Qo,useReducer:No,useRef:Vo,useState:function(){return No(Eo)},useDebugValue:Xo,useDeferredValue:function(e){return $o(_o(),vo.memoizedState,e)},useTransition:function(){return[No(Eo)[0],_o().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ii,useCallback:Yo,useContext:Ii,useEffect:Go,useImperativeHandle:Zo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:Qo,useReducer:Ro,useRef:Vo,useState:function(){return Ro(Eo)},useDebugValue:Xo,useDeferredValue:function(e){var t=_o();return null===vo?t.memoizedState=e:$o(t,vo.memoizedState,e)},useTransition:function(){return[Ro(Eo)[0],_o().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function hs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Ku=r),ds(0,t)},n}function ms(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ds(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,Pi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Yi(t,e.child,n,r)}function ks(e,t,n,r,a){n=n.render;var i=t.ref;return Ci(t,a),r=Co(e,t,n,r,i,a),n=Io(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cs(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Pc(i,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return _s(e,t,n,r,a)}function Is(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ta(Pu,Du),Du|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ta(Pu,Du),Du|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ta(Pu,Du),Du|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ta(Pu,Du),Du|=r;return ws(e,t,a,n),t.child}function Ts(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _s(e,t,n,r,a){var i=Oa(n)?Ra:Ea.current;return i=Aa(t,i),Ci(t,a),n=Co(e,t,n,r,i,a),r=Io(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Es(e,t,n,r,a){if(Oa(n)){var i=!0;La(t)}else i=!1;if(Ci(t,a),null===t.stateNode)Gs(e,t),ji(t,n,r),Hi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ii(c):c=Aa(t,c=Oa(n)?Ra:Ea.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Gi(t,o,r,c),Ri=!1;var d=t.memoizedState;o.state=d,Fi(t,r,o,a),u=t.memoizedState,s!==r||d!==u||Na.current||Ri?("function"===typeof l&&(Vi(t,n,l,r),u=t.memoizedState),(s=Ri||Wi(t,n,s,r,d,u,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Oi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:vi(t.type,s),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ii(u):u=Aa(t,u=Oa(n)?Ra:Ea.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==u)&&Gi(t,o,r,u),Ri=!1,d=t.memoizedState,o.state=d,Fi(t,r,o,a);var p=t.memoizedState;s!==h||d!==p||Na.current||Ri?("function"===typeof f&&(Vi(t,n,f,r),p=t.memoizedState),(c=Ri||Wi(t,n,c,r,d,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ns(e,t,n,r,i,a)}function Ns(e,t,n,r,a,i){Ts(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Fa(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Yi(t,e.child,null,i),t.child=Yi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&Fa(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Pa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pa(0,t.context,!1),ro(e,t.containerInfo)}function As(e,t,n,r,a){return fi(),pi(a),t.flags|=256,ws(e,t,n,r),t.child}var Os,Ds,Ps,Ms,Ls={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function zs(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ta(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Fc(u,a,0,null),e=Lc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=Ls,e):Bs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Vs(e,t,s,r=hs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Fc({mode:"visible",children:r.children},a,0,null),(o=Lc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Yi(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Ls,o);if(0===(1&t.mode))return Vs(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Vs(e,t,s,r=hs(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=Ru)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ni(e,a),rc(r,e,a,-1))}return vc(),Vs(e,t,s,r=hs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(qa[Za++]=Ya,qa[Za++]=Qa,qa[Za++]=Xa,Ya=e.id,Qa=e.overflow,Xa=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Pc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Pc(r,s):(s=Lc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?Fs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ls,a}return e=(s=e.child).sibling,a=Pc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vs(e,t,n,r){return null!==r&&pi(r),Yi(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Si(e.return,t,n)}function Ws(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function js(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ta(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ws(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ws(t,!0,n,null,i);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Zs(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Oa(t.type)&&Da(),qs(t),null;case 3:return r=t.stateNode,ao(),Ia(Na),Ia(Ea),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),Ds(e,t),qs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=no(Ji.current),hi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[da]=t,r[fa]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)Br(Mr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Y(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":K(r),J(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[da]=t,e[fa]=r,Os(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)Br(Mr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Y(e,r),a=X(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=F({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ve(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&de(e,l):"number"===typeof l&&de(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Br("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":K(e),J(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no(Ji.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[da]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=t,t.stateNode=r}return qs(t),null;case 13:if(Ia(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))di(),fi(),t.flags|=98560,o=!1;else if(o=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(sc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Mu&&(Mu=3):vc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ao(),Ds(e,t),null===e&&Wr(t.stateNode.containerInfo),qs(t),null;case 10:return ki(t.type._context),qs(t),null;case 19:if(Ia(so),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Ks(o,!1);else{if(0!==Mu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Ks(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ta(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>ju&&(t.flags|=128,r=!0,Ks(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ks(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return qs(t),null}else 2*Qe()-o.renderingStartTime>ju&&1073741824!==n&&(t.flags|=128,r=!0,Ks(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=so.current,Ta(so,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Du)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xs(e,t){switch(ti(t),t.tag){case 1:return Oa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Ia(Na),Ia(Ea),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ia(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ia(so),null;case 4:return ao(),null;case 10:return ki(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Os=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(){},Ps=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no(Ji.current);var i,o=null;switch(n){case"input":a=X(e,a),r=X(e,r),o=[];break;case"select":a=F({},a,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Br("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Qs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Js=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ic(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Ic(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tu(t,n,i)}a=a.next}while(a!==r)}}function au(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ou(e){var t=e.alternate;null!==t&&(e.alternate=null,ou(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[fa],delete t[ma],delete t[va],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var hu=null,du=!1;function fu(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=hu,a=du;hu=null,fu(e,t,n),du=a,null!==(hu=r)&&(du?(e=hu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hu.removeChild(n.stateNode));break;case 18:null!==hu&&(du?(e=hu,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Wt(e)):ua(hu,n.stateNode));break;case 4:r=hu,a=du,hu=n.stateNode.containerInfo,du=!0,fu(e,t,n),hu=r,du=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tu(n,t,o),a=a.next}while(a!==r)}fu(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Ic(n,t,s)}fu(e,t,n);break;case 21:fu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,fu(e,t,n),Qs=r):fu(e,t,n);break;default:fu(e,t,n)}}function mu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:hu=u.stateNode,du=!1;break e;case 3:case 4:hu=u.stateNode.containerInfo,du=!0;break e}u=u.return}if(null===hu)throw Error(i(160));pu(o,s,a),hu=null,du=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Ic(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gu(t,e),t=t.sibling}function gu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),yu(e),4&r){try{ru(3,e,e.return),au(3,e)}catch(v){Ic(e,e.return,v)}try{ru(5,e,e.return)}catch(v){Ic(e,e.return,v)}}break;case 1:vu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(vu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(v){Ic(e,e.return,v)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Q(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ve(a,d):"dangerouslySetInnerHTML"===h?he(a,d):"children"===h?de(a,d):b(a,h,d,l)}switch(u){case"input":$(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(v){Ic(e,e.return,v)}}break;case 6:if(vu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(v){Ic(e,e.return,v)}}break;case 3:if(vu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(v){Ic(e,e.return,v)}break;case 4:default:vu(t,e),yu(e);break;case 13:vu(t,e),yu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Wu=Qe())),4&r&&mu(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||h,vu(t,e),Qs=l):vu(t,e),yu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(d=Js=h;null!==Js;){switch(p=(f=Js).child,f.tag){case 0:case 11:case 14:case 15:ru(4,f,f.return);break;case 1:eu(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){Ic(r,n,v)}}break;case 5:eu(f,f.return);break;case 22:if(null!==f.memoizedState){ku(d);continue}}null!==p?(p.return=f,Js=p):ku(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=me("display",s))}catch(v){Ic(e,e.return,v)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(v){Ic(e,e.return,v)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vu(t,e),yu(e),4&r&&mu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(de(a,""),r.flags&=-33),lu(e,uu(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cu(e,uu(e),o);break;default:throw Error(i(161))}}catch(s){Ic(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){Js=e,xu(e,t,n)}function xu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var a=Js,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Ys;var c=Qs;if(Ys=o,(Qs=u)&&!c)for(Js=a;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?Su(a):null!==u?(u.return=o,Js=u):Su(a);for(;null!==i;)Js=i,xu(i,t,n),i=i.sibling;Js=a,Ys=s,Qs=c}wu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Js=i):wu(e)}}function wu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||au(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:vi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&zi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Wt(d)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&iu(t)}catch(f){Ic(t,t.return,f)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function Su(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(u){Ic(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Ic(t,a,u)}}var i=t.return;try{iu(t)}catch(u){Ic(t,i,u)}break;case 5:var o=t.return;try{iu(t)}catch(u){Ic(t,o,u)}}}catch(u){Ic(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Cu,Iu=Math.ceil,Tu=x.ReactCurrentDispatcher,_u=x.ReactCurrentOwner,Eu=x.ReactCurrentBatchConfig,Nu=0,Ru=null,Au=null,Ou=0,Du=0,Pu=Ca(0),Mu=0,Lu=null,Fu=0,zu=0,Bu=0,Vu=null,Uu=null,Wu=0,ju=1/0,Gu=null,Hu=!1,Ku=null,qu=null,Zu=!1,Xu=null,Yu=0,Qu=0,$u=null,Ju=-1,ec=0;function tc(){return 0!==(6&Nu)?Qe():-1!==Ju?Ju:Ju=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nu)&&0!==Ou?Ou&-Ou:null!==mi.transition?(0===ec&&(ec=mt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<Qu)throw Qu=0,$u=null,Error(i(185));gt(e,n,r),0!==(2&Nu)&&e===Ru||(e===Ru&&(0===(2&Nu)&&(zu|=n),4===Mu&&uc(e,Ou)),ac(e,r),1===n&&0===Nu&&0===(1&t.mode)&&(ju=Qe()+500,Ba&&Wa()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=ft(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=dt(e,e===Ru?Ou:0);if(0===r)null!==n&&Ze(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ze(n),1===t)0===e.tag?function(e){Ba=!0,Ua(e)}(cc.bind(null,e)):Ua(cc.bind(null,e)),oa((function(){0===(6&Nu)&&Wa()})),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Ju=-1,ec=0,0!==(6&Nu))throw Error(i(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=dt(e,e===Ru?Ou:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Nu;Nu|=2;var o=mc();for(Ru===e&&Ou===t||(Gu=null,ju=Qe()+500,fc(e,t));;)try{bc();break}catch(u){pc(e,u)}wi(),Tu.current=o,Nu=a,null!==Au?t=0:(Ru=null,Ou=0,t=Mu)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t)throw n=Lu,fc(e,0),uc(e,r),ac(e,Qe()),n;if(6===t)uc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Lu,fc(e,0),uc(e,r),ac(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:kc(e,Uu,Gu);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=Wu+500-Qe())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(kc.bind(null,e,Uu,Gu),t);break}kc(e,Uu,Gu);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Iu(r/1960))-r)){e.timeoutHandle=ra(kc.bind(null,e,Uu,Gu),r);break}kc(e,Uu,Gu);break;default:throw Error(i(329))}}}return ac(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=Vu;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Uu,Uu=n,null!==t&&sc(t)),e}function sc(e){null===Uu?Uu=e:Uu.push.apply(Uu,e)}function uc(e,t){for(t&=~Bu,t&=~zu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Nu))throw Error(i(327));Sc();var t=dt(e,0);if(0===(1&t))return ac(e,Qe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Lu,fc(e,0),uc(e,t),ac(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Uu,Gu),ac(e,Qe()),null}function lc(e,t){var n=Nu;Nu|=1;try{return e(t)}finally{0===(Nu=n)&&(ju=Qe()+500,Ba&&Wa())}}function hc(e){null!==Xu&&0===Xu.tag&&0===(6&Nu)&&Sc();var t=Nu;Nu|=1;var n=Eu.transition,r=bt;try{if(Eu.transition=null,bt=1,e)return e()}finally{bt=r,Eu.transition=n,0===(6&(Nu=t))&&Wa()}}function dc(){Du=Pu.current,Ia(Pu)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:ao(),Ia(Na),Ia(Ea),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ia(so);break;case 10:ki(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Ru=e,Au=e=Pc(e.current,null),Ou=Du=t,Mu=0,Lu=null,Bu=zu=Fu=0,Uu=Vu=null,null!==Ti){for(t=0;t<Ti.length;t++)if(null!==(r=(n=Ti[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ti=null}return e}function pc(e,t){for(;;){var n=Au;try{if(wi(),ho.current=os,yo){for(var r=mo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(po=0,go=vo=mo=null,bo=!1,xo=0,_u.current=null,null===n||null===n.return){Mu=1,Lu=t,Au=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ou,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=u,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,ys(p,s,u,0,t),1&p.mode&&vs(o,l,t),c=l;var m=(t=p).updateQueue;if(null===m){var v=new Set;v.add(c),t.updateQueue=v}else m.add(c);break e}if(0===(1&t)){vs(o,l,t),vc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,u,0,t),pi(ls(c,u));break e}}o=c=ls(c,u),4!==Mu&&(Mu=2),null===Vu?Vu=[o]:Vu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Li(o,ps(0,c,t));break e;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Li(o,ms(o,u,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(x){t=x,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function mc(){var e=Tu.current;return Tu.current=os,null===e?os:e}function vc(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===Ru||0===(268435455&Fu)&&0===(268435455&zu)||uc(Ru,Ou)}function gc(e,t){var n=Nu;Nu|=2;var r=mc();for(Ru===e&&Ou===t||(Gu=null,fc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(wi(),Nu=n,Tu.current=r,null!==Au)throw Error(i(261));return Ru=null,Ou=0,Mu}function yc(){for(;null!==Au;)xc(Au)}function bc(){for(;null!==Au&&!Xe();)xc(Au)}function xc(e){var t=Cu(e.alternate,e,Du);e.memoizedProps=e.pendingProps,null===t?wc(e):Au=t,_u.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Zs(n,t,Du)))return void(Au=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Au=n);if(null===e)return Mu=6,void(Au=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Au=t);Au=t=e}while(null!==t);0===Mu&&(Mu=5)}function kc(e,t,n){var r=bt,a=Eu.transition;try{Eu.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Xu);if(0!==(6&Nu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Ru&&(Au=Ru=null,Ou=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Zu||(Zu=!0,Rc(tt,(function(){return Sc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Eu.transition,Eu.transition=null;var s=bt;bt=1;var u=Nu;Nu|=4,_u.current=null,function(e,t){if(ea=Gt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,u=-1,c=-1,l=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(u=s+a),d!==o||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++l===a&&(u=s),f===o&&++h===r&&(c=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Gt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var v=m.memoizedProps,g=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?v:vi(t.type,v),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Ic(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=nu,nu=!1}(e,n),gu(n,e),pr(ta),Gt=!!ea,ta=ea=null,e.current=n,bu(n,e,a),Ye(),Nu=u,bt=s,Eu.transition=o}else e.current=n;if(Zu&&(Zu=!1,Xu=e,Yu=a),o=e.pendingLanes,0===o&&(qu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hu)throw Hu=!1,e=Ku,Ku=null,e;0!==(1&Yu)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===$u?Qu++:(Qu=0,$u=e):Qu=0,Wa()}(e,t,n,r)}finally{Eu.transition=a,bt=r}return null}function Sc(){if(null!==Xu){var e=xt(Yu),t=Eu.transition,n=bt;try{if(Eu.transition=null,bt=16>e?16:e,null===Xu)var r=!1;else{if(e=Xu,Xu=null,Yu=0,0!==(6&Nu))throw Error(i(331));var a=Nu;for(Nu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:ru(8,h,o)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var f=(h=Js).sibling,p=h.return;if(ou(h),h===l){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var m=o.alternate;if(null!==m){var v=m.child;if(null!==v){m.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(null!==v)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:ru(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Js=y;break e}Js=o.return}}var b=e.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:au(9,u)}}catch(k){Ic(u,u.return,k)}if(u===s){Js=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,Js=w;break e}Js=u.return}}if(Nu=a,Wa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{bt=n,Eu.transition=t}}return!1}function Cc(e,t,n){e=Pi(e,t=ps(0,t=ls(n,t),1),1),t=tc(),null!==e&&(gt(e,1,t),ac(e,t))}function Ic(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=Pi(t,e=ms(t,e=ls(n,e),1),1),e=tc(),null!==t&&(gt(t,1,e),ac(t,e));break}}t=t.return}}function Tc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Ru===e&&(Ou&n)===n&&(4===Mu||3===Mu&&(130023424&Ou)===Ou&&500>Qe()-Wu?fc(e,0):Bu|=n),ac(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Ni(e,t))&&(gt(e,t,n),ac(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_c(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),_c(e,n)}function Rc(e,t){return qe(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Lc(n.children,a,o,t);case C:s=8,a|=8;break;case I:return(e=Oc(12,n,t,2|a)).elementType=I,e.lanes=o,e;case N:return(e=Oc(13,n,t,a)).elementType=N,e.lanes=o,e;case R:return(e=Oc(19,n,t,a)).elementType=R,e.lanes=o,e;case D:return Fc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case _:s=9;break e;case E:s=11;break e;case A:s=14;break e;case O:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Oc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return(e=Oc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Oc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function zc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,a,i,o,s,u){return e=new Vc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Oc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ai(i),e}function Wc(e){if(!e)return _a;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Oa(n))return Ma(e,n,t)}return t}function jc(e,t,n,r,a,i,o,s,u){return(e=Uc(n,r,!0,e,0,i,0,s,u)).context=Wc(null),n=e.current,(i=Di(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Pi(n,i,a),e.current.lanes=a,gt(e,a,r),ac(e,r),e}function Gc(e,t,n,r){var a=t.current,i=tc(),o=nc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Pi(a,t,o))&&(rc(e,a,o,i),Mi(e,a,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}Cu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),fi();break;case 5:io(t);break;case 1:Oa(t.type)&&La(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ta(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ta(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?zs(e,t,n):(Ta(so,1&so.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ta(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return js(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ta(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Is(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&Ja(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var a=Aa(t,Ea.current);Ci(t,n),a=Co(null,t,r,e,a,n);var o=Io();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(o=!0,La(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ai(t),a.updater=Ui,t.stateNode=a,a._reactInternals=t,Hi(t,r,e,n),t=Ns(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===A)return 14}return 2}(r),e=vi(r,e),a){case 0:t=_s(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,vi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 3:e:{if(Rs(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Oi(e,t),Fi(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=Hs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Ts(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return zs(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Yi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ks(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ta(gi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Na.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Di(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Si(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Si(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ci(t,n),r=r(a=Ii(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=vi(r=t.type,t.pendingProps),Ss(e,t,r,a=vi(r.type,a),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vi(r,a),Gs(e,t),t.tag=1,Oa(r)?(e=!0,La(t)):e=!1,Ci(t,n),ji(t,r,a),Hi(t,r,a,n),Ns(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Is(e,t,n)}throw Error(i(156,t.tag))};var Zc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Hc(o);s.call(e)}}Gc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hc(o);i.call(e)}}var o=jc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[pa]=o.current,Wr(8===e.nodeType?e.parentNode:e),hc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(u);s.call(e)}}var u=Uc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=u,e[pa]=u.current,Wr(8===e.nodeType?e.parentNode:e),hc((function(){Gc(t,u,n,r)})),u}(n,t,e,a,r);return Hc(o)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Gc(null,e,null,null)})),t[pa]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Qe()),0===(6&Nu)&&(ju=Qe()+500,Wa()))}break;case 13:hc((function(){var t=Ni(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),qc(e,1)}},kt=function(e){if(13===e.tag){var t=Ni(e,134217728);if(null!==t)rc(t,e,134217728,tc());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Ni(e,t);if(null!==n)rc(n,e,t,tc());qc(e,t)}},Ct=function(){return bt},It=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));q(r),$(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=lc,Ne=hc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,wa,Te,_e,lc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Zc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Zc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,a,0,o,s),e[pa]=t.current,Wr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(hc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},3381:function(e){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},3813:function(e,t,n){var r=n(3381);e.exports=f,e.exports.parse=i,e.exports.compile=function(e,t){return s(i(e,t),t)},e.exports.tokensToFunction=s,e.exports.tokensToRegExp=d;var a=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function i(e,t){for(var n,r=[],i=0,o=0,s="",l=t&&t.delimiter||"/";null!=(n=a.exec(e));){var h=n[0],d=n[1],f=n.index;if(s+=e.slice(o,f),o=f+h.length,d)s+=d[1];else{var p=e[o],m=n[2],v=n[3],g=n[4],y=n[5],b=n[6],x=n[7];s&&(r.push(s),s="");var w=null!=m&&null!=p&&p!==m,k="+"===b||"*"===b,S="?"===b||"*"===b,C=n[2]||l,I=g||y;r.push({name:v||i++,prefix:m||"",delimiter:C,optional:S,repeat:k,partial:w,asterisk:!!x,pattern:I?c(I):x?".*":"[^"+u(C)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&r.push(s),r}function o(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function s(e,t){for(var n=new Array(e.length),a=0;a<e.length;a++)"object"===typeof e[a]&&(n[a]=new RegExp("^(?:"+e[a].pattern+")$",h(t)));return function(t,a){for(var i="",s=t||{},u=(a||{}).pretty?o:encodeURIComponent,c=0;c<e.length;c++){var l=e[c];if("string"!==typeof l){var h,d=s[l.name];if(null==d){if(l.optional){l.partial&&(i+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(r(d)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var f=0;f<d.length;f++){if(h=u(d[f]),!n[c].test(h))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(h)+"`");i+=(0===f?l.prefix:l.delimiter)+h}}else{if(h=l.asterisk?encodeURI(d).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):u(d),!n[c].test(h))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+h+'"');i+=l.prefix+h}}else i+=l}return i}}function u(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function c(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function l(e,t){return e.keys=t,e}function h(e){return e&&e.sensitive?"":"i"}function d(e,t,n){r(t)||(n=t||n,t=[]);for(var a=(n=n||{}).strict,i=!1!==n.end,o="",s=0;s<e.length;s++){var c=e[s];if("string"===typeof c)o+=u(c);else{var d=u(c.prefix),f="(?:"+c.pattern+")";t.push(c),c.repeat&&(f+="(?:"+d+f+")*"),o+=f=c.optional?c.partial?d+"("+f+")?":"(?:"+d+"("+f+"))?":d+"("+f+")"}}var p=u(n.delimiter||"/"),m=o.slice(-p.length)===p;return a||(o=(m?o.slice(0,-p.length):o)+"(?:"+p+"(?=$))?"),o+=i?"$":a&&m?"":"(?="+p+"|$)",l(new RegExp("^"+o,h(n)),t)}function f(e,t,n){return r(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return l(e,t)}(e,t):r(e)?function(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(f(e[a],t,n).source);return l(new RegExp("(?:"+r.join("|")+")",h(n)),t)}(e,t,n):function(e,t,n){return d(i(e,n),t,n)}(e,t,n)}},9195:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case h:case i:case s:case o:case f:return e;default:switch(e=e&&e.$$typeof){case c:case d:case v:case m:case u:return e;default:return t}}case a:return t}}}function k(e){return w(e)===h}},8228:function(e,t,n){"use strict";n(9195)},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function g(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,m(x,g.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+E(u,0):i,w(o)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),N(o,t,a,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var l=i+E(s=e[c],c);u+=N(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=N(s=s.value,t,a,l=i+E(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)k.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],h=1,d=null,f=3,p=!1,m=!1,v=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(v=!1,x(e),!m)if(null!==r(c))m=!0,D(k);else{var t=r(l);null!==t&&P(w,t.startTime-e)}}function k(e,n){m=!1,v&&(v=!1,y(T),T=-1),p=!0;var i=f;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&a(c),x(n)}else a(c);d=r(c)}if(null!==d)var u=!0;else{var h=r(l);null!==h&&P(w,h.startTime-n),u=!1}return u}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,C=!1,I=null,T=-1,_=5,E=-1;function N(){return!(t.unstable_now()-E<_)}function R(){if(null!==I){var e=t.unstable_now();E=e;var n=!0;try{n=I(!0,e)}finally{n?S():(C=!1,I=null)}}else C=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,O=A.port2;A.port1.onmessage=R,S=function(){O.postMessage(null)}}else S=function(){g(R,0)};function D(e){I=e,C||(C=!0,S())}function P(e,n){T=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(v?(y(T),T=-1):v=!0,P(w,i-o))):(e.sortIndex=s,n(c,e),m||p||(m=!0,D(k))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i,o){var s,u=256,c=o.pow(u,6),l=o.pow(2,52),h=2*l,d=u-1;function f(e,t,n){var r=[],d=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,y(i)]}}():e,3),r),f=new p(r),b=function(){for(var e=f.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,g(y(f.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,f),e.state=function(){return m(f,{})}),n?(o.random=e,t):e})(b,d,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*u+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(g(o.random(),i),e.exports){e.exports=f;try{s=n(5042)}catch(b){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},8086:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=n(1588).default,o=n(3808).default,s=n(1655).default,u=n(6389).default,c=n(7424).default;e.exports=function(e,t){"use strict";var n=[{key:"title",getter:function(e){return e.getTitle()}},{key:"html",getter:function(e){return e.getHtmlContainer()}},{key:"confirmButtonText",getter:function(e){return e.getConfirmButton()}},{key:"denyButtonText",getter:function(e){return e.getDenyButton()}},{key:"cancelButtonText",getter:function(e){return e.getCancelButton()}},{key:"footer",getter:function(e){return e.getFooter()}},{key:"closeButtonHtml",getter:function(e){return e.getCloseButton()}},{key:"iconHtml",getter:function(e){return e.getIconContent()}},{key:"loaderHtml",getter:function(e){return e.getLoader()}}],l=function(){};function h(h){function d(t){var r={},a={},i=n.map((function(e){return e.key}));return Object.entries(t).forEach((function(t){var n=c(t,2),o=n[0],s=n[1];i.includes(o)&&e.isValidElement(s)?(r[o]=s,a[o]=" "):a[o]=s})),[r,a]}function f(e,r){Object.entries(r).forEach((function(r){var a=c(r,2),i=a[0],o=a[1],s=n.find((function(e){return e.key===i})).getter(h),u=t.createRoot(s);u.render(o),e.__roots.push(u)}))}function p(e){e.__roots.forEach((function(e){e.unmount()})),e.__roots=[]}return function(t){s(m,t);var n=u(m);function m(){return r(this,m),n.apply(this,arguments)}return a(m,[{key:"_main",value:function(e,t){var n=this;this.__roots=[],this.__params=Object.assign({},t,e);var r=d(this.__params),a=c(r,2),s=a[0],u=a[1],h=u.willOpen||l,v=u.didOpen||l,g=u.didDestroy||l;return i(o(m.prototype),"_main",this).call(this,Object.assign({},u,{willOpen:function(e){f(n,s),h(e)},didOpen:function(e){setTimeout((function(){v(e)}))},didDestroy:function(e){g(e),p(n)}}))}},{key:"update",value:function(e){Object.assign(this.__params,e),p(this);var t=d(this.__params),n=c(t,2),r=n[0],a=n[1];i(o(m.prototype),"update",this).call(this,a),f(this,r)}}],[{key:"argsToParams",value:function(t){if(e.isValidElement(t[0])||e.isValidElement(t[1])){var n={};return["title","html","icon"].forEach((function(e,r){void 0!==t[r]&&(n[e]=t[r])})),n}return h.argsToParams(t)}}]),m}(h)}return h}(n(2791),n(1250))},1830:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=n(1588).default,o=n(3808).default,s=n(1655).default,u=n(6389).default,c=n(3515).default,l=n(7424).default,h=n(861).default;e.exports=function(){"use strict";function e(e,t){return d(e,n(e,t,"get"))}function t(e,t,r){return f(e,n(e,t,"set"),r),r}function n(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function d(e,t){return t.get?t.get.call(e):t.value}function f(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m(e,t,n){p(e,t),t.set(e,n)}var v=100,g={},y=function(){g.previousActiveElement instanceof HTMLElement?(g.previousActiveElement.focus(),g.previousActiveElement=null):document.body&&document.body.focus()},b=function(e){return new Promise((function(t){if(!e)return t();var n=window.scrollX,r=window.scrollY;g.restoreFocusTimeout=setTimeout((function(){y(),t()}),v),window.scrollTo(n,r)}))},x={innerParams:new WeakMap,domCache:new WeakMap},w="swal2-",k=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce((function(e,t){return e[t]=w+t,e}),{}),S=["success","warning","info","question","error"].reduce((function(e,t){return e[t]=w+t,e}),{}),C="SweetAlert2:",I=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},T=function(e){console.warn("".concat(C," ").concat("object"===typeof e?e.join(" "):e))},_=function(e){console.error("".concat(C," ").concat(e))},E=[],N=function(e){E.includes(e)||(E.push(e),T(e))},R=function(e,t){N('"'.concat(e,'" is deprecated and will be removed in the next major release. Please use "').concat(t,'" instead.'))},A=function(e){return"function"===typeof e?e():e},O=function(e){return e&&"function"===typeof e.toPromise},D=function(e){return O(e)?e.toPromise():Promise.resolve(e)},P=function(e){return e&&Promise.resolve(e)===e},M=function(){return document.body.querySelector(".".concat(k.container))},L=function(e){var t=M();return t?t.querySelector(e):null},F=function(e){return L(".".concat(e))},z=function(){return F(k.popup)},B=function(){return F(k.icon)},V=function(){return F(k["icon-content"])},U=function(){return F(k.title)},W=function(){return F(k["html-container"])},j=function(){return F(k.image)},G=function(){return F(k["progress-steps"])},H=function(){return F(k["validation-message"])},K=function(){return L(".".concat(k.actions," .").concat(k.confirm))},q=function(){return L(".".concat(k.actions," .").concat(k.cancel))},Z=function(){return L(".".concat(k.actions," .").concat(k.deny))},X=function(){return F(k["input-label"])},Y=function(){return L(".".concat(k.loader))},Q=function(){return F(k.actions)},$=function(){return F(k.footer)},J=function(){return F(k["timer-progress-bar"])},ee=function(){return F(k.close)},te='\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n',ne=function(){var e=z();if(!e)return[];var t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(t).sort((function(e,t){var n=parseInt(e.getAttribute("tabindex")||"0"),r=parseInt(t.getAttribute("tabindex")||"0");return n>r?1:n<r?-1:0})),r=e.querySelectorAll(te),a=Array.from(r).filter((function(e){return"-1"!==e.getAttribute("tabindex")}));return h(new Set(n.concat(a))).filter((function(e){return we(e)}))},re=function(){return se(document.body,k.shown)&&!se(document.body,k["toast-shown"])&&!se(document.body,k["no-backdrop"])},ae=function(){var e=z();return!!e&&se(e,k.toast)},ie=function(){var e=z();return!!e&&e.hasAttribute("data-loading")},oe=function(e,t){if(e.textContent="",t){var n=(new DOMParser).parseFromString(t,"text/html"),r=n.querySelector("head");r&&Array.from(r.childNodes).forEach((function(t){e.appendChild(t)}));var a=n.querySelector("body");a&&Array.from(a.childNodes).forEach((function(t){t instanceof HTMLVideoElement||t instanceof HTMLAudioElement?e.appendChild(t.cloneNode(!0)):e.appendChild(t)}))}},se=function(e,t){if(!t)return!1;for(var n=t.split(/\s+/),r=0;r<n.length;r++)if(!e.classList.contains(n[r]))return!1;return!0},ue=function(e,t){Array.from(e.classList).forEach((function(n){Object.values(k).includes(n)||Object.values(S).includes(n)||Object.values(t.showClass||{}).includes(n)||e.classList.remove(n)}))},ce=function(e,t,n){if(ue(e,t),t.customClass&&t.customClass[n]){if("string"!==typeof t.customClass[n]&&!t.customClass[n].forEach)return void T("Invalid type of customClass.".concat(n,'! Expected string or iterable object, got "').concat(typeof t.customClass[n],'"'));fe(e,t.customClass[n])}},le=function(e,t){if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(".".concat(k.popup," > .").concat(k[t]));case"checkbox":return e.querySelector(".".concat(k.popup," > .").concat(k.checkbox," input"));case"radio":return e.querySelector(".".concat(k.popup," > .").concat(k.radio," input:checked"))||e.querySelector(".".concat(k.popup," > .").concat(k.radio," input:first-child"));case"range":return e.querySelector(".".concat(k.popup," > .").concat(k.range," input"));default:return e.querySelector(".".concat(k.popup," > .").concat(k.input))}},he=function(e){if(e.focus(),"file"!==e.type){var t=e.value;e.value="",e.value=t}},de=function(e,t,n){e&&t&&("string"===typeof t&&(t=t.split(/\s+/).filter(Boolean)),t.forEach((function(t){Array.isArray(e)?e.forEach((function(e){n?e.classList.add(t):e.classList.remove(t)})):n?e.classList.add(t):e.classList.remove(t)})))},fe=function(e,t){de(e,t,!0)},pe=function(e,t){de(e,t,!1)},me=function(e,t){for(var n=Array.from(e.children),r=0;r<n.length;r++){var a=n[r];if(a instanceof HTMLElement&&se(a,t))return a}},ve=function(e,t,n){n==="".concat(parseInt(n))&&(n=parseInt(n)),n||0===parseInt(n)?e.style[t]="number"===typeof n?"".concat(n,"px"):n:e.style.removeProperty(t)},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex";e&&(e.style.display=t)},ye=function(e){e&&(e.style.display="none")},be=function(e,t,n,r){var a=e.querySelector(t);a&&(a.style[n]=r)},xe=function(e,t){t?ge(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):ye(e)},we=function(e){return!(!e||!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))},ke=function(){return!we(K())&&!we(Z())&&!we(q())},Se=function(e){return!!(e.scrollHeight>e.clientHeight)},Ce=function(e){var t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("animation-duration")||"0"),r=parseFloat(t.getPropertyValue("transition-duration")||"0");return n>0||r>0},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=J();n&&we(n)&&(t&&(n.style.transition="none",n.style.width="100%"),setTimeout((function(){n.style.transition="width ".concat(e/1e3,"s linear"),n.style.width="0%"}),10))},Te=function(){var e=J();if(e){var t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";var n=t/parseInt(window.getComputedStyle(e).width)*100;e.style.width="".concat(n,"%")}},_e=function(){return"undefined"===typeof window||"undefined"===typeof document},Ee='\n <div aria-labelledby="'.concat(k.title,'" aria-describedby="').concat(k["html-container"],'" class="').concat(k.popup,'" tabindex="-1">\n   <button type="button" class="').concat(k.close,'"></button>\n   <ul class="').concat(k["progress-steps"],'"></ul>\n   <div class="').concat(k.icon,'"></div>\n   <img class="').concat(k.image,'" />\n   <h2 class="').concat(k.title,'" id="').concat(k.title,'"></h2>\n   <div class="').concat(k["html-container"],'" id="').concat(k["html-container"],'"></div>\n   <input class="').concat(k.input,'" id="').concat(k.input,'" />\n   <input type="file" class="').concat(k.file,'" />\n   <div class="').concat(k.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(k.select,'" id="').concat(k.select,'"></select>\n   <div class="').concat(k.radio,'"></div>\n   <label class="').concat(k.checkbox,'">\n     <input type="checkbox" id="').concat(k.checkbox,'" />\n     <span class="').concat(k.label,'"></span>\n   </label>\n   <textarea class="').concat(k.textarea,'" id="').concat(k.textarea,'"></textarea>\n   <div class="').concat(k["validation-message"],'" id="').concat(k["validation-message"],'"></div>\n   <div class="').concat(k.actions,'">\n     <div class="').concat(k.loader,'"></div>\n     <button type="button" class="').concat(k.confirm,'"></button>\n     <button type="button" class="').concat(k.deny,'"></button>\n     <button type="button" class="').concat(k.cancel,'"></button>\n   </div>\n   <div class="').concat(k.footer,'"></div>\n   <div class="').concat(k["timer-progress-bar-container"],'">\n     <div class="').concat(k["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Ne=function(){var e=M();return!!e&&(e.remove(),pe([document.documentElement,document.body],[k["no-backdrop"],k["toast-shown"],k["has-column"]]),!0)},Re=function(){g.currentInstance.resetValidationMessage()},Ae=function(){var e=z(),t=me(e,k.input),n=me(e,k.file),r=e.querySelector(".".concat(k.range," input")),a=e.querySelector(".".concat(k.range," output")),i=me(e,k.select),o=e.querySelector(".".concat(k.checkbox," input")),s=me(e,k.textarea);t.oninput=Re,n.onchange=Re,i.onchange=Re,o.onchange=Re,s.oninput=Re,r.oninput=function(){Re(),a.value=r.value},r.onchange=function(){Re(),a.value=r.value}},Oe=function(e){return"string"===typeof e?document.querySelector(e):e},De=function(e){var t=z();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},Pe=function(e){"rtl"===window.getComputedStyle(e).direction&&fe(M(),k.rtl)},Me=function(e){var t=Ne();if(_e())_("SweetAlert2 requires document to initialize");else{var n=document.createElement("div");n.className=k.container,t&&fe(n,k["no-transition"]),oe(n,Ee);var r=Oe(e.target);r.appendChild(n),De(e),Pe(r),Ae()}},Le=function(e,t){e instanceof HTMLElement?t.appendChild(e):"object"===typeof e?Fe(e,t):e&&oe(t,e)},Fe=function(e,t){e.jquery?ze(t,e):oe(t,e.toString())},ze=function(e,t){if(e.textContent="",0 in t)for(var n=0;n in t;n++)e.appendChild(t[n].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},Be=function(){if(_e())return!1;var e=document.createElement("div");return"undefined"!==typeof e.style.webkitAnimation?"webkitAnimationEnd":"undefined"!==typeof e.style.animation&&"animationend"}(),Ve=function(e,t){var n=Q(),r=Y();n&&r&&(t.showConfirmButton||t.showDenyButton||t.showCancelButton?ge(n):ye(n),ce(n,t,"actions"),Ue(n,r,t),oe(r,t.loaderHtml||""),ce(r,t,"loader"))};function Ue(e,t,n){var r=K(),a=Z(),i=q();r&&a&&i&&(je(r,"confirm",n),je(a,"deny",n),je(i,"cancel",n),We(r,a,i,n),n.reverseButtons&&(n.toast?(e.insertBefore(i,r),e.insertBefore(a,r)):(e.insertBefore(i,t),e.insertBefore(a,t),e.insertBefore(r,t))))}function We(e,t,n,r){r.buttonsStyling?(fe([e,t,n],k.styled),r.confirmButtonColor&&(e.style.backgroundColor=r.confirmButtonColor,fe(e,k["default-outline"])),r.denyButtonColor&&(t.style.backgroundColor=r.denyButtonColor,fe(t,k["default-outline"])),r.cancelButtonColor&&(n.style.backgroundColor=r.cancelButtonColor,fe(n,k["default-outline"]))):pe([e,t,n],k.styled)}function je(e,t,n){var r=I(t);xe(e,n["show".concat(r,"Button")],"inline-block"),oe(e,n["".concat(t,"ButtonText")]||""),e.setAttribute("aria-label",n["".concat(t,"ButtonAriaLabel")]||""),e.className=k[t],ce(e,n,"".concat(t,"Button"))}var Ge=function(e,t){var n=ee();n&&(oe(n,t.closeButtonHtml||""),ce(n,t,"closeButton"),xe(n,t.showCloseButton),n.setAttribute("aria-label",t.closeButtonAriaLabel||""))},He=function(e,t){var n=M();n&&(Ke(n,t.backdrop),qe(n,t.position),Ze(n,t.grow),ce(n,t,"container"))};function Ke(e,t){"string"===typeof t?e.style.background=t:t||fe([document.documentElement,document.body],k["no-backdrop"])}function qe(e,t){t&&(t in k?fe(e,k[t]):(T('The "position" parameter is not valid, defaulting to "center"'),fe(e,k.center)))}function Ze(e,t){t&&fe(e,k["grow-".concat(t)])}var Xe=["input","file","range","select","radio","checkbox","textarea"],Ye=function(e,t){var n=z();if(n){var r=x.innerParams.get(e),a=!r||t.input!==r.input;Xe.forEach((function(e){var r=me(n,k[e]);r&&(Je(e,t.inputAttributes),r.className=k[e],a&&ye(r))})),t.input&&(a&&Qe(t),et(t))}},Qe=function(e){if(e.input)if(it[e.input]){var t=rt(e.input),n=it[e.input](t,e);ge(t),e.inputAutoFocus&&setTimeout((function(){he(n)}))}else _('Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "'.concat(e.input,'"'))},$e=function(e){for(var t=0;t<e.attributes.length;t++){var n=e.attributes[t].name;["id","type","value","style"].includes(n)||e.removeAttribute(n)}},Je=function(e,t){var n=le(z(),e);if(n)for(var r in $e(n),t)n.setAttribute(r,t[r])},et=function(e){var t=rt(e.input);"object"===typeof e.customClass&&fe(t,e.customClass.input)},tt=function(e,t){e.placeholder&&!t.inputPlaceholder||(e.placeholder=t.inputPlaceholder)},nt=function(e,t,n){if(n.inputLabel){var r=document.createElement("label"),a=k["input-label"];r.setAttribute("for",e.id),r.className=a,"object"===typeof n.customClass&&fe(r,n.customClass.inputLabel),r.innerText=n.inputLabel,t.insertAdjacentElement("beforebegin",r)}},rt=function(e){return me(z(),k[e]||k.input)},at=function(e,t){["string","number"].includes(typeof t)?e.value="".concat(t):P(t)||T('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(typeof t,'"'))},it={};it.text=it.email=it.password=it.number=it.tel=it.url=function(e,t){return at(e,t.inputValue),nt(e,e,t),tt(e,t),e.type=t.input,e},it.file=function(e,t){return nt(e,e,t),tt(e,t),e},it.range=function(e,t){var n=e.querySelector("input"),r=e.querySelector("output");return at(n,t.inputValue),n.type=t.input,at(r,t.inputValue),nt(n,e,t),e},it.select=function(e,t){if(e.textContent="",t.inputPlaceholder){var n=document.createElement("option");oe(n,t.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,e.appendChild(n)}return nt(e,e,t),e},it.radio=function(e){return e.textContent="",e},it.checkbox=function(e,t){var n=le(z(),"checkbox");n.value="1",n.checked=Boolean(t.inputValue);var r=e.querySelector("span");return oe(r,t.inputPlaceholder),n},it.textarea=function(e,t){at(e,t.inputValue),tt(e,t),nt(e,e,t);var n=function(e){return parseInt(window.getComputedStyle(e).marginLeft)+parseInt(window.getComputedStyle(e).marginRight)};return setTimeout((function(){if("MutationObserver"in window){var r=parseInt(window.getComputedStyle(z()).width);new MutationObserver((function(){if(document.body.contains(e)){var a=e.offsetWidth+n(e);a>r?z().style.width="".concat(a,"px"):ve(z(),"width",t.width)}})).observe(e,{attributes:!0,attributeFilter:["style"]})}})),e};var ot=function(e,t){var n=W();n&&(ce(n,t,"htmlContainer"),t.html?(Le(t.html,n),ge(n,"block")):t.text?(n.textContent=t.text,ge(n,"block")):ye(n),Ye(e,t))},st=function(e,t){var n=$();n&&(xe(n,t.footer,"block"),t.footer&&Le(t.footer,n),ce(n,t,"footer"))},ut=function(e,t){var n=x.innerParams.get(e),r=B();if(r){if(n&&t.icon===n.icon)return ft(r,t),void ct(r,t);if(t.icon||t.iconHtml){if(t.icon&&-1===Object.keys(S).indexOf(t.icon))return _('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(t.icon,'"')),void ye(r);ge(r),ft(r,t),ct(r,t),fe(r,t.showClass&&t.showClass.icon)}else ye(r)}},ct=function(e,t){for(var n=0,r=Object.entries(S);n<r.length;n++){var a=l(r[n],2),i=a[0],o=a[1];t.icon!==i&&pe(e,o)}fe(e,t.icon&&S[t.icon]),pt(e,t),lt(),ce(e,t,"icon")},lt=function(){var e=z();if(e)for(var t=window.getComputedStyle(e).getPropertyValue("background-color"),n=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),r=0;r<n.length;r++)n[r].style.backgroundColor=t},ht='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',dt='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n',ft=function(e,t){if(t.icon||t.iconHtml){var n=e.innerHTML,r="";t.iconHtml?r=mt(t.iconHtml):"success"===t.icon?(r=ht,n=n.replace(/ style=".*?"/g,"")):"error"===t.icon?r=dt:t.icon&&(r=mt({question:"?",warning:"!",info:"i"}[t.icon])),n.trim()!==r.trim()&&oe(e,r)}},pt=function(e,t){if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(var n=0,r=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];n<r.length;n++){var a=r[n];be(e,a,"backgroundColor",t.iconColor)}be(e,".swal2-success-ring","borderColor",t.iconColor)}},mt=function(e){return'<div class="'.concat(k["icon-content"],'">').concat(e,"</div>")},vt=function(e,t){var n=j();n&&(t.imageUrl?(ge(n,""),n.setAttribute("src",t.imageUrl),n.setAttribute("alt",t.imageAlt||""),ve(n,"width",t.imageWidth),ve(n,"height",t.imageHeight),n.className=k.image,ce(n,t,"image")):ye(n))},gt=function(e,t){var n=M(),r=z();if(n&&r){if(t.toast){ve(n,"width",t.width),r.style.width="100%";var a=Y();a&&r.insertBefore(a,B())}else ve(r,"width",t.width);ve(r,"padding",t.padding),t.color&&(r.style.color=t.color),t.background&&(r.style.background=t.background),ye(H()),yt(r,t)}},yt=function(e,t){var n=t.showClass||{};e.className="".concat(k.popup," ").concat(we(e)?n.popup:""),t.toast?(fe([document.documentElement,document.body],k["toast-shown"]),fe(e,k.toast)):fe(e,k.modal),ce(e,t,"popup"),"string"===typeof t.customClass&&fe(e,t.customClass),t.icon&&fe(e,k["icon-".concat(t.icon)])},bt=function(e,t){var n=G();if(n){var r=t.progressSteps,a=t.currentProgressStep;r&&0!==r.length&&void 0!==a?(ge(n),n.textContent="",a>=r.length&&T("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((function(e,i){var o=xt(e);if(n.appendChild(o),i===a&&fe(o,k["active-progress-step"]),i!==r.length-1){var s=wt(t);n.appendChild(s)}}))):ye(n)}},xt=function(e){var t=document.createElement("li");return fe(t,k["progress-step"]),oe(t,e),t},wt=function(e){var t=document.createElement("li");return fe(t,k["progress-step-line"]),e.progressStepsDistance&&ve(t,"width",e.progressStepsDistance),t},kt=function(e,t){var n=U();n&&(xe(n,t.title||t.titleText,"block"),t.title&&Le(t.title,n),t.titleText&&(n.innerText=t.titleText),ce(n,t,"title"))},St=function(e,t){gt(e,t),He(e,t),bt(e,t),ut(e,t),vt(e,t),kt(e,t),Ge(e,t),ot(e,t),Ve(e,t),st(e,t);var n=z();"function"===typeof t.didRender&&n&&t.didRender(n)},Ct=function(){return we(z())},It=function(){var e;return null===(e=K())||void 0===e?void 0:e.click()},Tt=function(){var e;return null===(e=Z())||void 0===e?void 0:e.click()},_t=function(){var e;return null===(e=q())||void 0===e?void 0:e.click()},Et=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Nt=function(e){e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},Rt=function(e,t,n,r){Nt(t),n.toast||(t.keydownHandler=function(t){return Pt(e,t,r)},t.keydownTarget=n.keydownListenerCapture?window:z(),t.keydownListenerCapture=n.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},At=function(e,t){var n=ne();if(n.length)return(e+=t)===n.length?e=0:-1===e&&(e=n.length-1),void n[e].focus();z().focus()},Ot=["ArrowRight","ArrowDown"],Dt=["ArrowLeft","ArrowUp"],Pt=function(e,t,n){var r=x.innerParams.get(e);r&&(t.isComposing||229===t.keyCode||(r.stopKeydownPropagation&&t.stopPropagation(),"Enter"===t.key?Mt(e,t,r):"Tab"===t.key?Lt(t):[].concat(Ot,Dt).includes(t.key)?Ft(t.key):"Escape"===t.key&&zt(t,r,n)))},Mt=function(e,t,n){if(A(n.allowEnterKey)&&t.target&&e.getInput()&&t.target instanceof HTMLElement&&t.target.outerHTML===e.getInput().outerHTML){if(["textarea","file"].includes(n.input))return;It(),t.preventDefault()}},Lt=function(e){for(var t=e.target,n=ne(),r=-1,a=0;a<n.length;a++)if(t===n[a]){r=a;break}e.shiftKey?At(r,-1):At(r,1),e.stopPropagation(),e.preventDefault()},Ft=function(e){var t=[K(),Z(),q()];if(!(document.activeElement instanceof HTMLElement)||t.includes(document.activeElement)){for(var n=Ot.includes(e)?"nextElementSibling":"previousElementSibling",r=document.activeElement,a=0;a<Q().children.length;a++){if(!(r=r[n]))return;if(r instanceof HTMLButtonElement&&we(r))break}r instanceof HTMLButtonElement&&r.focus()}},zt=function(e,t,n){A(t.allowEscapeKey)&&(e.preventDefault(),n(Et.esc))},Bt={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},Vt=function(){Array.from(document.body.children).forEach((function(e){e===M()||e.contains(M())||(e.hasAttribute("aria-hidden")&&e.setAttribute("data-previous-aria-hidden",e.getAttribute("aria-hidden")||""),e.setAttribute("aria-hidden","true"))}))},Ut=function(){Array.from(document.body.children).forEach((function(e){e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")}))},Wt="undefined"!==typeof window&&!!window.GestureEvent,jt=function(){if(Wt&&!se(document.body,k.iosfix)){var e=document.body.scrollTop;document.body.style.top="".concat(-1*e,"px"),fe(document.body,k.iosfix),Gt()}},Gt=function(){var e,t=M();t&&(t.ontouchstart=function(t){e=Ht(t)},t.ontouchmove=function(t){e&&(t.preventDefault(),t.stopPropagation())})},Ht=function(e){var t=e.target,n=M(),r=W();return!(!n||!r)&&!Kt(e)&&!qt(e)&&(t===n||!Se(n)&&t instanceof HTMLElement&&"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&(!Se(r)||!r.contains(t)))},Kt=function(e){return e.touches&&e.touches.length&&"stylus"===e.touches[0].touchType},qt=function(e){return e.touches&&e.touches.length>1},Zt=function(){if(se(document.body,k.iosfix)){var e=parseInt(document.body.style.top,10);pe(document.body,k.iosfix),document.body.style.top="",document.body.scrollTop=-1*e}},Xt=function(){var e=document.createElement("div");e.className=k["scrollbar-measure"],document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},Yt=null,Qt=function(e){null===Yt&&(document.body.scrollHeight>window.innerHeight||"scroll"===e)&&(Yt=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(Yt+Xt(),"px"))},$t=function(){null!==Yt&&(document.body.style.paddingRight="".concat(Yt,"px"),Yt=null)};function Jt(e,t,n,r){ae()?cn(e,r):(b(n).then((function(){return cn(e,r)})),Nt(g)),Wt?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),re()&&($t(),Zt(),Ut()),en()}function en(){pe([document.documentElement,document.body],[k.shown,k["height-auto"],k["no-backdrop"],k["toast-shown"]])}function tn(e){e=on(e);var t=Bt.swalPromiseResolve.get(this),n=nn(this);this.isAwaitingPromise?e.isDismissed||(an(this),t(e)):n&&t(e)}var nn=function(e){var t=z();if(!t)return!1;var n=x.innerParams.get(e);if(!n||se(t,n.hideClass.popup))return!1;pe(t,n.showClass.popup),fe(t,n.hideClass.popup);var r=M();return pe(r,n.showClass.backdrop),fe(r,n.hideClass.backdrop),sn(e,t,n),!0};function rn(e){var t=Bt.swalPromiseReject.get(this);an(this),t&&t(e)}var an=function(e){e.isAwaitingPromise&&(delete e.isAwaitingPromise,x.innerParams.get(e)||e._destroy())},on=function(e){return"undefined"===typeof e?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e)},sn=function(e,t,n){var r=M(),a=Be&&Ce(t);"function"===typeof n.willClose&&n.willClose(t),a?un(e,t,r,n.returnFocus,n.didClose):Jt(e,r,n.returnFocus,n.didClose)},un=function(e,t,n,r,a){Be&&(g.swalCloseEventFinishedCallback=Jt.bind(null,e,n,r,a),t.addEventListener(Be,(function(e){e.target===t&&(g.swalCloseEventFinishedCallback(),delete g.swalCloseEventFinishedCallback)})))},cn=function(e,t){setTimeout((function(){"function"===typeof t&&t.bind(e.params)(),e._destroy&&e._destroy()}))},ln=function(e){var t=z();if(t||new la,t=z()){var n=Y();ae()?ye(B()):hn(t,e),ge(n),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()}},hn=function(e,t){var n=Q(),r=Y();n&&r&&(!t&&we(K())&&(t=K()),ge(n),t&&(ye(t),r.setAttribute("data-button-to-replace",t.className),n.insertBefore(r,t)),fe([e,n],k.loading))},dn=function(e,t){"select"===t.input||"radio"===t.input?gn(e,t):["text","email","number","tel","textarea"].some((function(e){return e===t.input}))&&(O(t.inputValue)||P(t.inputValue))&&(ln(K()),yn(e,t))},fn=function(e,t){var n=e.getInput();if(!n)return null;switch(t.input){case"checkbox":return pn(n);case"radio":return mn(n);case"file":return vn(n);default:return t.inputAutoTrim?n.value.trim():n.value}},pn=function(e){return e.checked?1:0},mn=function(e){return e.checked?e.value:null},vn=function(e){return e.files&&e.files.length?null!==e.getAttribute("multiple")?e.files:e.files[0]:null},gn=function(e,t){var n=z();if(n){var r=function(e){"select"===t.input?bn(n,wn(e),t):"radio"===t.input&&xn(n,wn(e),t)};O(t.inputOptions)||P(t.inputOptions)?(ln(K()),D(t.inputOptions).then((function(t){e.hideLoading(),r(t)}))):"object"===typeof t.inputOptions?r(t.inputOptions):_("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(typeof t.inputOptions))}},yn=function(e,t){var n=e.getInput();n&&(ye(n),D(t.inputValue).then((function(r){n.value="number"===t.input?"".concat(parseFloat(r)||0):"".concat(r),ge(n),n.focus(),e.hideLoading()})).catch((function(t){_("Error in inputValue promise: ".concat(t)),n.value="",ge(n),n.focus(),e.hideLoading()})))};function bn(e,t,n){var r=me(e,k.select);if(r){var a=function(e,t,r){var a=document.createElement("option");a.value=r,oe(a,t),a.selected=kn(r,n.inputValue),e.appendChild(a)};t.forEach((function(e){var t=e[0],n=e[1];if(Array.isArray(n)){var i=document.createElement("optgroup");i.label=t,i.disabled=!1,r.appendChild(i),n.forEach((function(e){return a(i,e[1],e[0])}))}else a(r,n,t)})),r.focus()}}function xn(e,t,n){var r=me(e,k.radio);if(r){t.forEach((function(e){var t=e[0],a=e[1],i=document.createElement("input"),o=document.createElement("label");i.type="radio",i.name=k.radio,i.value=t,kn(t,n.inputValue)&&(i.checked=!0);var s=document.createElement("span");oe(s,a),s.className=k.label,o.appendChild(i),o.appendChild(s),r.appendChild(o)}));var a=r.querySelectorAll("input");a.length&&a[0].focus()}}var wn=function e(t){var n=[];return t instanceof Map?t.forEach((function(t,r){var a=t;"object"===typeof a&&(a=e(a)),n.push([r,a])})):Object.keys(t).forEach((function(r){var a=t[r];"object"===typeof a&&(a=e(a)),n.push([r,a])})),n},kn=function(e,t){return!!t&&t.toString()===e.toString()},Sn=function(e){var t=x.innerParams.get(e);e.disableButtons(),t.input?Tn(e,"confirm"):An(e,!0)},Cn=function(e){var t=x.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?Tn(e,"deny"):En(e,!1)},In=function(e,t){e.disableButtons(),t(Et.cancel)},Tn=function(e,t){var n=x.innerParams.get(e);if(n.input){var r=e.getInput(),a=fn(e,n);n.inputValidator?_n(e,a,t):r&&!r.checkValidity()?(e.enableButtons(),e.showValidationMessage(n.validationMessage)):"deny"===t?En(e,a):An(e,a)}else _('The "input" parameter is needed to be set when using returnInputValueOn'.concat(I(t)))},_n=function(e,t,n){var r=x.innerParams.get(e);e.disableInput(),Promise.resolve().then((function(){return D(r.inputValidator(t,r.validationMessage))})).then((function(r){e.enableButtons(),e.enableInput(),r?e.showValidationMessage(r):"deny"===n?En(e,t):An(e,t)}))},En=function(e,t){var n=x.innerParams.get(e||void 0);n.showLoaderOnDeny&&ln(Z()),n.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then((function(){return D(n.preDeny(t,n.validationMessage))})).then((function(n){!1===n?(e.hideLoading(),an(e)):e.close({isDenied:!0,value:"undefined"===typeof n?t:n})})).catch((function(t){return Rn(e||void 0,t)}))):e.close({isDenied:!0,value:t})},Nn=function(e,t){e.close({isConfirmed:!0,value:t})},Rn=function(e,t){e.rejectPromise(t)},An=function(e,t){var n=x.innerParams.get(e||void 0);n.showLoaderOnConfirm&&ln(),n.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then((function(){return D(n.preConfirm(t,n.validationMessage))})).then((function(n){we(H())||!1===n?(e.hideLoading(),an(e)):Nn(e,"undefined"===typeof n?t:n)})).catch((function(t){return Rn(e||void 0,t)}))):Nn(e,t)};function On(){var e=x.innerParams.get(this);if(e){var t=x.domCache.get(this);ye(t.loader),ae()?e.icon&&ge(B()):Dn(t),pe([t.popup,t.actions],k.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}}var Dn=function(e){var t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?ge(t[0],"inline-block"):ke()&&ye(e.actions)};function Pn(){var e=x.innerParams.get(this),t=x.domCache.get(this);return t?le(t.popup,e.input):null}function Mn(e,t,n){var r=x.domCache.get(e);t.forEach((function(e){r[e].disabled=n}))}function Ln(e,t){var n=z();if(n&&e)if("radio"===e.type)for(var r=n.querySelectorAll('[name="'.concat(k.radio,'"]')),a=0;a<r.length;a++)r[a].disabled=t;else e.disabled=t}function Fn(){Mn(this,["confirmButton","denyButton","cancelButton"],!1)}function zn(){Mn(this,["confirmButton","denyButton","cancelButton"],!0)}function Bn(){Ln(this.getInput(),!1)}function Vn(){Ln(this.getInput(),!0)}function Un(e){var t=x.domCache.get(this),n=x.innerParams.get(this);oe(t.validationMessage,e),t.validationMessage.className=k["validation-message"],n.customClass&&n.customClass.validationMessage&&fe(t.validationMessage,n.customClass.validationMessage),ge(t.validationMessage);var r=this.getInput();r&&(r.setAttribute("aria-invalid",!0),r.setAttribute("aria-describedby",k["validation-message"]),he(r),fe(r,k.inputerror))}function Wn(){var e=x.domCache.get(this);e.validationMessage&&ye(e.validationMessage);var t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),pe(t,k.inputerror))}var jn={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Gn=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Hn={},Kn=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],qn=function(e){return Object.prototype.hasOwnProperty.call(jn,e)},Zn=function(e){return-1!==Gn.indexOf(e)},Xn=function(e){return Hn[e]},Yn=function(e){qn(e)||T('Unknown parameter "'.concat(e,'"'))},Qn=function(e){Kn.includes(e)&&T('The parameter "'.concat(e,'" is incompatible with toasts'))},$n=function(e){var t=Xn(e);t&&R(e,t)},Jn=function(e){for(var t in!1===e.backdrop&&e.allowOutsideClick&&T('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e)Yn(t),e.toast&&Qn(t),$n(t)};function er(e){var t=z(),n=x.innerParams.get(this);if(t&&!se(t,n.hideClass.popup)){var r=tr(e),a=Object.assign({},n,r);St(this,a),x.innerParams.set(this,a),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}else T("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var tr=function(e){var t={};return Object.keys(e).forEach((function(n){Zn(n)?t[n]=e[n]:T("Invalid parameter to update: ".concat(n))})),t};function nr(){var e=x.domCache.get(this),t=x.innerParams.get(this);t?(e.popup&&g.swalCloseEventFinishedCallback&&(g.swalCloseEventFinishedCallback(),delete g.swalCloseEventFinishedCallback),"function"===typeof t.didDestroy&&t.didDestroy(),rr(this)):ar(this)}var rr=function(e){ar(e),delete e.params,delete g.keydownHandler,delete g.keydownTarget,delete g.currentInstance},ar=function(e){e.isAwaitingPromise?(ir(x,e),e.isAwaitingPromise=!0):(ir(Bt,e),ir(x,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},ir=function(e,t){for(var n in e)e[n].delete(t)},or=Object.freeze({__proto__:null,_destroy:nr,close:tn,closeModal:tn,closePopup:tn,closeToast:tn,disableButtons:zn,disableInput:Vn,disableLoading:On,enableButtons:Fn,enableInput:Bn,getInput:Pn,handleAwaitingPromise:an,hideLoading:On,rejectPromise:rn,resetValidationMessage:Wn,showValidationMessage:Un,update:er}),sr=function(e,t,n){x.innerParams.get(e).toast?ur(e,t,n):(hr(t),dr(t),fr(e,t,n))},ur=function(e,t,n){t.popup.onclick=function(){var t=x.innerParams.get(e);t&&(cr(t)||t.timer||t.input)||n(Et.close)}},cr=function(e){return e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton},lr=!1,hr=function(e){e.popup.onmousedown=function(){e.container.onmouseup=function(t){e.container.onmouseup=void 0,t.target===e.container&&(lr=!0)}}},dr=function(e){e.container.onmousedown=function(){e.popup.onmouseup=function(t){e.popup.onmouseup=void 0,(t.target===e.popup||e.popup.contains(t.target))&&(lr=!0)}}},fr=function(e,t,n){t.container.onclick=function(r){var a=x.innerParams.get(e);lr?lr=!1:r.target===t.container&&A(a.allowOutsideClick)&&n(Et.backdrop)}},pr=function(e){return"object"===typeof e&&e.jquery},mr=function(e){return e instanceof Element||pr(e)},vr=function(e){var t={};return"object"!==typeof e[0]||mr(e[0])?["title","html","icon"].forEach((function(n,r){var a=e[r];"string"===typeof a||mr(a)?t[n]=a:void 0!==a&&_("Unexpected type of ".concat(n,'! Expected "string" or "Element", got ').concat(typeof a))})):Object.assign(t,e[0]),t};function gr(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c(e,n)}function yr(e){var t=function(t){s(c,t);var n=u(c);function c(){return r(this,c),n.apply(this,arguments)}return a(c,[{key:"_main",value:function(t,n){return i(o(c.prototype),"_main",this).call(this,t,Object.assign({},e,n))}}]),c}(this);return t}var br=function(){return g.timeout&&g.timeout.getTimerLeft()},xr=function(){if(g.timeout)return Te(),g.timeout.stop()},wr=function(){if(g.timeout){var e=g.timeout.start();return Ie(e),e}},kr=function(){var e=g.timeout;return e&&(e.running?xr():wr())},Sr=function(e){if(g.timeout){var t=g.timeout.increase(e);return Ie(t,!0),t}},Cr=function(){return!(!g.timeout||!g.timeout.isRunning())},Ir=!1,Tr={};function _r(){Tr[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Ir||(document.body.addEventListener("click",Nr),Ir=!0)}var Er,Nr=function(e){for(var t=e.target;t&&t!==document;t=t.parentNode)for(var n in Tr){var r=t.getAttribute(n);if(r)return void Tr[n].fire({template:r})}},Rr=Object.freeze({__proto__:null,argsToParams:vr,bindClickHandler:_r,clickCancel:_t,clickConfirm:It,clickDeny:Tt,enableLoading:ln,fire:gr,getActions:Q,getCancelButton:q,getCloseButton:ee,getConfirmButton:K,getContainer:M,getDenyButton:Z,getFocusableElements:ne,getFooter:$,getHtmlContainer:W,getIcon:B,getIconContent:V,getImage:j,getInputLabel:X,getLoader:Y,getPopup:z,getProgressSteps:G,getTimerLeft:br,getTimerProgressBar:J,getTitle:U,getValidationMessage:H,increaseTimer:Sr,isDeprecatedParameter:Xn,isLoading:ie,isTimerRunning:Cr,isUpdatableParameter:Zn,isValidParameter:qn,isVisible:Ct,mixin:yr,resumeTimer:wr,showLoading:ln,stopTimer:xr,toggleTimer:kr}),Ar=function(){function e(t,n){r(this,e),this.callback=t,this.remaining=n,this.running=!1,this.start()}return a(e,[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(e){var t=this.running;return t&&this.stop(),this.remaining+=e,t&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}]),e}(),Or=["swal-title","swal-html","swal-footer"],Dr=function(e){var t="string"===typeof e.template?document.querySelector(e.template):e.template;if(!t)return{};var n=t.content;return Ur(n),Object.assign(Pr(n),Mr(n),Lr(n),Fr(n),zr(n),Br(n),Vr(n,Or))},Pr=function(e){var t={};return Array.from(e.querySelectorAll("swal-param")).forEach((function(e){Wr(e,["name","value"]);var n=e.getAttribute("name"),r=e.getAttribute("value");"boolean"===typeof jn[n]?t[n]="false"!==r:"object"===typeof jn[n]?t[n]=JSON.parse(r):t[n]=r})),t},Mr=function(e){var t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach((function(e){var n=e.getAttribute("name"),r=e.getAttribute("value");t[n]=new Function("return ".concat(r))()})),t},Lr=function(e){var t={};return Array.from(e.querySelectorAll("swal-button")).forEach((function(e){Wr(e,["type","color","aria-label"]);var n=e.getAttribute("type");t["".concat(n,"ButtonText")]=e.innerHTML,t["show".concat(I(n),"Button")]=!0,e.hasAttribute("color")&&(t["".concat(n,"ButtonColor")]=e.getAttribute("color")),e.hasAttribute("aria-label")&&(t["".concat(n,"ButtonAriaLabel")]=e.getAttribute("aria-label"))})),t},Fr=function(e){var t={},n=e.querySelector("swal-image");return n&&(Wr(n,["src","width","height","alt"]),n.hasAttribute("src")&&(t.imageUrl=n.getAttribute("src")),n.hasAttribute("width")&&(t.imageWidth=n.getAttribute("width")),n.hasAttribute("height")&&(t.imageHeight=n.getAttribute("height")),n.hasAttribute("alt")&&(t.imageAlt=n.getAttribute("alt"))),t},zr=function(e){var t={},n=e.querySelector("swal-icon");return n&&(Wr(n,["type","color"]),n.hasAttribute("type")&&(t.icon=n.getAttribute("type")),n.hasAttribute("color")&&(t.iconColor=n.getAttribute("color")),t.iconHtml=n.innerHTML),t},Br=function(e){var t={},n=e.querySelector("swal-input");n&&(Wr(n,["type","label","placeholder","value"]),t.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(t.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(t.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(t.inputValue=n.getAttribute("value")));var r=Array.from(e.querySelectorAll("swal-input-option"));return r.length&&(t.inputOptions={},r.forEach((function(e){Wr(e,["value"]);var n=e.getAttribute("value"),r=e.innerHTML;t.inputOptions[n]=r}))),t},Vr=function(e,t){var n={};for(var r in t){var a=t[r],i=e.querySelector(a);i&&(Wr(i,[]),n[a.replace(/^swal-/,"")]=i.innerHTML.trim())}return n},Ur=function(e){var t=Or.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach((function(e){var n=e.tagName.toLowerCase();t.includes(n)||T("Unrecognized element <".concat(n,">"))}))},Wr=function(e,t){Array.from(e.attributes).forEach((function(n){-1===t.indexOf(n.name)&&T(['Unrecognized attribute "'.concat(n.name,'" on <').concat(e.tagName.toLowerCase(),">."),"".concat(t.length?"Allowed attributes are: ".concat(t.join(", ")):"To set the value, use HTML within the element.")])}))},jr=10,Gr=function(e){var t=M(),n=z();"function"===typeof e.willOpen&&e.willOpen(n);var r=window.getComputedStyle(document.body).overflowY;Zr(t,n,e),setTimeout((function(){Kr(t,n)}),jr),re()&&(qr(t,e.scrollbarPadding,r),Vt()),ae()||g.previousActiveElement||(g.previousActiveElement=document.activeElement),"function"===typeof e.didOpen&&setTimeout((function(){return e.didOpen(n)})),pe(t,k["no-transition"])},Hr=function e(t){var n=z();if(t.target===n&&Be){var r=M();n.removeEventListener(Be,e),r.style.overflowY="auto"}},Kr=function(e,t){Be&&Ce(t)?(e.style.overflowY="hidden",t.addEventListener(Be,Hr)):e.style.overflowY="auto"},qr=function(e,t,n){jt(),t&&"hidden"!==n&&Qt(n),setTimeout((function(){e.scrollTop=0}))},Zr=function(e,t,n){fe(e,n.showClass.backdrop),t.style.setProperty("opacity","0","important"),ge(t,"grid"),setTimeout((function(){fe(t,n.showClass.popup),t.style.removeProperty("opacity")}),jr),fe([document.documentElement,document.body],k.shown),n.heightAuto&&n.backdrop&&!n.toast&&fe([document.documentElement,document.body],k["height-auto"])},Xr={email:function(e,t){return/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address")},url:function(e,t){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")}};function Yr(e){e.inputValidator||("email"===e.input&&(e.inputValidator=Xr.email),"url"===e.input&&(e.inputValidator=Xr.url))}function Qr(e){(!e.target||"string"===typeof e.target&&!document.querySelector(e.target)||"string"!==typeof e.target&&!e.target.appendChild)&&(T('Target parameter is not valid, defaulting to "body"'),e.target="body")}function $r(e){Yr(e),e.showLoaderOnConfirm&&!e.preConfirm&&T("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),Qr(e),"string"===typeof e.title&&(e.title=e.title.split("\n").join("<br />")),Me(e)}var Jr=new WeakMap,ea=function(){function n(){if(r(this,n),m(this,Jr,{writable:!0,value:void 0}),"undefined"!==typeof window){Er=this;for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];var o=Object.freeze(this.constructor.argsToParams(a));this.params=o,this.isAwaitingPromise=!1,t(this,Jr,this._main(Er.params))}}return a(n,[{key:"_main",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Jn(Object.assign({},t,e)),g.currentInstance&&(g.currentInstance._destroy(),re()&&Ut()),g.currentInstance=Er;var n=na(e,t);$r(n),Object.freeze(n),g.timeout&&(g.timeout.stop(),delete g.timeout),clearTimeout(g.restoreFocusTimeout);var r=ra(Er);return St(Er,n),x.innerParams.set(Er,n),ta(Er,r,n)}},{key:"then",value:function(t){return e(this,Jr).then(t)}},{key:"finally",value:function(t){return e(this,Jr).finally(t)}}]),n}(),ta=function(e,t,n){return new Promise((function(r,a){var i=function(t){e.close({isDismissed:!0,dismiss:t})};Bt.swalPromiseResolve.set(e,r),Bt.swalPromiseReject.set(e,a),t.confirmButton.onclick=function(){Sn(e)},t.denyButton.onclick=function(){Cn(e)},t.cancelButton.onclick=function(){In(e,i)},t.closeButton.onclick=function(){i(Et.close)},sr(e,t,i),Rt(e,g,n,i),dn(e,n),Gr(n),aa(g,n,i),ia(t,n),setTimeout((function(){t.container.scrollTop=0}))}))},na=function(e,t){var n=Dr(e),r=Object.assign({},jn,t,n,e);return r.showClass=Object.assign({},jn.showClass,r.showClass),r.hideClass=Object.assign({},jn.hideClass,r.hideClass),r},ra=function(e){var t={popup:z(),container:M(),actions:Q(),confirmButton:K(),denyButton:Z(),cancelButton:q(),loader:Y(),closeButton:ee(),validationMessage:H(),progressSteps:G()};return x.domCache.set(e,t),t},aa=function(e,t,n){var r=J();ye(r),t.timer&&(e.timeout=new Ar((function(){n("timer"),delete e.timeout}),t.timer),t.timerProgressBar&&(ge(r),ce(r,t,"timerProgressBar"),setTimeout((function(){e.timeout&&e.timeout.running&&Ie(t.timer)}))))},ia=function(e,t){t.toast||(A(t.allowEnterKey)?oa(e,t)||At(-1,1):sa())},oa=function(e,t){return t.focusDeny&&we(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&we(e.cancelButton)?(e.cancelButton.focus(),!0):!(!t.focusConfirm||!we(e.confirmButton))&&(e.confirmButton.focus(),!0)},sa=function(){document.activeElement instanceof HTMLElement&&"function"===typeof document.activeElement.blur&&document.activeElement.blur()};if("undefined"!==typeof window&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var ua=new Date,ca=localStorage.getItem("swal-initiation");ca?(ua.getTime()-Date.parse(ca))/864e5>3&&setTimeout((function(){document.body.style.pointerEvents="none";var e=document.createElement("audio");e.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",e.loop=!0,document.body.appendChild(e),setTimeout((function(){e.play().catch((function(){}))}),2500)}),500):localStorage.setItem("swal-initiation","".concat(ua))}ea.prototype.disableButtons=zn,ea.prototype.enableButtons=Fn,ea.prototype.getInput=Pn,ea.prototype.disableInput=Vn,ea.prototype.enableInput=Bn,ea.prototype.hideLoading=On,ea.prototype.disableLoading=On,ea.prototype.showValidationMessage=Un,ea.prototype.resetValidationMessage=Wn,ea.prototype.close=tn,ea.prototype.closePopup=tn,ea.prototype.closeModal=tn,ea.prototype.closeToast=tn,ea.prototype.rejectPromise=rn,ea.prototype.update=er,ea.prototype._destroy=nr,Object.assign(ea,Rr),Object.keys(or).forEach((function(e){ea[e]=function(){var t;return Er&&Er[e]?(t=Er)[e].apply(t,arguments):null}})),ea.DismissReason=Et,ea.version="11.7.27";var la=ea;return la.default=la,la}(),"undefined"!==typeof this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(e,t){var n=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=t);else try{n.innerHTML=t}catch(e){n.innerText=t}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},5410:function(){},8628:function(){},5042:function(){},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,n){var r=n(6015),a=n(9617);function i(t,n,o){return a()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&r(i,n.prototype),i},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),a=n(9617),i=n(4993);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,n){var r=n(1753);function a(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=a=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,n){var a=r(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(this,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,a=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),a=n(8872),i=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,n){var r=n(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),a=n(9498),i=n(6116),o=n(2281);e.exports=function(e){return r(e)||a(e)||i(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,a=n(5036);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function a(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},7462:function(e,t,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:function(){return r}})},3366:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,{Z:function(){return r}})},885:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||(0,r.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2982:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);var a=n(181);function i(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==(0,r.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".a526e8cd.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="test-project:";n.l=function(r,a,i,o){if(e[r])e[r].push(a);else{var s,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+i){s=h;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var d=function(t,n){s.onerror=s.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(u)u(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunktest_project=self.webpackChunktest_project||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e={};n.r(e),n.d(e,{CompositeArrayBuffer:function(){return mN},browserFiles:function(){return mA},browserHTTPRequest:function(){return _A},concatenateArrayBuffers:function(){return IN},copyModel:function(){return gR},decodeWeights:function(){return bN},encodeWeights:function(){return gN},fromMemory:function(){return OA},fromMemorySync:function(){return DA},getLoadHandlers:function(){return zN},getModelArtifactsForJSON:function(){return NN},getModelArtifactsForJSONSync:function(){return EN},getModelArtifactsInfoForJSON:function(){return AN},getSaveHandlers:function(){return FN},getWeightSpecs:function(){return ON},http:function(){return TA},isHTTPScheme:function(){return CA},listModels:function(){return fR},loadWeights:function(){return bA},moveModel:function(){return bR},registerLoadRouter:function(){return LN},registerSaveRouter:function(){return MN},removeModel:function(){return mR},weightsLoaderFactory:function(){return wA},withSaveHandler:function(){return PA},withSaveHandlerSync:function(){return MA}});var t={};n.r(t),n.d(t,{conv2d:function(){return hL},depthwiseConv2d:function(){return pL},matMul:function(){return mL}});var r={};n.r(r),n.d(r,{json:function(){return wz}});var a={};n.r(a),n.d(a,{json:function(){return kz}});var i={};n.r(i),n.d(i,{json:function(){return Sz}});var o={};n.r(o),n.d(o,{json:function(){return Cz}});var s={};n.r(s),n.d(s,{json:function(){return Iz}});var u={};n.r(u),n.d(u,{json:function(){return Tz}});var c={};n.r(c),n.d(c,{json:function(){return _z}});var l={};n.r(l),n.d(l,{json:function(){return Ez}});var h={};n.r(h),n.d(h,{json:function(){return Nz}});var d={};n.r(d),n.d(d,{json:function(){return Rz}});var f={};n.r(f),n.d(f,{json:function(){return Az}});var p={};n.r(p),n.d(p,{json:function(){return Oz}});var m={};n.r(m),n.d(m,{json:function(){return Dz}});var v={};n.r(v),n.d(v,{json:function(){return Pz}});var g={};n.r(g),n.d(g,{json:function(){return Mz}});var y={};n.r(y),n.d(y,{json:function(){return Lz}});var b={};n.r(b),n.d(b,{json:function(){return Fz}});var x={};n.r(x),n.d(x,{json:function(){return zz}});var w={};n.r(w),n.d(w,{json:function(){return Bz}});var k={};n.r(k),n.d(k,{OP_SCOPE_SUFFIX:function(){return cN},abs:function(){return rA},acos:function(){return $A},acosh:function(){return JA},add:function(){return LR},addN:function(){return eO},all:function(){return tO},any:function(){return nO},argMax:function(){return rO},argMin:function(){return aO},asin:function(){return iO},asinh:function(){return oO},atan:function(){return sO},atan2:function(){return uO},atanh:function(){return cO},avgPool:function(){return TO},avgPool3d:function(){return _O},basicLSTMCell:function(){return DO},batchNorm:function(){return MO},batchNorm2d:function(){return LO},batchNorm3d:function(){return FO},batchNorm4d:function(){return zO},batchToSpaceND:function(){return PO},bincount:function(){return BO},bitwiseAnd:function(){return VO},booleanMaskAsync:function(){return XM},broadcastArgs:function(){return UO},broadcastTo:function(){return WO},buffer:function(){return IR},cast:function(){return TR},ceil:function(){return jO},clipByValue:function(){return GO},clone:function(){return _R},complex:function(){return hN},concat:function(){return EO},concat1d:function(){return HO},concat2d:function(){return KO},concat3d:function(){return qO},concat4d:function(){return ZO},conv1d:function(){return YO},conv2d:function(){return XO},conv2dTranspose:function(){return $O},conv3d:function(){return JO},conv3dTranspose:function(){return tD},cos:function(){return nD},cosh:function(){return rD},cosineWindow:function(){return rL},cumprod:function(){return aD},cumsum:function(){return iD},denseBincount:function(){return oD},depthToSpace:function(){return sD},depthwiseConv2d:function(){return uD},diag:function(){return cD},dilation2d:function(){return lD},div:function(){return zR},divNoNan:function(){return fD},dot:function(){return pD},dropout:function(){return tL},einsum:function(){return mD},elu:function(){return vD},enclosingPowerOfTwo:function(){return nL},ensureShape:function(){return gD},equal:function(){return hD},erf:function(){return yD},euclideanNorm:function(){return AD},exp:function(){return OD},expandDims:function(){return DD},expm1:function(){return PD},eye:function(){return LD},fft:function(){return bM},fill:function(){return $R},floor:function(){return FD},floorDiv:function(){return FR},fused:function(){return t},gather:function(){return zD},gatherND:function(){return eL},greater:function(){return BD},greaterEqual:function(){return VD},ifft:function(){return xM},imag:function(){return UD},image:function(){return bF},inTopKAsync:function(){return iL},irfft:function(){return wM},isFinite:function(){return WD},isInf:function(){return jD},isNaN:function(){return GD},leakyRelu:function(){return HD},less:function(){return KD},lessEqual:function(){return qD},linalg:function(){return xF},linspace:function(){return ZD},localResponseNormalization:function(){return XD},log:function(){return YD},log1p:function(){return QD},logSigmoid:function(){return eP},logSoftmax:function(){return tP},logSumExp:function(){return nP},logicalAnd:function(){return rP},logicalNot:function(){return aP},logicalOr:function(){return iP},logicalXor:function(){return oP},losses:function(){return wF},lowerBound:function(){return cP},matMul:function(){return NO},max:function(){return TD},maxPool:function(){return lP},maxPool3d:function(){return hP},maxPoolWithArgmax:function(){return dP},maximum:function(){return oA},mean:function(){return fP},meshgrid:function(){return vP},min:function(){return _D},minimum:function(){return gP},mirrorPad:function(){return yP},mod:function(){return bP},moments:function(){return xP},movingAverage:function(){return QM},mul:function(){return BR},multiRNNCell:function(){return wP},multinomial:function(){return kP},neg:function(){return $D},norm:function(){return RD},notEqual:function(){return SP},oneHot:function(){return CP},ones:function(){return mP},onesLike:function(){return IP},op:function(){return lN},outerProduct:function(){return TP},pad:function(){return _P},pad1d:function(){return EP},pad2d:function(){return NP},pad3d:function(){return RP},pad4d:function(){return AP},pool:function(){return DP},pow:function(){return eA},prelu:function(){return PP},print:function(){return ER},prod:function(){return MP},raggedGather:function(){return LP},raggedRange:function(){return FP},raggedTensorToTensor:function(){return zP},rand:function(){return BP},randomGamma:function(){return GP},randomNormal:function(){return HP},randomStandardNormal:function(){return KP},randomUniform:function(){return qP},randomUniformInt:function(){return ZP},range:function(){return XP},real:function(){return YP},reciprocal:function(){return QP},relu:function(){return $P},relu6:function(){return JP},reshape:function(){return IO},reverse:function(){return eM},reverse1d:function(){return tM},reverse2d:function(){return nM},reverse3d:function(){return rM},reverse4d:function(){return aM},rfft:function(){return SM},round:function(){return iM},rsqrt:function(){return oM},scalar:function(){return GR},scatterND:function(){return $M},searchSorted:function(){return uP},selu:function(){return sM},separableConv2d:function(){return uM},setdiff1dAsync:function(){return lM},sigmoid:function(){return RO},sign:function(){return hM},signal:function(){return yF},sin:function(){return dM},sinh:function(){return fM},slice:function(){return AO},slice1d:function(){return pM},slice2d:function(){return mM},slice3d:function(){return vM},slice4d:function(){return gM},softmax:function(){return yM},softplus:function(){return JD},spaceToBatchND:function(){return OP},sparse:function(){return kF},sparseToDense:function(){return JM},spectral:function(){return gF},split:function(){return kM},sqrt:function(){return VR},square:function(){return UR},squaredDifference:function(){return CM},squeeze:function(){return IM},stack:function(){return TM},step:function(){return _M},stridedSlice:function(){return EM},string:function(){return SF},sub:function(){return tA},sum:function(){return ED},tan:function(){return NM},tanh:function(){return OO},tensor:function(){return fN},tensor1d:function(){return RM},tensor2d:function(){return AM},tensor3d:function(){return LA},tensor4d:function(){return OM},tensor5d:function(){return DM},tensor6d:function(){return PM},tensorScatterUpdate:function(){return FM},tile:function(){return MD},topk:function(){return zM},transpose:function(){return YM},truncatedNormal:function(){return BM},unique:function(){return VM},unsortedSegmentSum:function(){return UM},unstack:function(){return WM},upperBound:function(){return jM},variable:function(){return GM},where:function(){return dD},whereAsync:function(){return qM},zeros:function(){return pP},zerosLike:function(){return WR}});var S=n(2791),C=n(1250),I=n(1002);function T(){T=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new O(r||[]);return a(o,"_invoke",{value:E(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var x={};c(x,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(D([])));k&&k!==n&&r.call(k,o)&&(x=k);var S=b.prototype=g.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,i,o,s){var u=h(e[a],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==(0,I.Z)(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(l).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return i=i?i.then(a,a):a()}})}function E(t,n,r){var a=d;return function(i,o){if(a===p)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:e,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var u=N(s,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=p;var c=h(t,n,r);if("normal"===c.type){if(a=r.done?m:f,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=m,r.method="throw",r.arg=c.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=h(a,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError((0,I.Z)(t)+" is not iterable")}return y.prototype=b,a(S,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},C(_.prototype),c(_.prototype,s,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new _(l(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(S),c(S,u,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;A(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}var _=n(4942);function E(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){E(i,r,a,o,s,"next",e)}function s(e){E(i,r,a,o,s,"throw",e)}o(void 0)}))}}var R=n(7541),A=n(772),O=n(7122),D=n(4853),P=n(2946),M=n(184),L=[{title:"\u30db\u30fc\u30e0",icon:(0,M.jsx)(R.Z,{}),link:"/"},{title:"\u30ab\u30ec\u30f3\u30c0\u30fc",icon:(0,M.jsx)(A.Z,{}),link:"/calendar"},{title:"\u30b0\u30e9\u30d5",icon:(0,M.jsx)(D.Z,{}),link:"/graph"},{title:"\u8a73\u7d30\u8a2d\u5b9a",icon:(0,M.jsx)(O.Z,{}),link:"/setting"}],F={"/":{title:"\u30db\u30fc\u30e0",icon:(0,M.jsx)(R.Z,{})},"/calendar":{title:"\u30ab\u30ec\u30f3\u30c0\u30fc",icon:(0,M.jsx)(A.Z,{})},"/graph":{title:"\u30b0\u30e9\u30d5",icon:(0,M.jsx)(D.Z,{})},"/setting":{title:"\u8a73\u7d30\u8a2d\u5b9a",icon:(0,M.jsx)(O.Z,{})},"/training":{title:"\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0",icon:(0,M.jsx)(P.Z,{})}},z=n(5545);var B=function(){return(0,M.jsxs)("div",{className:"SidebarIcon",children:[(0,M.jsx)("div",{className:"Icon",children:(0,M.jsx)(z.Z,{})}),(0,M.jsx)("p",{children:"yourId : Null"})]})};var V=function(){return(0,M.jsxs)("div",{className:"Sidebar",children:[(0,M.jsx)(B,{}),(0,M.jsx)("ul",{className:"SidebarList",children:L.map((function(e,t){return(0,M.jsxs)("li",{className:"row",id:window.location.pathname===e.link?"active":"",onClick:function(){window.location.pathname=e.link},children:[(0,M.jsx)("div",{id:"icon",children:e.icon}),(0,M.jsx)("div",{id:"title",children:e.title})]},t)}))})]})},U=n(885),W=n(7892),j=n.n(W);function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j()().month(),t=j()().year(),n=0-j()(new Date(t,e,1)).day();return new Array(5).fill([]).map((function(){return new Array(7).fill(null).map((function(){return n++,j()(new Date(t,e,n))}))}))}var H=S.createContext({monthIndex:0,setMonthIndex:function(e){},daySelected:null,setDaySelected:function(e){},showEventModal:!1,setShowEventModal:function(){},savedEvents:[],dispatchCalEvent:function(e){e.type,e.payload},selectedEvent:null,setSelectedEvent:function(){},userTrainingData:{},setUserTrainingData:function(){},trainingType:"",setTrainingType:function(){},trainingCount:0,setTrainingCount:function(){}}),K=function(e){var t=e.day,n=(0,S.useContext)(H),r=n.setDaySelected,a=n.setShowEventModal,i=n.monthIndex,o=JSON.parse(localStorage.getItem("userTrainingData")),s=j()().format("YYYY/MM/DD").toString();return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{className:"border border-gray-200 flex flex-col CalendarDayBox",children:[(0,M.jsx)("header",{className:"flex flex-col items-center CalendarDay",children:(0,M.jsx)("p",{className:"text-sm p-1 my-1 text-center ".concat(t.format("DD-MM-YY")===j()().format("DD-MM-YY")?"bg-blue-600 text-white rounded-full w-7":""),id:parseInt(t.format("MM"))-1!==i%12?"DifferentMonth":"",children:t.format("DD")})}),(0,M.jsx)("div",{className:"flex-1 cursor-pointer",onClick:function(){r(t),s>=j()(t).format("YYYY/MM/DD")&&void 0!==o[j()(t).format("YYYY/MM/DD")]?a(!0):r(t)},children:(0,M.jsx)("div",{id:parseInt(t.format("MM"))-1!==i%12?"DifferentMonth":"",children:function(e){var t=j()(e).format("YYYY/MM/DD").toString(),n=o[t],r=0;if(void 0===n&&s>t)return(0,M.jsx)("p",{children:" / "});if(void 0===n&&s<t)return(0,M.jsx)("p",{children:"  "});if(t===s){var a=["AbsTraining","LegTraining","PectoralTraining"],i=0;for(r=0;r<a.length;r++)n.target[a[r]]>n.training[a[r]]&&i++;return 0===i?(0,M.jsx)("div",{className:"gohi",children:"\u9054\u6210\uff01"}):(0,M.jsx)("div",{className:"gohi",children:"\u672a\u9054\u6210"})}if(t<s){var u=["AbsTraining","LegTraining","PectoralTraining"],c=0;for(r=0;r<u.length;r++)n.target[u[r]]>n.training[u[r]]&&c++;return 0===c?(0,M.jsx)("div",{className:"CircleGood"}):1===c?(0,M.jsx)("div",{className:"CircleNice"}):2===c?(0,M.jsx)("div",{className:"Traiangle"}):(0,M.jsx)("div",{className:"CircleBad"})}return(0,M.jsx)("p",{})}(t)})})]})})},q=function(e){var t=e.month;return(0,M.jsx)("div",{className:"flex-1 grid grid-cols-7 grid-rows-5",children:t.map((function(e,t){return(0,M.jsx)(S.Fragment,{children:e.map((function(e,n){return(0,M.jsx)(K,{day:e,rowIdx:t},n)}))},t)}))})},Z=n(5884),X=n.n(Z),Y={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Q=S.createContext&&S.createContext(Y),$=function(){return $=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},$.apply(this,arguments)},J=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function ee(e){return e&&e.map((function(e,t){return S.createElement(e.tag,$({key:t},e.attr),ee(e.child))}))}function te(e){return function(t){return S.createElement(ne,$({attr:$({},e.attr)},t),ee(e.child))}}function ne(e){var t=function(t){var n,r=e.attr,a=e.size,i=e.title,o=J(e,["attr","size","title"]),s=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),S.createElement("svg",$({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:n,style:$($({color:e.color||t.color},t.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),i&&S.createElement("title",null,i),e.children)};return void 0!==Q?S.createElement(Q.Consumer,null,(function(e){return t(e)})):t(Y)}function re(e){return te({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}}]})(e)}function ae(e){return te({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}}]})(e)}function ie(e){return te({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}}]})(e)}function oe(e){return te({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)}j().locale(X());var se=function(){var e=(0,S.useContext)(H),t=e.monthIndex,n=e.setMonthIndex;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("header",{className:"px-4 py-2 flex items-center",children:[(0,M.jsx)("h1",{className:"mr-10 text-xl text-gray-500 fond-bold",children:"Calendar"}),(0,M.jsx)("button",{onClick:function(){n(j()().month())},className:"border rounded py-2 px-4 mr-5",children:"Today"}),(0,M.jsx)("button",{onClick:function(){n(t-1)},children:(0,M.jsx)("span",{className:"cursor-pointer text-gray-600 mx-2",children:(0,M.jsx)(ae,{})})}),(0,M.jsx)("button",{onClick:function(){n(t+1)},children:(0,M.jsx)("span",{className:"cursor-pointer text-gray-600 mx-2",children:(0,M.jsx)(ie,{})})}),(0,M.jsx)("h2",{className:"ml-4 text-xl text-gray-500 font-bold",children:j()(new Date(j()().year(),t)).format("MMMM YYYY")})]}),(0,M.jsxs)("div",{className:"CalendarDays",children:[(0,M.jsx)("p",{children:"\u65e5"}),(0,M.jsx)("p",{children:"\u6708"}),(0,M.jsx)("p",{children:"\u706b"}),(0,M.jsx)("p",{children:"\u6c34"}),(0,M.jsx)("p",{children:"\u6728"}),(0,M.jsx)("p",{children:"\u91d1"}),(0,M.jsx)("p",{children:"\u571f"})]})]})},ue=function(){var e=(0,S.useContext)(H),t=e.daySelected,n=e.setShowEventModal,r=e.dispatchCalEvent,a=e.selectedEvent,i=JSON.parse(localStorage.getItem("userTrainingData"));if(i==={})return(0,M.jsx)(M.Fragment,{});var o=i[j()(t).format("YYYY/MM/DD")],s=[{title:"\u4e0a\u4f53\u8d77\u3053\u3057",type:"AbsTraining",count:o.training.AbsTraining,target:o.target.AbsTraining},{title:"\u8155\u7acb\u3066\u4f0f\u305b",type:"PectoralTraining",count:o.training.PectoralTraining,target:o.target.PectoralTraining},{title:"\u30b9\u30af\u30ef\u30c3\u30c8",type:"LegTraining",target:o.target.LegTraining,count:o.training.LegTraining}];return(0,M.jsx)("div",{className:"h-screen w-full fixed left-0 top-0 flex justify-center items-center",children:(0,M.jsxs)("form",{className:"bg-white rounded-lg shadow-2xl w-1/4 CalendarModalForm",children:[(0,M.jsx)("header",{className:"bg-gray-100 px-4 py-2 flex justify-end",children:(0,M.jsxs)("div",{className:"text-gray-400",children:[a&&(0,M.jsx)("button",{onClick:function(){r({type:"delete",payload:a}),n(!1)},children:(0,M.jsx)(re,{})}),(0,M.jsx)("button",{onClick:function(){return n(!1)},children:(0,M.jsx)(oe,{})})]})}),(0,M.jsx)("div",{className:"p-3",children:(0,M.jsxs)("div",{className:"grid grid-cols-1/5 items-end gap-y-7",children:[(0,M.jsx)("div",{children:" "}),(0,M.jsxs)("h2",{className:"ModalTitle",children:[t.format("MMMM DD"),"\u65e5 \u306e\u30e1\u30cb\u30e5\u30fc"]}),(0,M.jsx)("ul",{children:s.map((function(e,t){return(0,M.jsxs)("li",{className:"CalendarTrainingText",children:[(0,M.jsxs)("div",{className:"ModalListWrapper",children:[(0,M.jsx)("div",{className:"TrainingTitle",children:e.title}),(0,M.jsxs)("div",{className:"TrainingCount",children:[e.count," / ",e.target," \u56de"]})]}),(0,M.jsxs)("div",{children:[" \u9054\u6210\u7387 : ",(0,M.jsxs)("progress",{max:"100",value:e.count/e.target*100|0,children:[e.count/e.target*100|0,"%"]})]})]},t)}))})]})})]})})};var ce=function(){var e=(0,S.useState)(G()),t=(0,U.Z)(e,2),n=t[0],r=t[1],a=(0,S.useContext)(H),i=a.monthIndex,o=a.showEventModal;return(0,S.useEffect)((function(){r(G(i))}),[i]),(0,M.jsxs)("div",{className:"Main",children:[o&&(0,M.jsx)(ue,{}),(0,M.jsxs)("div",{className:"h-screen flex flex-col CalendarArea",children:[(0,M.jsx)(se,{}),(0,M.jsx)("div",{className:"flex flex-1",children:(0,M.jsx)(q,{month:n})})]})]})};var le=function(){var e=F[window.location.pathname],t=(0,S.useState)(!1),n=(0,U.Z)(t,2),r=n[0],a=n[1],i=function(){a(!r)};return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"header",children:[(0,M.jsx)("div",{className:"HamburgerMenu",children:(0,M.jsxs)("div",{className:"nav-toggle",id:r?"active":"",onClick:i,children:[(0,M.jsx)("span",{}),(0,M.jsx)("span",{}),(0,M.jsx)("span",{})]})}),(0,M.jsx)("div",{className:"headerIcon",children:e.icon}),(0,M.jsx)("div",{className:"headerTitle",children:e.title})]}),(0,M.jsx)("div",{className:"Subbar",id:r?"active":"",children:(0,M.jsx)("div",{className:"overlay",onClick:i,children:(0,M.jsx)(V,{})})})]})};function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function de(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function fe(e,t,n){return fe=de()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&he(a,n.prototype),a},fe.apply(null,arguments)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function me(){return me="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pe(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},me.apply(this,arguments)}function ve(e){var t="function"===typeof Map?new Map:void 0;return ve=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return fe(e,arguments,pe(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),he(n,e)},ve(e)}var ge=n(181);function ye(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,ge.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function be(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}function xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){var t=de();return function(){var n,r=pe(e);if(t){var a=pe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===(0,I.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xe(e)}(this,n)}}var ke=n(2982);function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ce=n(9142);function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(0,Ce.Z)(r.key),r)}}function Te(e,t,n){return t&&Ie(e.prototype,t),n&&Ie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var _e=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},Ee={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],a=0;a<e.length;a+=3){var i=e[a],o=a+1<e.length,s=o?e[a+1]:0,u=a+2<e.length,c=u?e[a+2]:0,l=i>>2,h=(3&i)<<4|s>>4,d=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(d=64)),r.push(n[l],n[h],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(_e(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){var o=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],a=0;a<e.length;){var i=n[e.charAt(a++)],o=a<e.length?n[e.charAt(a)]:0,s=++a<e.length?n[e.charAt(a)]:64,u=++a<e.length?n[e.charAt(a)]:64;if(++a,null==i||null==o||null==s||null==u)throw new Ne;var c=i<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Ne=function(e){be(n,e);var t=we(n);function n(){var e;return Se(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return Te(n)}(ve(Error)),Re=function(e){return function(e){var t=_e(e);return Ee.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ae=function(e){try{return Ee.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};var Oe=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},De=function(){try{return Oe()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCqQZh3zE_1UH4rKx88PyjMRieV9t-7A3g",REACT_APP_FIREBASE_APP_ID:"1:204890033321:web:b3f60102c800c8c49e2db8",REACT_APP_FIREBASE_AUTH_DOMAIN:"vol-9-hackathon.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-Z8G55SP15Z",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"204890033321",REACT_APP_FIREBASE_PROJECT_ID:"vol-9-hackathon",REACT_APP_FIREBASE_STORAGE_BUCKET:"vol-9-hackathon.appspot.com"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&Ae(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},Pe=function(e){var t=function(e){var t,n;return null===(n=null===(t=De())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]}(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},Me=function(){var e;return null===(e=De())||void 0===e?void 0:e.config},Le=function(){function e(){var t=this;Se(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return Te(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function Fe(){try{return"object"===typeof indexedDB}catch(e){return!1}}var ze=function(e){be(n,e);var t=we(n);function n(e,r,a){var i;return Se(this,n),(i=t.call(this,r)).code=e,i.customData=a,i.name="FirebaseError",Object.setPrototypeOf(xe(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(xe(i),Be.prototype.create),i}return Te(n)}(ve(Error)),Be=function(){function e(t,n,r){Se(this,e),this.service=t,this.serviceName=n,this.errors=r}return Te(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(Ve,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new ze(n,i,t)}}]),e}();var Ve=/\{\$([^}]+)}/g;function Ue(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(We(s)&&We(u)){if(!Ue(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function We(e){return null!==e&&"object"===typeof e}function je(e){return e&&e._delegate?e._delegate:e}var Ge=function(){function e(t,n,r){Se(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return Te(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),He="[DEFAULT]",Ke=function(){function e(t,n){Se(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return Te(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Le;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(a){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:He})}catch(u){}var t,n=ye(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=(0,U.Z)(t.value,2),a=r[0],i=r[1],o=this.normalizeInstanceIdentifier(a);try{var s=this.getOrInitializeService({instanceIdentifier:o});i.resolve(s)}catch(u){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat((0,ke.Z)(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),(0,ke.Z)(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a,i=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=ye(this.instancesDeferred.entries());try{for(o.s();!(a=o.n()).done;){var s=(0,U.Z)(a.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(i)}}catch(l){o.e(l)}finally{o.f()}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);var i=this.instances.get(r);return i&&e(i,r),function(){a.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i(e,t)}catch(o){}}}catch(s){a.e(s)}finally{a.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,a=void 0===r?{}:r,i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===He?void 0:t),options:a}),this.instances.set(n,i),this.instancesOptions.set(n,a),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch(o){}return i||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He;return this.component?this.component.multipleInstances?e:He:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var qe,Ze,Xe=function(){function e(t){Se(this,e),this.name=t,this.providers=new Map}return Te(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ke(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),Ye=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ze||(Ze={}));var Qe={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},$e=Ze.INFO,Je=(qe={},(0,_.Z)(qe,Ze.DEBUG,"log"),(0,_.Z)(qe,Ze.VERBOSE,"log"),(0,_.Z)(qe,Ze.INFO,"info"),(0,_.Z)(qe,Ze.WARN,"warn"),(0,_.Z)(qe,Ze.ERROR,"error"),qe),et=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Je[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];(a=console)[r].apply(a,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},tt=function(){function e(t){Se(this,e),this.name=t,this._logLevel=$e,this._logHandler=et,this._userLogHandler=null,Ye.push(this)}return Te(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Ze))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Qe[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ze.DEBUG].concat(t)),this._logHandler.apply(this,[this,Ze.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ze.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Ze.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ze.INFO].concat(t)),this._logHandler.apply(this,[this,Ze.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ze.WARN].concat(t)),this._logHandler.apply(this,[this,Ze.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ze.ERROR].concat(t)),this._logHandler.apply(this,[this,Ze.ERROR].concat(t))}}]),e}();function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var at,it,ot=function(e,t){return t.some((function(t){return e instanceof t}))};var st=new WeakMap,ut=new WeakMap,ct=new WeakMap,lt=new WeakMap,ht=new WeakMap;var dt={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ut.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ct.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mt(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function ft(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(it||(it=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(vt(this),n),mt(st.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return mt(e.apply(vt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.call.apply(e,[vt(this),t].concat(r));return ct.set(i,t.sort?t.sort():[t]),mt(i)}}function pt(e){return"function"===typeof e?ft(e):(e instanceof IDBTransaction&&function(e){if(!ut.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));ut.set(e,t)}}(e),ot(e,at||(at=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,dt):e)}function mt(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",a),e.removeEventListener("error",i)},a=function(){t(mt(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&st.set(t,e)})).catch((function(){})),ht.set(t,e),t}(e);if(lt.has(e))return lt.get(e);var t=pt(e);return t!==e&&(lt.set(e,t),ht.set(t,e)),t}var vt=function(e){return ht.get(e)};var gt,yt,bt=["get","getKey","getAll","getAllKeys","count"],xt=["put","add","delete","clear"],wt=new Map;function kt(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(wt.get(t))return wt.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,a=xt.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(a||bt.includes(n))){var i=function(){var e=N(T().mark((function e(t){var i,o,s,u,c,l,h=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,a?"readwrite":"readonly"),s=o.store,u=h.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=h[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,c),a&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return wt.set(t,i),i}}}!function(e){dt=e(dt)}((function(e){return rt(rt({},e),{},{get:function(t,n,r){return kt(t,n)||e.get(t,n,r)},has:function(t,n){return!!kt(t,n)||e.has(t,n)}})}));var St=function(){function e(t){Se(this,e),this.container=t}return Te(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var Ct="@firebase/app",It="0.9.17",Tt=new tt("@firebase/app"),_t="[DEFAULT]",Et=(gt={},(0,_.Z)(gt,Ct,"fire-core"),(0,_.Z)(gt,"@firebase/app-compat","fire-core-compat"),(0,_.Z)(gt,"@firebase/analytics","fire-analytics"),(0,_.Z)(gt,"@firebase/analytics-compat","fire-analytics-compat"),(0,_.Z)(gt,"@firebase/app-check","fire-app-check"),(0,_.Z)(gt,"@firebase/app-check-compat","fire-app-check-compat"),(0,_.Z)(gt,"@firebase/auth","fire-auth"),(0,_.Z)(gt,"@firebase/auth-compat","fire-auth-compat"),(0,_.Z)(gt,"@firebase/database","fire-rtdb"),(0,_.Z)(gt,"@firebase/database-compat","fire-rtdb-compat"),(0,_.Z)(gt,"@firebase/functions","fire-fn"),(0,_.Z)(gt,"@firebase/functions-compat","fire-fn-compat"),(0,_.Z)(gt,"@firebase/installations","fire-iid"),(0,_.Z)(gt,"@firebase/installations-compat","fire-iid-compat"),(0,_.Z)(gt,"@firebase/messaging","fire-fcm"),(0,_.Z)(gt,"@firebase/messaging-compat","fire-fcm-compat"),(0,_.Z)(gt,"@firebase/performance","fire-perf"),(0,_.Z)(gt,"@firebase/performance-compat","fire-perf-compat"),(0,_.Z)(gt,"@firebase/remote-config","fire-rc"),(0,_.Z)(gt,"@firebase/remote-config-compat","fire-rc-compat"),(0,_.Z)(gt,"@firebase/storage","fire-gcs"),(0,_.Z)(gt,"@firebase/storage-compat","fire-gcs-compat"),(0,_.Z)(gt,"@firebase/firestore","fire-fst"),(0,_.Z)(gt,"@firebase/firestore-compat","fire-fst-compat"),(0,_.Z)(gt,"fire-js","fire-js"),(0,_.Z)(gt,"firebase","fire-js-all"),gt),Nt=new Map,Rt=new Map;function At(e,t){try{e.container.addComponent(t)}catch(n){Tt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Ot(e){var t=e.name;if(Rt.has(t))return Tt.debug("There were multiple attempts to register component ".concat(t,".")),!1;Rt.set(t,e);var n,r=ye(Nt.values());try{for(r.s();!(n=r.n()).done;){At(n.value,e)}}catch(a){r.e(a)}finally{r.f()}return!0}function Dt(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Pt=(yt={},(0,_.Z)(yt,"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),(0,_.Z)(yt,"bad-app-name","Illegal App name: '{$appName}"),(0,_.Z)(yt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),(0,_.Z)(yt,"app-deleted","Firebase App named '{$appName}' already deleted"),(0,_.Z)(yt,"no-options","Need to provide options, when not being deployed to hosting via source."),(0,_.Z)(yt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),(0,_.Z)(yt,"invalid-log-argument","First argument to `onLog` must be null or a function."),(0,_.Z)(yt,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),(0,_.Z)(yt,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),(0,_.Z)(yt,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),(0,_.Z)(yt,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),yt),Mt=new Be("app","Firebase",Pt),Lt=function(){function e(t,n,r){var a=this;Se(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ge("app",(function(){return a}),"PUBLIC"))}return Te(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Mt.create("app-deleted",{appName:this._name})}}]),e}();function Ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:_t,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw Mt.create("bad-app-name",{appName:String(a)});if(n||(n=Me()),!n)throw Mt.create("no-options");var i=Nt.get(a);if(i){if(Ue(n,i.options)&&Ue(r,i.config))return i;throw Mt.create("duplicate-app",{appName:a})}var o,s=new Xe(a),u=ye(Rt.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s.addComponent(c)}}catch(h){u.e(h)}finally{u.f()}var l=new Lt(n,r,s);return Nt.set(a,l),l}function zt(e,t,n){var r,a=null!==(r=Et[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));var i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){var s=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Tt.warn(s.join(" "))}Ot(new Ge("".concat(a,"-version"),(function(){return{library:a,version:t}}),"VERSION"))}var Bt="firebase-heartbeat-database",Vt=1,Ut="firebase-heartbeat-store",Wt=null;function jt(){return Wt||(Wt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,a=n.upgrade,i=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=mt(s);return a&&s.addEventListener("upgradeneeded",(function(e){a(mt(s.result),e.oldVersion,e.newVersion,mt(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),i&&e.addEventListener("versionchange",(function(e){return i(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}(Bt,Vt,{upgrade:function(e,t){if(0===t)e.createObjectStore(Ut)}}).catch((function(e){throw Mt.create("idb-open",{originalErrorMessage:e.message})}))),Wt}function Gt(e){return Ht.apply(this,arguments)}function Ht(){return Ht=N(T().mark((function e(t){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,jt();case 3:return n=e.sent,e.next=6,n.transaction(Ut).objectStore(Ut).get(Zt(t));case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof ze?Tt.warn(e.t0.message):(a=Mt.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Tt.warn(a.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),Ht.apply(this,arguments)}function Kt(e,t){return qt.apply(this,arguments)}function qt(){return qt=N(T().mark((function e(t,n){var r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,jt();case 3:return r=e.sent,a=r.transaction(Ut,"readwrite"),i=a.objectStore(Ut),e.next=8,i.put(n,Zt(t));case 8:return e.next=10,a.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof ze?Tt.warn(e.t0.message):(o=Mt.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Tt.warn(o.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),qt.apply(this,arguments)}function Zt(e){return"".concat(e.name,"!").concat(e.options.appId)}var Xt=function(){function e(t){var n=this;Se(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Jt(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return Te(e,[{key:"triggerHeartbeat",value:function(){var e=N(T().mark((function e(){var t,n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=Yt(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=Yt(),n=Qt(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,a=n.unsentEntries,i=Re(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(a.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=a,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Yt(){return(new Date).toISOString().substring(0,10)}function Qt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],a=e.slice(),i=ye(e);try{var o=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),en(r)>n)return i.dates.pop(),0}else if(r.push({agent:e.agent,dates:[e.date]}),en(r)>n)return r.pop(),0;a=a.slice(1)};for(i.s();!(t=i.n()).done&&0!==o(););}catch(s){i.e(s)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:a}}var $t,Jt=function(){function e(t){Se(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return Te(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Fe()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=function(){a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=function(){n=!1},a.onerror=function(){var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Gt(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Kt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Kt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat((0,ke.Z)(r.heartbeats),(0,ke.Z)(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function en(e){return Re(JSON.stringify({version:2,heartbeats:e})).length}$t="",Ot(new Ge("platform-logger",(function(e){return new St(e)}),"PRIVATE")),Ot(new Ge("heartbeat",(function(e){return new Xt(e)}),"PRIVATE")),zt(Ct,It,$t),zt(Ct,It,"esm2017"),zt("fire-js","");var tn,nn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},rn={},an=an||{},on=nn||self;function sn(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function un(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var cn="closure_uid_"+(1e9*Math.random()>>>0),ln=0;function hn(e,t,n){return e.call.apply(e.bind,arguments)}function dn(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function fn(e,t,n){return(fn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?hn:dn).apply(null,arguments)}function pn(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function mn(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function vn(){this.s=this.s,this.o=this.o}vn.prototype.s=!1,vn.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,cn)&&e[cn]||(e[cn]=++ln))},vn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var gn=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function yn(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function bn(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(sn(r)){var a=e.length||0,i=r.length||0;e.length=a+i;for(var o=0;o<i;o++)e[a+o]=r[o]}else e.push(r)}}function xn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}xn.prototype.h=function(){this.defaultPrevented=!0};var wn=function(){if(!on.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{on.addEventListener("test",(function(){}),t),on.removeEventListener("test",(function(){}),t)}catch(n){}return e}();function kn(e){return/^[\s\xa0]*$/.test(e)}function Sn(){var e=on.navigator;return e&&(e=e.userAgent)?e:""}function Cn(e){return-1!=Sn().indexOf(e)}function In(e){return In[" "](e),e}In[" "]=function(){};var Tn,_n,En=Cn("Opera"),Nn=Cn("Trident")||Cn("MSIE"),Rn=Cn("Edge"),An=Rn||Nn,On=Cn("Gecko")&&!(-1!=Sn().toLowerCase().indexOf("webkit")&&!Cn("Edge"))&&!(Cn("Trident")||Cn("MSIE"))&&!Cn("Edge"),Dn=-1!=Sn().toLowerCase().indexOf("webkit")&&!Cn("Edge");function Pn(){var e=on.document;return e?e.documentMode:void 0}e:{var Mn="",Ln=function(){var e=Sn();return On?/rv:([^\);]+)(\)|;)/.exec(e):Rn?/Edge\/([\d\.]+)/.exec(e):Nn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Dn?/WebKit\/(\S+)/.exec(e):En?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Ln&&(Mn=Ln?Ln[1]:""),Nn){var Fn=Pn();if(null!=Fn&&Fn>parseFloat(Mn)){Tn=String(Fn);break e}}Tn=Mn}if(on.document&&Nn){var zn=Pn();_n=zn||(parseInt(Tn,10)||void 0)}else _n=void 0;var Bn=_n;function Vn(e,t){if(xn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(On){e:{try{In(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Un[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Vn.$.h.call(this)}}mn(Vn,xn);var Un={2:"touch",3:"pen",4:"mouse"};Vn.prototype.h=function(){Vn.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Wn="closure_listenable_"+(1e6*Math.random()|0),jn=0;function Gn(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=a,this.key=++jn,this.fa=this.ia=!1}function Hn(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Kn(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function qn(e){var t={};for(var n in e)t[n]=e[n];return t}var Zn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xn(e,t){for(var n,r,a=1;a<arguments.length;a++){for(n in r=arguments[a])e[n]=r[n];for(var i=0;i<Zn.length;i++)n=Zn[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Yn(e){this.src=e,this.g={},this.h=0}function Qn(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=gn(a,t);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(Hn(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $n(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return a}return-1}Yn.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=$n(e,t,r,a);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Gn(t,this.src,i,!!r,a)).ia=n,e.push(t)),t};var Jn="closure_lm_"+(1e6*Math.random()|0),er={};function tr(e,t,n,r,a){if(r&&r.once)return rr(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)tr(e,t[i],n,r,a);return null}return n=lr(n),e&&e[Wn]?e.O(t,n,un(r)?!!r.capture:!!r,a):nr(e,t,n,!1,r,a)}function nr(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=un(a)?!!a.capture:!!a,s=ur(e);if(s||(e[Jn]=s=new Yn(e)),(n=s.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=sr;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)wn||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(or(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function rr(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)rr(e,t[i],n,r,a);return null}return n=lr(n),e&&e[Wn]?e.P(t,n,un(r)?!!r.capture:!!r,a):nr(e,t,n,!0,r,a)}function ar(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)ar(e,t[i],n,r,a);else r=un(r)?!!r.capture:!!r,n=lr(n),e&&e[Wn]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$n(i=e.g[t],n,r,a))&&(Hn(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=ur(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$n(t,n,r,a)),(n=-1<e?t[e]:null)&&ir(n))}function ir(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Wn])Qn(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(or(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ur(t))?(Qn(n,e),0==n.h&&(n.src=null,t[Jn]=null)):Hn(e)}}}function or(e){return e in er?er[e]:er[e]="on"+e}function sr(e,t){if(e.fa)e=!0;else{t=new Vn(t,this);var n=e.listener,r=e.la||e.src;e.ia&&ir(e),e=n.call(r,t)}return e}function ur(e){return(e=e[Jn])instanceof Yn?e:null}var cr="__closure_events_fn_"+(1e9*Math.random()>>>0);function lr(e){return"function"===typeof e?e:(e[cr]||(e[cr]=function(t){return e.handleEvent(t)}),e[cr])}function hr(){vn.call(this),this.i=new Yn(this),this.S=this,this.J=null}function dr(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new xn(t,e);else if(t instanceof xn)t.target=t.target||e;else{var a=t;Xn(t=new xn(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];a=fr(o,r,!0,t)&&a}if(a=fr(o=t.g=e,r,!0,t)&&a,a=fr(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=fr(o=t.g=n[i],r,!1,t)&&a}function fr(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var s=o.listener,u=o.la||o.src;o.ia&&Qn(e.i,o),a=!1!==s.call(u,r)&&a}}return a&&!r.defaultPrevented}mn(hr,vn),hr.prototype[Wn]=!0,hr.prototype.removeEventListener=function(e,t,n,r){ar(this,e,t,n,r)},hr.prototype.N=function(){if(hr.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Hn(n[r]);delete t.g[e],t.h--}}this.J=null},hr.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},hr.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var pr=on.JSON.stringify,mr=function(){function e(t,n){Se(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return Te(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}();function vr(){var e=Cr,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var gr=function(){function e(){Se(this,e),this.h=this.g=null}return Te(e,[{key:"add",value:function(e,t){var n=yr.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),yr=new mr((function(){return new br}),(function(e){return e.reset()})),br=function(){function e(){Se(this,e),this.next=this.g=this.h=null}return Te(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function xr(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function wr(e){on.setTimeout((function(){throw e}),0)}var kr,Sr=!1,Cr=new gr,Ir=function(){var e=on.Promise.resolve(void 0);kr=function(){e.then(Tr)}},Tr=function(){for(var e;e=vr();){try{e.h.call(e.g)}catch(n){wr(n)}var t=yr;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Sr=!1};function _r(e,t){hr.call(this),this.h=e||1,this.g=t||on,this.j=fn(this.qb,this),this.l=Date.now()}function Er(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Nr(e,t,n){if("function"===typeof e)n&&(e=fn(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=fn(e.handleEvent,e)}return 2147483647<Number(t)?-1:on.setTimeout(e,t||0)}function Rr(e){e.g=Nr((function(){e.g=null,e.i&&(e.i=!1,Rr(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}mn(_r,hr),(tn=_r.prototype).ga=!1,tn.T=null,tn.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),dr(this,"tick"),this.ga&&(Er(this),this.start()))}},tn.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},tn.N=function(){_r.$.N.call(this),Er(this),delete this.g};var Ar=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).m=e,a.j=r,a.h=null,a.i=!1,a.g=null,a}return Te(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Rr(this)}},{key:"N",value:function(){me(pe(n.prototype),"N",this).call(this),this.g&&(on.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(vn);function Or(e){vn.call(this),this.h=e,this.g={}}mn(Or,vn);var Dr=[];function Pr(e,t,n,r){Array.isArray(n)||(n&&(Dr[0]=n.toString()),n=Dr);for(var a=0;a<n.length;a++){var i=tr(t,n[a],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function Mr(e){Kn(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ir(e)}),e),e.g={}}function Lr(){this.g=!0}function Fr(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return pr(n)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}Or.prototype.N=function(){Or.$.N.call(this),Mr(this)},Or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Lr.prototype.Ea=function(){this.g=!1},Lr.prototype.info=function(){};var zr={},Br=null;function Vr(){return Br=Br||new hr}function Ur(e){xn.call(this,zr.Ta,e)}function Wr(e){var t=Vr();dr(t,new Ur(t))}function jr(e,t){xn.call(this,zr.STAT_EVENT,e),this.stat=t}function Gr(e){var t=Vr();dr(t,new jr(t,e))}function Hr(e,t){xn.call(this,zr.Ua,e),this.size=t}function Kr(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return on.setTimeout((function(){e()}),t)}zr.Ta="serverreachability",mn(Ur,xn),zr.STAT_EVENT="statevent",mn(jr,xn),zr.Ua="timingevent",mn(Hr,xn);var qr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Zr={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Xr(){}function Yr(e){return e.h||(e.h=e.i())}function Qr(){}Xr.prototype.h=null;var $r,Jr={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ea(){xn.call(this,"d")}function ta(){xn.call(this,"c")}function na(){}function ra(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Or(this),this.P=ia,e=An?125:void 0,this.V=new _r(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new aa}function aa(){this.i=null,this.g="",this.h=!1}mn(ea,xn),mn(ta,xn),mn(na,Xr),na.prototype.g=function(){return new XMLHttpRequest},na.prototype.i=function(){return{}},$r=new na;var ia=45e3,oa={},sa={};function ua(e,t,n){e.L=1,e.v=_a(ka(t)),e.s=n,e.S=!0,ca(e,null)}function ca(e,t){e.G=Date.now(),fa(e),e.A=ka(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Va(n.i,"t",r),e.C=0,n=e.l.J,e.h=new aa,e.g=Ui(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Ar(fn(e.Pa,e,e.g),e.O)),Pr(e.U,e.g,"readystatechange",e.nb),t=e.I?qn(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Wr(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var o="",s=i.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function la(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function ha(e,t,n){for(var r,a=!0;!e.J&&e.C<n.length;){if((r=da(e,n))==sa){4==t&&(e.o=4,Gr(14),a=!1),Fr(e.j,e.m,null,"[Incomplete Response]");break}if(r==oa){e.o=4,Gr(15),Fr(e.j,e.m,n,"[Invalid Chunk]"),a=!1;break}Fr(e.j,e.m,r,null),ya(e,r)}la(e)&&r!=sa&&r!=oa&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Gr(16),a=!1),e.i=e.i&&a,a?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Di(t),t.M=!0,Gr(11))):(Fr(e.j,e.m,n,"[Invalid Chunked Response]"),ga(e),va(e))}function da(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?sa:(n=Number(t.substring(n,r)),isNaN(n)?oa:(r+=1)+n>t.length?sa:(t=t.slice(r,r+n),e.C=r+n,t))}function fa(e){e.Y=Date.now()+e.P,pa(e,e.P)}function pa(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Kr(fn(e.lb,e),t)}function ma(e){e.B&&(on.clearTimeout(e.B),e.B=null)}function va(e){0==e.l.H||e.J||Li(e.l,e)}function ga(e){ma(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Er(e.V),Mr(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function ya(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||qa(n.i,e)))if(!e.K&&qa(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Mi(n),Ii(n)}Oi(n),Gr(18)}}else n.Fa=a[1],0<n.Fa-n.V&&37500>a[2]&&n.G&&0==n.A&&!n.v&&(n.v=Kr(fn(n.ib,n),6e3));if(1>=Ka(n.i)&&n.oa){try{n.oa()}catch(i){}n.oa=void 0}}else zi(n,11)}else if((e.K||n.g==e)&&Mi(n),!kn(t))for(a=n.Ja.g.parse(t),t=0;t<a.length;t++){var i=a[t];if(n.V=i[0],i=i[1],2==n.H)if("c"==i[0]){n.K=i[1],n.pa=i[2];var o=i[3];null!=o&&(n.ra=o,n.l.info("VER="+n.ra));var s=i[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));var u=i[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(Za(h,h.h),h.h=null))}if(r.F){var d=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.Da=d,Ta(r.I,r.F,d))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var f=e;if((r=n).wa=Vi(r,r.J?r.pa:null,r.Y),f.K){Xa(r.i,f);var p=f,m=r.L;m&&p.setTimeout(m),p.B&&(ma(p),fa(p)),r.g=f}else Ai(r);0<n.j.length&&_i(n)}else"stop"!=i[0]&&"close"!=i[0]||zi(n,7);else 3==n.H&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?zi(n,7):Ci(n):"noop"!=i[0]&&n.h&&n.h.Aa(i),n.A=0)}Wr()}catch(i){}}function ba(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(sn(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(sn(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(sn(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,i=0;i<a;i++)t.call(void 0,r[i],n&&n[i],e)}(tn=ra.prototype).setTimeout=function(e){this.P=e},tn.nb=function(e){e=e.target;var t=this.M;t&&3==yi(e)?t.l():this.Pa(e)},tn.Pa=function(e){try{if(e==this.g)e:{var t=yi(this.g),n=this.g.Ia();this.g.da();if(!(3>t)&&(3!=t||An||this.g&&(this.h.h||this.g.ja()||bi(this.g)))){this.J||4!=t||7==n||Wr(),ma(this);var r=this.g.da();this.ca=r;t:if(la(this)){var a=bi(this.g);e="";var i=a.length,o=4==yi(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){ga(this),va(this);var s="";break t}this.h.i=new on.TextDecoder}for(n=0;n<i;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:o&&n==i-1});a.splice(0,i),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==r,function(e,t,n,r,a,i,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.j,this.u,this.A,this.m,this.W,t,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!kn(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,Gr(12),ga(this),va(this);break e}Fr(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ya(this,r)}this.S?(ha(this,t,s),An&&this.i&&3==t&&(Pr(this.U,this.V,"tick",this.mb),this.V.start())):(Fr(this.j,this.m,s,null),ya(this,s)),4==t&&ga(this),this.i&&!this.J&&(4==t?Li(this.l,this):(this.i=!1,fa(this)))}else(function(e){var t={};e=(e.g&&2<=yi(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!kn(e[n])){var r=xr(e[n]),a=r[0];if("string"===typeof(r=r[1])){r=r.trim();var i=t[a]||[];t[a]=i,i.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<s.indexOf("Unknown SID")?(this.o=3,Gr(12)):(this.o=0,Gr(13)),ga(this),va(this)}}}catch(t){}},tn.mb=function(){if(this.g){var e=yi(this.g),t=this.g.ja();this.C<t.length&&(ma(this),ha(this,e,t),this.i&&4!=e&&fa(this))}},tn.cancel=function(){this.J=!0,ga(this)},tn.lb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Wr(),Gr(17)),ga(this),this.o=2,va(this)):pa(this,this.Y-e)};var xa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof wa){this.h=e.h,Sa(this,e.j),this.s=e.s,this.g=e.g,Ca(this,e.m),this.l=e.l;var t=e.i,n=new La;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ia(this,n),this.o=e.o}else e&&(t=String(e).match(xa))?(this.h=!1,Sa(this,t[1]||"",!0),this.s=Ea(t[2]||""),this.g=Ea(t[3]||"",!0),Ca(this,t[4]),this.l=Ea(t[5]||"",!0),Ia(this,t[6]||"",!0),this.o=Ea(t[7]||"")):(this.h=!1,this.i=new La(null,this.h))}function ka(e){return new wa(e)}function Sa(e,t,n){e.j=n?Ea(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ca(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ia(e,t,n){t instanceof La?(e.i=t,function(e,t){t&&!e.j&&(Fa(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(za(this,t),Va(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Na(t,Pa)),e.i=new La(t,e.h))}function Ta(e,t,n){e.i.set(t,n)}function _a(e){return Ta(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ea(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Na(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Ra),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ra(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}wa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Na(t,Aa,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Na(t,Aa,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Na(n,"/"==n.charAt(0)?Da:Oa,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Na(n,Ma)),e.join("")};var Aa=/[#\/\?@]/g,Oa=/[#\?:]/g,Da=/[#\?]/g,Pa=/[#\?@]/g,Ma=/#/g;function La(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Fa(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function za(e,t){Fa(e),t=Ua(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ba(e,t){return Fa(e),t=Ua(e,t),e.g.has(t)}function Va(e,t,n){za(e,t),0<n.length&&(e.i=null,e.g.set(Ua(e,t),yn(n)),e.h+=n.length)}function Ua(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(tn=La.prototype).add=function(e,t){Fa(this),this.i=null,e=Ua(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},tn.forEach=function(e,t){Fa(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},tn.ta=function(){Fa(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var a=e[r],i=0;i<a.length;i++)n.push(t[r]);return n},tn.Z=function(e){Fa(this);var t=[];if("string"===typeof e)Ba(this,e)&&(t=t.concat(this.g.get(Ua(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},tn.set=function(e,t){return Fa(this),this.i=null,Ba(this,e=Ua(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},tn.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},tn.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],a=encodeURIComponent(String(r)),i=this.Z(r);for(r=0;r<i.length;r++){var o=a;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};var Wa=Te((function e(t,n){Se(this,e),this.g=t,this.map=n}));function ja(e){this.l=e||Ga,on.PerformanceNavigationTiming?e=0<(e=on.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(on.g&&on.g.Ka&&on.g.Ka()&&on.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ga=10;function Ha(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ka(e){return e.h?1:e.g?e.g.size:0}function qa(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Za(e,t){e.g?e.g.add(t):e.h=t}function Xa(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Ya(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=ye(e.g.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;n=n.concat(a.F)}}catch(i){r.e(i)}finally{r.f()}return n}return yn(e.i)}ja.prototype.cancel=function(){if(this.i=Ya(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=ye(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}};var Qa,$a=function(){function e(){Se(this,e)}return Te(e,[{key:"stringify",value:function(e){return on.JSON.stringify(e,void 0)}},{key:"parse",value:function(e){return on.JSON.parse(e,void 0)}}]),e}();function Ja(){this.g=new $a}function ei(e,t,n){var r=n||"";try{ba(e,(function(e,n){var a=e;un(e)&&(a=pr(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function ti(e,t,n,r,a){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,a(r)}catch(i){}}function ni(e){this.l=e.fc||null,this.j=e.ob||!1}function ri(e,t){hr.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=ai,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mn(ni,Xr),ni.prototype.g=function(){return new ri(this.l,this.j)},ni.prototype.i=(Qa={},function(){return Qa}),mn(ri,hr);var ai=0;function ii(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function oi(e){e.readyState=4,e.l=null,e.j=null,e.A=null,si(e)}function si(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(tn=ri.prototype).open=function(e,t){if(this.readyState!=ai)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,si(this)},tn.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||on).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},tn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,oi(this)),this.readyState=ai},tn.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,si(this)),this.g&&(this.readyState=3,si(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof on.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ii(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},tn.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?oi(this):si(this),3==this.readyState&&ii(this)}},tn.Za=function(e){this.g&&(this.response=this.responseText=e,oi(this))},tn.Ya=function(e){this.g&&(this.response=e,oi(this))},tn.ka=function(){this.g&&oi(this)},tn.setRequestHeader=function(e,t){this.v.append(e,t)},tn.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},tn.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ri.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var ui=on.JSON.parse;function ci(e){hr.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=li,this.L=this.M=!1}mn(ci,hr);var li="",hi=/^https?$/i,di=["POST","PUT"];function fi(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,pi(e),vi(e)}function pi(e){e.F||(e.F=!0,dr(e,"complete"),dr(e,"error"))}function mi(e){if(e.h&&"undefined"!=typeof an&&(!e.C[1]||4!=yi(e)||2!=e.da()))if(e.v&&4==yi(e))Nr(e.La,0,e);else if(dr(e,"readystatechange"),4==yi(e)){e.h=!1;try{var t,n=e.da();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var a;if(a=0===n){var i=String(e.I).match(xa)[1]||null;!i&&on.self&&on.self.location&&(i=on.self.location.protocol.slice(0,-1)),a=!hi.test(i?i.toLowerCase():"")}t=a}if(t)dr(e,"complete"),dr(e,"success");else{e.m=6;try{var o=2<yi(e)?e.g.statusText:""}catch(s){o=""}e.j=o+" ["+e.da()+"]",pi(e)}}finally{vi(e)}}}function vi(e,t){if(e.g){gi(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||dr(e,"ready");try{n.onreadystatechange=r}catch(a){}}}function gi(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(on.clearTimeout(e.A),e.A=null)}function yi(e){return e.g?e.g.readyState:0}function bi(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case li:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(_o){return null}}function xi(e){var t="";return Kn(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function wi(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=xi(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Ta(e,t,n))}function ki(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Si(e){this.Ga=0,this.j=[],this.l=new Lr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ki("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ki("baseRetryDelayMs",5e3,e),this.hb=ki("retryDelaySeedMs",1e4,e),this.eb=ki("forwardChannelMaxRetries",2,e),this.xa=ki("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new ja(e&&e.concurrentRequestLimit),this.Ja=new Ja,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ci(e){if(Ti(e),3==e.H){var t=e.W++,n=ka(e.I);if(Ta(n,"SID",e.K),Ta(n,"RID",t),Ta(n,"TYPE","terminate"),Ni(e,n),(t=new ra(e,e.l,t)).L=2,t.v=_a(ka(n)),n=!1,on.navigator&&on.navigator.sendBeacon)try{n=on.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&on.Image&&((new Image).src=t.v,n=!0),n||(t.g=Ui(t.l,null),t.g.ha(t.v)),t.G=Date.now(),fa(t)}Bi(e)}function Ii(e){e.g&&(Di(e),e.g.cancel(),e.g=null)}function Ti(e){Ii(e),e.u&&(on.clearTimeout(e.u),e.u=null),Mi(e),e.i.cancel(),e.m&&("number"===typeof e.m&&on.clearTimeout(e.m),e.m=null)}function _i(e){if(!Ha(e.i)&&!e.m){e.m=!0;var t=e.Na;kr||Ir(),Sr||(kr(),Sr=!0),Cr.add(t,e),e.C=0}}function Ei(e,t){var n;n=t?t.m:e.W++;var r=ka(e.I);Ta(r,"SID",e.K),Ta(r,"RID",n),Ta(r,"AID",e.V),Ni(e,r),e.o&&e.s&&wi(r,e.o,e.s),n=new ra(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Ri(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Za(e.i,n),ua(n,r,t)}function Ni(e,t){e.na&&Kn(e.na,(function(e,n){Ta(t,n,e)})),e.h&&ba({},(function(e,n){Ta(t,n,e)}))}function Ri(e,t,n){n=Math.min(e.j.length,n);var r=e.h?fn(e.h.Va,e.h,e):null;e:for(var a=e.j,i=-1;;){var o=["count="+n];-1==i?0<n?(i=a[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);for(var s=!0,u=0;u<n;u++){var c=a[u].g,l=a[u].map;if(0>(c-=i))i=Math.max(0,a[u].g-100),s=!1;else try{ei(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.j.splice(0,n),t.F=e,r}function Ai(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;kr||Ir(),Sr||(kr(),Sr=!0),Cr.add(t,e),e.A=0}}function Oi(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Kr(fn(e.Ma,e),Fi(e,e.A)),e.A++,!0)}function Di(e){null!=e.B&&(on.clearTimeout(e.B),e.B=null)}function Pi(e){e.g=new ra(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=ka(e.wa);Ta(t,"RID","rpc"),Ta(t,"SID",e.K),Ta(t,"AID",e.V),Ta(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ta(t,"TO",e.qa),Ta(t,"TYPE","xmlhttp"),Ni(e,t),e.o&&e.s&&wi(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=_a(ka(t)),n.s=null,n.S=!0,ca(n,e)}function Mi(e){null!=e.v&&(on.clearTimeout(e.v),e.v=null)}function Li(e,t){var n=null;if(e.g==t){Mi(e),Di(e),e.g=null;var r=2}else{if(!qa(e.i,t))return;n=t.F,Xa(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var a=e.C;dr(r=Vr(),new Hr(r,n)),_i(e)}else Ai(e);else if(3==(a=t.o)||0==a&&0<t.ca||!(1==r&&function(e,t){return!(Ka(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Kr(fn(e.Na,e,t),Fi(e,e.C)),e.C++,!0))}(e,t)||2==r&&Oi(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),a){case 1:zi(e,5);break;case 4:zi(e,10);break;case 3:zi(e,6);break;default:zi(e,2)}}function Fi(e,t){var n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function zi(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=fn(e.pb,e);n||(n=new wa("//www.google.com/images/cleardot.gif"),on.location&&"http"==on.location.protocol||Sa(n,"https"),_a(n)),function(e,t){var n=new Lr;if(on.Image){var r=new Image;r.onload=pn(ti,n,r,"TestLoadImage: loaded",!0,t),r.onerror=pn(ti,n,r,"TestLoadImage: error",!1,t),r.onabort=pn(ti,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=pn(ti,n,r,"TestLoadImage: timeout",!1,t),on.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Gr(2);e.H=0,e.h&&e.h.za(t),Bi(e),Ti(e)}function Bi(e){if(e.H=0,e.ma=[],e.h){var t=Ya(e.i);0==t.length&&0==e.j.length||(bn(e.ma,t),bn(e.ma,e.j),e.i.i.length=0,yn(e.j),e.j.length=0),e.h.ya()}}function Vi(e,t,n){var r=n instanceof wa?ka(n):new wa(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Ca(r,r.m);else{var a=on.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var i=new wa(null);r&&Sa(i,r),t&&(i.g=t),a&&Ca(i,a),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&Ta(r,n,t),Ta(r,"VER",e.ra),Ni(e,r),r}function Ui(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new ci(new ni({ob:!0})):new ci(e.va)).Oa(e.J),t}function Wi(){}function ji(){if(Nn&&!(10<=Number(Bn)))throw Error("Environmental error: no available transport.")}function Gi(e,t){hr.call(this),this.g=new Si(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!kn(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!kn(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new qi(this)}function Hi(e){ea.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Ki(){ta.call(this),this.status=1}function qi(e){this.g=e}function Zi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Xi(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],o=t+(i^n&(a^i))+r[0]+3614090360&4294967295;o=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(o<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=n+((o=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((a=i+((o=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function Yi(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}(tn=ci.prototype).Oa=function(e){this.M=e},tn.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():$r.g(),this.C=this.u?Yr(this.u):Yr($r),this.g.onreadystatechange=fn(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void fi(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var i,o=ye(r.keys());try{for(o.s();!(i=o.n()).done;){var s=i.value;n.set(s,r.get(s))}}catch(f){o.e(f)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),a=on.FormData&&e instanceof on.FormData,!(0<=gn(di,t))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var u,c=ye(n);try{for(c.s();!(u=c.n()).done;){var l=(0,U.Z)(u.value,2),h=l[0],d=l[1];this.g.setRequestHeader(h,d)}}catch(f){c.e(f)}finally{c.f()}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{gi(this),0<this.B&&((this.L=function(e){return Nn&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=fn(this.ua,this)):this.A=Nr(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){fi(this,s)}},tn.ua=function(){"undefined"!=typeof an&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,dr(this,"timeout"),this.abort(8))},tn.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,dr(this,"complete"),dr(this,"abort"),vi(this))},tn.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vi(this,!0)),ci.$.N.call(this)},tn.La=function(){this.s||(this.G||this.v||this.l?mi(this):this.kb())},tn.kb=function(){mi(this)},tn.isActive=function(){return!!this.g},tn.da=function(){try{return 2<yi(this)?this.g.status:-1}catch(Qa){return-1}},tn.ja=function(){try{return this.g?this.g.responseText:""}catch(Qa){return""}},tn.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ui(t)}},tn.Ia=function(){return this.m},tn.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(tn=Si.prototype).ra=8,tn.H=1,tn.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new ra(this,this.l,e),n=this.s;if(this.U&&(n?Xn(n=qn(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,a=0;a<this.j.length;a++){var i=this.j[a];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(r+=i)){r=a;break e}if(4096===r||a===this.j.length-1){r=a+1;break e}}r=1e3}else r=1e3;r=Ri(this,t,r),Ta(a=ka(this.I),"RID",e),Ta(a,"CVER",22),this.F&&Ta(a,"X-HTTP-Session-Id",this.F),Ni(this,a),n&&(this.O?r="headers="+encodeURIComponent(String(xi(n)))+"&"+r:this.o&&wi(a,this.o,n)),Za(this.i,t),this.bb&&Ta(a,"TYPE","init"),this.P?(Ta(a,"$req",r),Ta(a,"SID","null"),t.aa=!0,ua(t,a,null)):ua(t,a,r),this.H=2}}else 3==this.H&&(e?Ei(this,e):0==this.j.length||Ha(this.i)||Ei(this))},tn.Ma=function(){if(this.u=null,Pi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Kr(fn(this.jb,this),e)}},tn.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gr(10),Ii(this),Pi(this))},tn.ib=function(){null!=this.v&&(this.v=null,Ii(this),Oi(this),Gr(19))},tn.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Gr(2)):(this.l.info("Failed to ping google.com"),Gr(1))},tn.isActive=function(){return!!this.h&&this.h.isActive(this)},(tn=Wi.prototype).Ba=function(){},tn.Aa=function(){},tn.za=function(){},tn.ya=function(){},tn.isActive=function(){return!0},tn.Va=function(){},ji.prototype.g=function(e,t){return new Gi(e,t)},mn(Gi,hr),Gi.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Gr(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Vi(e,null,e.Y),_i(e)},Gi.prototype.close=function(){Ci(this.g)},Gi.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=pr(e),e=n);t.j.push(new Wa(t.fb++,e)),3==t.H&&_i(t)},Gi.prototype.N=function(){this.g.h=null,delete this.j,Ci(this.g),delete this.g,Gi.$.N.call(this)},mn(Hi,ea),mn(Ki,ta),mn(qi,Wi),qi.prototype.Ba=function(){dr(this.g,"a")},qi.prototype.Aa=function(e){dr(this.g,new Hi(e))},qi.prototype.za=function(e){dr(this.g,new Ki)},qi.prototype.ya=function(){dr(this.g,"b")},mn(Zi,(function(){this.blockSize=-1})),Zi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Zi.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,a=this.h,i=0;i<t;){if(0==a)for(;i<=n;)Xi(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(r[a++]=e.charCodeAt(i++),a==this.blockSize){Xi(this,r),a=0;break}}else for(;i<t;)if(r[a++]=e[i++],a==this.blockSize){Xi(this,r),a=0;break}}this.h=a,this.i+=t},Zi.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Qi={};function $i(e){return-128<=e&&128>e?function(e,t){var n=Qi;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Yi([0|e],0>e?-1:0)})):new Yi([0|e],0>e?-1:0)}function Ji(e){if(isNaN(e)||!isFinite(e))return to;if(0>e)return oo(Ji(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=eo;return new Yi(t,0)}var eo=4294967296,to=$i(0),no=$i(1),ro=$i(16777216);function ao(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function io(e){return-1==e.h}function oo(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Yi(n,~e.h).add(no)}function so(e,t){return e.add(oo(t))}function uo(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function co(e,t){this.g=e,this.h=t}function lo(e,t){if(ao(t))throw Error("division by zero");if(ao(e))return new co(to,to);if(io(e))return t=lo(oo(e),t),new co(oo(t.g),oo(t.h));if(io(t))return t=lo(e,oo(t)),new co(oo(t.g),t.h);if(30<e.g.length){if(io(e)||io(t))throw Error("slowDivide_ only works with positive integers.");for(var n=no,r=t;0>=r.X(e);)n=ho(n),r=ho(r);var a=fo(n,1),i=fo(r,1);for(r=fo(r,2),n=fo(n,2);!ao(r);){var o=i.add(r);0>=o.X(e)&&(a=a.add(n),i=o),r=fo(r,1),n=fo(n,1)}return t=so(e,a.R(t)),new co(a,t)}for(a=to;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(i=Ji(n)).R(t);io(o)||0<o.X(e);)o=(i=Ji(n-=r)).R(t);ao(i)&&(i=no),a=a.add(i),e=so(e,o)}return new co(a,e)}function ho(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Yi(n,e.h)}function fo(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],i=0;i<r;i++)a[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new Yi(a,e.h)}(tn=Yi.prototype).ea=function(){if(io(this))return-oo(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:eo+r)*t,t*=eo}return e},tn.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(ao(this))return"0";if(io(this))return"-"+oo(this).toString(e);for(var t=Ji(Math.pow(e,6)),n=this,r="";;){var a=lo(n,t).g,i=((0<(n=so(n,a.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(ao(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},tn.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},tn.X=function(e){return io(e=so(this,e))?-1:ao(e)?0:1},tn.abs=function(){return io(this)?oo(this):this},tn.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var i=r+(65535&this.D(a))+(65535&e.D(a)),o=(i>>>16)+(this.D(a)>>>16)+(e.D(a)>>>16);r=o>>>16,i&=65535,o&=65535,n[a]=o<<16|i}return new Yi(n,-2147483648&n[n.length-1]?-1:0)},tn.R=function(e){if(ao(this)||ao(e))return to;if(io(this))return io(e)?oo(this).R(oo(e)):oo(oo(this).R(e));if(io(e))return oo(this.R(oo(e)));if(0>this.X(ro)&&0>e.X(ro))return Ji(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var i=this.D(r)>>>16,o=65535&this.D(r),s=e.D(a)>>>16,u=65535&e.D(a);n[2*r+2*a]+=o*u,uo(n,2*r+2*a),n[2*r+2*a+1]+=i*u,uo(n,2*r+2*a+1),n[2*r+2*a+1]+=o*s,uo(n,2*r+2*a+1),n[2*r+2*a+2]+=i*s,uo(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Yi(n,0)},tn.gb=function(e){return lo(this,e).h},tn.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Yi(n,this.h&e.h)},tn.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Yi(n,this.h|e.h)},tn.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Yi(n,this.h^e.h)},ji.prototype.createWebChannel=ji.prototype.g,Gi.prototype.send=Gi.prototype.u,Gi.prototype.open=Gi.prototype.m,Gi.prototype.close=Gi.prototype.close,qr.NO_ERROR=0,qr.TIMEOUT=8,qr.HTTP_ERROR=6,Zr.COMPLETE="complete",Qr.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",hr.prototype.listen=hr.prototype.O,ci.prototype.listenOnce=ci.prototype.P,ci.prototype.getLastError=ci.prototype.Sa,ci.prototype.getLastErrorCode=ci.prototype.Ia,ci.prototype.getStatus=ci.prototype.da,ci.prototype.getResponseJson=ci.prototype.Wa,ci.prototype.getResponseText=ci.prototype.ja,ci.prototype.send=ci.prototype.ha,ci.prototype.setWithCredentials=ci.prototype.Oa,Zi.prototype.digest=Zi.prototype.l,Zi.prototype.reset=Zi.prototype.reset,Zi.prototype.update=Zi.prototype.j,Yi.prototype.add=Yi.prototype.add,Yi.prototype.multiply=Yi.prototype.R,Yi.prototype.modulo=Yi.prototype.gb,Yi.prototype.compare=Yi.prototype.X,Yi.prototype.toNumber=Yi.prototype.ea,Yi.prototype.toString=Yi.prototype.toString,Yi.prototype.getBits=Yi.prototype.D,Yi.fromNumber=Ji,Yi.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return oo(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Ji(Math.pow(n,8)),a=to,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),s=parseInt(t.substring(i,i+o),n);8>o?(o=Ji(Math.pow(n,o)),a=a.R(o).add(Ji(s))):a=(a=a.R(r)).add(Ji(s))}return a};var po=rn.createWebChannelTransport=function(){return new ji},mo=rn.getStatEventTarget=function(){return Vr()},vo=rn.ErrorCode=qr,go=rn.EventType=Zr,yo=rn.Event=zr,bo=rn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},xo=(rn.FetchXmlHttpFactory=ni,rn.WebChannel=Qr),wo=rn.XhrIo=ci,ko=rn.Md5=Zi,So=rn.Integer=Yi,Co="@firebase/firestore",Io=function(){function e(t){Se(this,e),this.uid=t}return Te(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Io.UNAUTHENTICATED=new Io(null),Io.GOOGLE_CREDENTIALS=new Io("google-credentials-uid"),Io.FIRST_PARTY=new Io("first-party-uid"),Io.MOCK_USER=new Io("mock-user");var To="10.3.0",_o=new tt("@firebase/firestore");function Eo(){return _o.logLevel}function No(e){if(_o.logLevel<=Ze.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Oo);_o.debug.apply(_o,["Firestore (".concat(To,"): ").concat(e)].concat((0,ke.Z)(a)))}}function Ro(e){if(_o.logLevel<=Ze.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Oo);_o.error.apply(_o,["Firestore (".concat(To,"): ").concat(e)].concat((0,ke.Z)(a)))}}function Ao(e){if(_o.logLevel<=Ze.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(Oo);_o.warn.apply(_o,["Firestore (".concat(To,"): ").concat(e)].concat((0,ke.Z)(a)))}}function Oo(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(vQ){return e}}function Do(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(To,") INTERNAL ASSERTION FAILED: ")+e;throw Ro(t),new Error(t)}function Po(e,t){e||Do()}function Mo(e,t){return e}var Lo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Fo=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this,e,r)).code=e,a.message=r,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},a}return Te(n)}(ze),zo=Te((function e(){var t=this;Se(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Bo=Te((function e(t,n){Se(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Vo=function(){function e(){Se(this,e)}return Te(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Io.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Uo=function(){function e(t){Se(this,e),this.token=t,this.changeListener=null}return Te(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),Wo=function(){function e(t){Se(this,e),this.t=t,this.currentUser=Io.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Te(e,[{key:"start",value:function(e,t){var n=this,r=this.i,a=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},i=new zo;this.o=function(){n.i++,n.currentUser=n.u(),i.resolve(),i=new zo,e.enqueueRetryable((function(){return a(n.currentUser)}))};var o=function(){var t=i;e.enqueueRetryable(N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},s=function(e){No("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?s(e):(No("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new zo)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(No("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Po("string"==typeof n.accessToken),new Bo(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Po(null===e||"string"==typeof e),new Io(e)}}]),e}(),jo=function(){function e(t,n,r){Se(this,e),this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=Io.FIRST_PARTY,this.I=new Map}return Te(e,[{key:"T",value:function(){return this.P?this.P():null}},{key:"headers",get:function(){this.I.set("X-Goog-AuthUser",this.l);var e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}]),e}(),Go=function(){function e(t,n,r){Se(this,e),this.l=t,this.h=n,this.P=r}return Te(e,[{key:"getToken",value:function(){return Promise.resolve(new jo(this.l,this.h,this.P))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Io.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Ho=Te((function e(t){Se(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Ko=function(){function e(t){Se(this,e),this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}return Te(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&No("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.R;return n.R=e.token,No("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var a=function(e){No("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.A.onInit((function(e){return a(e)})),setTimeout((function(){if(!n.appCheck){var e=n.A.getImmediate({optional:!0});e?a(e):No("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Po("string"==typeof t.token),e.R=t.token,new Ho(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function qo(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Zo=function(){function e(){Se(this,e)}return Te(e,null,[{key:"V",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62),n="";n.length<20;)for(var r=qo(40),a=0;a<r.length;++a)n.length<20&&r[a]<t&&(n+=e.charAt(r[a]%62));return n}}]),e}();function Xo(e,t){return e<t?-1:e>t?1:0}function Yo(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}var Qo=function(){function e(t,n){if(Se(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Fo(Lo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Fo(Lo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Fo(Lo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Fo(Lo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return Te(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Xo(this.nanoseconds,e.nanoseconds):Xo(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),$o=function(){function e(t){Se(this,e),this.timestamp=t}return Te(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Qo(0,0))}},{key:"max",value:function(){return new e(new Qo(253402300799,999999999))}}]),e}(),Jo=function(){function e(t,n,r){Se(this,e),void 0===n?n=0:n>t.length&&Do(),void 0===r?r=t.length-n:r>t.length-n&&Do(),this.segments=t,this.offset=n,this.len=r}return Te(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var a=e.get(r),i=t.get(r);if(a<i)return-1;if(a>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),es=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,(0,ke.Z)(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Jo),ts=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ns=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return ts.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",a=0,i=function(){if(0===r.length)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;a<e.length;){var s=e[a];if("\\"===s){if(a+1===e.length)throw new Fo(Lo.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[a+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Fo(Lo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else"`"===s?(o=!o,a++):"."!==s||o?(r+=s,a++):(i(),a++)}if(i(),o)throw new Fo(Lo.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Jo),rs=function(){function e(t){Se(this,e),this.path=t}return Te(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===es.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(es.fromString(t))}},{key:"fromName",value:function(t){return new e(es.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(es.emptyPath())}},{key:"comparator",value:function(e,t){return es.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new es(t.slice()))}}]),e}(),as=Te((function e(t,n,r,a){Se(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=a}));as.UNKNOWN_ID=-1;function is(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=$o.fromTimestamp(1e9===r?new Qo(n+1,0):new Qo(n,r));return new ss(a,rs.empty(),t)}function os(e){return new ss(e.readTime,e.key,-1)}var ss=function(){function e(t,n,r){Se(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return Te(e,null,[{key:"min",value:function(){return new e($o.min(),rs.empty(),-1)}},{key:"max",value:function(){return new e($o.max(),rs.empty(),-1)}}]),e}();function us(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=rs.comparator(e.documentKey,t.documentKey))?n:Xo(e.largestBatchId,t.largestBatchId)}var cs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ls=function(){function e(){Se(this,e),this.onCommittedListeners=[]}return Te(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function hs(e){return ds.apply(this,arguments)}function ds(){return(ds=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Lo.FAILED_PRECONDITION&&t.message===cs){e.next=2;break}throw t;case 2:No("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fs=function(){function e(t){var n=this;Se(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return Te(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Do(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,a){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,a)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,a)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,a=0,i=!1;t.forEach((function(t){++r,t.next((function(){++a,i&&a===r&&e()}),(function(e){return n(e)}))})),i=!0,a===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),a=ye(t);try{var i=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,a){r.push(t.call(n,e,a))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var a=t.length,i=new Array(a),o=0,s=function(){var s=u;n(t[s]).next((function(t){i[s]=t,++o===a&&e(i)}),(function(e){return r(e)}))},u=0;u<a;u++)s()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function a(){!0===t()?n().next((function(){a()}),r):e()}()}))}}]),e}();function ps(e){return"IndexedDbTransactionError"===e.name}var ms=function(){function e(t,n){var r=this;Se(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.oe(e)},this._e=function(e){return n.writeSequenceNumber(e)})}return Te(e,[{key:"oe",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this._e&&this._e(e),e}}]),e}();function vs(e){return null==e}function gs(e){return 0===e&&1/e==-1/0}function ys(e){return"number"==typeof e&&Number.isInteger(e)&&!gs(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}ms.ae=-1;var bs=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),xs=([].concat((0,ke.Z)(bs),["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),ws=xs;[].concat(ws,["indexConfiguration","indexState","indexEntries"]);function ks(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ss(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Cs(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Is=function(){function e(t,n){Se(this,e),this.comparator=t,this.root=n||_s.EMPTY}return Te(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,_s.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_s.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Ts(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Ts(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Ts(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Ts(this.root,e,this.comparator,!0)}}]),e}(),Ts=function(){function e(t,n,r,a){Se(this,e),this.isReverse=a,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&a&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return Te(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),_s=function(){function e(t,n,r,a,i){Se(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=i?i:e.EMPTY,this.size=this.left.size+1+this.right.size}return Te(e,[{key:"copy",value:function(t,n,r,a,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=i?i:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,a=n(e,r.key);return(r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,a=this;if(n(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===n(t,a.key)){if(a.right.isEmpty())return e.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,n))}return a.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Do();if(this.right.isRed())throw Do();var e=this.left.check();if(e!==this.right.check())throw Do();return e+(this.isRed()?0:1)}}]),e}();_s.EMPTY=null,_s.RED=!0,_s.BLACK=!1,_s.EMPTY=new(function(){function e(){Se(this,e),this.size=0}return Te(e,[{key:"key",get:function(){throw Do()}},{key:"value",get:function(){throw Do()}},{key:"color",get:function(){throw Do()}},{key:"left",get:function(){throw Do()}},{key:"right",get:function(){throw Do()}},{key:"copy",value:function(e,t,n,r,a){return this}},{key:"insert",value:function(e,t,n){return new _s(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Es=function(){function e(t){Se(this,e),this.comparator=t,this.data=new Is(this.comparator)}return Te(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Ns(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Ns(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(0!==this.comparator(a,i))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Ns=function(){function e(t){Se(this,e),this.iter=t}return Te(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();var Rs=function(){function e(t){Se(this,e),this.fields=t,t.sort(ns.comparator)}return Te(e,[{key:"unionWith",value:function(t){var n,r=new Es(ns.comparator),a=ye(this.fields);try{for(a.s();!(n=a.n()).done;){var i=n.value;r=r.add(i)}}catch(c){a.e(c)}finally{a.f()}var o,s=ye(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=ye(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Yo(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),As=function(e){be(n,e);var t=we(n);function n(){var e;return Se(this,n),(e=t.apply(this,arguments)).name="Base64DecodeError",e}return Te(n)}(ve(Error));var Os=function(e){function t(e){Se(this,t),this.binaryString=e}return Te(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Xo(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){var n=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new As("Invalid base64 string: "+e):e}}(e);return new t(n)}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();Os.EMPTY_BYTE_STRING=new Os("");var Ds=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ps(e){if(Po(!!e),"string"==typeof e){var t=0,n=Ds.exec(e);if(Po(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:Ms(e.seconds),nanos:Ms(e.nanos)}}function Ms(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ls(e){return"string"==typeof e?Os.fromBase64String(e):Os.fromUint8Array(e)}function Fs(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zs(e){var t=e.mapValue.fields.__previous_value__;return Fs(t)?zs(t):t}function Bs(e){var t=Ps(e.mapValue.fields.__local_write_time__.timestampValue);return new Qo(t.seconds,t.nanos)}var Vs=Te((function e(t,n,r,a,i,o,s,u,c){Se(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=u,this.useFetchStreams=c})),Us=function(){function e(t,n){Se(this,e),this.projectId=t,this.database=n||"(default)"}return Te(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}(),Ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function js(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Fs(e)?4:ru(e)?9007199254740991:10:Do()}function Gs(e,t){if(e===t)return!0;var n=js(e);if(n!==js(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Bs(e).isEqual(Bs(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Ps(e.timestampValue),r=Ps(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ls(e.bytesValue).isEqual(Ls(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Ms(e.geoPointValue.latitude)===Ms(t.geoPointValue.latitude)&&Ms(e.geoPointValue.longitude)===Ms(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Ms(e.integerValue)===Ms(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Ms(e.doubleValue),r=Ms(t.doubleValue);return n===r?gs(n)===gs(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Yo(e.arrayValue.values||[],t.arrayValue.values||[],Gs);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ks(n)!==ks(r))return!1;for(var a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Gs(n[a],r[a])))return!1;return!0}(e,t);default:return Do()}}function Hs(e,t){return void 0!==(e.values||[]).find((function(e){return Gs(e,t)}))}function Ks(e,t){if(e===t)return 0;var n=js(e),r=js(t);if(n!==r)return Xo(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Xo(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Ms(e.integerValue||e.doubleValue),r=Ms(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return qs(e.timestampValue,t.timestampValue);case 4:return qs(Bs(e),Bs(t));case 5:return Xo(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Ls(e),r=Ls(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0;a<n.length&&a<r.length;a++){var i=Xo(n[a],r[a]);if(0!==i)return i}return Xo(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Xo(Ms(e.latitude),Ms(t.latitude));return 0!==n?n:Xo(Ms(e.longitude),Ms(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],a=0;a<n.length&&a<r.length;++a){var i=Ks(n[a],r[a]);if(i)return i}return Xo(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ws.mapValue&&t===Ws.mapValue)return 0;if(e===Ws.mapValue)return 1;if(t===Ws.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(var o=0;o<r.length&&o<i.length;++o){var s=Xo(r[o],i[o]);if(0!==s)return s;var u=Ks(n[r[o]],a[i[o]]);if(0!==u)return u}return Xo(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Do()}}function qs(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Xo(e,t);var n=Ps(e),r=Ps(t),a=Xo(n.seconds,r.seconds);return 0!==a?a:Xo(n.nanos,r.nanos)}function Zs(e){return Xs(e)}function Xs(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Ps(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Ls(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return rs.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){var t,n="[",r=!0,a=ye(e.values||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+=Xs(i)}}catch(o){a.e(o)}finally{a.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,a=ye(Object.keys(e.fields||{}).sort());try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+="".concat(i,":").concat(Xs(e.fields[i]))}}catch(o){a.e(o)}finally{a.f()}return n+"}"}(e.mapValue):Do()}function Ys(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Qs(e){return!!e&&"integerValue"in e}function $s(e){return!!e&&"arrayValue"in e}function Js(e){return!!e&&"nullValue"in e}function eu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function tu(e){return!!e&&"mapValue"in e}function nu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Ss(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=nu(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=nu(e.arrayValue.values[r]);return n}return Object.assign({},e)}function ru(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var au=function(){function e(t){Se(this,e),this.value=t}return Te(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!tu(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nu(t)}},{key:"setAll",value:function(e){var t=this,n=ns.emptyPath(),r={},a=[];e.forEach((function(e,i){if(!n.isImmediateParentOf(i)){var o=t.getFieldsMap(n);t.applyChanges(o,r,a),r={},a=[],n=i.popLast()}e?r[i.lastSegment()]=nu(e):a.push(i.lastSegment())}));var i=this.getFieldsMap(n);this.applyChanges(i,r,a)}},{key:"delete",value:function(e){var t=this.field(e.popLast());tu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Gs(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];tu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Ss(t,(function(t,n){return e[t]=n}));var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;delete e[i]}}catch(o){a.e(o)}finally{a.f()}}},{key:"clone",value:function(){return new e(nu(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function iu(e){var t=[];return Ss(e.fields,(function(e,n){var r=new ns([e]);if(tu(n)){var a=iu(n.mapValue).fields;if(0===a.length)t.push(r);else{var i,o=ye(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)})),new Rs(t)}var ou=function(){function e(t,n,r,a,i,o,s){Se(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.createTime=i,this.data=o,this.documentState=s}return Te(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual($o.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=au.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=au.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=$o.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,$o.min(),$o.min(),$o.min(),au.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,a){return new e(t,1,n,$o.min(),r,a,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,$o.min(),$o.min(),au.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,$o.min(),$o.min(),au.empty(),2)}}]),e}(),su=Te((function e(t,n){Se(this,e),this.position=t,this.inclusive=n}));function uu(e,t,n){for(var r=0,a=0;a<e.position.length;a++){var i=t[a],o=e.position[a];if(r=i.field.isKeyField()?rs.comparator(rs.fromName(o.referenceValue),n.key):Ks(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function cu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Gs(e.position[n],t.position[n]))return!1;return!0}var lu=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";Se(this,e),this.field=t,this.dir=n}));function hu(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var du=Te((function e(){Se(this,e)})),fu=function(e){be(n,e);var t=we(n);function n(e,r,a){var i;return Se(this,n),(i=t.call(this)).field=e,i.op=r,i.value=a,i}return Te(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Ks(t,this.value)):null!==t&&js(this.value)===js(t)&&this.matchesComparison(Ks(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Do()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new wu(e,t,r):"array-contains"===t?new Iu(e,r):"in"===t?new Tu(e,r):"not-in"===t?new _u(e,r):"array-contains-any"===t?new Eu(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new ku(e,n):new Su(e,n)}}]),n}(du),pu=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).filters=e,a.op=r,a.ce=null,a}return Te(n,[{key:"matches",value:function(e){return mu(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ce||(this.ce=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ce}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.le((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"le",value:function(e){var t,n=ye(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(a){n.e(a)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(du);function mu(e){return"and"===e.op}function vu(e){return gu(e)&&mu(e)}function gu(e){var t,n=ye(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof pu)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function yu(e){if(e instanceof fu)return e.field.canonicalString()+e.op.toString()+Zs(e.value);if(vu(e))return e.filters.map((function(e){return yu(e)})).join(",");var t=e.filters.map((function(e){return yu(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function bu(e,t){return e instanceof fu?function(e,t){return t instanceof fu&&e.op===t.op&&e.field.isEqual(t.field)&&Gs(e.value,t.value)}(e,t):e instanceof pu?function(e,t){return t instanceof pu&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&bu(n,t.filters[r])}),!0)}(e,t):void Do()}function xu(e){return e instanceof fu?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Zs(e.value))}(e):e instanceof pu?function(e){return e.op.toString()+" {"+e.getFilters().map(xu).join(" ,")+"}"}(e):"Filter"}var wu=function(e){be(n,e);var t=we(n);function n(e,r,a){var i;return Se(this,n),(i=t.call(this,e,r,a)).key=rs.fromName(a.referenceValue),i}return Te(n,[{key:"matches",value:function(e){var t=rs.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(fu),ku=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this,e,"in",r)).keys=Cu("in",r),a}return Te(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(fu),Su=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this,e,"not-in",r)).keys=Cu("not-in",r),a}return Te(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(fu);function Cu(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return rs.fromName(e.referenceValue)}))}var Iu=function(e){be(n,e);var t=we(n);function n(e,r){return Se(this,n),t.call(this,e,"array-contains",r)}return Te(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return $s(t)&&Hs(t.arrayValue,this.value)}}]),n}(fu),Tu=function(e){be(n,e);var t=we(n);function n(e,r){return Se(this,n),t.call(this,e,"in",r)}return Te(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Hs(this.value.arrayValue,t)}}]),n}(fu),_u=function(e){be(n,e);var t=we(n);function n(e,r){return Se(this,n),t.call(this,e,"not-in",r)}return Te(n,[{key:"matches",value:function(e){if(Hs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Hs(this.value.arrayValue,t)}}]),n}(fu),Eu=function(e){be(n,e);var t=we(n);function n(e,r){return Se(this,n),t.call(this,e,"array-contains-any",r)}return Te(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!$s(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Hs(t.value.arrayValue,e)}))}}]),n}(fu),Nu=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Se(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=s,this.he=null}));function Ru(e){return new Nu(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Au(e){var t=Mo(e);if(null===t.he){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return yu(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),vs(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Zs(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Zs(e)})).join(",")),t.he=n}return t.he}function Ou(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!hu(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!bu(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cu(e.startAt,t.startAt)&&cu(e.endAt,t.endAt)}function Du(e){return rs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var Pu=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Se(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Pe=null,this.Ie=null,this.Te=null,this.startAt,this.endAt}));function Mu(e,t,n,r,a,i,o,s){return new Pu(e,t,n,r,a,i,o,s)}function Lu(e){return new Pu(e)}function Fu(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function zu(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Bu(e){var t,n=ye(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(a){n.e(a)}finally{n.f()}return null}function Vu(e){return null!==e.collectionGroup}function Uu(e){var t=Mo(e);if(null===t.Pe){t.Pe=[];var n=Bu(t),r=zu(t);if(null!==n&&null===r)n.isKeyField()||t.Pe.push(new lu(n)),t.Pe.push(new lu(ns.keyField(),"asc"));else{var a,i=!1,o=ye(t.explicitOrderBy);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.Pe.push(s),s.field.isKeyField()&&(i=!0)}}catch(c){o.e(c)}finally{o.f()}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.Pe.push(new lu(ns.keyField(),u))}}}return t.Pe}function Wu(e){var t=Mo(e);return t.Ie||(t.Ie=ju(t,Uu(e))),t.Ie}function ju(e,t){if("F"===e.limitType)return Ru(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);t=t.map((function(e){var t="desc"===e.dir?"asc":"desc";return new lu(e.field,t)}));var n=e.endAt?new su(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new su(e.startAt.position,e.startAt.inclusive):null;return Ru(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}function Gu(e,t){t.getFirstInequalityField(),Bu(e);var n=e.filters.concat([t]);return new Pu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Hu(e,t,n){return new Pu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ku(e,t){return Ou(Wu(e),Wu(t))&&e.limitType===t.limitType}function qu(e){return"".concat(Au(Wu(e)),"|lt:").concat(e.limitType)}function Zu(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return xu(e)})).join(", "),"]")),vs(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return Zs(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return Zs(e)})).join(",")),"Target(".concat(t,")")}(Wu(e)),"; limitType=").concat(e.limitType,")")}function Xu(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):rs.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=ye(Uu(e));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!a.field.isKeyField()&&null===t.data.field(a.field))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=ye(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=uu(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Uu(e),t))&&!(e.endAt&&!function(e,t,n){var r=uu(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Uu(e),t))}(e,t)}function Yu(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qu(e){return function(t,n){var r,a=!1,i=ye(Uu(e));try{for(i.s();!(r=i.n()).done;){var o=r.value,s=$u(o,t,n);if(0!==s)return s;a=a||o.field.isKeyField()}}catch(u){i.e(u)}finally{i.f()}return 0}}function $u(e,t,n){var r=e.field.isKeyField()?rs.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Ks(r,a):Do()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Do()}}var Ju=function(){function e(t,n){Se(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return Te(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=(0,U.Z)(r.value,2),o=i[0],s=i[1];if(this.equalsFn(o,e))return s}}catch(u){a.e(u)}finally{a.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Ss(this.inner,(function(t,n){var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=(0,U.Z)(r.value,2),o=i[0],s=i[1];e(o,s)}}catch(u){a.e(u)}finally{a.f()}}))}},{key:"isEmpty",value:function(){return Cs(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),ec=new Is(rs.comparator);function tc(){return ec}var nc=new Is(rs.comparator);function rc(){for(var e=nc,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.insert(o.key,o)}return e}function ac(e){var t=nc;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function ic(){return sc()}function oc(){return sc()}function sc(){return new Ju((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var uc=new Is(rs.comparator),cc=new Es(rs.comparator);function lc(){for(var e=cc,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.add(o)}return e}var hc=new Es(Xo);function dc(){return hc}function fc(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gs(t)?"-0":t}}function pc(e){return{integerValue:""+e}}function mc(e,t){return ys(t)?pc(t):fc(e,t)}var vc=Te((function e(){Se(this,e),this._=void 0}));function gc(e,t,n){return e instanceof xc?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Fs(t)&&(t=zs(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wc?kc(e,t):e instanceof Sc?Cc(e,t):function(e,t){var n=bc(e,t),r=Tc(n)+Tc(e.Ee);return Qs(n)&&Qs(e.Ee)?pc(r):fc(e.serializer,r)}(e,t)}function yc(e,t,n){return e instanceof wc?kc(e,t):e instanceof Sc?Cc(e,t):n}function bc(e,t){return e instanceof Ic?function(e){return Qs(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}var xc=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n)}(vc),wc=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).elements=e,r}return Te(n)}(vc);function kc(e,t){var n,r=_c(t),a=ye(e.elements);try{var i=function(){var e=n.value;r.some((function(t){return Gs(t,e)}))||r.push(e)};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var Sc=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).elements=e,r}return Te(n)}(vc);function Cc(e,t){var n,r=_c(t),a=ye(e.elements);try{var i=function(){var e=n.value;r=r.filter((function(t){return!Gs(t,e)}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var Ic=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).serializer=e,a.Ee=r,a}return Te(n)}(vc);function Tc(e){return Ms(e.integerValue||e.doubleValue)}function _c(e){return $s(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Ec=Te((function e(t,n){Se(this,e),this.version=t,this.transformResults=n})),Nc=function(){function e(t,n){Se(this,e),this.updateTime=t,this.exists=n}return Te(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Rc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Ac=Te((function e(){Se(this,e)}));function Oc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Gc(e.key,Nc.none()):new Fc(e.key,e.data,Nc.none());var n,r=e.data,a=au.empty(),i=new Es(ns.comparator),o=ye(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!i.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?a.delete(s):a.set(s,u),i=i.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new zc(e.key,a,new Rs(i.toArray()),Nc.none())}function Dc(e,t,n){e instanceof Fc?function(e,t,n){var r=e.value.clone(),a=Vc(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof zc?function(e,t,n){if(Rc(e.precondition,t)){var r=Vc(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Bc(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Pc(e,t,n,r){return e instanceof Fc?function(e,t,n,r){if(!Rc(e.precondition,t))return n;var a=e.value.clone(),i=Uc(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof zc?function(e,t,n,r){if(!Rc(e.precondition,t))return n;var a=Uc(e.fieldTransforms,r,t),i=t.data;return i.setAll(Bc(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Rc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Mc(e,t){var n,r=null,a=ye(e.fieldTransforms);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=t.data.field(i.field),s=bc(i.transform,o||null);null!=s&&(null===r&&(r=au.empty()),r.set(i.field,s))}}catch(u){a.e(u)}finally{a.f()}return r||null}function Lc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Yo(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wc&&t instanceof wc||e instanceof Sc&&t instanceof Sc?Yo(e.elements,t.elements,Gs):e instanceof Ic&&t instanceof Ic?Gs(e.Ee,t.Ee):e instanceof xc&&t instanceof xc}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Fc=function(e){be(n,e);var t=we(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Se(this,n),(i=t.call(this)).key=e,i.value=r,i.precondition=a,i.fieldTransforms=o,i.type=0,i}return Te(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ac),zc=function(e){be(n,e);var t=we(n);function n(e,r,a,i){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Se(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=a,o.precondition=i,o.fieldTransforms=s,o.type=1,o}return Te(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Ac);function Bc(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Vc(e,t,n){var r=new Map;Po(e.length===n.length);for(var a=0;a<n.length;a++){var i=e[a],o=i.transform,s=t.data.field(i.field);r.set(i.field,yc(o,s,n[a]))}return r}function Uc(e,t,n){var r,a=new Map,i=ye(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);a.set(o.field,gc(s,u,t))}}catch(c){i.e(c)}finally{i.f()}return a}var Wc,jc,Gc=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=2,a.fieldTransforms=[],a}return Te(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ac),Hc=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=3,a.fieldTransforms=[],a}return Te(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ac),Kc=function(){function e(t,n,r,a){Se(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}return Te(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var a=this.mutations[r];a.key.isEqual(e.key)&&Dc(a,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=ye(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var i,o=ye(this.mutations);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.key.isEqual(e.key)&&(t=Pc(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=oc();return this.mutations.forEach((function(a){var i=e.get(a.key),o=i.overlayedDocument,s=n.applyToLocalView(o,i.mutatedFields),u=Oc(o,s=t.has(a.key)?null:s);null!==u&&r.set(a.key,u),o.isValidDocument()||o.convertToNoDocument($o.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),lc())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Yo(this.mutations,e.mutations,(function(e,t){return Lc(e,t)}))&&Yo(this.baseMutations,e.baseMutations,(function(e,t){return Lc(e,t)}))}}]),e}(),qc=function(){function e(t,n,r,a){Se(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}return Te(e,null,[{key:"from",value:function(t,n,r){Po(t.mutations.length===r.length);for(var a=uc,i=t.mutations,o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new e(t,n,r,a)}}]),e}(),Zc=function(){function e(t,n){Se(this,e),this.largestBatchId=t,this.mutation=n}return Te(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Xc=Te((function e(t,n){Se(this,e),this.count=t,this.unchangedNames=n}));function Yc(e){switch(e){default:return Do();case Lo.CANCELLED:case Lo.UNKNOWN:case Lo.DEADLINE_EXCEEDED:case Lo.RESOURCE_EXHAUSTED:case Lo.INTERNAL:case Lo.UNAVAILABLE:case Lo.UNAUTHENTICATED:return!1;case Lo.INVALID_ARGUMENT:case Lo.NOT_FOUND:case Lo.ALREADY_EXISTS:case Lo.PERMISSION_DENIED:case Lo.FAILED_PRECONDITION:case Lo.ABORTED:case Lo.OUT_OF_RANGE:case Lo.UNIMPLEMENTED:case Lo.DATA_LOSS:return!0}}function Qc(e){if(void 0===e)return Ro("GRPC error has no .code"),Lo.UNKNOWN;switch(e){case Wc.OK:return Lo.OK;case Wc.CANCELLED:return Lo.CANCELLED;case Wc.UNKNOWN:return Lo.UNKNOWN;case Wc.DEADLINE_EXCEEDED:return Lo.DEADLINE_EXCEEDED;case Wc.RESOURCE_EXHAUSTED:return Lo.RESOURCE_EXHAUSTED;case Wc.INTERNAL:return Lo.INTERNAL;case Wc.UNAVAILABLE:return Lo.UNAVAILABLE;case Wc.UNAUTHENTICATED:return Lo.UNAUTHENTICATED;case Wc.INVALID_ARGUMENT:return Lo.INVALID_ARGUMENT;case Wc.NOT_FOUND:return Lo.NOT_FOUND;case Wc.ALREADY_EXISTS:return Lo.ALREADY_EXISTS;case Wc.PERMISSION_DENIED:return Lo.PERMISSION_DENIED;case Wc.FAILED_PRECONDITION:return Lo.FAILED_PRECONDITION;case Wc.ABORTED:return Lo.ABORTED;case Wc.OUT_OF_RANGE:return Lo.OUT_OF_RANGE;case Wc.UNIMPLEMENTED:return Lo.UNIMPLEMENTED;case Wc.DATA_LOSS:return Lo.DATA_LOSS;default:return Do()}}(jc=Wc||(Wc={}))[jc.OK=0]="OK",jc[jc.CANCELLED=1]="CANCELLED",jc[jc.UNKNOWN=2]="UNKNOWN",jc[jc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jc[jc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jc[jc.NOT_FOUND=5]="NOT_FOUND",jc[jc.ALREADY_EXISTS=6]="ALREADY_EXISTS",jc[jc.PERMISSION_DENIED=7]="PERMISSION_DENIED",jc[jc.UNAUTHENTICATED=16]="UNAUTHENTICATED",jc[jc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jc[jc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jc[jc.ABORTED=10]="ABORTED",jc[jc.OUT_OF_RANGE=11]="OUT_OF_RANGE",jc[jc.UNIMPLEMENTED=12]="UNIMPLEMENTED",jc[jc.INTERNAL=13]="INTERNAL",jc[jc.UNAVAILABLE=14]="UNAVAILABLE",jc[jc.DATA_LOSS=15]="DATA_LOSS";var $c=null;function Jc(){return new TextEncoder}var el=new So([4294967295,4294967295],0);function tl(e){var t=Jc().encode(e),n=new ko;return n.update(t),new Uint8Array(n.digest())}function nl(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new So([n,r],0),new So([a,i],0)]}var rl=function(){function e(t,n,r){if(Se(this,e),this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new al("Invalid padding: ".concat(n));if(r<0)throw new al("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new al("Invalid hash count: ".concat(r));if(0===t.length&&0!==n)throw new al("Invalid padding when bitmap length is 0: ".concat(n));this.Ae=8*t.length-n,this.Re=So.fromNumber(this.Ae)}return Te(e,[{key:"Ve",value:function(e,t,n){var r=e.add(t.multiply(So.fromNumber(n)));return 1===r.compare(el)&&(r=new So([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Re).toNumber()}},{key:"me",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"mightContain",value:function(e){if(0===this.Ae)return!1;for(var t=nl(tl(e)),n=(0,U.Z)(t,2),r=n[0],a=n[1],i=0;i<this.hashCount;i++){var o=this.Ve(r,a,i);if(!this.me(o))return!1}return!0}},{key:"insert",value:function(e){if(0!==this.Ae)for(var t=nl(tl(e)),n=(0,U.Z)(t,2),r=n[0],a=n[1],i=0;i<this.hashCount;i++){var o=this.Ve(r,a,i);this.fe(o)}}},{key:"fe",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(t,n,r){var a=t%8==0?0:8-t%8,i=new e(new Uint8Array(Math.ceil(t/8)),a,n);return r.forEach((function(e){return i.insert(e)})),i}}]),e}(),al=function(e){be(n,e);var t=we(n);function n(){var e;return Se(this,n),(e=t.apply(this,arguments)).name="BloomFilterError",e}return Te(n)}(ve(Error)),il=function(){function e(t,n,r,a,i){Se(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}return Te(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var a=new Map;return a.set(t,ol.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e($o.min(),a,new Is(Xo),tc(),lc())}}]),e}(),ol=function(){function e(t,n,r,a,i){Se(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}return Te(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,lc(),lc(),lc())}}]),e}(),sl=Te((function e(t,n,r,a){Se(this,e),this.ge=t,this.removedTargetIds=n,this.key=r,this.pe=a})),ul=Te((function e(t,n){Se(this,e),this.targetId=t,this.ye=n})),cl=Te((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Os.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Se(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a})),ll=function(){function e(){Se(this,e),this.we=0,this.Se=fl(),this.be=Os.EMPTY_BYTE_STRING,this.De=!1,this.ve=!0}return Te(e,[{key:"current",get:function(){return this.De}},{key:"resumeToken",get:function(){return this.be}},{key:"Ce",get:function(){return 0!==this.we}},{key:"Fe",get:function(){return this.ve}},{key:"Me",value:function(e){e.approximateByteSize()>0&&(this.ve=!0,this.be=e)}},{key:"xe",value:function(){var e=lc(),t=lc(),n=lc();return this.Se.forEach((function(r,a){switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Do()}})),new ol(this.be,this.De,e,t,n)}},{key:"Oe",value:function(){this.ve=!1,this.Se=fl()}},{key:"Ne",value:function(e,t){this.ve=!0,this.Se=this.Se.insert(e,t)}},{key:"Be",value:function(e){this.ve=!0,this.Se=this.Se.remove(e)}},{key:"Le",value:function(){this.we+=1}},{key:"ke",value:function(){this.we-=1}},{key:"qe",value:function(){this.ve=!0,this.De=!0}}]),e}(),hl=function(){function e(t){Se(this,e),this.Qe=t,this.Ke=new Map,this.$e=tc(),this.Ue=dl(),this.We=new Is(Xo)}return Te(e,[{key:"Ge",value:function(e){var t,n=ye(e.ge);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.pe&&e.pe.isFoundDocument()?this.ze(r,e.pe):this.je(r,e.key,e.pe)}}catch(s){n.e(s)}finally{n.f()}var a,i=ye(e.removedTargetIds);try{for(i.s();!(a=i.n()).done;){var o=a.value;this.je(o,e.key,e.pe)}}catch(s){i.e(s)}finally{i.f()}}},{key:"He",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Je(n);switch(e.state){case 0:t.Ye(n)&&r.Me(e.resumeToken);break;case 1:r.ke(),r.Ce||r.Oe(),r.Me(e.resumeToken);break;case 2:r.ke(),r.Ce||t.removeTarget(n);break;case 3:t.Ye(n)&&(r.qe(),r.Me(e.resumeToken));break;case 4:t.Ye(n)&&(t.Ze(n),r.Me(e.resumeToken));break;default:Do()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ke.forEach((function(e,r){n.Ye(r)&&t(r)}))}},{key:"Xe",value:function(e){var t=e.targetId,n=e.ye.count,r=this.et(t);if(r){var a=r.target;if(Du(a))if(0===n){var i=new rs(a.path);this.je(t,i,ou.newNoDocument(i,$o.min()))}else Po(1===n);else{var o=this.tt(t);if(o!==n){var s=this.nt(e),u=s?this.rt(s,e,o):1;if(0!==u){this.Ze(t);var c=2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(t,c)}null==$c||$c.it(function(e,t,n,r,a){var i,o,s,u,c,l,h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===a,hashCount:null!==(i=null==d?void 0:d.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(u=null===(s=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===s?void 0:s.length)&&void 0!==u?u:0,padding:null!==(l=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:function(e){var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(o,e.ye,this.Qe.st(),s,u))}}}}},{key:"nt",value:function(e){var t=e.ye.unchangedNames;if(!t||!t.bits)return null;var n,r,a=t.bits,i=a.bitmap,o=void 0===i?"":i,s=a.padding,u=void 0===s?0:s,c=t.hashCount,l=void 0===c?0:c;try{n=Ls(o).toUint8Array()}catch(e){if(e instanceof As)return Ao("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new rl(n,u,l)}catch(e){return Ao(e instanceof al?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.Ae?null:r}},{key:"rt",value:function(e,t,n){return t.ye.count===n-this.ot(e,t.targetId)?0:2}},{key:"ot",value:function(e,t){var n=this,r=this.Qe.getRemoteKeysForTarget(t),a=0;return r.forEach((function(r){var i=n.Qe.st(),o="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(r.path.canonicalString());e.mightContain(o)||(n.je(t,r,null),a++)})),a}},{key:"_t",value:function(e){var t=this,n=new Map;this.Ke.forEach((function(r,a){var i=t.et(a);if(i){if(r.current&&Du(i.target)){var o=new rs(i.target.path);null!==t.$e.get(o)||t.ut(a,o)||t.je(a,o,ou.newNoDocument(o,e))}r.Fe&&(n.set(a,r.xe()),r.Oe())}}));var r=lc();this.Ue.forEach((function(e,n){var a=!0;n.forEachWhile((function(e){var n=t.et(e);return!n||"TargetPurposeLimboResolution"===n.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.$e.forEach((function(t,n){return n.setReadTime(e)}));var a=new il(e,n,this.We,this.$e,r);return this.$e=tc(),this.Ue=dl(),this.We=new Is(Xo),a}},{key:"ze",value:function(e,t){if(this.Ye(e)){var n=this.ut(e,t.key)?2:0;this.Je(e).Ne(t.key,n),this.$e=this.$e.insert(t.key,t),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}}},{key:"je",value:function(e,t,n){if(this.Ye(e)){var r=this.Je(e);this.ut(e,t)?r.Ne(t,1):r.Be(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),n&&(this.$e=this.$e.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ke.delete(e)}},{key:"tt",value:function(e){var t=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Le",value:function(e){this.Je(e).Le()}},{key:"Je",value:function(e){var t=this.Ke.get(e);return t||(t=new ll,this.Ke.set(e,t)),t}},{key:"ct",value:function(e){var t=this.Ue.get(e);return t||(t=new Es(Xo),this.Ue=this.Ue.insert(e,t)),t}},{key:"Ye",value:function(e){var t=null!==this.et(e);return t||No("WatchChangeAggregator","Detected inactive target",e),t}},{key:"et",value:function(e){var t=this.Ke.get(e);return t&&t.Ce?null:this.Qe.lt(e)}},{key:"Ze",value:function(e){var t=this;this.Ke.set(e,new ll),this.Qe.getRemoteKeysForTarget(e).forEach((function(n){t.je(e,n,null)}))}},{key:"ut",value:function(e,t){return this.Qe.getRemoteKeysForTarget(e).has(t)}}]),e}();function dl(){return new Is(rs.comparator)}function fl(){return new Is(rs.comparator)}var pl={asc:"ASCENDING",desc:"DESCENDING"},ml={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vl={and:"AND",or:"OR"},gl=Te((function e(t,n){Se(this,e),this.databaseId=t,this.useProto3Json=n}));function yl(e,t){return e.useProto3Json||vs(t)?t:{value:t}}function bl(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function xl(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function wl(e,t){return bl(e,t.toTimestamp())}function kl(e){return Po(!!e),$o.fromTimestamp(function(e){var t=Ps(e);return new Qo(t.seconds,t.nanos)}(e))}function Sl(e,t){return function(e){return new es(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Cl(e){var t=es.fromString(e);return Po(Gl(t)),t}function Il(e,t){return Sl(e.databaseId,t.path)}function Tl(e,t){var n=Cl(t);if(n.get(1)!==e.databaseId.projectId)throw new Fo(Lo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Fo(Lo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new rs(Rl(n))}function _l(e,t){return Sl(e.databaseId,t)}function El(e){var t=Cl(e);return 4===t.length?es.emptyPath():Rl(t)}function Nl(e){return new es(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Rl(e){return Po(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Al(e,t,n){return{name:Il(e,t),fields:n.value.mapValue.fields}}function Ol(e,t){var n;if(t instanceof Fc)n={update:Al(e,t.key,t.value)};else if(t instanceof Gc)n={delete:Il(e,t.key)};else if(t instanceof zc)n={update:Al(e,t.key,t.data),updateMask:jl(t.fieldMask)};else{if(!(t instanceof Hc))return Do();n={verify:Il(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof xc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Sc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ic)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw Do()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:wl(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Do()}(e,t.precondition)),n}function Dl(e,t){return{documents:[_l(e,t.path)]}}function Pl(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=_l(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=_l(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var a=function(e){if(0!==e.length)return Wl(pu.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);var i=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:Vl(e.field),direction:Fl(e.dir)}}(e)}))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);var o=yl(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Ml(e){var t=El(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,a=null;if(r>0){Po(1===r);var i=n.from[0];i.allDescendants?a=i.collectionId:t=t.child(i.collectionId)}var o=[];n.where&&(o=function(e){var t=Ll(e);return t instanceof pu&&vu(t)?t.getFilters():[t]}(n.where));var s=[];n.orderBy&&(s=function(e){return e.map((function(e){return function(e){return new lu(Ul(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)}))}(n.orderBy));var u=null;n.limit&&(u=function(e){var t;return vs(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new su(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new su(n,t)}(n.endAt)),Mu(t,a,s,o,u,"F",c,l)}function Ll(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Ul(e.unaryFilter.field);return fu.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Ul(e.unaryFilter.field);return fu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ul(e.unaryFilter.field);return fu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var a=Ul(e.unaryFilter.field);return fu.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Do()}}(e):void 0!==e.fieldFilter?function(e){return fu.create(Ul(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Do()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return pu.create(e.compositeFilter.filters.map((function(e){return Ll(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Do()}}(e.compositeFilter.op))}(e):Do()}function Fl(e){return pl[e]}function zl(e){return ml[e]}function Bl(e){return vl[e]}function Vl(e){return{fieldPath:e.canonicalString()}}function Ul(e){return ns.fromServerFormat(e.fieldPath)}function Wl(e){return e instanceof fu?function(e){if("=="===e.op){if(eu(e.value))return{unaryFilter:{field:Vl(e.field),op:"IS_NAN"}};if(Js(e.value))return{unaryFilter:{field:Vl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(eu(e.value))return{unaryFilter:{field:Vl(e.field),op:"IS_NOT_NAN"}};if(Js(e.value))return{unaryFilter:{field:Vl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vl(e.field),op:zl(e.op),value:e.value}}}(e):e instanceof pu?function(e){var t=e.getFilters().map((function(e){return Wl(e)}));return 1===t.length?t[0]:{compositeFilter:{op:Bl(e.op),filters:t}}}(e):Do()}function jl(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function Gl(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var Hl=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$o.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:$o.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Os.EMPTY_BYTE_STRING,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Se(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=u}return Te(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}},{key:"withExpectedCount",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}]),e}(),Kl=Te((function e(t){Se(this,e),this.ht=t}));function ql(e){var t=Ml({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Hu(t,t.limit,"L"):t}var Zl=function(){function e(){Se(this,e)}return Te(e,[{key:"Tt",value:function(e,t){this.Et(e,t),t.dt()}},{key:"Et",value:function(e,t){if("nullValue"in e)this.At(t,5);else if("booleanValue"in e)this.At(t,10),t.Rt(e.booleanValue?1:0);else if("integerValue"in e)this.At(t,15),t.Rt(Ms(e.integerValue));else if("doubleValue"in e){var n=Ms(e.doubleValue);isNaN(n)?this.At(t,13):(this.At(t,15),gs(n)?t.Rt(0):t.Rt(n))}else if("timestampValue"in e){var r=e.timestampValue;this.At(t,20),"string"==typeof r?t.Vt(r):(t.Vt("".concat(r.seconds||"")),t.Rt(r.nanos||0))}else if("stringValue"in e)this.ft(e.stringValue,t),this.gt(t);else if("bytesValue"in e)this.At(t,30),t.yt(Ls(e.bytesValue)),this.gt(t);else if("referenceValue"in e)this.wt(e.referenceValue,t);else if("geoPointValue"in e){var a=e.geoPointValue;this.At(t,45),t.Rt(a.latitude||0),t.Rt(a.longitude||0)}else"mapValue"in e?ru(e)?this.At(t,Number.MAX_SAFE_INTEGER):(this.St(e.mapValue,t),this.gt(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.gt(t)):Do()}},{key:"ft",value:function(e,t){this.At(t,25),this.Dt(e,t)}},{key:"Dt",value:function(e,t){t.Vt(e)}},{key:"St",value:function(e,t){var n=e.fields||{};this.At(t,55);for(var r=0,a=Object.keys(n);r<a.length;r++){var i=a[r];this.ft(i,t),this.Et(n[i],t)}}},{key:"bt",value:function(e,t){var n=e.values||[];this.At(t,50);var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.Et(i,t)}}catch(o){a.e(o)}finally{a.f()}}},{key:"wt",value:function(e,t){var n=this;this.At(t,37),rs.fromName(e).path.forEach((function(e){n.At(t,60),n.Dt(e,t)}))}},{key:"At",value:function(e,t){e.Rt(t)}},{key:"gt",value:function(e){e.Rt(2)}}]),e}();Zl.vt=new Zl;var Xl=function(){function e(){Se(this,e),this._n=new Yl}return Te(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this._n.add(t),fs.resolve()}},{key:"getCollectionParents",value:function(e,t){return fs.resolve(this._n.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return fs.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return fs.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return fs.resolve(null)}},{key:"getIndexType",value:function(e,t){return fs.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return fs.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return fs.resolve(null)}},{key:"getMinOffset",value:function(e,t){return fs.resolve(ss.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return fs.resolve(ss.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return fs.resolve()}},{key:"updateIndexEntries",value:function(e,t){return fs.resolve()}}]),e}(),Yl=function(){function e(){Se(this,e),this.index={}}return Te(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Es(es.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Es(es.comparator)).toArray()}}]),e}();new Uint8Array(0);var Ql=function(){function e(t,n,r){Se(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Te(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();Ql.DEFAULT_COLLECTION_PERCENTILE=10,Ql.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ql.DEFAULT=new Ql(41943040,Ql.DEFAULT_COLLECTION_PERCENTILE,Ql.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ql.DISABLED=new Ql(-1,0,0);var $l=function(){function e(t){Se(this,e),this.On=t}return Te(e,[{key:"next",value:function(){return this.On+=2,this.On}}],[{key:"Nn",value:function(){return new e(0)}},{key:"Bn",value:function(){return new e(-1)}}]),e}();var Jl=function(){function e(){Se(this,e),this.changes=new Ju((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return Te(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,ou.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?fs.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}();var eh=Te((function e(t,n){Se(this,e),this.overlayedDocument=t,this.mutatedFields=n})),th=function(){function e(t,n,r,a){Se(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}return Te(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(a){return r=a,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&Pc(r.mutation,e,Rs.empty(),Qo.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,lc()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lc(),a=ic();return this.populateOverlays(e,a,t).next((function(){return n.computeViews(e,t,a,r).next((function(e){var t=rc();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=ic();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,lc())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var a=tc(),i=sc(),o=sc();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof zc)?a=a.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),Pc(o.mutation,t,o.mutation.getFieldMask(),Qo.now())):i.set(t.key,Rs.empty())})),this.recalculateAndSaveOverlays(e,a).next((function(e){return e.forEach((function(e,t){return i.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new eh(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=sc(),a=new Is((function(e,t){return e-t})),i=lc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,i=ye(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var i=t.get(n);if(null!==i){var o=r.get(n)||Rs.empty();o=e.applyToLocalView(i,o),r.set(n,o);var s=(a.get(e.batchId)||lc()).add(n);a=a.insert(e.batchId,s)}}))};for(i.s();!(n=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}})).next((function(){for(var o=[],s=a.getReverseIterator(),u=function(){var a=s.getNext(),u=a.key,c=a.value,l=oc();c.forEach((function(e){if(!i.has(e)){var n=Oc(t.get(e),r.get(e));null!==n&&l.set(e,n),i=i.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return fs.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return rs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var a=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(i){var o=r-i.size>0?a.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):fs.resolve(ic()),s=-1,u=i;return o.next((function(t){return fs.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?fs.resolve():a.remoteDocumentCache.getEntry(e,t).next((function(e){u=u.insert(t,e)}))})).next((function(){return a.populateOverlays(e,t,i)})).next((function(){return a.computeViews(e,u,t,lc())})).next((function(e){return{batchId:s,changes:ac(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new rs(t)).next((function(e){var t=rc();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,a=t.collectionGroup,i=rc();return this.indexManager.getCollectionParents(e,a).next((function(o){return fs.forEach(o,(function(o){var s=function(e,t){return new Pu(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){i=i.insert(e,t)}))}))})).next((function(){return i}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,a=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(i){return r=i,a.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,ou.newInvalidDocument(r)))}));var n=rc();return e.forEach((function(e,a){var i=r.get(e);void 0!==i&&Pc(i.mutation,a,Rs.empty(),Qo.now()),Xu(t,a)&&(n=n.insert(e,a))})),n}))}}]),e}(),nh=function(){function e(t){Se(this,e),this.serializer=t,this.cr=new Map,this.lr=new Map}return Te(e,[{key:"getBundleMetadata",value:function(e,t){return fs.resolve(this.cr.get(t))}},{key:"saveBundleMetadata",value:function(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:kl(e.createTime)}}(t)),fs.resolve()}},{key:"getNamedQuery",value:function(e,t){return fs.resolve(this.lr.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:ql(e.bundledQuery),readTime:kl(e.readTime)}}(t)),fs.resolve()}}]),e}(),rh=function(){function e(){Se(this,e),this.overlays=new Is(rs.comparator),this.hr=new Map}return Te(e,[{key:"getOverlay",value:function(e,t){return fs.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=ic();return fs.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,a){r.It(e,t,a)})),fs.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,a=this.hr.get(n);return void 0!==a&&(a.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.hr.delete(n)),fs.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=ic(),a=t.length+1,i=new rs(t.child("")),o=this.overlays.getIteratorFrom(i);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===a&&s.largestBatchId>n&&r.set(s.getKey(),s)}return fs.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var a=new Is((function(e,t){return e-t})),i=this.overlays.getIterator();i.hasNext();){var o=i.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=a.get(o.largestBatchId);null===s&&(s=ic(),a=a.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=ic(),c=a.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return fs.resolve(u)}},{key:"It",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var a=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Zc(t,n));var i=this.hr.get(t);void 0===i&&(i=lc(),this.hr.set(t,i)),this.hr.set(t,i.add(n.key))}}]),e}(),ah=function(){function e(){Se(this,e),this.Pr=new Es(ih.Ir),this.Tr=new Es(ih.Er)}return Te(e,[{key:"isEmpty",value:function(){return this.Pr.isEmpty()}},{key:"addReference",value:function(e,t){var n=new ih(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}},{key:"dr",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.Ar(new ih(e,t))}},{key:"Rr",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Vr",value:function(e){var t=this,n=new rs(new es([])),r=new ih(n,e),a=new ih(n,e+1),i=[];return this.Tr.forEachInRange([r,a],(function(e){t.Ar(e),i.push(e.key)})),i}},{key:"mr",value:function(){var e=this;this.Pr.forEach((function(t){return e.Ar(t)}))}},{key:"Ar",value:function(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}},{key:"gr",value:function(e){var t=new rs(new es([])),n=new ih(t,e),r=new ih(t,e+1),a=lc();return this.Tr.forEachInRange([n,r],(function(e){a=a.add(e.key)})),a}},{key:"containsKey",value:function(e){var t=new ih(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),ih=function(){function e(t,n){Se(this,e),this.key=t,this.pr=n}return Te(e,null,[{key:"Ir",value:function(e,t){return rs.comparator(e.key,t.key)||Xo(e.pr,t.pr)}},{key:"Er",value:function(e,t){return Xo(e.pr,t.pr)||rs.comparator(e.key,t.key)}}]),e}(),oh=function(){function e(t,n){Se(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Es(ih.Ir)}return Te(e,[{key:"checkEmpty",value:function(e){return fs.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var a=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var i=new Kc(a,t,n,r);this.mutationQueue.push(i);var o,s=ye(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.wr=this.wr.add(new ih(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return fs.resolve(i)}},{key:"lookupMutationBatch",value:function(e,t){return fs.resolve(this.Sr(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.br(n),a=r<0?0:r;return fs.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return fs.resolve(0===this.mutationQueue.length?-1:this.yr-1)}},{key:"getAllMutationBatches",value:function(e){return fs.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new ih(t,0),a=new ih(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,a],(function(e){var t=n.Sr(e.pr);i.push(t)})),fs.resolve(i)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Es(Xo);return t.forEach((function(e){var t=new ih(e,0),a=new ih(e,Number.POSITIVE_INFINITY);n.wr.forEachInRange([t,a],(function(e){r=r.add(e.pr)}))})),fs.resolve(this.Dr(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,a=n;rs.isDocumentKey(a)||(a=a.child(""));var i=new ih(new rs(a),0),o=new Es(Xo);return this.wr.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)}),i),fs.resolve(this.Dr(o))}},{key:"Dr",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Sr(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Po(0===this.vr(t.batchId,"removed")),this.mutationQueue.shift();var r=this.wr;return fs.forEach(t.mutations,(function(a){var i=new ih(a.key,t.batchId);return r=r.delete(i),n.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((function(){n.wr=r}))}},{key:"Mn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new ih(t,0),r=this.wr.firstAfterOrEqual(n);return fs.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,fs.resolve()}},{key:"vr",value:function(e,t){return this.br(e)}},{key:"br",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Sr",value:function(e){var t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),sh=function(){function e(t){Se(this,e),this.Cr=t,this.docs=new Is(rs.comparator),this.size=0}return Te(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return fs.resolve(n?n.document.mutableCopy():ou.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=tc();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ou.newInvalidDocument(e))})),fs.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var a=tc(),i=t.path,o=new rs(i.child("")),s=this.docs.getIteratorFrom(o);s.hasNext();){var u=s.getNext(),c=u.key,l=u.value.document;if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||us(os(l),n)<=0||(r.has(l.key)||Xu(t,l))&&(a=a.insert(l.key,l.mutableCopy()))}return fs.resolve(a)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Do()}},{key:"Fr",value:function(e,t){return fs.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new uh(this)}},{key:"getSize",value:function(e){return fs.resolve(this.size)}}]),e}(),uh=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).ar=e,r}return Te(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,a){a.isValidDocument()?n.push(t.ar.addEntry(e,a)):t.ar.removeEntry(r)})),fs.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.ar.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.ar.getEntries(e,t)}}]),n}(Jl),ch=function(){function e(t){Se(this,e),this.persistence=t,this.Mr=new Ju((function(e){return Au(e)}),Ou),this.lastRemoteSnapshotVersion=$o.min(),this.highestTargetId=0,this.Or=0,this.Nr=new ah,this.targetCount=0,this.Br=$l.Nn()}return Te(e,[{key:"forEachTarget",value:function(e,t){return this.Mr.forEach((function(e,n){return t(n)})),fs.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return fs.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return fs.resolve(this.Or)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Br.next(),fs.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),fs.resolve()}},{key:"qn",value:function(e){this.Mr.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Br=new $l(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.qn(t),this.targetCount+=1,fs.resolve()}},{key:"updateTargetData",value:function(e,t){return this.qn(t),fs.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,fs.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,a=0,i=[];return this.Mr.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Mr.delete(o),i.push(r.removeMatchingKeysForTargetId(e,s.targetId)),a++)})),fs.waitFor(i).next((function(){return a}))}},{key:"getTargetCount",value:function(e){return fs.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Mr.get(t)||null;return fs.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Nr.dr(t,n),fs.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Nr.Rr(t,n);var r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((function(t){a.push(r.markPotentiallyOrphaned(e,t))})),fs.waitFor(a)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Nr.Vr(t),fs.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Nr.gr(t);return fs.resolve(n)}},{key:"containsKey",value:function(e,t){return fs.resolve(this.Nr.containsKey(t))}}]),e}(),lh=function(){function e(t,n){var r=this;Se(this,e),this.Lr={},this.overlays={},this.kr=new ms(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new ch(this),this.indexManager=new Xl,this.remoteDocumentCache=function(e){return new sh(e)}((function(e){return r.referenceDelegate.Kr(e)})),this.serializer=new Kl(n),this.$r=new nh(this.serializer)}return Te(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.qr=!1,Promise.resolve()}},{key:"started",get:function(){return this.qr}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new rh,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Lr[e.toKey()];return n||(n=new oh(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Qr}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.$r}},{key:"runTransaction",value:function(e,t,n){var r=this;No("MemoryPersistence","Starting transaction:",e);var a=new hh(this.kr.next());return this.referenceDelegate.Ur(),n(a).next((function(e){return r.referenceDelegate.Wr(a).next((function(){return e}))})).toPromise().then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Gr",value:function(e,t){return fs.or(Object.values(this.Lr).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),hh=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return Te(n)}(ls),dh=function(){function e(t){Se(this,e),this.persistence=t,this.zr=new ah,this.jr=null}return Te(e,[{key:"Jr",get:function(){if(this.jr)return this.jr;throw Do()}},{key:"addReference",value:function(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),fs.resolve()}},{key:"removeReference",value:function(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),fs.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Jr.add(t.toString()),fs.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.zr.Vr(t.targetId).forEach((function(e){return n.Jr.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Jr.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Ur",value:function(){this.jr=new Set}},{key:"Wr",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fs.forEach(this.Jr,(function(r){var a=rs.fromPath(r);return t.Yr(e,a).next((function(e){e||n.removeEntry(a,$o.min())}))})).next((function(){return t.jr=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Yr(e,t).next((function(e){e?n.Jr.delete(t.toString()):n.Jr.add(t.toString())}))}},{key:"Kr",value:function(e){return 0}},{key:"Yr",value:function(e,t){var n=this;return fs.or([function(){return fs.resolve(n.zr.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Gr(e,t)}])}}],[{key:"Hr",value:function(t){return new e(t)}}]),e}();var fh=function(){function e(t,n,r,a){Se(this,e),this.targetId=t,this.fromCache=n,this.qi=r,this.Qi=a}return Te(e,null,[{key:"Ki",value:function(t,n){var r,a=lc(),i=lc(),o=ye(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:a=a.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,a,i)}}]),e}(),ph=function(){function e(){Se(this,e),this.$i=!1}return Te(e,[{key:"initialize",value:function(e,t){this.Ui=e,this.indexManager=t,this.$i=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var a=this;return this.Wi(e,t).next((function(i){return i||a.Gi(e,t,r,n)})).next((function(n){return n||a.zi(e,t)}))}},{key:"Wi",value:function(e,t){var n=this;if(Fu(t))return fs.resolve(null);var r=Wu(t);return this.indexManager.getIndexType(e,r).next((function(a){return 0===a?null:(null!==t.limit&&1===a&&(t=Hu(t,null,"F"),r=Wu(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(a){var i=lc.apply(void 0,(0,ke.Z)(a));return n.Ui.getDocuments(e,i).next((function(a){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.ji(t,a);return n.Hi(t,o,i,r.readTime)?n.Wi(e,Hu(t,null,"F")):n.Ji(e,o,t,r)}))}))})))}))}},{key:"Gi",value:function(e,t,n,r){var a=this;return Fu(t)||r.isEqual($o.min())?this.zi(e,t):this.Ui.getDocuments(e,n).next((function(i){var o=a.ji(t,i);return a.Hi(t,o,n,r)?a.zi(e,t):(Eo()<=Ze.DEBUG&&No("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zu(t)),a.Ji(e,o,t,is(r,-1)))}))}},{key:"ji",value:function(e,t){var n=new Es(Qu(e));return t.forEach((function(t,r){Xu(e,r)&&(n=n.add(r))})),n}},{key:"Hi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}},{key:"zi",value:function(e,t){return Eo()<=Ze.DEBUG&&No("QueryEngine","Using full collection scan to execute query:",Zu(t)),this.Ui.getDocumentsMatchingQuery(e,t,ss.min())}},{key:"Ji",value:function(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),mh=function(){function e(t,n,r,a){Se(this,e),this.persistence=t,this.Yi=n,this.serializer=a,this.Zi=new Is(Xo),this.Xi=new Ju((function(e){return Au(e)}),Ou),this.es=new Map,this.ts=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this.ns(r)}return Te(e,[{key:"ns",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new th(this.ts,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ts.setIndexManager(this.indexManager),this.Yi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Zi)}))}}]),e}();function vh(e,t,n,r){return new mh(e,t,n,r)}function gh(e,t){return yh.apply(this,arguments)}function yh(){return yh=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Mo(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(a){return t=a,r.ns(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var a,i=[],o=[],s=lc(),u=ye(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;i.push(c.batchId);var l,h=ye(c.mutations);try{for(h.s();!(l=h.n()).done;){var d=l.value;s=s.add(d.key)}}catch(b){h.e(b)}finally{h.f()}}}catch(b){u.e(b)}finally{u.f()}var f,p=ye(n);try{for(p.s();!(f=p.n()).done;){var m=f.value;o.push(m.batchId);var v,g=ye(m.mutations);try{for(g.s();!(v=g.n()).done;){var y=v.value;s=s.add(y.key)}}catch(b){g.e(b)}finally{g.f()}}}catch(b){p.e(b)}finally{p.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{rs:e,removedBatchIds:i,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),yh.apply(this,arguments)}function bh(e,t){var n=Mo(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),a=n.ts.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var a=n.batch,i=a.keys(),o=fs.resolve();return i.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var i=n.docVersions.get(e);Po(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,a)}))}(n,e,t,a).next((function(){return a.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=lc(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function xh(e){var t=Mo(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Qr.getLastRemoteSnapshotVersion(e)}))}function wh(e,t){var n=Mo(e),r=t.snapshotVersion,a=n.Zi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var i=n.ts.newChangeBuffer({trackRemovals:!0});a=n.Zi;var o=[];t.targetChanges.forEach((function(i,s){var u=a.get(s);if(u){o.push(n.Qr.removeMatchingKeys(e,i.removedDocuments,s).next((function(){return n.Qr.addMatchingKeys(e,i.addedDocuments,s)})));var c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?c=c.withResumeToken(Os.EMPTY_BYTE_STRING,$o.min()).withLastLimboFreeSnapshotVersion($o.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,i)&&o.push(n.Qr.updateTargetData(e,c))}}));var s=tc(),u=lc();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(kh(e,i,t.documentUpdates).next((function(e){s=e.ss,u=e.os}))),!r.isEqual($o.min())){var c=n.Qr.getLastRemoteSnapshotVersion(e).next((function(t){return n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return fs.waitFor(o).next((function(){return i.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.Zi=a,e}))}function kh(e,t,n){var r=lc(),a=lc();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=tc();return n.forEach((function(n,i){var o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual($o.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):No("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{ss:r,os:a}}))}function Sh(e,t){var n=Mo(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function Ch(e,t){var n=Mo(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Qr.getTargetData(e,t).next((function(a){return a?(r=a,fs.resolve(r)):n.Qr.allocateTargetId(e).next((function(a){return r=new Hl(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Zi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Zi=n.Zi.insert(e.targetId,e),n.Xi.set(t,e.targetId)),e}))}function Ih(e,t,n){return Th.apply(this,arguments)}function Th(){return Th=N(T().mark((function e(t,n,r){var a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Mo(t),i=a.Zi.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",o,(function(e){return a.persistence.referenceDelegate.removeTarget(e,i)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),ps(e.t1)){e.next=12;break}throw e.t1;case 12:No("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:a.Zi=a.Zi.remove(n),a.Xi.delete(i.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),Th.apply(this,arguments)}function _h(e,t,n){var r=Mo(e),a=$o.min(),i=lc();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Mo(e),a=r.Xi.get(n);return void 0!==a?fs.resolve(r.Zi.get(a)):r.Qr.getTargetData(t,n)}(r,e,Wu(t)).next((function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((function(e){i=e}))})).next((function(){return r.Yi.getDocumentsMatchingQuery(e,t,n?a:$o.min(),n?i:lc())})).next((function(e){return Eh(r,Yu(t),e),{documents:e,_s:i}}))}))}function Eh(e,t,n){var r=e.es.get(t)||$o.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.es.set(t,r)}var Nh=function(){function e(){Se(this,e),this.activeTargetIds=dc()}return Te(e,[{key:"Is",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Ts",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Ps",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),Rh=function(){function e(){Se(this,e),this.Ys=new Nh,this.Zs={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Te(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Ys.Is(e),this.Zs[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Zs[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Ys.Ts(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Ys.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Zs[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Ys.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Ys.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Ys=new Nh,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),Ah=function(){function e(){Se(this,e)}return Te(e,[{key:"Xs",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),Oh=function(){function e(){var t=this;Se(this,e),this.eo=function(){return t.no()},this.ro=function(){return t.io()},this.so=[],this.oo()}return Te(e,[{key:"Xs",value:function(e){this.so.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.eo),window.removeEventListener("offline",this.ro)}},{key:"oo",value:function(){window.addEventListener("online",this.eo),window.addEventListener("offline",this.ro)}},{key:"no",value:function(){No("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=ye(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"io",value:function(){No("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=ye(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"v",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),Dh=null;function Ph(){return null===Dh?Dh=268435456+Math.round(2147483648*Math.random()):Dh++,"0x"+Dh.toString(16)}var Mh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Lh=function(){function e(t){Se(this,e),this._o=t._o,this.ao=t.ao}return Te(e,[{key:"uo",value:function(e){this.co=e}},{key:"lo",value:function(e){this.ho=e}},{key:"onMessage",value:function(e){this.Po=e}},{key:"close",value:function(){this.ao()}},{key:"send",value:function(e){this._o(e)}},{key:"Io",value:function(){this.co()}},{key:"To",value:function(e){this.ho(e)}},{key:"Eo",value:function(e){this.Po(e)}}]),e}(),Fh="WebChannelConnection",zh=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r.longPollingOptions=e.longPollingOptions,r}return Te(n,[{key:"wo",value:function(e,t,n,r){var a=Ph();return new Promise((function(i,o){var s=new wo;s.setWithCredentials(!0),s.listenOnce(go.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case vo.NO_ERROR:var t=s.getResponseJson();No(Fh,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(t)),i(t);break;case vo.TIMEOUT:No(Fh,"RPC '".concat(e,"' ").concat(a," timed out")),o(new Fo(Lo.DEADLINE_EXCEEDED,"Request time out"));break;case vo.HTTP_ERROR:var n=s.getStatus();if(No(Fh,"RPC '".concat(e,"' ").concat(a," failed with status:"),n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var c=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(Lo).indexOf(t)>=0?t:Lo.UNKNOWN}(u.status);o(new Fo(c,u.message))}else o(new Fo(Lo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Fo(Lo.UNAVAILABLE,"Connection failed."));break;default:Do()}}finally{No(Fh,"RPC '".concat(e,"' ").concat(a," completed."))}}));var u=JSON.stringify(r);No(Fh,"RPC '".concat(e,"' ").concat(a," sending request:"),r),s.send(t,"POST",u,n,15)}))}},{key:"bo",value:function(e,t,n){var r=Ph(),a=[this.Ao,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=po(),o=mo(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(s.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(s.useFetchStreams=!0),this.yo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;var c=a.join("");No(Fh,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);var l=i.createWebChannel(c,s),h=!1,d=!1,f=new Lh({_o:function(t){d?No(Fh,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(No(Fh,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),h=!0),No(Fh,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},ao:function(){return l.close()}}),p=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return p(l,xo.EventType.OPEN,(function(){d||No(Fh,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(l,xo.EventType.CLOSE,(function(){d||(d=!0,No(Fh,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.To())})),p(l,xo.EventType.ERROR,(function(t){d||(d=!0,Ao(Fh,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.To(new Fo(Lo.UNAVAILABLE,"The operation could not be completed")))})),p(l,xo.EventType.MESSAGE,(function(t){var n;if(!d){var a=t.data[0];Po(!!a);var i=a,o=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){No(Fh,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);var s=o.status,u=function(e){var t=Wc[e];if(void 0!==t)return Qc(t)}(s),c=o.message;void 0===u&&(u=Lo.INTERNAL,c="Unknown error status: "+s+" with message "+o.message),d=!0,f.To(new Fo(u,c)),l.close()}else No(Fh,"RPC '".concat(e,"' stream ").concat(r," received:"),a),f.Eo(a)}})),p(o,yo.STAT_EVENT,(function(t){t.stat===bo.PROXY?No(Fh,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===bo.NOPROXY&&No(Fh,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){f.Io()}),0),f}}]),n}(function(){function e(t){Se(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Ao=n+"://"+t.host,this.Ro="projects/".concat(r,"/databases/").concat(a),this.Vo="(default)"===this.databaseId.database?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(a)}return Te(e,[{key:"mo",get:function(){return!1}},{key:"fo",value:function(e,t,n,r,a){var i=Ph(),o=this.po(e,t);No("RestConnection","Sending RPC '".concat(e,"' ").concat(i,":"),o,n);var s={"google-cloud-resource-prefix":this.Ro,"x-goog-request-params":this.Vo};return this.yo(s,r,a),this.wo(e,o,s,n).then((function(t){return No("RestConnection","Received RPC '".concat(e,"' ").concat(i,": "),t),t}),(function(t){throw Ao("RestConnection","RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",o,"request:",n),t}))}},{key:"So",value:function(e,t,n,r,a,i){return this.fo(e,t,n,r,a)}},{key:"yo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+To,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"po",value:function(e,t){var n=Mh[e];return"".concat(this.Ao,"/v1/").concat(t,":").concat(n)}}]),e}());function Bh(){return"undefined"!=typeof document?document:null}function Vh(e){return new gl(e,!0)}var Uh=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;Se(this,e),this.oi=t,this.timerId=n,this.Do=r,this.vo=a,this.Co=i,this.Fo=0,this.Mo=null,this.xo=Date.now(),this.reset()}return Te(e,[{key:"reset",value:function(){this.Fo=0}},{key:"Oo",value:function(){this.Fo=this.Co}},{key:"No",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Fo+this.Bo()),r=Math.max(0,Date.now()-this.xo),a=Math.max(0,n-r);a>0&&No("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.Fo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Mo=this.oi.enqueueAfterDelay(this.timerId,a,(function(){return t.xo=Date.now(),e()})),this.Fo*=this.vo,this.Fo<this.Do&&(this.Fo=this.Do),this.Fo>this.Co&&(this.Fo=this.Co)}},{key:"Lo",value:function(){null!==this.Mo&&(this.Mo.skipDelay(),this.Mo=null)}},{key:"cancel",value:function(){null!==this.Mo&&(this.Mo.cancel(),this.Mo=null)}},{key:"Bo",value:function(){return(Math.random()-.5)*this.Fo}}]),e}(),Wh=function(){function e(t,n,r,a,i,o,s,u){Se(this,e),this.oi=t,this.ko=r,this.qo=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Qo=0,this.Ko=null,this.$o=null,this.stream=null,this.Uo=new Uh(t,n)}return Te(e,[{key:"Wo",value:function(){return 1===this.state||5===this.state||this.Go()}},{key:"Go",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.zo()}},{key:"stop",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Wo(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jo",value:function(){this.state=0,this.Uo.reset()}},{key:"Ho",value:function(){var e=this;this.Go()&&null===this.Ko&&(this.Ko=this.oi.enqueueAfterDelay(this.ko,6e4,(function(){return e.Jo()})))}},{key:"Yo",value:function(e){this.Zo(),this.stream.send(e)}},{key:"Jo",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Go()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Zo",value:function(){this.Ko&&(this.Ko.cancel(),this.Ko=null)}},{key:"Xo",value:function(){this.$o&&(this.$o.cancel(),this.$o=null)}},{key:"close",value:function(){var e=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Zo(),this.Xo(),this.Uo.cancel(),this.Qo++,4!==t?this.Uo.reset():n&&n.code===Lo.RESOURCE_EXHAUSTED?(Ro(n.toString()),Ro("Using maximum backoff delay to prevent overloading the backend."),this.Uo.Oo()):n&&n.code===Lo.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.e_(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.lo(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"e_",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.t_(this.Qo),n=this.Qo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=(0,U.Z)(t,2),a=r[0],i=r[1];e.Qo===n&&e.n_(a,i)}),(function(n){t((function(){var t=new Fo(Lo.UNKNOWN,"Fetching auth token failed: "+n.message);return e.r_(t)}))}))}},{key:"n_",value:function(e,t){var n=this,r=this.t_(this.Qo);this.stream=this.i_(e,t),this.stream.uo((function(){r((function(){return n.state=2,n.$o=n.oi.enqueueAfterDelay(n.qo,1e4,(function(){return n.Go()&&(n.state=3),Promise.resolve()})),n.listener.uo()}))})),this.stream.lo((function(e){r((function(){return n.r_(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"zo",value:function(){var e=this;this.state=5,this.Uo.No(N(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"r_",value:function(e){return No("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"t_",value:function(e){var t=this;return function(n){t.oi.enqueueAndForget((function(){return t.Qo===e?n():(No("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),jh=function(e){be(n,e);var t=we(n);function n(e,r,a,i,o,s){var u;return Se(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,a,i,s)).serializer=o,u}return Te(n,[{key:"i_",value:function(e,t){return this.connection.bo("Listen",e,t)}},{key:"onMessage",value:function(e){this.Uo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Do()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(Po(void 0===t||"string"==typeof t),Os.fromBase64String(t||"")):(Po(void 0===t||t instanceof Uint8Array),Os.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?Lo.UNKNOWN:Qc(e.code);return new Fo(t,e.message||"")}(o);n=new cl(r,a,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var c=Tl(e,u.document.name),l=kl(u.document.updateTime),h=u.document.createTime?kl(u.document.createTime):$o.min(),d=new au({mapValue:{fields:u.document.fields}}),f=ou.newFoundDocument(c,l,h,d),p=u.targetIds||[],m=u.removedTargetIds||[];n=new sl(p,m,f.key,f)}else if("documentDelete"in t){t.documentDelete;var v=t.documentDelete;v.document;var g=Tl(e,v.document),y=v.readTime?kl(v.readTime):$o.min(),b=ou.newNoDocument(g,y),x=v.removedTargetIds||[];n=new sl([],x,b.key,b)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var k=Tl(e,w.document),S=w.removedTargetIds||[];n=new sl([],S,k,null)}else{if(!("filter"in t))return Do();t.filter;var C=t.filter;C.targetId;var I=C.count,T=void 0===I?0:I,_=C.unchangedNames,E=new Xc(T,_),N=C.targetId;n=new ul(N,E)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return $o.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?$o.min():t.readTime?kl(t.readTime):$o.min()}(e);return this.listener.s_(t,n)}},{key:"o_",value:function(e){var t={};t.database=Nl(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=Du(r)?{documents:Dl(e,r)}:{query:Pl(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=xl(e,t.resumeToken);var a=yl(e,t.expectedCount);null!==a&&(n.expectedCount=a)}else if(t.snapshotVersion.compareTo($o.min())>0){n.readTime=bl(e,t.snapshotVersion.toTimestamp());var i=yl(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);var n=function(e,t){var n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Do()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Yo(t)}},{key:"__",value:function(e){var t={};t.database=Nl(this.serializer),t.removeTarget=e,this.Yo(t)}}]),n}(Wh),Gh=function(e){be(n,e);var t=we(n);function n(e,r,a,i,o,s){var u;return Se(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,a,i,s)).serializer=o,u.a_=!1,u}return Te(n,[{key:"u_",get:function(){return this.a_}},{key:"start",value:function(){this.a_=!1,this.lastStreamToken=void 0,me(pe(n.prototype),"start",this).call(this)}},{key:"e_",value:function(){this.a_&&this.c_([])}},{key:"i_",value:function(e,t){return this.connection.bo("Write",e,t)}},{key:"onMessage",value:function(e){if(Po(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_){this.Uo.reset();var t=function(e,t){return e&&e.length>0?(Po(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?kl(e.updateTime):kl(t);return n.isEqual($o.min())&&(n=kl(t)),new Ec(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=kl(e.commitTime);return this.listener.l_(n,t)}return Po(!e.writeResults||0===e.writeResults.length),this.a_=!0,this.listener.h_()}},{key:"P_",value:function(){var e={};e.database=Nl(this.serializer),this.Yo(e)}},{key:"c_",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Ol(t.serializer,e)}))};this.Yo(n)}}]),n}(Wh),Hh=function(e){be(n,e);var t=we(n);function n(e,r,a,i){var o;return Se(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=a,o.serializer=i,o.I_=!1,o}return Te(n,[{key:"T_",value:function(){if(this.I_)throw new Fo(Lo.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"fo",value:function(e,t,n){var r=this;return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var i=(0,U.Z)(a,2),o=i[0],s=i[1];return r.connection.fo(e,t,n,o,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Lo.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Fo(Lo.UNKNOWN,e.toString())}))}},{key:"So",value:function(e,t,n,r){var a=this;return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var o=(0,U.Z)(i,2),s=o[0],u=o[1];return a.connection.So(e,t,n,s,u,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Lo.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new Fo(Lo.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.I_=!0}}]),n}(Te((function e(){Se(this,e)})));var Kh=function(){function e(t,n){Se(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.d_=0,this.A_=null,this.R_=!0}return Te(e,[{key:"V_",value:function(){var e=this;0===this.d_&&(this.m_("Unknown"),this.A_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.A_=null,e.f_("Backend didn't respond within 10 seconds."),e.m_("Offline"),Promise.resolve()})))}},{key:"g_",value:function(e){"Online"===this.state?this.m_("Unknown"):(this.d_++,this.d_>=1&&(this.p_(),this.f_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.m_("Offline")))}},{key:"set",value:function(e){this.p_(),this.d_=0,"Online"===e&&(this.R_=!1),this.m_(e)}},{key:"m_",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"f_",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.R_?(Ro(t),this.R_=!1):No("OnlineStateTracker",t)}},{key:"p_",value:function(){null!==this.A_&&(this.A_.cancel(),this.A_=null)}}]),e}(),qh=Te((function e(t,n,r,a,i){var o=this;Se(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.y_=[],this.w_=new Map,this.S_=new Set,this.b_=[],this.D_=i,this.D_.Xs((function(e){r.enqueueAndForget(N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=ad(o),!e.t0){e.next=5;break}return No("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=N(T().mark((function e(t){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Mo(t)).S_.add(4),e.next=4,Yh(n);case 4:return n.v_.set("Unknown"),n.S_.delete(4),e.next=8,Zh(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this.v_=new Kh(r,a)}));function Zh(e){return Xh.apply(this,arguments)}function Xh(){return(Xh=N(T().mark((function e(t){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ad(t)){e.next=18;break}n=ye(t.b_),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))).apply(this,arguments)}function Yh(e){return Qh.apply(this,arguments)}function Qh(){return(Qh=N(T().mark((function e(t){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ye(t.b_),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}function $h(e,t){var n=Mo(e);n.w_.has(t.targetId)||(n.w_.set(t.targetId,t),rd(n)?nd(n):Dd(n).Go()&&ed(n,t))}function Jh(e,t){var n=Mo(e),r=Dd(n);n.w_.delete(t),r.Go()&&td(n,t),0===n.w_.size&&(r.Go()?r.Ho():ad(n)&&n.v_.set("Unknown"))}function ed(e,t){if(e.C_.Le(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo($o.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Dd(e).o_(t)}function td(e,t){e.C_.Le(t),Dd(e).__(t)}function nd(e){e.C_=new hl({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.w_.get(t)||null},st:function(){return e.datastore.serializer.databaseId}}),Dd(e).start(),e.v_.V_()}function rd(e){return ad(e)&&!Dd(e).Wo()&&e.w_.size>0}function ad(e){return 0===Mo(e).S_.size}function id(e){e.C_=void 0}function od(e){return sd.apply(this,arguments)}function sd(){return(sd=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.w_.forEach((function(e,n){ed(t,e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ud(e,t){return cd.apply(this,arguments)}function cd(){return(cd=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:id(t),rd(t)?(t.v_.g_(n),nd(t)):t.v_.set("Unknown");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ld(e,t,n){return hd.apply(this,arguments)}function hd(){return hd=N(T().mark((function e(t,n,r){var a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.v_.set("Online"),!(n instanceof cl&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=N(T().mark((function e(t,n){var r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,a=ye(n.targetIds),e.prev=2,a.s();case 4:if((i=a.n()).done){e.next=14;break}if(o=i.value,e.t0=t.w_.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.w_.delete(o),t.C_.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),a.e(e.t1);case 19:return e.prev=19,a.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),No("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,dd(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof sl?t.C_.Ge(n):n instanceof ul?t.C_.Xe(n):t.C_.He(n),r.isEqual($o.min())){e.next=29;break}return e.prev=14,e.next=17,xh(t.localStore);case 17:if(a=e.sent,e.t1=r.compareTo(a)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.C_._t(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var a=e.w_.get(r);a&&e.w_.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t,n){var r=e.w_.get(t);if(r){e.w_.set(t,r.withResumeToken(Os.EMPTY_BYTE_STRING,r.snapshotVersion)),td(e,t);var a=new Hl(r.target,t,n,r.sequenceNumber);ed(e,a)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),No("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,dd(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),hd.apply(this,arguments)}function dd(e,t,n){return fd.apply(this,arguments)}function fd(){return(fd=N(T().mark((function e(t,n,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ps(n)){e.next=2;break}throw n;case 2:return t.S_.add(1),e.next=5,Yh(t);case 5:t.v_.set("Offline"),r||(r=function(){return xh(t.localStore)}),t.asyncQueue.enqueueRetryable(N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return No("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.S_.delete(1),e.next=6,Zh(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pd(e,t){return t().catch((function(n){return dd(e,n,t)}))}function md(e){return vd.apply(this,arguments)}function vd(){return vd=N(T().mark((function e(t){var n,r,a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Mo(t),r=Pd(n),a=n.y_.length>0?n.y_[n.y_.length-1].batchId:-1;case 2:if(!gd(n)){e.next=19;break}return e.prev=3,e.next=6,Sh(n.localStore,a);case 6:if(null!==(i=e.sent)){e.next=10;break}return 0===n.y_.length&&r.Ho(),e.abrupt("break",19);case 10:a=i.batchId,yd(n,i),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,dd(n,e.t0);case 17:e.next=2;break;case 19:bd(n)&&xd(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),vd.apply(this,arguments)}function gd(e){return ad(e)&&e.y_.length<10}function yd(e,t){e.y_.push(t);var n=Pd(e);n.Go()&&n.u_&&n.c_(t.mutations)}function bd(e){return ad(e)&&!Pd(e).Wo()&&e.y_.length>0}function xd(e){Pd(e).start()}function wd(e){return kd.apply(this,arguments)}function kd(){return(kd=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Pd(t).P_();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sd(e){return Cd.apply(this,arguments)}function Cd(){return(Cd=N(T().mark((function e(t){var n,r,a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Pd(t),r=ye(t.y_);try{for(r.s();!(a=r.n()).done;)i=a.value,n.c_(i.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Id(e,t,n){return Td.apply(this,arguments)}function Td(){return Td=N(T().mark((function e(t,n,r){var a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.y_.shift(),i=qc.from(a,n,r),e.next=3,pd(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}));case 3:return e.next=5,md(t);case 5:case"end":return e.stop()}}),e)}))),Td.apply(this,arguments)}function _d(e,t){return Ed.apply(this,arguments)}function Ed(){return Ed=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&Pd(t).u_,!e.t0){e.next=4;break}return e.next=4,function(){var e=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!function(e){return Yc(e)&&e!==Lo.ABORTED}(n.code)){e.next=7;break}return r=t.y_.shift(),Pd(t).jo(),e.next=5,pd(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,md(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:bd(t)&&xd(t);case 5:case"end":return e.stop()}}),e)}))),Ed.apply(this,arguments)}function Nd(e,t){return Rd.apply(this,arguments)}function Rd(){return Rd=N(T().mark((function e(t,n){var r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Mo(t)).asyncQueue.verifyOperationInProgress(),No("RemoteStore","RemoteStore received new credentials"),a=ad(r),r.S_.add(3),e.next=6,Yh(r);case 6:return a&&r.v_.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.S_.delete(3),e.next=12,Zh(r);case 12:case"end":return e.stop()}}),e)}))),Rd.apply(this,arguments)}function Ad(e,t){return Od.apply(this,arguments)}function Od(){return(Od=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Mo(t),!n){e.next=7;break}return r.S_.delete(2),e.next=5,Zh(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.S_.add(2),e.next=12,Yh(r);case 12:r.v_.set("Unknown");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dd(e){return e.F_||(e.F_=function(e,t,n){var r=Mo(e);return r.T_(),new jh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:od.bind(null,e),lo:ud.bind(null,e),s_:ld.bind(null,e)}),e.b_.push(function(){var t=N(T().mark((function t(n){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.F_.jo(),rd(e)?nd(e):e.v_.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.F_.stop();case 6:id(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.F_}function Pd(e){return e.M_||(e.M_=function(e,t,n){var r=Mo(e);return r.T_(),new Gh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:wd.bind(null,e),lo:_d.bind(null,e),h_:Sd.bind(null,e),l_:Id.bind(null,e)}),e.b_.push(function(){var t=N(T().mark((function t(n){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.M_.jo(),t.next=4,md(e);case 4:t.next=9;break;case 6:return t.next=8,e.M_.stop();case 8:e.y_.length>0&&(No("RemoteStore","Stopping write stream with ".concat(e.y_.length," pending writes")),e.y_=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.M_}var Md=function(){function e(t,n,r,a,i){Se(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new zo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return Te(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Fo(Lo.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,a,i){var o=new e(t,n,Date.now()+r,a,i);return o.start(r),o}}]),e}();function Ld(e,t){if(Ro("AsyncQueue","".concat(t,": ").concat(e)),ps(e))return new Fo(Lo.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var Fd=function(){function e(t){Se(this,e),this.comparator=t?function(e,n){return t(e,n)||rs.comparator(e.key,n.key)}:function(e,t){return rs.comparator(e.key,t.key)},this.keyedMap=rc(),this.sortedSet=new Is(this.comparator)}return Te(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),zd=function(){function e(){Se(this,e),this.x_=new Is(rs.comparator)}return Te(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.x_.get(t);n?0!==e.type&&3===n.type?this.x_=this.x_.insert(t,e):3===e.type&&1!==n.type?this.x_=this.x_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.x_=this.x_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.x_=this.x_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.x_=this.x_.remove(t):1===e.type&&2===n.type?this.x_=this.x_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.x_=this.x_.insert(t,{type:2,doc:e.doc}):Do():this.x_=this.x_.insert(t,e)}},{key:"O_",value:function(){var e=[];return this.x_.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),Bd=function(){function e(t,n,r,a,i,o,s,u,c){Se(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=c}return Te(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ku(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,a,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Fd.emptySet(n),o,r,a,!0,!1,i)}}]),e}(),Vd=Te((function e(){Se(this,e),this.N_=void 0,this.listeners=[]})),Ud=Te((function e(){Se(this,e),this.queries=new Ju((function(e){return qu(e)}),Ku),this.onlineState="Unknown",this.B_=new Set}));function Wd(e,t){return jd.apply(this,arguments)}function jd(){return jd=N(T().mark((function e(t,n){var r,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Mo(t),a=n.query,i=!1,(o=r.queries.get(a))||(i=!0,o=new Vd),!i){e.next=13;break}return e.prev=3,e.next=6,r.onListen(a);case 6:o.N_=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=Ld(e.t0,"Initialization of query '".concat(Zu(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(a,o),o.listeners.push(n),n.L_(r.onlineState),o.N_&&n.k_(o.N_)&&Zd(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),jd.apply(this,arguments)}function Gd(e,t){return Hd.apply(this,arguments)}function Hd(){return Hd=N(T().mark((function e(t,n){var r,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Mo(t),a=n.query,i=!1,(o=r.queries.get(a))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),!i){e.next=6;break}return e.abrupt("return",(r.queries.delete(a),r.onUnlisten(a)));case 6:case"end":return e.stop()}}),e)}))),Hd.apply(this,arguments)}function Kd(e,t){var n,r=Mo(e),a=!1,i=ye(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=o.query,u=r.queries.get(s);if(u){var c,l=ye(u.listeners);try{for(l.s();!(c=l.n()).done;){c.value.k_(o)&&(a=!0)}}catch(h){l.e(h)}finally{l.f()}u.N_=o}}}catch(h){i.e(h)}finally{i.f()}a&&Zd(r)}function qd(e,t,n){var r=Mo(e),a=r.queries.get(t);if(a){var i,o=ye(a.listeners);try{for(o.s();!(i=o.n()).done;){i.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function Zd(e){e.B_.forEach((function(e){e.next()}))}var Xd=function(){function e(t,n,r){Se(this,e),this.query=t,this.q_=n,this.Q_=!1,this.K_=null,this.onlineState="Unknown",this.options=r||{}}return Te(e,[{key:"k_",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=ye(e.docChanges);try{for(r.s();!(t=r.n()).done;){var a=t.value;3!==a.type&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}e=new Bd(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var i=!1;return this.Q_?this.U_(e)&&(this.q_.next(e),i=!0):this.W_(e,this.onlineState)&&(this.G_(e),i=!0),this.K_=e,i}},{key:"onError",value:function(e){this.q_.error(e)}},{key:"L_",value:function(e){this.onlineState=e;var t=!1;return this.K_&&!this.Q_&&this.W_(this.K_,e)&&(this.G_(this.K_),t=!0),t}},{key:"W_",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.z_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"U_",value:function(e){if(e.docChanges.length>0)return!0;var t=this.K_&&this.K_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"G_",value:function(e){e=Bd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Q_=!0,this.q_.next(e)}}]),e}();var Yd=Te((function e(t){Se(this,e),this.key=t})),Qd=Te((function e(t){Se(this,e),this.key=t})),$d=function(){function e(t,n){Se(this,e),this.query=t,this.ta=n,this.na=null,this.hasCachedResults=!1,this.current=!1,this.ra=lc(),this.mutatedKeys=lc(),this.ia=Qu(t),this.sa=new Fd(this.ia)}return Te(e,[{key:"oa",get:function(){return this.ta}},{key:"_a",value:function(e,t){var n=this,r=t?t.aa:new zd,a=t?t.sa:this.sa,i=t?t.mutatedKeys:this.mutatedKeys,o=a,s=!1,u="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,c="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((function(e,t){var l=a.get(e),h=Xu(n.query,t)?t:null,d=!!l&&n.mutatedKeys.has(l.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?d!==f&&(r.track({type:3,doc:h}),p=!0):n.ua(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.ia(h,u)>0||c&&n.ia(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(o=o.add(h),i=f?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{sa:o,aa:r,Hi:s,mutatedKeys:i}}},{key:"ua",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,a=this.sa;this.sa=e.sa,this.mutatedKeys=e.mutatedKeys;var i=e.aa.O_();i.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Do()}};return n(e)-n(t)}(e.type,t.type)||r.ia(e.doc,t.doc)})),this.ca(n);var o=t?this.la():[],s=0===this.ra.size&&this.current?1:0,u=s!==this.na;return this.na=s,0!==i.length||u?{snapshot:new Bd(this.query,e.sa,a,i,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),ha:o}:{ha:o}}},{key:"L_",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({sa:this.sa,aa:new zd,mutatedKeys:this.mutatedKeys,Hi:!1},!1)):{ha:[]}}},{key:"Pa",value:function(e){return!this.ta.has(e)&&!!this.sa.has(e)&&!this.sa.get(e).hasLocalMutations}},{key:"ca",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.ta=t.ta.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.ta=t.ta.delete(e)})),this.current=e.current)}},{key:"la",value:function(){var e=this;if(!this.current)return[];var t=this.ra;this.ra=lc(),this.sa.forEach((function(t){e.Pa(t.key)&&(e.ra=e.ra.add(t.key))}));var n=[];return t.forEach((function(t){e.ra.has(t)||n.push(new Qd(t))})),this.ra.forEach((function(e){t.has(e)||n.push(new Yd(e))})),n}},{key:"Ia",value:function(e){this.ta=e._s,this.ra=lc();var t=this._a(e.documents);return this.applyChanges(t,!0)}},{key:"Ta",value:function(){return Bd.fromInitialDocuments(this.query,this.sa,this.mutatedKeys,0===this.na,this.hasCachedResults)}}]),e}(),Jd=Te((function e(t,n,r){Se(this,e),this.query=t,this.targetId=n,this.view=r})),ef=Te((function e(t){Se(this,e),this.key=t,this.Ea=!1})),tf=function(){function e(t,n,r,a,i,o){Se(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.da={},this.Aa=new Ju((function(e){return qu(e)}),Ku),this.Ra=new Map,this.Va=new Set,this.ma=new Is(rs.comparator),this.fa=new Map,this.ga=new ah,this.pa={},this.ya=new Map,this.wa=$l.Bn(),this.onlineState="Unknown",this.Sa=void 0}return Te(e,[{key:"isPrimaryClient",get:function(){return!0===this.Sa}}]),e}();function nf(e,t){return rf.apply(this,arguments)}function rf(){return rf=N(T().mark((function e(t,n){var r,a,i,o,s,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Of(t),!(o=r.Aa.get(n))){e.next=6;break}a=o.targetId,r.sharedClientState.addLocalQueryTarget(a),i=o.view.Ta(),e.next=15;break;case 6:return e.next=8,Ch(r.localStore,Wu(n));case 8:return s=e.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.targetId,e.next=13,af(r,n,a,"current"===u,s.resumeToken);case 13:i=e.sent,r.isPrimaryClient&&$h(r.remoteStore,s);case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)}))),rf.apply(this,arguments)}function af(e,t,n,r,a){return of.apply(this,arguments)}function of(){return of=N(T().mark((function e(t,n,r,a,i){var o,s,u,c,l,h;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ba=function(e,n,r){return function(){var e=N(T().mark((function e(t,n,r,a){var i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.view._a(r),e.t0=i.Hi,!e.t0){e.next=6;break}return e.next=5,_h(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view._a(t,i)}));case 5:i=e.sent;case 6:return o=a&&a.targetChanges.get(n.targetId),s=n.view.applyChanges(i,t.isPrimaryClient,o),e.abrupt("return",(Cf(t,n.targetId,s.ha),s.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,_h(t.localStore,n,!0);case 3:return o=e.sent,s=new $d(n,o._s),u=s._a(o.documents),c=ol.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==t.onlineState,i),l=s.applyChanges(u,t.isPrimaryClient,c),Cf(t,r,l.ha),h=new Jd(n,r,s),e.abrupt("return",(t.Aa.set(n,h),t.Ra.has(r)?t.Ra.get(r).push(n):t.Ra.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}}),e)}))),of.apply(this,arguments)}function sf(e,t){return uf.apply(this,arguments)}function uf(){return uf=N(T().mark((function e(t,n){var r,a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Mo(t),a=r.Aa.get(n),!((i=r.Ra.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.Ra.set(a.targetId,i.filter((function(e){return!Ku(e,n)}))),void r.Aa.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,Ih(r.localStore,a.targetId,!1).then((function(){r.sharedClientState.clearQueryState(a.targetId),Jh(r.remoteStore,a.targetId),kf(r,a.targetId)})).catch(hs);case 9:e.next=14;break;case 11:return kf(r,a.targetId),e.next=14,Ih(r.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),uf.apply(this,arguments)}function cf(e,t,n){return lf.apply(this,arguments)}function lf(){return lf=N(T().mark((function e(t,n,r){var a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Df(t),e.prev=1,e.next=4,function(e,t){var n,r,a=Mo(e),i=Qo.now(),o=t.reduce((function(e,t){return e.add(t.key)}),lc());return a.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=tc(),u=lc();return a.ts.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return a.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],u=ye(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Mc(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new zc(c.key,l,iu(l.value.mapValue),Nc.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return a.mutationQueue.addMutationBatch(e,i,s,t)})).next((function(t){r=t;var i=t.applyToLocalDocumentSet(n,u);return a.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((function(){return{batchId:r.batchId,changes:ac(n)}}))}(a.localStore,n);case 4:return i=e.sent,a.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.pa[e.currentUser.toKey()];r||(r=new Is(Xo)),r=r.insert(t,n),e.pa[e.currentUser.toKey()]=r}(a,i.batchId,r),e.next=9,_f(a,i.changes);case 9:return e.next=11,md(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=Ld(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),lf.apply(this,arguments)}function hf(e,t){return df.apply(this,arguments)}function df(){return df=N(T().mark((function e(t,n){var r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Mo(t),e.prev=1,e.next=4,wh(r.localStore,n);case 4:return a=e.sent,n.targetChanges.forEach((function(e,t){var n=r.fa.get(t);n&&(Po(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Ea=!0:e.modifiedDocuments.size>0?Po(n.Ea):e.removedDocuments.size>0&&(Po(n.Ea),n.Ea=!1))})),e.next=8,_f(r,a,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,hs(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),df.apply(this,arguments)}function ff(e,t,n){var r=Mo(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var a=[];r.Aa.forEach((function(e,n){var r=n.view.L_(t);r.snapshot&&a.push(r.snapshot)})),function(e,t){var n=Mo(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var a,i=ye(n.listeners);try{for(i.s();!(a=i.n()).done;){a.value.L_(t)&&(r=!0)}}catch(o){i.e(o)}finally{i.f()}})),r&&Zd(n)}(r.eventManager,t),a.length&&r.da.s_(a),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function pf(e,t,n){return mf.apply(this,arguments)}function mf(){return mf=N(T().mark((function e(t,n,r){var a,i,o,s,u,c;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=Mo(t)).sharedClientState.updateQueryState(n,"rejected",r),i=a.fa.get(n),!(o=i&&i.key)){e.next=14;break}return s=(s=new Is(rs.comparator)).insert(o,ou.newNoDocument(o,$o.min())),u=lc().add(o),c=new il($o.min(),new Map,new Is(Xo),s,u),e.next=9,hf(a,c);case 9:a.ma=a.ma.remove(o),a.fa.delete(n),Tf(a),e.next=16;break;case 14:return e.next=16,Ih(a.localStore,n,!1).then((function(){return kf(a,n,r)})).catch(hs);case 16:case"end":return e.stop()}}),e)}))),mf.apply(this,arguments)}function vf(e,t){return gf.apply(this,arguments)}function gf(){return gf=N(T().mark((function e(t,n){var r,a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Mo(t),a=n.batch.batchId,e.prev=1,e.next=4,bh(r.localStore,n);case 4:return i=e.sent,wf(r,a,null),xf(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,_f(r,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,hs(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),gf.apply(this,arguments)}function yf(e,t,n){return bf.apply(this,arguments)}function bf(){return bf=N(T().mark((function e(t,n,r){var a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Mo(t),e.prev=1,e.next=4,function(e,t){var n=Mo(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Po(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,n);case 4:return i=e.sent,wf(a,n,r),xf(a,n),a.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,_f(a,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,hs(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),bf.apply(this,arguments)}function xf(e,t){(e.ya.get(t)||[]).forEach((function(e){e.resolve()})),e.ya.delete(t)}function wf(e,t,n){var r=Mo(e),a=r.pa[r.currentUser.toKey()];if(a){var i=a.get(t);i&&(n?i.reject(n):i.resolve(),a=a.remove(t)),r.pa[r.currentUser.toKey()]=a}}function kf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,a=ye(e.Ra.get(t));try{for(a.s();!(r=a.n()).done;){var i=r.value;e.Aa.delete(i),n&&e.da.Da(i,n)}}catch(o){a.e(o)}finally{a.f()}e.Ra.delete(t),e.isPrimaryClient&&e.ga.Vr(t).forEach((function(t){e.ga.containsKey(t)||Sf(e,t)}))}function Sf(e,t){e.Va.delete(t.path.canonicalString());var n=e.ma.get(t);null!==n&&(Jh(e.remoteStore,n),e.ma=e.ma.remove(t),e.fa.delete(n),Tf(e))}function Cf(e,t,n){var r,a=ye(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;i instanceof Yd?(e.ga.addReference(i.key,t),If(e,i)):i instanceof Qd?(No("SyncEngine","Document no longer in limbo: "+i.key),e.ga.removeReference(i.key,t),e.ga.containsKey(i.key)||Sf(e,i.key)):Do()}}catch(o){a.e(o)}finally{a.f()}}function If(e,t){var n=t.key,r=n.path.canonicalString();e.ma.get(n)||e.Va.has(r)||(No("SyncEngine","New document in limbo: "+n),e.Va.add(r),Tf(e))}function Tf(e){for(;e.Va.size>0&&e.ma.size<e.maxConcurrentLimboResolutions;){var t=e.Va.values().next().value;e.Va.delete(t);var n=new rs(es.fromString(t)),r=e.wa.next();e.fa.set(r,new ef(n)),e.ma=e.ma.insert(n,r),$h(e.remoteStore,new Hl(Wu(Lu(n.path)),r,"TargetPurposeLimboResolution",ms.ae))}}function _f(e,t,n){return Ef.apply(this,arguments)}function Ef(){return Ef=N(T().mark((function e(t,n,r){var a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Mo(t),i=[],o=[],s=[],e.t0=a.Aa.isEmpty(),e.t0){e.next=9;break}return a.Aa.forEach((function(e,t){s.push(a.ba(t,n,r).then((function(e){if((e||r)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);var n=fh.Ki(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(s);case 6:return a.da.s_(i),e.next=9,function(){var e=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Mo(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return fs.forEach(n,(function(t){return fs.forEach(t.qi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return fs.forEach(t.Qi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),ps(e.t0)){e.next=10;break}throw e.t0;case 10:No("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:a=ye(n);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.targetId,o.fromCache||(u=r.Zi.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),r.Zi=r.Zi.insert(s,l))}catch(h){a.e(h)}finally{a.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(a.localStore,o);case 9:case"end":return e.stop()}}),e)}))),Ef.apply(this,arguments)}function Nf(e,t){return Rf.apply(this,arguments)}function Rf(){return(Rf=N(T().mark((function e(t,n){var r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Mo(t)).currentUser.isEqual(n)){e.next=11;break}return No("SyncEngine","User change. New user:",n.toKey()),e.next=5,gh(r.localStore,n);case 5:return a=e.sent,r.currentUser=n,function(e,t){e.ya.forEach((function(e){e.forEach((function(e){e.reject(new Fo(Lo.CANCELLED,t))}))})),e.ya.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),e.next=11,_f(r,a.rs);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Af(e,t){var n=Mo(e),r=n.fa.get(t);if(r&&r.Ea)return lc().add(r.key);var a=lc(),i=n.Ra.get(t);if(!i)return a;var o,s=ye(i);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.Aa.get(u);a=a.unionWith(c.view.oa)}}catch(l){s.e(l)}finally{s.f()}return a}function Of(e){var t=Mo(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=hf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Af.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=pf.bind(null,t),t.da.s_=Kd.bind(null,t.eventManager),t.da.Da=qd.bind(null,t.eventManager),t}function Df(e){var t=Mo(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=vf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yf.bind(null,t),t}var Pf=function(){function e(){Se(this,e),this.synchronizeTabs=!1}return Te(e,[{key:"initialize",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.serializer=Vh(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),e.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return vh(this.persistence,new ph,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new lh(dh.Hr,this.serializer)}},{key:"createSharedClientState",value:function(e){return new Rh}},{key:"terminate",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Mf=function(){function e(){Se(this,e)}return Te(e,[{key:"initialize",value:function(){var e=N(T().mark((function e(t,n){var r=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return ff(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Nf.bind(null,this.syncEngine),e.next=12,Ad(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new Ud}},{key:"createDatastore",value:function(e){var t=Vh(e.databaseInfo.databaseId),n=function(e){return new zh(e)}(e.databaseInfo);return function(e,t,n,r){return new Hh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t=this;return function(e,t,n,r,a){return new qh(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,(function(e){return ff(t.syncEngine,e,0)}),Oh.v()?new Oh:new Ah)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,a,i,o){var s=new tf(e,t,n,r,a,i);return o&&(s.Sa=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=N(T().mark((function e(t){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Mo(t),No("RemoteStore","RemoteStore shutting down."),n.S_.add(5),e.next=5,Yh(n);case 5:n.D_.shutdown(),n.v_.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();var Lf=function(){function e(t){Se(this,e),this.observer=t,this.muted=!1}return Te(e,[{key:"next",value:function(e){this.observer.next&&this.Fa(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Fa(this.observer.error,e):Ro("Uncaught Error in snapshot listener:",e.toString())}},{key:"Ma",value:function(){this.muted=!0}},{key:"Fa",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),Ff=function(){function e(t,n,r,a){var i=this;Se(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=Io.UNAUTHENTICATED,this.clientId=Zo.V(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return No("FirestoreClient","Received user=",t.uid),e.next=3,i.authCredentialListener(t);case 3:i.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return No("FirestoreClient","Received new app check token=",e),i.appCheckCredentialListener(e,i.user)}))}return Te(e,[{key:"getConfiguration",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Fo(Lo.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new zo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(N(T().mark((function n(){var r;return T().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e._onlineComponents,!n.t0){n.next=5;break}return n.next=5,e._onlineComponents.terminate();case 5:if(n.t1=e._offlineComponents,!n.t1){n.next=9;break}return n.next=9,e._offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=Ld(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function zf(e,t){return Bf.apply(this,arguments)}function Bf(){return Bf=N(T().mark((function e(t,n){var r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),No("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:a=r.initialUser,t.setCredentialChangeListener(function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(t),e.t0){e.next=5;break}return e.next=4,gh(n.localStore,t);case 4:a=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t._offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),Bf.apply(this,arguments)}function Vf(e,t){return Uf.apply(this,arguments)}function Uf(){return Uf=N(T().mark((function e(t,n){var r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,jf(t);case 3:return r=e.sent,No("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return a=e.sent,e.next=10,n.initialize(r,a);case 10:t.setCredentialChangeListener((function(e){return Nd(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return Nd(n.remoteStore,t)})),t._onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),Uf.apply(this,arguments)}function Wf(e){return"FirebaseError"===e.name?e.code===Lo.FAILED_PRECONDITION||e.code===Lo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function jf(e){return Gf.apply(this,arguments)}function Gf(){return(Gf=N(T().mark((function e(t){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._offlineComponents){e.next=21;break}if(!t._uninitializedComponentsProvider){e.next=18;break}return No("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,zf(t,t._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),Wf(n=e.t0)){e.next=13;break}throw n;case 13:return Ao("Error using user provided cache. Falling back to memory cache: "+n),e.next=16,zf(t,new Pf);case 16:e.next=21;break;case 18:return No("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,zf(t,new Pf);case 21:return e.abrupt("return",t._offlineComponents);case 22:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function Hf(e){return Kf.apply(this,arguments)}function Kf(){return(Kf=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t._onlineComponents,e.t0){e.next=11;break}if(!t._uninitializedComponentsProvider){e.next=8;break}return No("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,Vf(t,t._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return No("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,Vf(t,new Mf);case 11:return e.abrupt("return",t._onlineComponents);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qf(e){return Hf(e).then((function(e){return e.syncEngine}))}function Zf(e){return Xf.apply(this,arguments)}function Xf(){return(Xf=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hf(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=nf.bind(null,n.syncEngine),r.onUnlisten=sf.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new zo;return e.asyncQueue.enqueueAndForget(N(T().mark((function a(){return T().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new Lf({next:function(i){t.enqueueAndForget((function(){return Gd(e,o)}));var s=i.docs.has(n);!s&&i.fromCache?a.reject(new Fo(Lo.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&i.fromCache&&r&&"server"===r.source?a.reject(new Fo(Lo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(i)},error:function(e){return a.reject(e)}}),o=new Xd(Lu(n.path),i,{includeMetadataChanges:!0,z_:!0});return Wd(e,o)},a.next=3,Zf(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}function Qf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new zo;return e.asyncQueue.enqueueAndForget(N(T().mark((function a(){return T().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new Lf({next:function(n){t.enqueueAndForget((function(){return Gd(e,o)})),n.fromCache&&"server"===r.source?a.reject(new Fo(Lo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:function(e){return a.reject(e)}}),o=new Xd(n,i,{includeMetadataChanges:!0,z_:!0});return Wd(e,o)},a.next=3,Zf(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}function $f(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}var Jf=new Map;function ep(e,t,n){if(!n)throw new Fo(Lo.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function tp(e){if(!rs.isDocumentKey(e))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function np(e){if(rs.isDocumentKey(e))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function rp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Do()}function ap(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Fo(Lo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=rp(e);throw new Fo(Lo.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var ip=function(){function e(t){var n,r;if(Se(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Fo(Lo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Fo(Lo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Fo(Lo.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$f(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Fo(Lo.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Fo(Lo.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Fo(Lo.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}return Te(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),op=function(){function e(t,n,r,a){Se(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ip({}),this._settingsFrozen=!1}return Te(e,[{key:"app",get:function(){if(!this._app)throw new Fo(Lo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Fo(Lo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ip(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Vo;switch(e.type){case"firstParty":return new Go(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Fo(Lo.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=Jf.get(e);t&&(No("ComponentProvider","Removing Datastore"),Jf.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function sp(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(e=ap(e,op))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==i.host&&i.host!==o&&Ao("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),a.mockUserToken){var s,u;if("string"==typeof a.mockUserToken)s=a.mockUserToken,u=Io.MOCK_USER;else{s=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Re(JSON.stringify({alg:"none",type:"JWT"})),Re(JSON.stringify(i)),""].join(".")}(a.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=a.mockUserToken.sub||a.mockUserToken.user_id;if(!c)throw new Fo(Lo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Io(c)}e._authCredentials=new Uo(new Bo(s,u))}}var up=function(){function e(t,n,r){Se(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return Te(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),cp=function(){function e(t,n,r){Se(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return Te(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new lp(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),lp=function(e){be(n,e);var t=we(n);function n(e,r,a){var i;return Se(this,n),(i=t.call(this,e,r,Lu(a)))._path=a,i.type="collection",i}return Te(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new cp(this.firestore,null,new rs(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(up);function hp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=je(e),ep("collection","path",t),e instanceof op){var i=es.fromString.apply(es,[t].concat(r));return np(i),new lp(e,null,i)}if(!(e instanceof cp||e instanceof lp))throw new Fo(Lo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(es.fromString.apply(es,[t].concat(r)));return np(o),new lp(e.firestore,null,o)}function dp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=je(e),1===arguments.length&&(t=Zo.V()),ep("doc","path",t),e instanceof op){var i=es.fromString.apply(es,[t].concat(r));return tp(i),new cp(e,null,new rs(i))}if(!(e instanceof cp||e instanceof lp))throw new Fo(Lo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(es.fromString.apply(es,[t].concat(r)));return tp(o),new cp(e.firestore,e instanceof lp?e.converter:null,new rs(o))}var fp=function(){function e(){var t=this;Se(this,e),this.za=Promise.resolve(),this.ja=[],this.Ha=!1,this.Ja=[],this.Ya=null,this.Za=!1,this.Xa=!1,this.eu=[],this.Uo=new Uh(this,"async_queue_retry"),this.tu=function(){var e=Bh();e&&No("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Uo.Lo()};var n=Bh();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.tu)}return Te(e,[{key:"isShuttingDown",get:function(){return this.Ha}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.nu(),this.ru(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Ha){this.Ha=!0,this.Xa=e||!1;var t=Bh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.tu)}}},{key:"enqueue",value:function(e){var t=this;if(this.nu(),this.Ha)return new Promise((function(){}));var n=new zo;return this.ru((function(){return t.Ha&&t.Xa?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.ja.push(e),t.iu()}))}},{key:"iu",value:function(){var e=N(T().mark((function e(){var t=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.ja.length){e.next=14;break}return e.prev=1,e.next=4,this.ja[0]();case 4:this.ja.shift(),this.Uo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),ps(e.t0)){e.next=12;break}throw e.t0;case 12:No("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.ja.length>0&&this.Uo.No((function(){return t.iu()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"ru",value:function(e){var t=this,n=this.za.then((function(){return t.Za=!0,e().catch((function(e){t.Ya=e,t.Za=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ro("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Za=!1,e}))}));return this.za=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.nu(),this.eu.indexOf(e)>-1&&(t=0);var a=Md.createAndSchedule(this,e,t,n,(function(e){return r.su(e)}));return this.Ja.push(a),a}},{key:"nu",value:function(){this.Ya&&Do()}},{key:"verifyOperationInProgress",value:function(){}},{key:"ou",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.za,e.next=3,t;case 3:if(t!==this.za){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_u",value:function(e){var t,n=ye(this.Ja);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"au",value:function(e){var t=this;return this.ou().then((function(){t.Ja.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=ye(t.Ja);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.skipDelay(),"all"!==e&&a.timerId===e)break}}catch(i){r.e(i)}finally{r.f()}return t.ou()}))}},{key:"uu",value:function(e){this.eu.push(e)}},{key:"su",value:function(e){var t=this.Ja.indexOf(e);this.Ja.splice(t,1)}}]),e}();var pp=function(e){be(n,e);var t=we(n);function n(e,r,a,i){var o;return Se(this,n),(o=t.call(this,e,r,a,i)).type="firestore",o._queue=new fp,o._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]",o}return Te(n,[{key:"_terminate",value:function(){return this._firestoreClient||vp(this),this._firestoreClient.terminate()}}]),n}(op);function mp(e){return e._firestoreClient||vp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function vp(e){var t,n,r,a=e._freezeSettings(),i=function(e,t,n,r){return new Vs(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,$f(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._firestoreClient=new Ff(e._authCredentials,e._appCheckCredentials,e._queue,i),(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.localCache.kind,_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider})}var gp=function(){function e(t){Se(this,e),this._byteString=t}return Te(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Os.fromBase64String(t))}catch(t){throw new Fo(Lo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Os.fromUint8Array(t))}}]),e}(),yp=function(){function e(){Se(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0;a<n.length;++a)if(0===n[a].length)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ns(n)}return Te(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var bp=Te((function e(t){Se(this,e),this._methodName=t})),xp=function(){function e(t,n){if(Se(this,e),!isFinite(t)||t<-90||t>90)throw new Fo(Lo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Fo(Lo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Te(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Xo(this._lat,e._lat)||Xo(this._long,e._long)}}]),e}(),wp=/^__.*__$/,kp=function(){function e(t,n,r){Se(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Te(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new zc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fc(e,this.data,t,this.fieldTransforms)}}]),e}();function Sp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Do()}}var Cp=function(){function e(t,n,r,a,i,o){Se(this,e),this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,void 0===i&&this.cu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Te(e,[{key:"path",get:function(){return this.settings.path}},{key:"lu",get:function(){return this.settings.lu}},{key:"hu",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Pu",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.hu({path:n,Iu:!1});return r.Tu(e),r}},{key:"Eu",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.hu({path:n,Iu:!1});return r.cu(),r}},{key:"du",value:function(e){return this.hu({path:void 0,Iu:!0})}},{key:"Au",value:function(e){return Lp(e,this.settings.methodName,this.settings.Ru||!1,this.path,this.settings.Vu)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"cu",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Tu(this.path.get(e))}},{key:"Tu",value:function(e){if(0===e.length)throw this.Au("Document fields must not be empty");if(Sp(this.lu)&&wp.test(e))throw this.Au('Document fields cannot begin and end with "__"')}}]),e}(),Ip=function(){function e(t,n,r){Se(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Vh(t)}return Te(e,[{key:"mu",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Cp({lu:e,methodName:t,Vu:n,path:ns.emptyPath(),Iu:!1,Ru:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),e}();function Tp(e){var t=e._freezeSettings(),n=Vh(e._databaseId);return new Ip(e._databaseId,!!t.ignoreUndefinedProperties,n)}function _p(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.mu(i.merge||i.mergeFields?2:0,t,n,a);Op("Data must be an object, but it was:",o,r);var s,u,c=Rp(r,o);if(i.merge)s=new Rs(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){var l,h=[],d=ye(i.mergeFields);try{for(d.s();!(l=d.n()).done;){var f=Dp(t,l.value,n);if(!o.contains(f))throw new Fo(Lo.INVALID_ARGUMENT,"Field '".concat(f,"' is specified in your field mask but missing from your input data."));Fp(h,f)||h.push(f)}}catch(p){d.e(p)}finally{d.f()}s=new Rs(h),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new kp(new au(c),s,u)}function Ep(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Np(n,e.mu(r?4:3,t))}function Np(e,t){if(Ap(e=je(e)))return Op("Unsupported field value:",t,e),Rp(e,t);if(e instanceof bp)return function(e,t){if(!Sp(t.lu))throw t.Au("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Au("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Iu&&4!==t.lu)throw t.Au("Nested arrays are not supported");return function(e,t){var n,r=[],a=0,i=ye(e);try{for(i.s();!(n=i.n()).done;){var o=Np(n.value,t.du(a));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),a++}}catch(s){i.e(s)}finally{i.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=je(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return mc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Qo.fromDate(e);return{timestampValue:bl(t.serializer,n)}}if(e instanceof Qo){var r=new Qo(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:bl(t.serializer,r)}}if(e instanceof xp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof gp)return{bytesValue:xl(t.serializer,e._byteString)};if(e instanceof cp){var a=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(a))throw t.Au("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(a.projectId,"/").concat(a.database));return{referenceValue:Sl(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Au("Unsupported field value: ".concat(rp(e)))}(e,t)}function Rp(e,t){var n={};return Cs(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ss(e,(function(e,r){var a=Np(r,t.Pu(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function Ap(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Qo||e instanceof xp||e instanceof gp||e instanceof cp||e instanceof bp)}function Op(e,t,n){if(!Ap(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=rp(n);throw"an object"===r?t.Au(e+" a custom object"):t.Au(e+" "+r)}}function Dp(e,t,n){if((t=je(t))instanceof yp)return t._internalPath;if("string"==typeof t)return Mp(e,t);throw Lp("Field path arguments must be of type string or ",e,!1,void 0,n)}var Pp=new RegExp("[~\\*/\\[\\]]");function Mp(e,t,n){if(t.search(Pp)>=0)throw Lp("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return fe(yp,(0,ke.Z)(t.split(".")))._internalPath}catch(mn){throw Lp("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Lp(e,t,n,r,a){var i=r&&!r.isEmpty(),o=void 0!==a,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(i||o)&&(u+=" (found",i&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(a)),u+=")"),new Fo(Lo.INVALID_ARGUMENT,s+e+u)}function Fp(e,t){return e.some((function(e){return e.isEqual(t)}))}var zp=function(){function e(t,n,r,a,i){Se(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}return Te(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new cp(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Bp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Vp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),Bp=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"data",value:function(){return me(pe(n.prototype),"data",this).call(this)}}]),n}(zp);function Vp(e,t){return"string"==typeof t?Mp(e,t):t instanceof yp?t._internalPath:t._delegate._internalPath}function Up(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Fo(Lo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wp=Te((function e(){Se(this,e)})),jp=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n)}(Wp);function Gp(e,t){for(var n=[],r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof Wp&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof qp})).length,n=e.filter((function(e){return e instanceof Hp})).length;if(t>1||t>0&&n>0)throw new Fo(Lo.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(a));var o,s=ye(n);try{for(s.s();!(o=s.n()).done;){e=o.value._apply(e)}}catch(u){s.e(u)}finally{s.f()}return e}var Hp=function(e){be(n,e);var t=we(n);function n(e,r,a){var i;return Se(this,n),(i=t.call(this))._field=e,i._op=r,i._value=a,i.type="where",i}return Te(n,[{key:"_apply",value:function(e){var t=this._parse(e);return Yp(e._query,t),new up(e.firestore,e.converter,Gu(e._query,t))}},{key:"_parse",value:function(e){var t=Tp(e.firestore),n=function(e,t,n,r,a,i,o){var s;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){Xp(o,i);var u,c=[],l=ye(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(Zp(r,e,h))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=Zp(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Xp(o,i),s=Ep(n,t,o,"in"===i||"not-in"===i);return fu.create(a,i,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(jp);function Kp(e,t,n){var r=t,a=Vp("where",e);return Hp._create(a,r,n)}var qp=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this)).type=e,a._queryConstraints=r,a}return Te(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:pu.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,a=ye(t.getFlattenedFilters());try{for(a.s();!(n=a.n()).done;){var i=n.value;Yp(r,i),r=Gu(r,i)}}catch(o){a.e(o)}finally{a.f()}}(e._query,t),new up(e.firestore,e.converter,Gu(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Wp);function Zp(e,t,n){if("string"==typeof(n=je(n))){if(""===n)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vu(t)&&-1!==n.indexOf("/"))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(es.fromString(n));if(!rs.isDocumentKey(r))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ys(e,new rs(r))}if(n instanceof cp)return Ys(e,n._key);throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(rp(n),"."))}function Xp(e,t){if(!Array.isArray(e)||0===e.length)throw new Fo(Lo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Yp(e,t){if(t.isInequality()){var n=Bu(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var a=zu(e);null!==a&&Qp(e,r,a)}var i=function(e,t){var n,r=ye(e);try{for(r.s();!(n=r.n()).done;){var a,i=ye(n.value.getFlattenedFilters());try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.indexOf(o.op)>=0)return o.op}}catch(s){i.e(s)}finally{i.f()}}}catch(s){r.e(s)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new Fo(Lo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Fo(Lo.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}function Qp(e,t,n){if(!n.isEqual(t))throw new Fo(Lo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var $p=function(){function e(){Se(this,e)}return Te(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(js(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ms(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Do()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return Ss(e,(function(e,a){r[e]=t.convertValue(a,n)})),r}},{key:"convertGeoPoint",value:function(e){return new xp(Ms(e.latitude),Ms(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=zs(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Bs(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Ps(e);return new Qo(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=es.fromString(e);Po(Gl(n));var r=new Us(n.get(1),n.get(3)),a=new rs(n.popFirst(5));return r.isEqual(t)||Ro("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}]),e}();function Jp(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var em=function(){function e(t,n){Se(this,e),this.hasPendingWrites=t,this.fromCache=n}return Te(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),tm=function(e){be(n,e);var t=we(n);function n(e,r,a,i,o,s){var u;return Se(this,n),(u=t.call(this,e,r,a,i,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Te(n,[{key:"exists",value:function(){return me(pe(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new nm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Vp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(zp),nm=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return me(pe(n.prototype),"data",this).call(this,e)}}]),n}(tm),rm=function(){function e(t,n,r,a){Se(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new em(a.hasPendingWrites,a.fromCache),this.query=r}return Te(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new nm(n._firestore,n._userDataWriter,r.key,r,new em(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Fo(Lo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new nm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new em(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new nm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new em(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),a=-1,i=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(i=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:am(t.type),doc:n,oldIndex:a,newIndex:i}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function am(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Do()}}function im(e){e=ap(e,cp);var t=ap(e.firestore,pp);return Yf(mp(t),e._key).then((function(n){return lm(t,e,n)}))}var om=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).firestore=e,r}return Te(n,[{key:"convertBytes",value:function(e){return new gp(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new cp(this.firestore,null,t)}}]),n}($p);function sm(e){e=ap(e,up);var t=ap(e.firestore,pp),n=mp(t),r=new om(t);return Up(e._query),Qf(n,e._query).then((function(n){return new rm(t,r,e,n)}))}function um(e,t,n){e=ap(e,cp);var r=ap(e.firestore,pp),a=Jp(e.converter,t,n);return cm(r,[_p(Tp(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Nc.none())])}function cm(e,t){return function(e,t){var n=new zo;return e.asyncQueue.enqueueAndForget(N(T().mark((function r(){return T().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=cf,r.next=3,qf(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(mp(e),t)}function lm(e,t,n){var r=n.docs.get(t._key),a=new om(e);return new tm(e,a,t._key,r,new em(n.hasPendingWrites,n.fromCache),t.converter)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){To=e}("10.3.0"),Ot(new Ge("firestore",(function(e,n){var r=n.instanceIdentifier,a=n.options,i=e.getProvider("app").getImmediate(),o=new pp(new Wo(e.getProvider("auth-internal")),new Ko(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Fo(Lo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Us(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),o._setSettings(a),o}),"PUBLIC").setMultipleInstances(!0)),zt(Co,"4.1.2",e),zt(Co,"4.1.2","esm2017")}();var hm=function(){var e=(0,S.useState)(!1),t=(0,U.Z)(e,2),n=t[0],r=t[1],a=(0,S.useState)(""),i=(0,U.Z)(a,2),o=i[0],s=i[1],u=(0,S.useState)(""),c=(0,U.Z)(u,2),l=c[0],h=c[1],d=(0,S.useState)(""),f=(0,U.Z)(d,2),p=f[0],m=f[1],v=(0,S.useState)("\u30ed\u30b0\u30a4\u30f3"),g=(0,U.Z)(v,2),y=g[0],b=g[1],x=function(){r(!n),b("\u30ed\u30b0\u30a4\u30f3"===y?"\u30e6\u30fc\u30b6\u30fc\u767b\u9332":"\u30ed\u30b0\u30a4\u30f3")},w=function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sm(Gp(hp(k8,"User"),Kp("UserId","==",o),Kp("password","==",l)));case 2:1===e.sent.docs.length?(localStorage.setItem("Login","yes"),localStorage.setItem("UserId",o),window.location.pathname="/"):alert("\u30e6\u30fc\u30b6\u30fcID\u304b\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u3002");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sm(Gp(hp(k8,"User"),Kp("UserId","==",o)));case 2:if(0!==e.sent.docs.length||l!==p){e.next=11;break}return e.next=6,um(dp(k8,"User",o),{UserId:o,password:l});case 6:localStorage.setItem("Login","yes"),localStorage.setItem("UserId",o),window.location.pathname="/",e.next=12;break;case 11:l!==p?alert("\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093"):alert("\u305d\u306e\u30e6\u30fc\u30b6\u30fcID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\u5225\u306e\u3082\u306e\u3092\u767b\u9332\u3057\u3066\u304f\u3060\u3055\u3044\u3002");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,M.jsx)("div",{className:"Form",children:(0,M.jsxs)("div",{className:"wrap",children:[(0,M.jsx)("h2",{children:y}),(0,M.jsx)("label",{className:"InputLabel",children:"\u30e6\u30fc\u30b6\u30fcID : "}),(0,M.jsx)("input",{type:"text",className:"LoginUser",id:"UserId",value:o,onChange:function(e){return s(e.target.value)},required:!0}),(0,M.jsx)("br",{}),(0,M.jsx)("label",{className:"InputLabel",children:"\u30d1\u30b9\u30ef\u30fc\u30c9 : "}),(0,M.jsx)("input",{type:"password",value:l,onChange:function(e){return h(e.target.value)},required:!0}),(0,M.jsx)("div",{id:n?"":"active",className:"SignIn",children:(0,M.jsxs)("div",{className:"GuideButton",children:[(0,M.jsx)("div",{onClick:w,className:"LoginButton",children:"\u30ed\u30b0\u30a4\u30f3"}),(0,M.jsx)("div",{onClick:x,className:"LRToggle",children:"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u306f\u3053\u3061\u3089"})]})}),(0,M.jsxs)("div",{id:n?"active":"",className:"SignIn",children:[(0,M.jsx)("label",{className:"InputLabel",children:"\u30d1\u30b9\u30ef\u30fc\u30c9(\u78ba\u8a8d\u7528) : "}),(0,M.jsx)("input",{type:"password",className:"SecondPassword",value:p,onChange:function(e){return m(e.target.value)},required:!0}),(0,M.jsxs)("div",{className:"GuideButton",children:[(0,M.jsx)("div",{className:"LoginButton",onClick:k,children:" \u30e6\u30fc\u30b6\u30fc\u767b\u9332"}),(0,M.jsx)("div",{onClick:x,className:"LRToggle",children:"\u30ed\u30b0\u30a4\u30f3\u306f\u3053\u3061\u3089"})]})]})]})})},dm=n.p+"static/media/macho.d84f0c2eadf9233e0728.png",fm=n(5397),pm=n(1830),mm=n.n(pm),vm=n(8086),gm=n.n(vm)()(mm());var ym=function(){var e=(0,S.useContext)(H).setTrainingType,t=JSON.parse(localStorage.getItem("userTrainingData"))[j()().format("YYYY/MM/DD")];if(void 0===t)return(0,M.jsx)(M.Fragment,{});var n=[{title:"\u4e0a\u4f53\u8d77\u3053\u3057",type:"AbsTraining",count:t.target.AbsTraining-t.training.AbsTraining,link:"?classification=AbsTraining"},{title:"\u8155\u7acb\u3066\u4f0f\u305b",type:"PectoralTraining",count:t.target.PectoralTraining-t.training.PectoralTraining,link:"?classification=PectoralTraining"},{title:"\u30b9\u30af\u30ef\u30c3\u30c8",type:"LegTraining",count:t.target.LegTraining-t.training.LegTraining,link:"?classification=LegTraining"}];return(0,M.jsxs)("div",{className:"TrainingMenu",children:[(0,M.jsx)("p",{children:"\u4eca\u65e5\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0 : "}),(0,M.jsx)("ul",{children:n.map((function(t,n){return(0,M.jsxs)("li",{className:"TrainingText",onClick:function(){e(t.type),0!==t.count?window.location.href="/training".concat(t.link):gm.fire({title:"\u5b8c\u4e86\u6e08\u307f\uff01",text:"\u4eca\u65e5\u306f\u5225\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3092\u884c\u3044\u307e\u3057\u3087\u3046\uff01",icon:"success"})},children:[(0,M.jsx)("div",{className:"StartButtonIcon",children:(0,M.jsx)(P.Z,{})}),(0,M.jsx)("div",{className:"TrainingTitle",children:0!==t.count?t.title:(0,M.jsx)("s",{children:t.title})}),(0,M.jsx)("div",{className:"TrainingCount",children:0!==t.count?(0,M.jsxs)("div",{children:["\u6b8b\u308a ",t.count," \u56de"]}):(0,M.jsxs)("s",{children:["\u6b8b\u308a ",t.count," \u56de"]})}),(0,M.jsx)("div",{className:"StartButtonAllow",children:(0,M.jsx)(fm.Z,{})})]},n)}))})]})};var bm=function(){return(0,M.jsxs)("div",{className:"Main",children:[(0,M.jsxs)("div",{className:"StartTraining",children:[(0,M.jsx)("img",{src:dm,alt:"\u30de\u30c3\u30c1\u30e7",className:"TrainingImage"}),(0,M.jsx)("h2",{children:"\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3092\u59cb\u3081\u307e\u3057\u3087\u3046!"}),(0,M.jsx)("p",{className:"discription",children:"\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u30ab\u30e1\u30e9\u304c\u8d77\u52d5\u3057\u3001\u8a08\u6e2c\u304c\u958b\u59cb\u3055\u308c\u307e\u3059\u3002"})]}),(0,M.jsx)(ym,{})]})};var xm=function(){return(0,M.jsx)("div",{className:"footer",children:(0,M.jsx)("div",{className:"FooterWrapper",children:L.map((function(e,t){return(0,M.jsxs)("div",{className:window.location.pathname===e.link?"CurrentPage":"NotCurrentPage",onClick:function(){window.location.pathname=e.link},children:[(0,M.jsx)("div",{className:"FooterIcon",children:e.icon}),(0,M.jsx)("div",{className:"FooterTitle",children:e.title})]},t)}))})})};function wm(e){return e+.5|0}var km=function(e,t,n){return Math.max(Math.min(e,n),t)};function Sm(e){return km(wm(2.55*e),0,255)}function Cm(e){return km(wm(255*e),0,255)}function Im(e){return km(wm(e/2.55)/100,0,1)}function Tm(e){return km(wm(100*e),0,100)}var _m={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Em=(0,ke.Z)("0123456789ABCDEF"),Nm=function(e){return Em[15&e]},Rm=function(e){return Em[(240&e)>>4]+Em[15&e]},Am=function(e){return(240&e)>>4===(15&e)};function Om(e){var t=function(e){return Am(e.r)&&Am(e.g)&&Am(e.b)&&Am(e.a)}(e)?Nm:Rm;return e?"#"+t(e.r)+t(e.g)+t(e.b)+function(e,t){return e<255?t(e):""}(e.a,t):void 0}var Dm=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Pm(e,t,n){var r=t*Math.min(n,1-n),a=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(a-3,9-a,1),-1)};return[a(0),a(8),a(4)]}function Mm(e,t,n){var r=function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(a,4-a,1),0)};return[r(5),r(3),r(1)]}function Lm(e,t,n){var r,a=Pm(e,1,.5);for(t+n>1&&(t*=r=1/(t+n),n*=r),r=0;r<3;r++)a[r]*=1-t-n,a[r]+=t;return a}function Fm(e){var t,n,r,a=e.r/255,i=e.g/255,o=e.b/255,s=Math.max(a,i,o),u=Math.min(a,i,o),c=(s+u)/2;return s!==u&&(r=s-u,n=c>.5?r/(2-s-u):r/(s+u),t=function(e,t,n,r,a){return e===a?(t-n)/r+(t<n?6:0):t===a?(n-e)/r+2:(e-t)/r+4}(a,i,o,r,s),t=60*t+.5),[0|t,n||0,c]}function zm(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(Cm)}function Bm(e,t,n){return zm(Pm,e,t,n)}function Vm(e){return(e%360+360)%360}function Um(e){var t,n=Dm.exec(e),r=255;if(n){n[5]!==t&&(r=n[6]?Sm(+n[5]):Cm(+n[5]));var a=Vm(+n[2]),i=+n[3]/100,o=+n[4]/100;return t="hwb"===n[1]?function(e,t,n){return zm(Lm,e,t,n)}(a,i,o):"hsv"===n[1]?function(e,t,n){return zm(Mm,e,t,n)}(a,i,o):Bm(a,i,o),{r:t[0],g:t[1],b:t[2],a:r}}}var Wm,jm={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Gm={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Hm(e){Wm||(Wm=function(){var e,t,n,r,a,i={},o=Object.keys(Gm),s=Object.keys(jm);for(e=0;e<o.length;e++){for(r=a=o[e],t=0;t<s.length;t++)n=s[t],a=a.replace(n,jm[n]);n=parseInt(Gm[r],16),i[a]=[n>>16&255,n>>8&255,255&n]}return i}(),Wm.transparent=[0,0,0,0]);var t=Wm[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}var Km=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;var qm=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},Zm=function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)};function Xm(e,t,n){if(e){var r=Fm(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=Bm(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function Ym(e,t){return e?Object.assign(t||{},e):e}function Qm(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Cm(e[3]))):(t=Ym(e,{r:0,g:0,b:0,a:1})).a=Cm(t.a),t}function $m(e){return"r"===e.charAt(0)?function(e){var t,n,r,a=Km.exec(e),i=255;if(a){if(a[7]!==t){var o=+a[7];i=a[8]?Sm(o):km(255*o,0,255)}return t=+a[1],n=+a[3],r=+a[5],{r:t=255&(a[2]?Sm(t):km(t,0,255)),g:n=255&(a[4]?Sm(n):km(n,0,255)),b:r=255&(a[6]?Sm(r):km(r,0,255)),a:i}}}(e):Um(e)}var Jm=function(){function e(t){if(Se(this,e),t instanceof e)return t;var n,r=typeof t;"object"===r?n=Qm(t):"string"===r&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*_m[e[1]],g:255&17*_m[e[2]],b:255&17*_m[e[3]],a:5===n?17*_m[e[4]]:255}:7!==n&&9!==n||(t={r:_m[e[1]]<<4|_m[e[2]],g:_m[e[3]]<<4|_m[e[4]],b:_m[e[5]]<<4|_m[e[6]],a:9===n?_m[e[7]]<<4|_m[e[8]]:255})),t}(t)||Hm(t)||$m(t)),this._rgb=n,this._valid=!!n}return Te(e,[{key:"valid",get:function(){return this._valid}},{key:"rgb",get:function(){var e=Ym(this._rgb);return e&&(e.a=Im(e.a)),e},set:function(e){this._rgb=Qm(e)}},{key:"rgbString",value:function(){return this._valid?function(e){return e&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(Im(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}(this._rgb):void 0}},{key:"hexString",value:function(){return this._valid?Om(this._rgb):void 0}},{key:"hslString",value:function(){return this._valid?function(e){if(e){var t=Fm(e),n=t[0],r=Tm(t[1]),a=Tm(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(r,"%, ").concat(a,"%, ").concat(Im(e.a),")"):"hsl(".concat(n,", ").concat(r,"%, ").concat(a,"%)")}}(this._rgb):void 0}},{key:"mix",value:function(e,t){if(e){var n,r=this.rgb,a=e.rgb,i=t===n?.5:t,o=2*i-1,s=r.a-a.a,u=((o*s===-1?o:(o+s)/(1+o*s))+1)/2;n=1-u,r.r=255&u*r.r+n*a.r+.5,r.g=255&u*r.g+n*a.g+.5,r.b=255&u*r.b+n*a.b+.5,r.a=i*r.a+(1-i)*a.a,this.rgb=r}return this}},{key:"interpolate",value:function(e,t){return e&&(this._rgb=function(e,t,n){var r=Zm(Im(e.r)),a=Zm(Im(e.g)),i=Zm(Im(e.b));return{r:Cm(qm(r+n*(Zm(Im(t.r))-r))),g:Cm(qm(a+n*(Zm(Im(t.g))-a))),b:Cm(qm(i+n*(Zm(Im(t.b))-i))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}},{key:"clone",value:function(){return new e(this.rgb)}},{key:"alpha",value:function(e){return this._rgb.a=Cm(e),this}},{key:"clearer",value:function(e){return this._rgb.a*=1-e,this}},{key:"greyscale",value:function(){var e=this._rgb,t=wm(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}},{key:"opaquer",value:function(e){return this._rgb.a*=1+e,this}},{key:"negate",value:function(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}},{key:"lighten",value:function(e){return Xm(this._rgb,2,e),this}},{key:"darken",value:function(e){return Xm(this._rgb,2,-e),this}},{key:"saturate",value:function(e){return Xm(this._rgb,1,e),this}},{key:"desaturate",value:function(e){return Xm(this._rgb,1,-e),this}},{key:"rotate",value:function(e){return function(e,t){var n=Fm(e);n[0]=Vm(n[0]+t),n=Bm(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}]),e}();function ev(){}var tv=function(){var e=0;return function(){return e++}}();function nv(e){return null===e||"undefined"===typeof e}function rv(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function av(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function iv(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function ov(e,t){return iv(e)?e:t}function sv(e,t){return"undefined"===typeof e?t:e}var uv=function(e,t){return"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e};function cv(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function lv(e,t,n,r){var a,i,o;if(rv(e))if(i=e.length,r)for(a=i-1;a>=0;a--)t.call(n,e[a],a);else for(a=0;a<i;a++)t.call(n,e[a],a);else if(av(e))for(i=(o=Object.keys(e)).length,a=0;a<i;a++)t.call(n,e[o[a]],o[a])}function hv(e,t){var n,r,a,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(a=e[n],i=t[n],a.datasetIndex!==i.datasetIndex||a.index!==i.index)return!1;return!0}function dv(e){if(rv(e))return e.map(dv);if(av(e)){for(var t=Object.create(null),n=Object.keys(e),r=n.length,a=0;a<r;++a)t[n[a]]=dv(e[n[a]]);return t}return e}function fv(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function pv(e,t,n,r){if(fv(e)){var a=t[e],i=n[e];av(a)&&av(i)?mv(a,i,r):t[e]=dv(i)}}function mv(e,t,n){var r=rv(t)?t:[t],a=r.length;if(!av(e))return e;for(var i,o=(n=n||{}).merger||pv,s=0;s<a;++s)if(av(i=r[s]))for(var u=Object.keys(i),c=0,l=u.length;c<l;++c)o(u[c],e,i,n);return e}function vv(e,t){return mv(e,t,{merger:gv})}function gv(e,t,n){if(fv(e)){var r=t[e],a=n[e];av(r)&&av(a)?vv(r,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=dv(a))}}var yv={"":function(e){return e},x:function(e){return e.x},y:function(e){return e.y}};function bv(e){var t=function(e){var t,n=[],r="",a=ye(e.split("."));try{for(a.s();!(t=a.n()).done;)(r+=t.value).endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="")}catch(i){a.e(i)}finally{a.f()}return n}(e);return function(e){var n,r=ye(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(""===a)break;e=e&&e[a]}}catch(i){r.e(i)}finally{r.f()}return e}}function xv(e,t){return(yv[t]||(yv[t]=bv(t)))(e)}function wv(e){return e.charAt(0).toUpperCase()+e.slice(1)}var kv=function(e){return"undefined"!==typeof e},Sv=function(e){return"function"===typeof e},Cv=function(e,t){if(e.size!==t.size)return!1;var n,r=ye(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0};var Iv=Math.PI,Tv=2*Iv,_v=Tv+Iv,Ev=Number.POSITIVE_INFINITY,Nv=Iv/180,Rv=Iv/2,Av=Iv/4,Ov=2*Iv/3,Dv=Math.log10,Pv=Math.sign;function Mv(e,t,n){return Math.abs(e-t)<n}function Lv(e){var t=Math.round(e);e=Mv(e,t,e/1e3)?t:e;var n=Math.pow(10,Math.floor(Dv(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function Fv(e){return!isNaN(parseFloat(e))&&isFinite(e)}function zv(e,t,n){var r,a,i;for(r=0,a=e.length;r<a;r++)i=e[r][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function Bv(e){return e*(Iv/180)}function Vv(e){return e*(180/Iv)}function Uv(e){if(iv(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}}function Wv(e,t){var n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r),i=Math.atan2(r,n);return i<-.5*Iv&&(i+=Tv),{angle:i,distance:a}}function jv(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Gv(e,t){return(e-t+_v)%Tv-Iv}function Hv(e){return(e%Tv+Tv)%Tv}function Kv(e,t,n,r){var a=Hv(e),i=Hv(t),o=Hv(n),s=Hv(i-a),u=Hv(o-a),c=Hv(a-i),l=Hv(a-o);return a===i||a===o||r&&i===o||s>u&&c<l}function qv(e,t,n){return Math.max(t,Math.min(n,e))}function Zv(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function Xv(e,t,n){n=n||function(n){return e[n]<t};for(var r,a=e.length-1,i=0;a-i>1;)n(r=i+a>>1)?i=r:a=r;return{lo:i,hi:a}}var Yv=function(e,t,n,r){return Xv(e,n,r?function(r){var a=e[r][t];return a<n||a===n&&e[r+1][t]===n}:function(r){return e[r][t]<n})},Qv=function(e,t,n){return Xv(e,n,(function(r){return e[r][t]>=n}))};var $v=["push","pop","shift","splice","unshift"];function Jv(e,t){var n=e._chartjs;if(n){var r=n.listeners,a=r.indexOf(t);-1!==a&&r.splice(a,1),r.length>0||($v.forEach((function(t){delete e[t]})),delete e._chartjs)}}function eg(e){var t=new Set(e);return t.size===e.length?e:Array.from(t)}var tg="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function ng(e,t){var n=[],r=!1;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];n=i,r||(r=!0,tg.call(window,(function(){r=!1,e.apply(t,n)})))}}var rg=function(e){return"start"===e?"left":"end"===e?"right":"center"},ag=function(e,t,n){return"start"===e?t:"end"===e?n:(t+n)/2};function ig(e,t,n){var r=t.length,a=0,i=r;if(e._sorted){var o=e.iScale,s=e._parsed,u=o.axis,c=o.getUserBounds(),l=c.min,h=c.max,d=c.minDefined,f=c.maxDefined;d&&(a=qv(Math.min(Yv(s,u,l).lo,n?r:Yv(t,u,o.getPixelForValue(l)).lo),0,r-1)),i=f?qv(Math.max(Yv(s,o.axis,h,!0).hi+1,n?0:Yv(t,u,o.getPixelForValue(h),!0).hi+1),a,r)-a:r-a}return{start:a,count:i}}function og(e){var t=e.xScale,n=e.yScale,r=e._scaleRanges,a={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=a,!0;var i=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,a),i}var sg=function(e){return 0===e||1===e},ug=function(e,t,n){return-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Tv/n)},cg=function(e,t,n){return Math.pow(2,-10*e)*Math.sin((e-t)*Tv/n)+1},lg={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*Rv)},easeOutSine:function(e){return Math.sin(e*Rv)},easeInOutSine:function(e){return-.5*(Math.cos(Iv*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return sg(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1)))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){return sg(e)?e:ug(e,.075,.3)},easeOutElastic:function(e){return sg(e)?e:cg(e,.075,.3)},easeInOutElastic:function(e){var t=.1125;return sg(e)?e:e<.5?.5*ug(2*e,t,.45):.5+.5*cg(2*e-1,t,.45)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-lg.easeOutBounce(1-e)},easeOutBounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*lg.easeInBounce(2*e):.5*lg.easeOutBounce(2*e-1)+.5}};function hg(e){if(e&&"object"===typeof e){var t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function dg(e){return hg(e)?e:new Jm(e)}function fg(e){return hg(e)?e:new Jm(e).saturate(.5).darken(.1).hexString()}var pg=["x","y","borderWidth","radius","tension"],mg=["color","borderColor","backgroundColor"];var vg=new Map;function gg(e,t,n){return function(e,t){t=t||{};var n=e+JSON.stringify(t),r=vg.get(n);return r||(r=new Intl.NumberFormat(e,t),vg.set(n,r)),r}(t,n).format(e)}var yg={values:function(e){return rv(e)?e:""+e},numeric:function(e,t,n){if(0===e)return"0";var r,a=this.chart.options.locale,i=e;if(n.length>1){var o=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(o<1e-4||o>1e15)&&(r="scientific"),i=function(e,t){var n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}var s=Dv(Math.abs(i)),u=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),c={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(c,this.options.ticks.format),gg(e,a,c)},logarithmic:function(e,t,n){if(0===e)return"0";var r=n[t].significand||e/Math.pow(10,Math.floor(Dv(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?yg.numeric.call(this,e,t,n):""}};var bg={formatters:yg};var xg=Object.create(null),wg=Object.create(null);function kg(e,t){if(!t)return e;for(var n=t.split("."),r=0,a=n.length;r<a;++r){var i=n[r];e=e[i]||(e[i]=Object.create(null))}return e}function Sg(e,t,n){return"string"===typeof t?mv(kg(e,t),n):mv(kg(e,""),t)}var Cg=function(){function e(t,n){Se(this,e),this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=function(e){return e.chart.platform.getDevicePixelRatio()},this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=function(e,t){return fg(t.backgroundColor)},this.hoverBorderColor=function(e,t){return fg(t.borderColor)},this.hoverColor=function(e,t){return fg(t.color)},this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}return Te(e,[{key:"set",value:function(e,t){return Sg(this,e,t)}},{key:"get",value:function(e){return kg(this,e)}},{key:"describe",value:function(e,t){return Sg(wg,e,t)}},{key:"override",value:function(e,t){return Sg(xg,e,t)}},{key:"route",value:function(e,t,n,r){var a,i=kg(this,e),o=kg(this,n),s="_"+t;Object.defineProperties(i,(a={},(0,_.Z)(a,s,{value:i[t],writable:!0}),(0,_.Z)(a,t,{enumerable:!0,get:function(){var e=this[s],t=o[r];return av(e)?Object.assign({},t,e):sv(e,t)},set:function(e){this[s]=e}}),a))}},{key:"apply",value:function(e){var t=this;e.forEach((function(e){return e(t)}))}}]),e}(),Ig=new Cg({_scriptable:function(e){return!e.startsWith("on")},_indexable:function(e){return"events"!==e},hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:function(e){return"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}}),e.set("animations",{colors:{type:"color",properties:mg},numbers:{type:"number",properties:pg}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:function(e){return 0|e}}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:function(e,t){return t.lineWidth},tickColor:function(e,t){return t.color},offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:bg.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:function(e){return!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e},_indexable:function(e){return"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:function(e){return"backdropPadding"!==e&&"callback"!==e},_indexable:function(e){return"backdropPadding"!==e}})}]);function Tg(e,t,n,r,a){var i=t[a];return i||(i=t[a]=e.measureText(a).width,n.push(a)),i>r&&(r=i),r}function _g(e,t,n,r){var a=(r=r||{}).data=r.data||{},i=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(a=r.data={},i=r.garbageCollect=[],r.font=t),e.save(),e.font=t;var o,s,u,c,l,h=0,d=n.length;for(o=0;o<d;o++)if(void 0===(c=n[o])||null===c||rv(c)){if(rv(c))for(s=0,u=c.length;s<u;s++)void 0===(l=c[s])||null===l||rv(l)||(h=Tg(e,a,i,h,l))}else h=Tg(e,a,i,h,c);e.restore();var f=i.length/2;if(f>n.length){for(o=0;o<f;o++)delete a[i[o]];i.splice(0,f)}return h}function Eg(e,t,n){var r=e.currentDevicePixelRatio,a=0!==n?Math.max(n/2,.5):0;return Math.round((t-a)*r)/r+a}function Ng(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Rg(e,t,n,r){Ag(e,t,n,r,null)}function Ag(e,t,n,r,a){var i,o,s,u,c,l,h,d,f=t.pointStyle,p=t.rotation,m=t.radius,v=(p||0)*Nv;if(f&&"object"===typeof f&&("[object HTMLImageElement]"===(i=f.toString())||"[object HTMLCanvasElement]"===i))return e.save(),e.translate(n,r),e.rotate(v),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(m)||m<=0)){switch(e.beginPath(),f){default:a?e.ellipse(n,r,a/2,m,0,0,Tv):e.arc(n,r,m,0,Tv),e.closePath();break;case"triangle":l=a?a/2:m,e.moveTo(n+Math.sin(v)*l,r-Math.cos(v)*m),v+=Ov,e.lineTo(n+Math.sin(v)*l,r-Math.cos(v)*m),v+=Ov,e.lineTo(n+Math.sin(v)*l,r-Math.cos(v)*m),e.closePath();break;case"rectRounded":u=m-(c=.516*m),o=Math.cos(v+Av)*u,h=Math.cos(v+Av)*(a?a/2-c:u),s=Math.sin(v+Av)*u,d=Math.sin(v+Av)*(a?a/2-c:u),e.arc(n-h,r-s,c,v-Iv,v-Rv),e.arc(n+d,r-o,c,v-Rv,v),e.arc(n+h,r+s,c,v,v+Rv),e.arc(n-d,r+o,c,v+Rv,v+Iv),e.closePath();break;case"rect":if(!p){u=Math.SQRT1_2*m,l=a?a/2:u,e.rect(n-l,r-u,2*l,2*u);break}v+=Av;case"rectRot":h=Math.cos(v)*(a?a/2:m),o=Math.cos(v)*m,s=Math.sin(v)*m,d=Math.sin(v)*(a?a/2:m),e.moveTo(n-h,r-s),e.lineTo(n+d,r-o),e.lineTo(n+h,r+s),e.lineTo(n-d,r+o),e.closePath();break;case"crossRot":v+=Av;case"cross":h=Math.cos(v)*(a?a/2:m),o=Math.cos(v)*m,s=Math.sin(v)*m,d=Math.sin(v)*(a?a/2:m),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"star":h=Math.cos(v)*(a?a/2:m),o=Math.cos(v)*m,s=Math.sin(v)*m,d=Math.sin(v)*(a?a/2:m),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o),v+=Av,h=Math.cos(v)*(a?a/2:m),o=Math.cos(v)*m,s=Math.sin(v)*m,d=Math.sin(v)*(a?a/2:m),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"line":o=a?a/2:Math.cos(v)*m,s=Math.sin(v)*m,e.moveTo(n-o,r-s),e.lineTo(n+o,r+s);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(v)*(a?a/2:m),r+Math.sin(v)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function Og(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Dg(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Pg(e){e.restore()}function Mg(e,t,n,r,a){if(!t)return e.lineTo(n.x,n.y);if("middle"===a){var i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===a!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Lg(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Fg(e,t,n,r,a){if(a.strikethrough||a.underline){var i=e.measureText(r),o=t-i.actualBoundingBoxLeft,s=t+i.actualBoundingBoxRight,u=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,l=a.strikethrough?(u+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(o,l),e.lineTo(s,l),e.stroke()}}function zg(e,t){var n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Bg(e,t,n,r,a){var i,o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=rv(t)?t:[t],c=s.strokeWidth>0&&""!==s.strokeColor;for(e.save(),e.font=a.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),nv(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),i=0;i<u.length;++i)o=u[i],s.backdrop&&zg(e,s.backdrop),c&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),nv(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(o,n,r,s.maxWidth)),e.fillText(o,n,r,s.maxWidth),Fg(e,n,r,o,s),r+=Number(a.lineHeight);e.restore()}function Vg(e,t){var n=t.x,r=t.y,a=t.w,i=t.h,o=t.radius;e.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*Iv,Iv,!0),e.lineTo(n,r+i-o.bottomLeft),e.arc(n+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,Iv,Rv,!0),e.lineTo(n+a-o.bottomRight,r+i),e.arc(n+a-o.bottomRight,r+i-o.bottomRight,o.bottomRight,Rv,0,!0),e.lineTo(n+a,r+o.topRight),e.arc(n+a-o.topRight,r+o.topRight,o.topRight,0,-Rv,!0),e.lineTo(n+o.topLeft,r)}var Ug=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Wg=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function jg(e,t){var n=(""+e).match(Ug);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}var Gg=function(e){return+e||0};function Hg(e,t){var n,r={},a=av(t),i=a?Object.keys(t):t,o=av(e)?a?function(n){return sv(e[n],e[t[n]])}:function(t){return e[t]}:function(){return e},s=ye(i);try{for(s.s();!(n=s.n()).done;){var u=n.value;r[u]=Gg(o(u))}}catch(c){s.e(c)}finally{s.f()}return r}function Kg(e){return Hg(e,{top:"y",right:"x",bottom:"y",left:"x"})}function qg(e){return Hg(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Zg(e){var t=Kg(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Xg(e,t){e=e||{},t=t||Ig.font;var n=sv(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));var r=sv(e.style,t.style);r&&!(""+r).match(Wg)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);var a={family:sv(e.family,t.family),lineHeight:jg(sv(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:sv(e.weight,t.weight),string:""};return a.string=function(e){return!e||nv(e.size)||nv(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function Yg(e,t,n,r){var a,i,o,s=!0;for(a=0,i=e.length;a<i;++a)if(void 0!==(o=e[a])&&(void 0!==t&&"function"===typeof o&&(o=o(t),s=!1),void 0!==n&&rv(o)&&(o=o[n%o.length],s=!1),void 0!==o))return r&&!s&&(r.cacheable=!1),o}function Qg(e,t){return Object.assign(Object.create(e),t)}function $g(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return e[0]},i=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof r&&(r=cy("_fallback",e));var o=(t={},(0,_.Z)(t,Symbol.toStringTag,"Object"),(0,_.Z)(t,"_cacheable",!0),(0,_.Z)(t,"_scopes",e),(0,_.Z)(t,"_rootScopes",i),(0,_.Z)(t,"_fallback",r),(0,_.Z)(t,"_getTarget",a),(0,_.Z)(t,"override",(function(t){return $g([t].concat((0,ke.Z)(e)),n,i,r)})),t);return new Proxy(o,{deleteProperty:function(t,n){return delete t[n],delete t._keys,delete e[0][n],!0},get:function(t,r){return ry(t,r,(function(){return function(e,t,n,r){var a,i,o=ye(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if("undefined"!==typeof(a=cy(ty(s,e),n)))return ny(e,a)?sy(n,r,e,a):a}}catch(u){o.e(u)}finally{o.f()}}(r,n,e,t)}))},getOwnPropertyDescriptor:function(e,t){return Reflect.getOwnPropertyDescriptor(e._scopes[0],t)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e[0])},has:function(e,t){return ly(e).includes(t)},ownKeys:function(e){return ly(e)},set:function(e,t,n){var r=e._storage||(e._storage=a());return e[t]=r[t]=n,delete e._keys,!0}})}function Jg(e,t,n,r){var a={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:ey(e,r),setContext:function(t){return Jg(e,t,n,r)},override:function(a){return Jg(e.override(a),t,n,r)}};return new Proxy(a,{deleteProperty:function(t,n){return delete t[n],delete e[n],!0},get:function(e,t,n){return ry(e,t,(function(){return function(e,t,n){var r=e._proxy,a=e._context,i=e._subProxy,o=e._descriptors,s=r[t];Sv(s)&&o.isScriptable(t)&&(s=function(e,t,n,r){var a=n._proxy,i=n._context,o=n._subProxy,s=n._stack;if(s.has(e))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+e);s.add(e);var u=t(i,o||r);s.delete(e),ny(e,u)&&(u=sy(a._scopes,a,e,u));return u}(t,s,e,n));rv(s)&&s.length&&(s=function(e,t,n,r){var a=n._proxy,i=n._context,o=n._subProxy,s=n._descriptors;if("undefined"!==typeof i.index&&r(e))return t[i.index%t.length];if(av(t[0])){var u=t,c=a._scopes.filter((function(e){return e!==u}));t=[];var l,h=ye(u);try{for(h.s();!(l=h.n()).done;){var d=sy(c,a,e,l.value);t.push(Jg(d,i,o&&o[e],s))}}catch(f){h.e(f)}finally{h.f()}}return t}(t,s,e,o.isIndexable));ny(t,s)&&(s=Jg(s,a,i&&i[t],o));return s}(e,t,n)}))},getOwnPropertyDescriptor:function(t,n){return t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e)},has:function(t,n){return Reflect.has(e,n)},ownKeys:function(){return Reflect.ownKeys(e)},set:function(t,n,r){return e[n]=r,delete t[n],!0}})}function ey(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0},n=e._scriptable,r=void 0===n?t.scriptable:n,a=e._indexable,i=void 0===a?t.indexable:a,o=e._allKeys;return{allKeys:void 0===o?t.allKeys:o,scriptable:r,indexable:i,isScriptable:Sv(r)?r:function(){return r},isIndexable:Sv(i)?i:function(){return i}}}var ty=function(e,t){return e?e+wv(t):t},ny=function(e,t){return av(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object)};function ry(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];var r=n();return e[t]=r,r}function ay(e,t,n){return Sv(e)?e(t,n):e}var iy=function(e,t){return!0===e?t:"string"===typeof e?xv(t,e):void 0};function oy(e,t,n,r,a){var i,o=ye(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=iy(n,s);if(u){e.add(u);var c=ay(u._fallback,n,a);if("undefined"!==typeof c&&c!==n&&c!==r)return c}else if(!1===u&&"undefined"!==typeof r&&n!==r)return null}}catch(l){o.e(l)}finally{o.f()}return!1}function sy(e,t,n,r){var a=t._rootScopes,i=ay(t._fallback,n,r),o=[].concat((0,ke.Z)(e),(0,ke.Z)(a)),s=new Set;s.add(r);var u=uy(s,o,n,i||n,r);return null!==u&&(("undefined"===typeof i||i===n||null!==(u=uy(s,o,i,u,r)))&&$g(Array.from(s),[""],a,i,(function(){return function(e,t,n){var r=e._getTarget();t in r||(r[t]={});var a=r[t];if(rv(a)&&av(n))return n;return a||{}}(t,n,r)})))}function uy(e,t,n,r,a){for(;n;)n=oy(e,t,n,r,a);return n}function cy(e,t){var n,r=ye(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a){var i=a[e];if("undefined"!==typeof i)return i}}}catch(o){r.e(o)}finally{r.f()}}function ly(e){var t=e._keys;return t||(t=e._keys=function(e){var t,n=new Set,r=ye(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=ye(Object.keys(i).filter((function(e){return!e.startsWith("_")})));try{for(o.s();!(a=o.n()).done;){var s=a.value;n.add(s)}}catch(u){o.e(u)}finally{o.f()}}}catch(u){r.e(u)}finally{r.f()}return Array.from(n)}(e._scopes)),t}function hy(e,t,n,r){var a,i,o,s,u=e.iScale,c=this._parsing.key,l=void 0===c?"r":c,h=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],h[a]={r:u.parse(xv(s,l),o)};return h}var dy=Number.EPSILON||1e-14,fy=function(e,t){return t<e.length&&!e[t].skip&&e[t]},py=function(e){return"x"===e?"y":"x"};function my(e,t,n,r){var a=e.skip?t:e,i=t,o=n.skip?t:n,s=jv(i,a),u=jv(o,i),c=s/(s+u),l=u/(s+u),h=r*(c=isNaN(c)?0:c),d=r*(l=isNaN(l)?0:l);return{previous:{x:i.x-h*(o.x-a.x),y:i.y-h*(o.y-a.y)},next:{x:i.x+d*(o.x-a.x),y:i.y+d*(o.y-a.y)}}}function vy(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",i=py(a),o=e.length,s=Array(o).fill(0),u=Array(o),c=fy(e,0);for(t=0;t<o;++t)if(n=r,r=c,c=fy(e,t+1),r){if(c){var l=c[a]-r[a];s[t]=0!==l?(c[i]-r[i])/l:0}u[t]=n?c?Pv(s[t-1])!==Pv(s[t])?0:(s[t-1]+s[t])/2:s[t-1]:s[t]}!function(e,t,n){for(var r,a,i,o,s,u=e.length,c=fy(e,0),l=0;l<u-1;++l)s=c,c=fy(e,l+1),s&&c&&(Mv(t[l],0,dy)?n[l]=n[l+1]=0:(r=n[l]/t[l],a=n[l+1]/t[l],(o=Math.pow(r,2)+Math.pow(a,2))<=9||(i=3/Math.sqrt(o),n[l]=r*i*t[l],n[l+1]=a*i*t[l])))}(e,s,u),function(e,t){for(var n,r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",o=py(i),s=e.length,u=fy(e,0),c=0;c<s;++c)if(r=a,a=u,u=fy(e,c+1),a){var l=a[i],h=a[o];r&&(n=(l-r[i])/3,a["cp1".concat(i)]=l-n,a["cp1".concat(o)]=h-n*t[c]),u&&(n=(u[i]-l)/3,a["cp2".concat(i)]=l+n,a["cp2".concat(o)]=h+n*t[c])}}(e,u,a)}function gy(e,t,n){return Math.max(Math.min(e,n),t)}function yy(e,t,n,r,a){var i,o,s,u;if(t.spanGaps&&(e=e.filter((function(e){return!e.skip}))),"monotone"===t.cubicInterpolationMode)vy(e,a);else{var c=r?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)u=my(c,s=e[i],e[Math.min(i+1,o-(r?0:1))%o],t.tension),s.cp1x=u.previous.x,s.cp1y=u.previous.y,s.cp2x=u.next.x,s.cp2y=u.next.y,c=s}t.capBezierPoints&&function(e,t){var n,r,a,i,o,s=Og(e[0],t);for(n=0,r=e.length;n<r;++n)o=i,i=s,s=n<r-1&&Og(e[n+1],t),i&&(a=e[n],o&&(a.cp1x=gy(a.cp1x,t.left,t.right),a.cp1y=gy(a.cp1y,t.top,t.bottom)),s&&(a.cp2x=gy(a.cp2x,t.left,t.right),a.cp2y=gy(a.cp2y,t.top,t.bottom)))}(e,n)}function by(){return"undefined"!==typeof window&&"undefined"!==typeof document}function xy(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function wy(e,t,n){var r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}var ky=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};var Sy=["top","right","bottom","left"];function Cy(e,t,n){var r={};n=n?"-"+n:"";for(var a=0;a<4;a++){var i=Sy[a];r[i]=parseFloat(e[t+"-"+i+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}var Iy=function(e,t,n){return(e>0||t>0)&&(!n||!n.shadowRoot)};function Ty(e,t){if("native"in e)return e;var n=t.canvas,r=t.currentDevicePixelRatio,a=ky(n),i="border-box"===a.boxSizing,o=Cy(a,"padding"),s=Cy(a,"border","width"),u=function(e,t){var n,r,a=e.touches,i=a&&a.length?a[0]:e,o=i.offsetX,s=i.offsetY,u=!1;if(Iy(o,s,e.target))n=o,r=s;else{var c=t.getBoundingClientRect();n=i.clientX-c.left,r=i.clientY-c.top,u=!0}return{x:n,y:r,box:u}}(e,n),c=u.x,l=u.y,h=u.box,d=o.left+(h&&s.left),f=o.top+(h&&s.top),p=t.width,m=t.height;return i&&(p-=o.width+s.width,m-=o.height+s.height),{x:Math.round((c-d)/p*n.width/r),y:Math.round((l-f)/m*n.height/r)}}var _y=function(e){return Math.round(10*e)/10};function Ey(e,t,n,r){var a=ky(e),i=Cy(a,"margin"),o=wy(a.maxWidth,e,"clientWidth")||Ev,s=wy(a.maxHeight,e,"clientHeight")||Ev,u=function(e,t,n){var r,a;if(void 0===t||void 0===n){var i=xy(e);if(i){var o=i.getBoundingClientRect(),s=ky(i),u=Cy(s,"border","width"),c=Cy(s,"padding");t=o.width-c.width-u.width,n=o.height-c.height-u.height,r=wy(s.maxWidth,i,"clientWidth"),a=wy(s.maxHeight,i,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||Ev,maxHeight:a||Ev}}(e,t,n),c=u.width,l=u.height;if("content-box"===a.boxSizing){var h=Cy(a,"border","width"),d=Cy(a,"padding");c-=d.width+h.width,l-=d.height+h.height}return c=Math.max(0,c-i.width),l=Math.max(0,r?c/r:l-i.height),c=_y(Math.min(c,o,u.maxWidth)),l=_y(Math.min(l,s,u.maxHeight)),c&&!l&&(l=_y(c/2)),(void 0!==t||void 0!==n)&&r&&u.height&&l>u.height&&(l=u.height,c=_y(Math.floor(l*r))),{width:c,height:l}}function Ny(e,t,n){var r=t||1,a=Math.floor(e.height*r),i=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);var o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height="".concat(e.height,"px"),o.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==r||o.height!==a||o.width!==i)&&(e.currentDevicePixelRatio=r,o.height=a,o.width=i,e.ctx.setTransform(r,0,0,r,0,0),!0)}var Ry=function(){var e=!1;try{var t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(n){}return e}();function Ay(e,t){var n=function(e,t){return ky(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Oy(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Dy(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function Py(e,t,n,r){var a={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=Oy(e,a,n),s=Oy(a,i,n),u=Oy(i,t,n),c=Oy(o,s,n),l=Oy(s,u,n);return Oy(c,l,n)}function My(e,t,n){return e?function(e,t){return{x:function(n){return e+e+t-n},setWidth:function(e){t=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}}(t,n):{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}}function Ly(e,t){var n,r;"ltr"!==t&&"rtl"!==t||(r=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function Fy(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function zy(e){return"angle"===e?{between:Kv,compare:Gv,normalize:Hv}:{between:Zv,compare:function(e,t){return e-t},normalize:function(e){return e}}}function By(e){var t=e.start,n=e.end,r=e.count;return{start:t%r,end:n%r,loop:e.loop&&(n-t+1)%r===0,style:e.style}}function Vy(e,t,n){if(!n)return[e];for(var r,a,i,o=n.property,s=n.start,u=n.end,c=t.length,l=zy(o),h=l.compare,d=l.between,f=l.normalize,p=function(e,t,n){var r,a,i=n.property,o=n.start,s=n.end,u=zy(i),c=u.between,l=u.normalize,h=t.length,d=e.start,f=e.end,p=e.loop;if(p){for(d+=h,f+=h,r=0,a=h;r<a&&c(l(t[d%h][i]),o,s);++r)d--,f--;d%=h,f%=h}return f<d&&(f+=h),{start:d,end:f,loop:p,style:e.style}}(e,t,n),m=p.start,v=p.end,g=p.loop,y=p.style,b=[],x=!1,w=null,k=function(){return x||d(s,i,r)&&0!==h(s,i)},S=function(){return!x||0===h(u,r)||d(u,i,r)},C=m,I=m;C<=v;++C)(a=t[C%c]).skip||(r=f(a[o]))!==i&&(x=d(r,s,u),null===w&&k()&&(w=0===h(r,s)?C:I),null!==w&&S()&&(b.push(By({start:w,end:C,loop:g,count:c,style:y})),w=null),I=C,i=r);return null!==w&&b.push(By({start:w,end:v,loop:g,count:c,style:y})),b}function Uy(e,t){for(var n=[],r=e.segments,a=0;a<r.length;a++){var i=Vy(r[a],e.points,t);i.length&&n.push.apply(n,(0,ke.Z)(i))}return n}function Wy(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){var a=e._chart.getContext(),i=jy(e.options),o=e._datasetIndex,s=e.options.spanGaps,u=n.length,c=[],l=i,h=t[0].start,d=h;function f(e,t,r,a){var i=s?-1:1;if(e!==t){for(e+=u;n[e%u].skip;)e-=i;for(;n[t%u].skip;)t+=i;e%u!==t%u&&(c.push({start:e%u,end:t%u,loop:r,style:a}),l=a,h=t%u)}}var p,m=ye(t);try{for(m.s();!(p=m.n()).done;){var v=p.value;h=s?h:v.start;var g=n[h%u],y=void 0;for(d=h+1;d<=v.end;d++){var b=n[d%u];Gy(y=jy(r.setContext(Qg(a,{type:"segment",p0:g,p1:b,p0DataIndex:(d-1)%u,p1DataIndex:d%u,datasetIndex:o}))),l)&&f(h,d-1,v.loop,l),g=b,l=y}h<d-1&&f(h,d-1,v.loop,l)}}catch(x){m.e(x)}finally{m.f()}return c}(e,t,n,r):t}function jy(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Gy(e,t){if(!t)return!1;var n=[],r=function(e,t){return hg(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}var Hy=function(){function e(){Se(this,e),this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}return Te(e,[{key:"_notify",value:function(e,t,n,r){var a=t.listeners[r],i=t.duration;a.forEach((function(r){return r({chart:e,initial:t.initial,numSteps:i,currentStep:Math.min(n-t.start,i)})}))}},{key:"_refresh",value:function(){var e=this;this._request||(this._running=!0,this._request=tg.call(window,(function(){e._update(),e._request=null,e._running&&e._refresh()})))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=0;this._charts.forEach((function(r,a){if(r.running&&r.items.length){for(var i,o=r.items,s=o.length-1,u=!1;s>=0;--s)(i=o[s])._active?(i._total>r.duration&&(r.duration=i._total),i.tick(t),u=!0):(o[s]=o[o.length-1],o.pop());u&&(a.draw(),e._notify(a,r,t,"progress")),o.length||(r.running=!1,e._notify(a,r,t,"complete"),r.initial=!1),n+=o.length}})),this._lastDate=t,0===n&&(this._running=!1)}},{key:"_getAnims",value:function(e){var t=this._charts,n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}},{key:"listen",value:function(e,t,n){this._getAnims(e).listeners[t].push(n)}},{key:"add",value:function(e,t){var n;t&&t.length&&(n=this._getAnims(e).items).push.apply(n,(0,ke.Z)(t))}},{key:"has",value:function(e){return this._getAnims(e).items.length>0}},{key:"start",value:function(e){var t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((function(e,t){return Math.max(e,t._duration)}),0),this._refresh())}},{key:"running",value:function(e){if(!this._running)return!1;var t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}},{key:"stop",value:function(e){var t=this._charts.get(e);if(t&&t.items.length){for(var n=t.items,r=n.length-1;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}}},{key:"remove",value:function(e){return this._charts.delete(e)}}]),e}(),Ky=new Hy,qy="transparent",Zy={boolean:function(e,t,n){return n>.5?t:e},color:function(e,t,n){var r=dg(e||qy),a=r.valid&&dg(t||qy);return a&&a.valid?a.mix(r,n).hexString():t},number:function(e,t,n){return e+(t-e)*n}},Xy=function(){function e(t,n,r,a){Se(this,e);var i=n[r];a=Yg([t.to,a,i,t.from]);var o=Yg([t.from,i,a]);this._active=!0,this._fn=t.fn||Zy[t.type||typeof o],this._easing=lg[t.easing]||lg.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=r,this._from=o,this._to=a,this._promises=void 0}return Te(e,[{key:"active",value:function(){return this._active}},{key:"update",value:function(e,t,n){if(this._active){this._notify(!1);var r=this._target[this._prop],a=n-this._start,i=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Yg([e.to,t,r,e.from]),this._from=Yg([e.from,r,t])}}},{key:"cancel",value:function(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}},{key:"tick",value:function(e){var t,n=e-this._start,r=this._duration,a=this._prop,i=this._from,o=this._loop,s=this._to;if(this._active=i!==s&&(o||n<r),!this._active)return this._target[a]=s,void this._notify(!0);n<0?this._target[a]=i:(t=n/r%2,t=o&&t>1?2-t:t,t=this._easing(Math.min(1,Math.max(0,t))),this._target[a]=this._fn(i,s,t))}},{key:"wait",value:function(){var e=this._promises||(this._promises=[]);return new Promise((function(t,n){e.push({res:t,rej:n})}))}},{key:"_notify",value:function(e){for(var t=e?"res":"rej",n=this._promises||[],r=0;r<n.length;r++)n[r][t]()}}]),e}(),Yy=function(){function e(t,n){Se(this,e),this._chart=t,this._properties=new Map,this.configure(n)}return Te(e,[{key:"configure",value:function(e){if(av(e)){var t=Object.keys(Ig.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((function(r){var a=e[r];if(av(a)){for(var i={},o=0,s=t;o<s.length;o++){var u=s[o];i[u]=a[u]}(rv(a.properties)&&a.properties||[r]).forEach((function(e){e!==r&&n.has(e)||n.set(e,i)}))}}))}}},{key:"_animateOptions",value:function(e,t){var n=t.options,r=function(e,t){if(!t)return;var n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];var a=this._createAnimations(r,n);return n.$shared&&function(e,t){for(var n=[],r=Object.keys(t),a=0;a<r.length;a++){var i=e[r[a]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}(e.options.$animations,n).then((function(){e.options=n}),(function(){})),a}},{key:"_createAnimations",value:function(e,t){var n,r=this._properties,a=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),s=Date.now();for(n=o.length-1;n>=0;--n){var u=o[n];if("$"!==u.charAt(0))if("options"!==u){var c=t[u],l=i[u],h=r.get(u);if(l){if(h&&l.active()){l.update(h,c,s);continue}l.cancel()}h&&h.duration?(i[u]=l=new Xy(h,e,u,c),a.push(l)):e[u]=c}else a.push.apply(a,(0,ke.Z)(this._animateOptions(e,t)))}return a}},{key:"update",value:function(e,t){if(0!==this._properties.size){var n=this._createAnimations(e,t);return n.length?(Ky.add(this._chart,n),!0):void 0}Object.assign(e,t)}}]),e}();function Qy(e,t){var n=e&&e.options||{},r=n.reverse,a=void 0===n.min?t:0,i=void 0===n.max?t:0;return{start:r?i:a,end:r?a:i}}function $y(e,t){var n,r,a=[],i=e._getSortedDatasetMetas(t);for(n=0,r=i.length;n<r;++n)a.push(i[n].index);return a}function Jy(e,t,n){var r,a,i,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=e.keys,c="single"===s.mode;if(null!==t){for(r=0,a=u.length;r<a;++r){if((i=+u[r])===n){if(s.all)continue;break}iv(o=e.values[i])&&(c||0===t||Pv(t)===Pv(o))&&(t+=o)}return t}}function eb(e,t){var n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function tb(e,t,n){var r=e[t]||(e[t]={});return r[n]||(r[n]={})}function nb(e,t,n,r){var a,i=ye(t.getMatchingVisibleMetas(r).reverse());try{for(i.s();!(a=i.n()).done;){var o=a.value,s=e[o.index];if(n&&s>0||!n&&s<0)return o.index}}catch(u){i.e(u)}finally{i.f()}return null}function rb(e,t){for(var n,r=e.chart,a=e._cachedMeta,i=r._stacks||(r._stacks={}),o=a.iScale,s=a.vScale,u=a.index,c=o.axis,l=s.axis,h=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(o,s,a),d=t.length,f=0;f<d;++f){var p=t[f],m=p[c],v=p[l];(n=(p._stacks||(p._stacks={}))[l]=tb(i,h,m))[u]=v,n._top=nb(n,s,!0,a.type),n._bottom=nb(n,s,!1,a.type),(n._visualValues||(n._visualValues={}))[u]=v}}function ab(e,t){var n=e.scales;return Object.keys(n).filter((function(e){return n[e].axis===t})).shift()}function ib(e,t){var n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){var a,i=ye(t=t||e._parsed);try{for(i.s();!(a=i.n()).done;){var o=a.value._stacks;if(!o||void 0===o[r]||void 0===o[r][n])return;delete o[r][n],void 0!==o[r]._visualValues&&void 0!==o[r]._visualValues[n]&&delete o[r]._visualValues[n]}}catch(s){i.e(s)}finally{i.f()}}}var ob=function(e){return"reset"===e||"none"===e},sb=function(e,t){return t?e:Object.assign({},e)},ub=function(){function e(t,n){Se(this,e),this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=(this instanceof e?this.constructor:void 0).datasetElementType,this.dataElementType=(this instanceof e?this.constructor:void 0).dataElementType,this.initialize()}return Te(e,[{key:"initialize",value:function(){var e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=eb(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}},{key:"updateIndex",value:function(e){this.index!==e&&ib(this._cachedMeta),this.index=e}},{key:"linkScales",value:function(){var e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=function(e,t,n,r){return"x"===e?t:"r"===e?r:n},a=t.xAxisID=sv(n.xAxisID,ab(e,"x")),i=t.yAxisID=sv(n.yAxisID,ab(e,"y")),o=t.rAxisID=sv(n.rAxisID,ab(e,"r")),s=t.indexAxis,u=t.iAxisID=r(s,a,i,o),c=t.vAxisID=r(s,i,a,o);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(i),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(u),t.vScale=this.getScaleForId(c)}},{key:"getDataset",value:function(){return this.chart.data.datasets[this.index]}},{key:"getMeta",value:function(){return this.chart.getDatasetMeta(this.index)}},{key:"getScaleForId",value:function(e){return this.chart.scales[e]}},{key:"_getOtherScale",value:function(e){var t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}},{key:"reset",value:function(){this._update("reset")}},{key:"_destroy",value:function(){var e=this._cachedMeta;this._data&&Jv(this._data,this),e._stacked&&ib(e)}},{key:"_dataCheck",value:function(){var e,t,n=this.getDataset(),r=n.data||(n.data=[]),a=this._data;if(av(r))this._data=function(e){var t,n,r,a=Object.keys(e),i=new Array(a.length);for(t=0,n=a.length;t<n;++t)r=a[t],i[t]={x:r,y:e[r]};return i}(r);else if(a!==r){if(a){Jv(a,this);var i=this._cachedMeta;ib(i),i._parsed=[]}r&&Object.isExtensible(r)&&(t=this,(e=r)._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),$v.forEach((function(t){var n="_onData"+wv(t),r=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var o=r.apply(this,a);return e._chartjs.listeners.forEach((function(e){"function"===typeof e[n]&&e[n].apply(e,a)})),o}})})))),this._syncList=[],this._data=r}}},{key:"addElements",value:function(){var e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}},{key:"buildOrUpdateElements",value:function(e){var t=this._cachedMeta,n=this.getDataset(),r=!1;this._dataCheck();var a=t._stacked;t._stacked=eb(t.vScale,t),t.stack!==n.stack&&(r=!0,ib(t),t.stack=n.stack),this._resyncElements(e),(r||a!==t._stacked)&&rb(this,t._parsed)}},{key:"configure",value:function(){var e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}},{key:"parse",value:function(e,t){var n,r,a,i=this._cachedMeta,o=this._data,s=i.iScale,u=i._stacked,c=s.axis,l=0===e&&t===o.length||i._sorted,h=e>0&&i._parsed[e-1];if(!1===this._parsing)i._parsed=o,i._sorted=!0,a=o;else{a=rv(o[e])?this.parseArrayData(i,o,e,t):av(o[e])?this.parseObjectData(i,o,e,t):this.parsePrimitiveData(i,o,e,t);for(n=0;n<t;++n)i._parsed[n+e]=r=a[n],l&&((null===r[c]||h&&r[c]<h[c])&&(l=!1),h=r);i._sorted=l}u&&rb(this,a)}},{key:"parsePrimitiveData",value:function(e,t,n,r){var a,i,o,s=e.iScale,u=e.vScale,c=s.axis,l=u.axis,h=s.getLabels(),d=s===u,f=new Array(r);for(a=0,i=r;a<i;++a){var p;o=a+n,f[a]=(p={},(0,_.Z)(p,c,d||s.parse(h[o],o)),(0,_.Z)(p,l,u.parse(t[o],o)),p)}return f}},{key:"parseArrayData",value:function(e,t,n,r){var a,i,o,s,u=e.xScale,c=e.yScale,l=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],l[a]={x:u.parse(s[0],o),y:c.parse(s[1],o)};return l}},{key:"parseObjectData",value:function(e,t,n,r){var a,i,o,s,u=e.xScale,c=e.yScale,l=this._parsing,h=l.xAxisKey,d=void 0===h?"x":h,f=l.yAxisKey,p=void 0===f?"y":f,m=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],m[a]={x:u.parse(xv(s,d),o),y:c.parse(xv(s,p),o)};return m}},{key:"getParsed",value:function(e){return this._cachedMeta._parsed[e]}},{key:"getDataElement",value:function(e){return this._cachedMeta.data[e]}},{key:"applyStack",value:function(e,t,n){var r=this.chart,a=this._cachedMeta,i=t[e.axis];return Jy({keys:$y(r,!0),values:t._stacks[e.axis]._visualValues},i,a.index,{mode:n})}},{key:"updateRangeFromParsed",value:function(e,t,n,r){var a=n[t.axis],i=null===a?NaN:a,o=r&&n._stacks[t.axis];r&&o&&(r.values=o,i=Jy(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}},{key:"getMinMax",value:function(e,t){var n,r,a=this._cachedMeta,i=a._parsed,o=a._sorted&&e===a.iScale,s=i.length,u=this._getOtherScale(e),c=function(e,t,n){return e&&!t.hidden&&t._stacked&&{keys:$y(n,!0),values:null}}(t,a,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},h=function(e){var t=e.getUserBounds(),n=t.min,r=t.max,a=t.minDefined,i=t.maxDefined;return{min:a?n:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}(u),d=h.min,f=h.max;function p(){var t=(r=i[n])[u.axis];return!iv(r[e.axis])||d>t||f<t}for(n=0;n<s&&(p()||(this.updateRangeFromParsed(l,e,r,c),!o));++n);if(o)for(n=s-1;n>=0;--n)if(!p()){this.updateRangeFromParsed(l,e,r,c);break}return l}},{key:"getAllParsedValues",value:function(e){var t,n,r,a=this._cachedMeta._parsed,i=[];for(t=0,n=a.length;t<n;++t)iv(r=a[t][e.axis])&&i.push(r);return i}},{key:"getMaxOverflow",value:function(){return!1}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}},{key:"_update",value:function(e){var t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){var t,n,r,a;return av(e)?(t=e.top,n=e.right,r=e.bottom,a=e.left):t=n=r=a=e,{top:t,right:n,bottom:r,left:a,disabled:!1===e}}(sv(this.options.clip,function(e,t,n){if(!1===n)return!1;var r=Qy(e,n),a=Qy(t,n);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}},{key:"update",value:function(e){}},{key:"draw",value:function(){var e,t=this._ctx,n=this.chart,r=this._cachedMeta,a=r.data||[],i=n.chartArea,o=[],s=this._drawStart||0,u=this._drawCount||a.length-s,c=this.options.drawActiveElementsOnTop;for(r.dataset&&r.dataset.draw(t,i,s,u),e=s;e<s+u;++e){var l=a[e];l.hidden||(l.active&&c?o.push(l):l.draw(t,i))}for(e=0;e<o.length;++e)o[e].draw(t,i)}},{key:"getStyle",value:function(e,t){var n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}},{key:"getContext",value:function(e,t,n){var r,a=this.getDataset();if(e>=0&&e<this._cachedMeta.data.length){var i=this._cachedMeta.data[e];r=i.$context||(i.$context=function(e,t,n){return Qg(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,i)),r.parsed=this.getParsed(e),r.raw=a.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return Qg(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=a,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}},{key:"resolveDatasetElementOptions",value:function(e){return this._resolveElementOptions(this.datasetElementType.id,e)}},{key:"resolveDataElementOptions",value:function(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}},{key:"_resolveElementOptions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,a="active"===n,i=this._cachedDataOpts,o=e+"-"+n,s=i[o],u=this.enableOptionSharing&&kv(r);if(s)return sb(s,u);var c=this.chart.config,l=c.datasetElementScopeKeys(this._type,e),h=a?["".concat(e,"Hover"),"hover",e,""]:[e,""],d=c.getOptionScopes(this.getDataset(),l),f=Object.keys(Ig.elements[e]),p=c.resolveNamedOptions(d,f,(function(){return t.getContext(r,a,n)}),h);return p.$shared&&(p.$shared=u,i[o]=Object.freeze(sb(p,u))),p}},{key:"_resolveAnimations",value:function(e,t,n){var r,a=this.chart,i=this._cachedDataOpts,o="animation-".concat(t),s=i[o];if(s)return s;if(!1!==a.options.animation){var u=this.chart.config,c=u.datasetAnimationScopeKeys(this._type,t),l=u.getOptionScopes(this.getDataset(),c);r=u.createResolver(l,this.getContext(e,n,t))}var h=new Yy(a,r&&r.animations);return r&&r._cacheable&&(i[o]=Object.freeze(h)),h}},{key:"getSharedOptions",value:function(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}},{key:"includeOptions",value:function(e,t){return!t||ob(e)||this.chart._animationsDisabled}},{key:"_getSharedOptions",value:function(e,t){var n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,a=this.getSharedOptions(n),i=this.includeOptions(t,a)||a!==r;return this.updateSharedOptions(a,t,n),{sharedOptions:a,includeOptions:i}}},{key:"updateElement",value:function(e,t,n,r){ob(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}},{key:"updateSharedOptions",value:function(e,t,n){e&&!ob(t)&&this._resolveAnimations(void 0,t).update(e,n)}},{key:"_setStyle",value:function(e,t,n,r){e.active=r;var a=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}},{key:"removeHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!1)}},{key:"setHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!0)}},{key:"_removeDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}},{key:"_setDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}},{key:"_resyncElements",value:function(e){var t,n=this._data,r=this._cachedMeta.data,a=ye(this._syncList);try{for(a.s();!(t=a.n()).done;){var i=(0,U.Z)(t.value,3),o=i[0],s=i[1],u=i[2];this[o](s,u)}}catch(d){a.e(d)}finally{a.f()}this._syncList=[];var c=r.length,l=n.length,h=Math.min(l,c);h&&this.parse(0,h),l>c?this._insertElements(c,l-c,e):l<c&&this._removeElements(l,c-l)}},{key:"_insertElements",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this._cachedMeta,i=a.data,o=e+t,s=function(e){for(e.length+=t,n=e.length-1;n>=o;n--)e[n]=e[n-t]};for(s(i),n=e;n<o;++n)i[n]=new this.dataElementType;this._parsing&&s(a._parsed),this.parse(e,t),r&&this.updateElements(i,e,t,"reset")}},{key:"updateElements",value:function(e,t,n,r){}},{key:"_removeElements",value:function(e,t){var n=this._cachedMeta;if(this._parsing){var r=n._parsed.splice(e,t);n._stacked&&ib(n,r)}n.data.splice(e,t)}},{key:"_sync",value:function(e){if(this._parsing)this._syncList.push(e);else{var t=(0,U.Z)(e,3),n=t[0],r=t[1],a=t[2];this[n](r,a)}this.chart._dataChanges.push([this.index].concat((0,ke.Z)(e)))}},{key:"_onDataPush",value:function(){var e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}},{key:"_onDataPop",value:function(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}},{key:"_onDataShift",value:function(){this._sync(["_removeElements",0,1])}},{key:"_onDataSplice",value:function(e,t){t&&this._sync(["_removeElements",e,t]);var n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}},{key:"_onDataUnshift",value:function(){this._sync(["_insertElements",0,arguments.length])}}]),e}();function cb(e){var t,n,r,a,i=e.iScale,o=function(e,t){if(!e._cache.$bar){for(var n=e.getMatchingVisibleMetas(t),r=[],a=0,i=n.length;a<i;a++)r=r.concat(n[a].controller.getAllParsedValues(e));e._cache.$bar=eg(r.sort((function(e,t){return e-t})))}return e._cache.$bar}(i,e.type),s=i._length,u=function(){32767!==r&&-32768!==r&&(kv(a)&&(s=Math.min(s,Math.abs(r-a)||s)),a=r)};for(t=0,n=o.length;t<n;++t)r=i.getPixelForValue(o[t]),u();for(a=void 0,t=0,n=i.ticks.length;t<n;++t)r=i.getPixelForTick(t),u();return s}function lb(e,t,n,r){return rv(e)?function(e,t,n,r){var a=n.parse(e[0],r),i=n.parse(e[1],r),o=Math.min(a,i),s=Math.max(a,i),u=o,c=s;Math.abs(o)>Math.abs(s)&&(u=s,c=o),t[n.axis]=c,t._custom={barStart:u,barEnd:c,start:a,end:i,min:o,max:s}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function hb(e,t,n,r){var a,i,o,s,u=e.iScale,c=e.vScale,l=u.getLabels(),h=u===c,d=[];for(a=n,i=n+r;a<i;++a)s=t[a],(o={})[u.axis]=h||u.parse(l[a],a),d.push(lb(s,o,c,a));return d}function db(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function fb(e,t,n,r){var a=t.borderSkipped,i={};if(a)if(!0!==a){var o=function(e){var t,n,r,a,i;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(a="end",i="start"):(a="start",i="end"),{start:n,end:r,reverse:t,top:a,bottom:i}}(e),s=o.start,u=o.end,c=o.reverse,l=o.top,h=o.bottom;"middle"===a&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?a=l:(n._bottom||0)===r?a=h:(i[pb(h,s,u,c)]=!0,a=l)),i[pb(a,s,u,c)]=!0,e.borderSkipped=i}else e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};else e.borderSkipped=i}function pb(e,t,n,r){var a,i,o;return r?(o=n,e=mb(e=(a=e)===(i=t)?o:a===o?i:a,n,t)):e=mb(e,t,n),e}function mb(e,t,n){return"start"===e?t:"end"===e?n:e}function vb(e,t,n){var r=t.inflateAmount;e.inflateAmount="auto"===r?1===n?.33:0:r}(0,_.Z)(ub,"defaults",{}),(0,_.Z)(ub,"datasetElementType",null),(0,_.Z)(ub,"dataElementType",null);var gb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"parsePrimitiveData",value:function(e,t,n,r){return hb(e,t,n,r)}},{key:"parseArrayData",value:function(e,t,n,r){return hb(e,t,n,r)}},{key:"parseObjectData",value:function(e,t,n,r){var a,i,o,s,u=e.iScale,c=e.vScale,l=this._parsing,h=l.xAxisKey,d=void 0===h?"x":h,f=l.yAxisKey,p=void 0===f?"y":f,m="x"===u.axis?d:p,v="x"===c.axis?d:p,g=[];for(a=n,i=n+r;a<i;++a)s=t[a],(o={})[u.axis]=u.parse(xv(s,m),a),g.push(lb(xv(s,v),o,c,a));return g}},{key:"updateRangeFromParsed",value:function(e,t,r,a){me(pe(n.prototype),"updateRangeFromParsed",this).call(this,e,t,r,a);var i=r._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}},{key:"getMaxOverflow",value:function(){return 0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e),i=a._custom,o=db(i)?"["+i.start+", "+i.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:o}}},{key:"initialize",value:function(){this.enableOptionSharing=!0,me(pe(n.prototype),"initialize",this).call(this),this._cachedMeta.stack=this.getDataset().stack}},{key:"update",value:function(e){var t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this.index,o=this._cachedMeta.vScale,s=o.getBasePixel(),u=o.isHorizontal(),c=this._getRuler(),l=this._getSharedOptions(t,r),h=l.sharedOptions,d=l.includeOptions,f=t;f<t+n;f++){var p=this.getParsed(f),m=a||nv(p[o.axis])?{base:s,head:s}:this._calculateBarValuePixels(f),v=this._calculateBarIndexPixels(f,c),g=(p._stacks||{})[o.axis],y={horizontal:u,base:m.base,enableBorderRadius:!g||db(p._custom)||i===g._top||i===g._bottom,x:u?m.head:v.center,y:u?v.center:m.head,height:u?v.size:Math.abs(m.size),width:u?Math.abs(m.size):v.size};d&&(y.options=h||this.resolveDataElementOptions(f,e[f].active?"active":r));var b=y.options||e[f].options;fb(y,b,g,i),vb(y,b,c.ratio),this.updateElement(e[f],f,y,r)}}},{key:"_getStacks",value:function(e,t){var n,r=this._cachedMeta.iScale,a=r.getMatchingVisibleMetas(this._type).filter((function(e){return e.controller.options.grouped})),i=r.options.stacked,o=[],s=function(e){var n=e.controller.getParsed(t),r=n&&n[e.vScale.axis];if(nv(r)||isNaN(r))return!0},u=ye(a);try{for(u.s();!(n=u.n()).done;){var c=n.value;if((void 0===t||!s(c))&&((!1===i||-1===o.indexOf(c.stack)||void 0===i&&void 0===c.stack)&&o.push(c.stack),c.index===e))break}}catch(l){u.e(l)}finally{u.f()}return o.length||o.push(void 0),o}},{key:"_getStackCount",value:function(e){return this._getStacks(void 0,e).length}},{key:"_getStackIndex",value:function(e,t,n){var r=this._getStacks(e,n),a=void 0!==t?r.indexOf(t):-1;return-1===a?r.length-1:a}},{key:"_getRuler",value:function(){var e,t,n=this.options,r=this._cachedMeta,a=r.iScale,i=[];for(e=0,t=r.data.length;e<t;++e)i.push(a.getPixelForValue(this.getParsed(e)[a.axis],e));var o=n.barThickness;return{min:o||cb(r),pixels:i,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:n.grouped,ratio:o?1:n.categoryPercentage*n.barPercentage}}},{key:"_calculateBarValuePixels",value:function(e){var t,n,r=this._cachedMeta,a=r.vScale,i=r._stacked,o=r.index,s=this.options,u=s.base,c=s.minBarLength,l=u||0,h=this.getParsed(e),d=h._custom,f=db(d),p=h[a.axis],m=0,v=i?this.applyStack(a,h,i):p;v!==p&&(m=v-p,v=p),f&&(p=d.barStart,v=d.barEnd-d.barStart,0!==p&&Pv(p)!==Pv(d.barEnd)&&(m=0),m+=p);var g=nv(u)||f?m:u,y=a.getPixelForValue(g);if(n=(t=this.chart.getDataVisibility(e)?a.getPixelForValue(m+v):y)-y,Math.abs(n)<c){n=function(e,t,n){return 0!==e?Pv(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(n,a,l)*c,p===l&&(y-=n/2);var b=a.getPixelForDecimal(0),x=a.getPixelForDecimal(1),w=Math.min(b,x),k=Math.max(b,x);t=(y=Math.max(Math.min(y,k),w))+n,i&&!f&&(h._stacks[a.axis]._visualValues[o]=a.getValueForPixel(t)-a.getValueForPixel(y))}if(y===a.getPixelForValue(l)){var S=Pv(n)*a.getLineWidthForValue(l)/2;y+=S,n-=S}return{size:n,base:y,head:t,center:t+n/2}}},{key:"_calculateBarIndexPixels",value:function(e,t){var n,r,a=t.scale,i=this.options,o=i.skipNull,s=sv(i.maxBarThickness,1/0);if(t.grouped){var u=o?this._getStackCount(e):t.stackCount,c="flex"===i.barThickness?function(e,t,n,r){var a=t.pixels,i=a[e],o=e>0?a[e-1]:null,s=e<a.length-1?a[e+1]:null,u=n.categoryPercentage;null===o&&(o=i-(null===s?t.end-t.start:s-i)),null===s&&(s=i+i-o);var c=i-(i-Math.min(o,s))/2*u;return{chunk:Math.abs(s-o)/2*u/r,ratio:n.barPercentage,start:c}}(e,t,i,u):function(e,t,n,r){var a,i,o=n.barThickness;return nv(o)?(a=t.min*n.categoryPercentage,i=n.barPercentage):(a=o*r,i=1),{chunk:a/r,ratio:i,start:t.pixels[e]-a/2}}(e,t,i,u),l=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0);n=c.start+c.chunk*l+c.chunk/2,r=Math.min(s,c.chunk*c.ratio)}else n=a.getPixelForValue(this.getParsed(e)[a.axis],e),r=Math.min(s,t.min*t.ratio);return{base:n-r/2,head:n+r/2,center:n,size:r}}},{key:"draw",value:function(){for(var e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length,a=0;a<r;++a)null!==this.getParsed(a)[t.axis]&&n[a].draw(this._ctx)}}]),n}(ub);(0,_.Z)(gb,"id","bar"),(0,_.Z)(gb,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,_.Z)(gb,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});var yb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"initialize",value:function(){this.enableOptionSharing=!0,me(pe(n.prototype),"initialize",this).call(this)}},{key:"parsePrimitiveData",value:function(e,t,r,a){for(var i=me(pe(n.prototype),"parsePrimitiveData",this).call(this,e,t,r,a),o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+r).radius;return i}},{key:"parseArrayData",value:function(e,t,r,a){for(var i=me(pe(n.prototype),"parseArrayData",this).call(this,e,t,r,a),o=0;o<i.length;o++){var s=t[r+o];i[o]._custom=sv(s[2],this.resolveDataElementOptions(o+r).radius)}return i}},{key:"parseObjectData",value:function(e,t,r,a){for(var i=me(pe(n.prototype),"parseObjectData",this).call(this,e,t,r,a),o=0;o<i.length;o++){var s=t[r+o];i[o]._custom=sv(s&&s.r&&+s.r,this.resolveDataElementOptions(o+r).radius)}return i}},{key:"getMaxOverflow",value:function(){for(var e=this._cachedMeta.data,t=0,n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,a=t.yScale,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y),u=i._custom;return{label:n[e]||"",value:"("+o+", "+s+(u?", "+u:"")+")"}}},{key:"update",value:function(e){var t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=this._getSharedOptions(t,r),c=u.sharedOptions,l=u.includeOptions,h=o.axis,d=s.axis,f=t;f<t+n;f++){var p=e[f],m=!a&&this.getParsed(f),v={},g=v[h]=a?o.getPixelForDecimal(.5):o.getPixelForValue(m[h]),y=v[d]=a?s.getBasePixel():s.getPixelForValue(m[d]);v.skip=isNaN(g)||isNaN(y),l&&(v.options=c||this.resolveDataElementOptions(f,p.active?"active":r),a&&(v.options.radius=0)),this.updateElement(p,f,v,r)}}},{key:"resolveDataElementOptions",value:function(e,t){var r=this.getParsed(e),a=me(pe(n.prototype),"resolveDataElementOptions",this).call(this,e,t);a.$shared&&(a=Object.assign({},a,{$shared:!1}));var i=a.radius;return"active"!==t&&(a.radius=0),a.radius+=sv(r&&r._custom,i),a}}]),n}(ub);(0,_.Z)(yb,"id","bubble"),(0,_.Z)(yb,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,_.Z)(yb,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});var bb=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this,e,r)).enableOptionSharing=!0,a.innerRadius=void 0,a.outerRadius=void 0,a.offsetX=void 0,a.offsetY=void 0,a}return Te(n,[{key:"linkScales",value:function(){}},{key:"parse",value:function(e,t){var n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{var a,i,o=function(e){return+n[e]};if(av(n[e])){var s=this._parsing.key,u=void 0===s?"value":s;o=function(e){return+xv(n[e],u)}}for(a=e,i=e+t;a<i;++a)r._parsed[a]=o(a)}}},{key:"_getRotation",value:function(){return Bv(this.options.rotation-90)}},{key:"_getCircumference",value:function(){return Bv(this.options.circumference)}},{key:"_getRotationExtents",value:function(){for(var e=Tv,t=-Tv,n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){var r=this.chart.getDatasetMeta(n).controller,a=r._getRotation(),i=r._getCircumference();e=Math.min(e,a),t=Math.max(t,a+i)}return{rotation:e,circumference:t-e}}},{key:"update",value:function(e){var t,n,r=this.chart.chartArea,a=this._cachedMeta,i=a.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,s=Math.max((Math.min(r.width,r.height)-o)/2,0),u=Math.min((t=this.options.cutout,n=s,"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/n),1),c=this._getRingWeight(this.index),l=this._getRotationExtents(),h=l.circumference,d=function(e,t,n){var r=1,a=1,i=0,o=0;if(t<Tv){var s=e,u=s+t,c=Math.cos(s),l=Math.sin(s),h=Math.cos(u),d=Math.sin(u),f=function(e,t,r){return Kv(e,s,u,!0)?1:Math.max(t,t*n,r,r*n)},p=function(e,t,r){return Kv(e,s,u,!0)?-1:Math.min(t,t*n,r,r*n)},m=f(0,c,h),v=f(Rv,l,d),g=p(Iv,c,h),y=p(Iv+Rv,l,d);r=(m-g)/2,a=(v-y)/2,i=-(m+g)/2,o=-(v+y)/2}return{ratioX:r,ratioY:a,offsetX:i,offsetY:o}}(l.rotation,h,u),f=d.ratioX,p=d.ratioY,m=d.offsetX,v=d.offsetY,g=(r.width-o)/f,y=(r.height-o)/p,b=Math.max(Math.min(g,y)/2,0),x=uv(this.options.radius,b),w=(x-Math.max(x*u,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*x,this.offsetY=v*x,a.total=this.calculateTotal(),this.outerRadius=x-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*c,0),this.updateElements(i,0,i.length,e)}},{key:"_circumference",value:function(e,t){var n=this.options,r=this._cachedMeta,a=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/Tv)}},{key:"updateElements",value:function(e,t,n,r){var a,i="reset"===r,o=this.chart,s=o.chartArea,u=o.options.animation,c=(s.left+s.right)/2,l=(s.top+s.bottom)/2,h=i&&u.animateScale,d=h?0:this.innerRadius,f=h?0:this.outerRadius,p=this._getSharedOptions(t,r),m=p.sharedOptions,v=p.includeOptions,g=this._getRotation();for(a=0;a<t;++a)g+=this._circumference(a,i);for(a=t;a<t+n;++a){var y=this._circumference(a,i),b=e[a],x={x:c+this.offsetX,y:l+this.offsetY,startAngle:g,endAngle:g+y,circumference:y,outerRadius:f,innerRadius:d};v&&(x.options=m||this.resolveDataElementOptions(a,b.active?"active":r)),g+=y,this.updateElement(b,a,x,r)}}},{key:"calculateTotal",value:function(){var e,t=this._cachedMeta,n=t.data,r=0;for(e=0;e<n.length;e++){var a=t._parsed[e];null===a||isNaN(a)||!this.chart.getDataVisibility(e)||n[e].hidden||(r+=Math.abs(a))}return r}},{key:"calculateCircumference",value:function(e){var t=this._cachedMeta.total;return t>0&&!isNaN(e)?Tv*(Math.abs(e)/t):0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=gg(t._parsed[e],n.options.locale);return{label:r[e]||"",value:a}}},{key:"getMaxBorderWidth",value:function(e){var t,n,r,a,i,o=0,s=this.chart;if(!e)for(t=0,n=s.data.datasets.length;t<n;++t)if(s.isDatasetVisible(t)){e=(r=s.getDatasetMeta(t)).data,a=r.controller;break}if(!e)return 0;for(t=0,n=e.length;t<n;++t)"inner"!==(i=a.resolveDataElementOptions(t)).borderAlign&&(o=Math.max(o,i.borderWidth||0,i.hoverBorderWidth||0));return o}},{key:"getMaxOffset",value:function(e){for(var t=0,n=0,r=e.length;n<r;++n){var a=this.resolveDataElementOptions(n);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}},{key:"_getRingWeightOffset",value:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}},{key:"_getRingWeight",value:function(e){return Math.max(sv(this.chart.data.datasets[e].weight,1),0)}},{key:"_getVisibleDatasetWeightTotal",value:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}]),n}(ub);(0,_.Z)(bb,"id","doughnut"),(0,_.Z)(bb,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,_.Z)(bb,"descriptors",{_scriptable:function(e){return"spacing"!==e},_indexable:function(e){return"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}}),(0,_.Z)(bb,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,a=n.color;return t.labels.map((function(t,n){var i=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});var xb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"initialize",value:function(){this.enableOptionSharing=!0,this.supportsDecimation=!0,me(pe(n.prototype),"initialize",this).call(this)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data,a=void 0===r?[]:r,i=t._dataset,o=this.chart._animationsDisabled,s=ig(t,a,o),u=s.start,c=s.count;this._drawStart=u,this._drawCount=c,og(t)&&(u=0,c=a.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=a;var l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},e),this.updateElements(a,u,c,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=i._stacked,c=i._dataset,l=this._getSharedOptions(t,r),h=l.sharedOptions,d=l.includeOptions,f=o.axis,p=s.axis,m=this.options,v=m.spanGaps,g=m.segment,y=Fv(v)?v:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||a||"none"===r,x=t+n,w=e.length,k=t>0&&this.getParsed(t-1),S=0;S<w;++S){var C=e[S],I=b?C:{};if(S<t||S>=x)I.skip=!0;else{var T=this.getParsed(S),_=nv(T[p]),E=I[f]=o.getPixelForValue(T[f],S),N=I[p]=a||_?s.getBasePixel():s.getPixelForValue(u?this.applyStack(s,T,u):T[p],S);I.skip=isNaN(E)||isNaN(N)||_,I.stop=S>0&&Math.abs(T[f]-k[f])>y,g&&(I.parsed=T,I.raw=c.data[S]),d&&(I.options=h||this.resolveDataElementOptions(S,C.active?"active":r)),b||this.updateElement(C,S,I,r),k=T}}}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;var a=r[0].size(this.resolveDataElementOptions(0)),i=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,a,i)/2}},{key:"draw",value:function(){var e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),me(pe(n.prototype),"draw",this).call(this)}}]),n}(ub);(0,_.Z)(xb,"id","line"),(0,_.Z)(xb,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,_.Z)(xb,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});var wb=function(e){be(n,e);var t=we(n);function n(e,r){var a;return Se(this,n),(a=t.call(this,e,r)).innerRadius=void 0,a.outerRadius=void 0,a}return Te(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=gg(t._parsed[e].r,n.options.locale);return{label:r[e]||"",value:a}}},{key:"parseObjectData",value:function(e,t,n,r){return hy.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}},{key:"getMinMax",value:function(){var e=this,t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((function(t,r){var a=e.getParsed(r).r;!isNaN(a)&&e.chart.getDataVisibility(r)&&(a<n.min&&(n.min=a),a>n.max&&(n.max=a))})),n}},{key:"_updateRadius",value:function(){var e=this.chart,t=e.chartArea,n=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),a=Math.max(r/2,0),i=(a-Math.max(n.cutoutPercentage?a/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=a-i*this.index,this.innerRadius=this.outerRadius-i}},{key:"updateElements",value:function(e,t,n,r){var a,i="reset"===r,o=this.chart,s=o.options.animation,u=this._cachedMeta.rScale,c=u.xCenter,l=u.yCenter,h=u.getIndexAngle(0)-.5*Iv,d=h,f=360/this.countVisibleElements();for(a=0;a<t;++a)d+=this._computeAngle(a,r,f);for(a=t;a<t+n;a++){var p=e[a],m=d,v=d+this._computeAngle(a,r,f),g=o.getDataVisibility(a)?u.getDistanceFromCenterForValue(this.getParsed(a).r):0;d=v,i&&(s.animateScale&&(g=0),s.animateRotate&&(m=v=h));var y={x:c,y:l,innerRadius:0,outerRadius:g,startAngle:m,endAngle:v,options:this.resolveDataElementOptions(a,p.active?"active":r)};this.updateElement(p,a,y,r)}}},{key:"countVisibleElements",value:function(){var e=this,t=this._cachedMeta,n=0;return t.data.forEach((function(t,r){!isNaN(e.getParsed(r).r)&&e.chart.getDataVisibility(r)&&n++})),n}},{key:"_computeAngle",value:function(e,t,n){return this.chart.getDataVisibility(e)?Bv(this.resolveDataElementOptions(e,t).angle||n):0}}]),n}(ub);(0,_.Z)(wb,"id","polarArea"),(0,_.Z)(wb,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,_.Z)(wb,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,a=n.color;return t.labels.map((function(t,n){var i=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});var kb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n)}(bb);(0,_.Z)(kb,"id","pie"),(0,_.Z)(kb,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});var Sb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}},{key:"parseObjectData",value:function(e,t,n,r){return hy.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data||[],a=t.iScale.getLabels();if(n.points=r,"resize"!==e){var i=this.resolveDatasetElementOptions(e);this.options.showLine||(i.borderWidth=0);var o={_loop:!0,_fullLoop:a.length===r.length,options:i};this.updateElement(n,void 0,o,e)}this.updateElements(r,0,r.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a=this._cachedMeta.rScale,i="reset"===r,o=t;o<t+n;o++){var s=e[o],u=this.resolveDataElementOptions(o,s.active?"active":r),c=a.getPointPositionForValue(o,this.getParsed(o).r),l=i?a.xCenter:c.x,h=i?a.yCenter:c.y,d={x:l,y:h,angle:c.angle,skip:isNaN(l)||isNaN(h),options:u};this.updateElement(s,o,d,r)}}}]),n}(ub);(0,_.Z)(Sb,"id","radar"),(0,_.Z)(Sb,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,_.Z)(Sb,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});var Cb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,a=t.yScale,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y);return{label:n[e]||"",value:"("+o+", "+s+")"}}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.data,r=void 0===n?[]:n,a=this.chart._animationsDisabled,i=ig(t,r,a),o=i.start,s=i.count;if(this._drawStart=o,this._drawCount=s,og(t)&&(o=0,s=r.length),this.options.showLine){this.datasetElementType||this.addElements();var u=t.dataset,c=t._dataset;u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!c._decimated,u.points=r;var l=this.resolveDatasetElementOptions(e);l.segment=this.options.segment,this.updateElement(u,void 0,{animated:!a,options:l},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,o,s,e)}},{key:"addElements",value:function(){var e=this.options.showLine;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),me(pe(n.prototype),"addElements",this).call(this)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=i._stacked,c=i._dataset,l=this.resolveDataElementOptions(t,r),h=this.getSharedOptions(l),d=this.includeOptions(r,h),f=o.axis,p=s.axis,m=this.options,v=m.spanGaps,g=m.segment,y=Fv(v)?v:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||a||"none"===r,x=t>0&&this.getParsed(t-1),w=t;w<t+n;++w){var k=e[w],S=this.getParsed(w),C=b?k:{},I=nv(S[p]),T=C[f]=o.getPixelForValue(S[f],w),_=C[p]=a||I?s.getBasePixel():s.getPixelForValue(u?this.applyStack(s,S,u):S[p],w);C.skip=isNaN(T)||isNaN(_)||I,C.stop=w>0&&Math.abs(S[f]-x[f])>y,g&&(C.parsed=S,C.raw=c.data[w]),d&&(C.options=h||this.resolveDataElementOptions(w,k.active?"active":r)),b||this.updateElement(k,w,C,r),x=S}this.updateSharedOptions(h,r,l)}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){for(var n=0,r=t.length-1;r>=0;--r)n=Math.max(n,t[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}var a=e.dataset,i=a.options&&a.options.borderWidth||0;if(!t.length)return i;var o=t[0].size(this.resolveDataElementOptions(0)),s=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,o,s)/2}}]),n}(ub);(0,_.Z)(Cb,"id","scatter"),(0,_.Z)(Cb,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,_.Z)(Cb,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function Ib(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var Tb={_date:function(){function e(t){Se(this,e),(0,_.Z)(this,"options",void 0),this.options=t||{}}return Te(e,[{key:"init",value:function(){}},{key:"formats",value:function(){return Ib()}},{key:"parse",value:function(){return Ib()}},{key:"format",value:function(){return Ib()}},{key:"add",value:function(){return Ib()}},{key:"diff",value:function(){return Ib()}},{key:"startOf",value:function(){return Ib()}},{key:"endOf",value:function(){return Ib()}}],[{key:"override",value:function(t){Object.assign(e.prototype,t)}}]),e}()};function _b(e,t,n,r){var a=e.controller,i=e.data,o=e._sorted,s=a._cachedMeta.iScale;if(s&&t===s.axis&&"r"!==t&&o&&i.length){var u=s._reversePixels?Qv:Yv;if(!r)return u(i,t,n);if(a._sharedOptions){var c=i[0],l="function"===typeof c.getRange&&c.getRange(t);if(l){var h=u(i,t,n-l),d=u(i,t,n+l);return{lo:h.lo,hi:d.hi}}}}return{lo:0,hi:i.length-1}}function Eb(e,t,n,r,a){for(var i=e.getSortedVisibleDatasetMetas(),o=n[t],s=0,u=i.length;s<u;++s)for(var c=i[s],l=c.index,h=c.data,d=_b(i[s],t,o,a),f=d.lo,p=d.hi,m=f;m<=p;++m){var v=h[m];v.skip||r(v,l,m)}}function Nb(e,t,n,r,a){var i=[];if(!a&&!e.isPointInArea(t))return i;return Eb(e,n,t,(function(n,o,s){(a||Og(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&i.push({element:n,datasetIndex:o,index:s})}),!0),i}function Rb(e,t,n,r,a,i){var o=[],s=function(e){var t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){var a=t?Math.abs(e.x-r.x):0,i=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}(n),u=Number.POSITIVE_INFINITY;return Eb(e,n,t,(function(n,c,l){var h=n.inRange(t.x,t.y,a);if(!r||h){var d=n.getCenterPoint(a);if(!!i||e.isPointInArea(d)||h){var f=s(t,d);f<u?(o=[{element:n,datasetIndex:c,index:l}],u=f):f===u&&o.push({element:n,datasetIndex:c,index:l})}}})),o}function Ab(e,t,n,r,a,i){return i||e.isPointInArea(t)?"r"!==n||r?Rb(e,t,n,r,a,i):function(e,t,n,r){var a=[];return Eb(e,n,t,(function(e,n,i){var o=e.getProps(["startAngle","endAngle"],r),s=o.startAngle,u=o.endAngle;Kv(Wv(e,{x:t.x,y:t.y}).angle,s,u)&&a.push({element:e,datasetIndex:n,index:i})})),a}(e,t,n,a):[]}function Ob(e,t,n,r,a){var i=[],o="x"===n?"inXRange":"inYRange",s=!1;return Eb(e,n,t,(function(e,r,u){e[o](t[n],a)&&(i.push({element:e,datasetIndex:r,index:u}),s=s||e.inRange(t.x,t.y,a))})),r&&!s?[]:i}var Db={evaluateInteractionItems:Eb,modes:{index:function(e,t,n,r){var a=Ty(t,e),i=n.axis||"x",o=n.includeInvisible||!1,s=n.intersect?Nb(e,a,i,r,o):Ab(e,a,i,!1,r,o),u=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach((function(e){var t=s[0].index,n=e.data[t];n&&!n.skip&&u.push({element:n,datasetIndex:e.index,index:t})})),u):[]},dataset:function(e,t,n,r){var a=Ty(t,e),i=n.axis||"xy",o=n.includeInvisible||!1,s=n.intersect?Nb(e,a,i,r,o):Ab(e,a,i,!1,r,o);if(s.length>0){var u=s[0].datasetIndex,c=e.getDatasetMeta(u).data;s=[];for(var l=0;l<c.length;++l)s.push({element:c[l],datasetIndex:u,index:l})}return s},point:function(e,t,n,r){return Nb(e,Ty(t,e),n.axis||"xy",r,n.includeInvisible||!1)},nearest:function(e,t,n,r){var a=Ty(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return Ab(e,a,i,n.intersect,r,o)},x:function(e,t,n,r){return Ob(e,Ty(t,e),"x",n.intersect,r)},y:function(e,t,n,r){return Ob(e,Ty(t,e),"y",n.intersect,r)}}},Pb=["left","top","right","bottom"];function Mb(e,t){return e.filter((function(e){return e.pos===t}))}function Lb(e,t){return e.filter((function(e){return-1===Pb.indexOf(e.pos)&&e.box.axis===t}))}function Fb(e,t){return e.sort((function(e,n){var r=t?n:e,a=t?e:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight}))}function zb(e,t){var n,r,a,i=function(e){var t,n={},r=ye(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.stack,o=a.pos,s=a.stackWeight;if(i&&Pb.includes(o)){var u=n[i]||(n[i]={count:0,placed:0,weight:0,size:0});u.count++,u.weight+=s}}}catch(c){r.e(c)}finally{r.f()}return n}(e),o=t.vBoxMaxWidth,s=t.hBoxMaxHeight;for(n=0,r=e.length;n<r;++n){var u=(a=e[n]).box.fullSize,c=i[a.stack],l=c&&a.stackWeight/c.weight;a.horizontal?(a.width=l?l*o:u&&t.availableWidth,a.height=s):(a.width=o,a.height=l?l*s:u&&t.availableHeight)}return i}function Bb(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function Vb(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Ub(e,t,n,r){var a=n.pos,i=n.box,o=e.maxPadding;if(!av(a)){n.size&&(e[a]-=n.size);var s=r[n.stack]||{size:0,count:1};s.size=Math.max(s.size,n.horizontal?i.height:i.width),n.size=s.size/s.count,e[a]+=n.size}i.getPadding&&Vb(o,i.getPadding());var u=Math.max(0,t.outerWidth-Bb(o,e,"left","right")),c=Math.max(0,t.outerHeight-Bb(o,e,"top","bottom")),l=u!==e.w,h=c!==e.h;return e.w=u,e.h=c,n.horizontal?{same:l,other:h}:{same:h,other:l}}function Wb(e,t){var n=t.maxPadding;function r(e){var r={left:0,top:0,right:0,bottom:0};return e.forEach((function(e){r[e]=Math.max(t[e],n[e])})),r}return r(e?["left","right"]:["top","bottom"])}function jb(e,t,n,r){var a,i,o,s,u,c,l=[];for(a=0,i=e.length,u=0;a<i;++a){(s=(o=e[a]).box).update(o.width||t.w,o.height||t.h,Wb(o.horizontal,t));var h=Ub(t,n,o,r),d=h.same,f=h.other;u|=d&&l.length,c=c||f,s.fullSize||l.push(o)}return u&&jb(l,t,n,r)||c}function Gb(e,t,n,r,a){e.top=n,e.left=t,e.right=t+r,e.bottom=n+a,e.width=r,e.height=a}function Hb(e,t,n,r){var a,i=n.padding,o=t.x,s=t.y,u=ye(e);try{for(u.s();!(a=u.n()).done;){var c=a.value,l=c.box,h=r[c.stack]||{count:1,placed:0,weight:1},d=c.stackWeight/h.weight||1;if(c.horizontal){var f=t.w*d,p=h.size||l.height;kv(h.start)&&(s=h.start),l.fullSize?Gb(l,i.left,s,n.outerWidth-i.right-i.left,p):Gb(l,t.left+h.placed,s,f,p),h.start=s,h.placed+=f,s=l.bottom}else{var m=t.h*d,v=h.size||l.width;kv(h.start)&&(o=h.start),l.fullSize?Gb(l,o,i.top,v,n.outerHeight-i.bottom-i.top):Gb(l,o,t.top+h.placed,v,m),h.start=o,h.placed+=m,o=l.right}}}catch(g){u.e(g)}finally{u.f()}t.x=o,t.y=s}var Kb=function(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(e){t.draw(e)}}]},e.boxes.push(t)},qb=function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},Zb=function(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},Xb=function(e,t,n,r){if(e){var a=Zg(e.options.layout.padding),i=Math.max(t-a.width,0),o=Math.max(n-a.height,0),s=function(e){var t=function(e){var t,n,r,a,i,o,s=[];for(t=0,n=(e||[]).length;t<n;++t){var u=r=e[t];a=u.position;var c=u.options;i=c.stack;var l=c.stackWeight;o=void 0===l?1:l,s.push({index:t,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:i&&a+i,stackWeight:o})}return s}(e),n=Fb(t.filter((function(e){return e.box.fullSize})),!0),r=Fb(Mb(t,"left"),!0),a=Fb(Mb(t,"right")),i=Fb(Mb(t,"top"),!0),o=Fb(Mb(t,"bottom")),s=Lb(t,"x"),u=Lb(t,"y");return{fullSize:n,leftAndTop:r.concat(i),rightAndBottom:a.concat(u).concat(o).concat(s),chartArea:Mb(t,"chartArea"),vertical:r.concat(a).concat(u),horizontal:i.concat(o).concat(s)}}(e.boxes),u=s.vertical,c=s.horizontal;lv(e.boxes,(function(e){"function"===typeof e.beforeLayout&&e.beforeLayout()}));var l=u.reduce((function(e,t){return t.box.options&&!1===t.box.options.display?e:e+1}),0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:a,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/l,hBoxMaxHeight:o/2}),d=Object.assign({},a);Vb(d,Zg(r));var f=Object.assign({maxPadding:d,w:i,h:o,x:a.left,y:a.top},a),p=zb(u.concat(c),h);jb(s.fullSize,f,h,p),jb(u,f,h,p),jb(c,f,h,p)&&jb(u,f,h,p),function(e){var t=e.maxPadding;function n(n){var r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(f),Hb(s.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,Hb(s.rightAndBottom,f,h,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},lv(s.chartArea,(function(t){var n=t.box;Object.assign(n,e.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}},Yb=function(){function e(){Se(this,e)}return Te(e,[{key:"acquireContext",value:function(e,t){}},{key:"releaseContext",value:function(e){return!1}},{key:"addEventListener",value:function(e,t,n){}},{key:"removeEventListener",value:function(e,t,n){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getMaximumSize",value:function(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}},{key:"isAttached",value:function(e){return!0}},{key:"updateConfig",value:function(e){}}]),e}(),Qb=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"acquireContext",value:function(e){return e&&e.getContext&&e.getContext("2d")||null}},{key:"updateConfig",value:function(e){e.options.animation=!1}}]),n}(Yb),$b="$chartjs",Jb={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ex=function(e){return null===e||""===e};var tx=!!Ry&&{passive:!0};function nx(e,t,n){e.canvas.removeEventListener(t,n,tx)}function rx(e,t){var n,r=ye(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a===t||a.contains(t))return!0}}catch(i){r.e(i)}finally{r.f()}}function ax(e,t,n){var r=e.canvas,a=new MutationObserver((function(e){var t,a=!1,i=ye(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a=(a=a||rx(o.addedNodes,r))&&!rx(o.removedNodes,r)}}catch(s){i.e(s)}finally{i.f()}a&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}function ix(e,t,n){var r=e.canvas,a=new MutationObserver((function(e){var t,a=!1,i=ye(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a=(a=a||rx(o.removedNodes,r))&&!rx(o.addedNodes,r)}}catch(s){i.e(s)}finally{i.f()}a&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}var ox=new Map,sx=0;function ux(){var e=window.devicePixelRatio;e!==sx&&(sx=e,ox.forEach((function(t,n){n.currentDevicePixelRatio!==e&&t()})))}function cx(e,t,n){var r=e.canvas,a=r&&xy(r);if(a){var i=ng((function(e,t){var r=a.clientWidth;n(e,t),r<a.clientWidth&&n()}),window),o=new ResizeObserver((function(e){var t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||i(n,r)}));return o.observe(a),function(e,t){ox.size||window.addEventListener("resize",ux),ox.set(e,t)}(e,i),o}}function lx(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){ox.delete(e),ox.size||window.removeEventListener("resize",ux)}(e)}function hx(e,t,n){var r=e.canvas,a=ng((function(t){null!==e.ctx&&n(function(e,t){var n=Jb[e.type]||e.type,r=Ty(e,t),a=r.x,i=r.y;return{type:n,chart:t,native:e,x:void 0!==a?a:null,y:void 0!==i?i:null}}(t,e))}),e);return function(e,t,n){e.addEventListener(t,n,tx)}(r,t,a),a}var dx=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"acquireContext",value:function(e,t){var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){var n=e.style,r=e.getAttribute("height"),a=e.getAttribute("width");if(e[$b]={initial:{height:r,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",ex(a)){var i=Ay(e,"width");void 0!==i&&(e.width=i)}if(ex(r))if(""===e.style.height)e.height=e.width/(t||2);else{var o=Ay(e,"height");void 0!==o&&(e.height=o)}}(e,t),n):null}},{key:"releaseContext",value:function(e){var t=e.canvas;if(!t[$b])return!1;var n=t[$b].initial;["height","width"].forEach((function(e){var r=n[e];nv(r)?t.removeAttribute(e):t.setAttribute(e,r)}));var r=n.style||{};return Object.keys(r).forEach((function(e){t.style[e]=r[e]})),t.width=t.width,delete t[$b],!0}},{key:"addEventListener",value:function(e,t,n){this.removeEventListener(e,t);var r=e.$proxies||(e.$proxies={}),a={attach:ax,detach:ix,resize:cx}[t]||hx;r[t]=a(e,t,n)}},{key:"removeEventListener",value:function(e,t){var n=e.$proxies||(e.$proxies={}),r=n[t];r&&(({attach:lx,detach:lx,resize:lx}[t]||nx)(e,t,r),n[t]=void 0)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getMaximumSize",value:function(e,t,n,r){return Ey(e,t,n,r)}},{key:"isAttached",value:function(e){var t=xy(e);return!(!t||!t.isConnected)}}]),n}(Yb);var fx=function(){function e(){Se(this,e),(0,_.Z)(this,"x",void 0),(0,_.Z)(this,"y",void 0),(0,_.Z)(this,"active",!1),(0,_.Z)(this,"options",void 0),(0,_.Z)(this,"$animations",void 0)}return Te(e,[{key:"tooltipPosition",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"hasValue",value:function(){return Fv(this.x)&&Fv(this.y)}},{key:"getProps",value:function(e,t){var n=this,r=this.$animations;if(!t||!r)return this;var a={};return e.forEach((function(e){a[e]=r[e]&&r[e].active()?r[e]._to:n[e]})),a}}]),e}();function px(e,t){var n=e.options.ticks,r=function(e){var t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),a=e._maxLength/n;return Math.floor(Math.min(r,a))}(e),a=Math.min(n.maxTicksLimit||r,r),i=n.major.enabled?function(e){var t,n,r=[];for(t=0,n=e.length;t<n;t++)e[t].major&&r.push(t);return r}(t):[],o=i.length,s=i[0],u=i[o-1],c=[];if(o>a)return function(e,t,n,r){var a,i=0,o=n[0];for(r=Math.ceil(r),a=0;a<e.length;a++)a===o&&(t.push(e[a]),o=n[++i*r])}(t,c,i,o/a),c;var l=function(e,t,n){var r=function(e){var t,n,r=e.length;if(r<2)return!1;for(n=e[0],t=1;t<r;++t)if(e[t]-e[t-1]!==n)return!1;return n}(e),a=t.length/n;if(!r)return Math.max(a,1);for(var i=function(e){var t,n=[],r=Math.sqrt(e);for(t=1;t<r;t++)e%t===0&&(n.push(t),n.push(e/t));return r===(0|r)&&n.push(r),n.sort((function(e,t){return e-t})).pop(),n}(r),o=0,s=i.length-1;o<s;o++){var u=i[o];if(u>a)return u}return Math.max(a,1)}(i,t,a);if(o>0){var h,d,f=o>1?Math.round((u-s)/(o-1)):null;for(mx(t,c,l,nv(f)?0:s-f,s),h=0,d=o-1;h<d;h++)mx(t,c,l,i[h],i[h+1]);return mx(t,c,l,u,nv(f)?t.length:u+f),c}return mx(t,c,l),c}function mx(e,t,n,r,a){var i,o,s,u=sv(r,0),c=Math.min(sv(a,e.length),e.length),l=0;for(n=Math.ceil(n),a&&(n=(i=a-r)/Math.floor(i/n)),s=u;s<0;)l++,s=Math.round(u+l*n);for(o=Math.max(u,0);o<c;o++)o===s&&(t.push(e[o]),l++,s=Math.round(u+l*n))}(0,_.Z)(fx,"defaults",{}),(0,_.Z)(fx,"defaultRoutes",void 0);var vx=function(e,t,n){return"top"===t||"left"===t?e[t]+n:e[t]-n},gx=function(e,t){return Math.min(t||e,e)};function yx(e,t){for(var n=[],r=e.length/t,a=e.length,i=0;i<a;i+=r)n.push(e[Math.floor(i)]);return n}function bx(e,t,n){var r,a=e.ticks.length,i=Math.min(t,a-1),o=e._startPixel,s=e._endPixel,u=1e-6,c=e.getPixelForTick(i);if(!(n&&(r=1===a?Math.max(c-o,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(i-1))/2,(c+=i<t?r:-r)<o-u||c>s+u)))return c}function xx(e){return e.drawTicks?e.tickLength:0}function wx(e,t){if(!e.display)return 0;var n=Xg(e.font,t),r=Zg(e.padding);return(rv(e.text)?e.text.length:1)*n.lineHeight+r.height}function kx(e,t,n){var r=rg(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=function(e){return"left"===e?"right":"right"===e?"left":e}(r)),r}var Sx=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).id=e.id,r.type=e.type,r.options=void 0,r.ctx=e.ctx,r.chart=e.chart,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.width=void 0,r.height=void 0,r._margins={left:0,right:0,top:0,bottom:0},r.maxWidth=void 0,r.maxHeight=void 0,r.paddingTop=void 0,r.paddingBottom=void 0,r.paddingLeft=void 0,r.paddingRight=void 0,r.axis=void 0,r.labelRotation=void 0,r.min=void 0,r.max=void 0,r._range=void 0,r.ticks=[],r._gridLineItems=null,r._labelItems=null,r._labelSizes=null,r._length=0,r._maxLength=0,r._longestTextCache={},r._startPixel=void 0,r._endPixel=void 0,r._reversePixels=!1,r._userMax=void 0,r._userMin=void 0,r._suggestedMax=void 0,r._suggestedMin=void 0,r._ticksLength=0,r._borderValue=0,r._cache={},r._dataLimitsCached=!1,r.$context=void 0,r}return Te(n,[{key:"init",value:function(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}},{key:"parse",value:function(e,t){return e}},{key:"getUserBounds",value:function(){var e=this._userMin,t=this._userMax,n=this._suggestedMin,r=this._suggestedMax;return e=ov(e,Number.POSITIVE_INFINITY),t=ov(t,Number.NEGATIVE_INFINITY),n=ov(n,Number.POSITIVE_INFINITY),r=ov(r,Number.NEGATIVE_INFINITY),{min:ov(e,n),max:ov(t,r),minDefined:iv(e),maxDefined:iv(t)}}},{key:"getMinMax",value:function(e){var t,n=this.getUserBounds(),r=n.min,a=n.max,i=n.minDefined,o=n.maxDefined;if(i&&o)return{min:r,max:a};for(var s=this.getMatchingVisibleMetas(),u=0,c=s.length;u<c;++u)t=s[u].controller.getMinMax(this,e),i||(r=Math.min(r,t.min)),o||(a=Math.max(a,t.max));return{min:ov(r=o&&r>a?a:r,ov(a=i&&r>a?r:a,r)),max:ov(a,ov(r,a))}}},{key:"getPadding",value:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}},{key:"getTicks",value:function(){return this.ticks}},{key:"getLabels",value:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}},{key:"getLabelItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}},{key:"beforeLayout",value:function(){this._cache={},this._dataLimitsCached=!1}},{key:"beforeUpdate",value:function(){cv(this.options.beforeUpdate,[this])}},{key:"update",value:function(e,t,n){var r=this.options,a=r.beginAtZero,i=r.grace,o=r.ticks,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){var r=e.min,a=e.max,i=uv(t,(a-r)/2),o=function(e,t){return n&&0===e?0:e+t};return{min:o(r,-Math.abs(i)),max:o(a,i)}}(this,i,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();var u=s<this.ticks.length;this._convertTicksToLabels(u?yx(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=px(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),u&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}},{key:"configure",value:function(){var e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}},{key:"afterUpdate",value:function(){cv(this.options.afterUpdate,[this])}},{key:"beforeSetDimensions",value:function(){cv(this.options.beforeSetDimensions,[this])}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}},{key:"afterSetDimensions",value:function(){cv(this.options.afterSetDimensions,[this])}},{key:"_callHooks",value:function(e){this.chart.notifyPlugins(e,this.getContext()),cv(this.options[e],[this])}},{key:"beforeDataLimits",value:function(){this._callHooks("beforeDataLimits")}},{key:"determineDataLimits",value:function(){}},{key:"afterDataLimits",value:function(){this._callHooks("afterDataLimits")}},{key:"beforeBuildTicks",value:function(){this._callHooks("beforeBuildTicks")}},{key:"buildTicks",value:function(){return[]}},{key:"afterBuildTicks",value:function(){this._callHooks("afterBuildTicks")}},{key:"beforeTickToLabelConversion",value:function(){cv(this.options.beforeTickToLabelConversion,[this])}},{key:"generateTickLabels",value:function(e){var t,n,r,a=this.options.ticks;for(t=0,n=e.length;t<n;t++)(r=e[t]).label=cv(a.callback,[r.value,t,e],this)}},{key:"afterTickToLabelConversion",value:function(){cv(this.options.afterTickToLabelConversion,[this])}},{key:"beforeCalculateLabelRotation",value:function(){cv(this.options.beforeCalculateLabelRotation,[this])}},{key:"calculateLabelRotation",value:function(){var e,t,n,r=this.options,a=r.ticks,i=gx(this.ticks.length,r.ticks.maxTicksLimit),o=a.minRotation||0,s=a.maxRotation,u=o;if(!this._isVisible()||!a.display||o>=s||i<=1||!this.isHorizontal())this.labelRotation=o;else{var c=this._getLabelSizes(),l=c.widest.width,h=c.highest.height,d=qv(this.chart.width-l,0,this.maxWidth);l+6>(e=r.offset?this.maxWidth/i:d/(i-1))&&(e=d/(i-(r.offset?.5:1)),t=this.maxHeight-xx(r.grid)-a.padding-wx(r.title,this.chart.options.font),n=Math.sqrt(l*l+h*h),u=Vv(Math.min(Math.asin(qv((c.highest.height+6)/e,-1,1)),Math.asin(qv(t/n,-1,1))-Math.asin(qv(h/n,-1,1)))),u=Math.max(o,Math.min(s,u))),this.labelRotation=u}}},{key:"afterCalculateLabelRotation",value:function(){cv(this.options.afterCalculateLabelRotation,[this])}},{key:"afterAutoSkip",value:function(){}},{key:"beforeFit",value:function(){cv(this.options.beforeFit,[this])}},{key:"fit",value:function(){var e={width:0,height:0},t=this.chart,n=this.options,r=n.ticks,a=n.title,i=n.grid,o=this._isVisible(),s=this.isHorizontal();if(o){var u=wx(a,t.options.font);if(s?(e.width=this.maxWidth,e.height=xx(i)+u):(e.height=this.maxHeight,e.width=xx(i)+u),r.display&&this.ticks.length){var c=this._getLabelSizes(),l=c.first,h=c.last,d=c.widest,f=c.highest,p=2*r.padding,m=Bv(this.labelRotation),v=Math.cos(m),g=Math.sin(m);if(s){var y=r.mirror?0:g*d.width+v*f.height;e.height=Math.min(this.maxHeight,e.height+y+p)}else{var b=r.mirror?0:v*d.width+g*f.height;e.width=Math.min(this.maxWidth,e.width+b+p)}this._calculatePadding(l,h,g,v)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}},{key:"_calculatePadding",value:function(e,t,n,r){var a=this.options,i=a.ticks,o=i.align,s=i.padding,u=a.position,c=0!==this.labelRotation,l="top"!==u&&"x"===this.axis;if(this.isHorizontal()){var h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1),f=0,p=0;c?l?(f=r*e.width,p=n*t.height):(f=n*e.height,p=r*t.width):"start"===o?p=t.width:"end"===o?f=e.width:"inner"!==o&&(f=e.width/2,p=t.width/2),this.paddingLeft=Math.max((f-h+s)*this.width/(this.width-h),0),this.paddingRight=Math.max((p-d+s)*this.width/(this.width-d),0)}else{var m=t.height/2,v=e.height/2;"start"===o?(m=0,v=e.height):"end"===o&&(m=t.height,v=0),this.paddingTop=m+s,this.paddingBottom=v+s}}},{key:"_handleMargins",value:function(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}},{key:"afterFit",value:function(){cv(this.options.afterFit,[this])}},{key:"isHorizontal",value:function(){var e=this.options,t=e.axis,n=e.position;return"top"===n||"bottom"===n||"x"===t}},{key:"isFullSize",value:function(){return this.options.fullSize}},{key:"_convertTicksToLabels",value:function(e){var t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)nv(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}},{key:"_getLabelSizes",value:function(){var e=this._labelSizes;if(!e){var t=this.options.ticks.sampleSize,n=this.ticks;t<n.length&&(n=yx(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}},{key:"_computeLabelSizes",value:function(e,t,n){var r,a,i,o,s,u,c,l,h,d,f,p=this.ctx,m=this._longestTextCache,v=[],g=[],y=Math.floor(t/gx(t,n)),b=0,x=0;for(r=0;r<t;r+=y){if(o=e[r].label,s=this._resolveTickFontOptions(r),p.font=u=s.string,c=m[u]=m[u]||{data:{},gc:[]},l=s.lineHeight,h=d=0,nv(o)||rv(o)){if(rv(o))for(a=0,i=o.length;a<i;++a)nv(f=o[a])||rv(f)||(h=Tg(p,c.data,c.gc,h,f),d+=l)}else h=Tg(p,c.data,c.gc,h,o),d=l;v.push(h),g.push(d),b=Math.max(h,b),x=Math.max(d,x)}!function(e,t){lv(e,(function(e){var n,r=e.gc,a=r.length/2;if(a>t){for(n=0;n<a;++n)delete e.data[r[n]];r.splice(0,a)}}))}(m,t);var w=v.indexOf(b),k=g.indexOf(x),S=function(e){return{width:v[e]||0,height:g[e]||0}};return{first:S(0),last:S(t-1),widest:S(w),highest:S(k),widths:v,heights:g}}},{key:"getLabelForValue",value:function(e){return e}},{key:"getPixelForValue",value:function(e,t){return NaN}},{key:"getValueForPixel",value:function(e){}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getPixelForDecimal",value:function(e){this._reversePixels&&(e=1-e);var t=this._startPixel+e*this._length;return qv(this._alignToPixels?Eg(this.chart,t,0):t,-32768,32767)}},{key:"getDecimalForPixel",value:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}},{key:"getBasePixel",value:function(){return this.getPixelForValue(this.getBaseValue())}},{key:"getBaseValue",value:function(){var e=this.min,t=this.max;return e<0&&t<0?t:e>0&&t>0?e:0}},{key:"getContext",value:function(e){var t=this.ticks||[];if(e>=0&&e<t.length){var n=t[e];return n.$context||(n.$context=function(e,t,n){return Qg(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=Qg(this.chart.getContext(),{scale:this,type:"scale"}))}},{key:"_tickSize",value:function(){var e=this.options.ticks,t=Bv(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),a=this._getLabelSizes(),i=e.autoSkipPadding||0,o=a?a.widest.width+i:0,s=a?a.highest.height+i:0;return this.isHorizontal()?s*n>o*r?o/n:s/r:s*r<o*n?s/n:o/r}},{key:"_isVisible",value:function(){var e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}},{key:"_computeGridLineItems",value:function(e){var t,n,r,a,i,o,s,u,c,l,h,d,f=this.axis,p=this.chart,m=this.options,v=m.grid,g=m.position,y=m.border,b=v.offset,x=this.isHorizontal(),w=this.ticks.length+(b?1:0),k=xx(v),S=[],C=y.setContext(this.getContext()),I=C.display?C.width:0,T=I/2,_=function(e){return Eg(p,e,I)};if("top"===g)t=_(this.bottom),o=this.bottom-k,u=t-T,l=_(e.top)+T,d=e.bottom;else if("bottom"===g)t=_(this.top),l=e.top,d=_(e.bottom)-T,o=t+T,u=this.top+k;else if("left"===g)t=_(this.right),i=this.right-k,s=t-T,c=_(e.left)+T,h=e.right;else if("right"===g)t=_(this.left),c=e.left,h=_(e.right)-T,i=t+T,s=this.left+k;else if("x"===f){if("center"===g)t=_((e.top+e.bottom)/2+.5);else if(av(g)){var E=Object.keys(g)[0],N=g[E];t=_(this.chart.scales[E].getPixelForValue(N))}l=e.top,d=e.bottom,u=(o=t+T)+k}else if("y"===f){if("center"===g)t=_((e.left+e.right)/2);else if(av(g)){var R=Object.keys(g)[0],A=g[R];t=_(this.chart.scales[R].getPixelForValue(A))}s=(i=t-T)-k,c=e.left,h=e.right}var O=sv(m.ticks.maxTicksLimit,w),D=Math.max(1,Math.ceil(w/O));for(n=0;n<w;n+=D){var P=this.getContext(n),M=v.setContext(P),L=y.setContext(P),F=M.lineWidth,z=M.color,B=L.dash||[],V=L.dashOffset,U=M.tickWidth,W=M.tickColor,j=M.tickBorderDash||[],G=M.tickBorderDashOffset;void 0!==(r=bx(this,n,b))&&(a=Eg(p,r,F),x?i=s=c=h=a:o=u=l=d=a,S.push({tx1:i,ty1:o,tx2:s,ty2:u,x1:c,y1:l,x2:h,y2:d,width:F,color:z,borderDash:B,borderDashOffset:V,tickWidth:U,tickColor:W,tickBorderDash:j,tickBorderDashOffset:G}))}return this._ticksLength=w,this._borderValue=t,S}},{key:"_computeLabelItems",value:function(e){var t,n,r,a,i,o,s,u,c,l,h,d=this.axis,f=this.options,p=f.position,m=f.ticks,v=this.isHorizontal(),g=this.ticks,y=m.align,b=m.crossAlign,x=m.padding,w=m.mirror,k=xx(f.grid),S=k+x,C=w?-x:S,I=-Bv(this.labelRotation),T=[],_="middle";if("top"===p)i=this.bottom-C,o=this._getXAxisLabelAlignment();else if("bottom"===p)i=this.top+C,o=this._getXAxisLabelAlignment();else if("left"===p){var E=this._getYAxisLabelAlignment(k);o=E.textAlign,a=E.x}else if("right"===p){var N=this._getYAxisLabelAlignment(k);o=N.textAlign,a=N.x}else if("x"===d){if("center"===p)i=(e.top+e.bottom)/2+S;else if(av(p)){var R=Object.keys(p)[0],A=p[R];i=this.chart.scales[R].getPixelForValue(A)+S}o=this._getXAxisLabelAlignment()}else if("y"===d){if("center"===p)a=(e.left+e.right)/2-S;else if(av(p)){var O=Object.keys(p)[0],D=p[O];a=this.chart.scales[O].getPixelForValue(D)}o=this._getYAxisLabelAlignment(k).textAlign}"y"===d&&("start"===y?_="top":"end"===y&&(_="bottom"));var P=this._getLabelSizes();for(t=0,n=g.length;t<n;++t){r=g[t].label;var M=m.setContext(this.getContext(t));s=this.getPixelForTick(t)+m.labelOffset,c=(u=this._resolveTickFontOptions(t)).lineHeight;var L=(l=rv(r)?r.length:1)/2,F=M.color,z=M.textStrokeColor,B=M.textStrokeWidth,V=o;v?(a=s,"inner"===o&&(V=t===n-1?this.options.reverse?"left":"right":0===t?this.options.reverse?"right":"left":"center"),h="top"===p?"near"===b||0!==I?-l*c+c/2:"center"===b?-P.highest.height/2-L*c+c:-P.highest.height+c/2:"near"===b||0!==I?c/2:"center"===b?P.highest.height/2-L*c:P.highest.height-l*c,w&&(h*=-1),0===I||M.showLabelBackdrop||(a+=c/2*Math.sin(I))):(i=s,h=(1-l)*c/2);var U=void 0;if(M.showLabelBackdrop){var W=Zg(M.backdropPadding),j=P.heights[t],G=P.widths[t],H=h-W.top,K=0-W.left;switch(_){case"middle":H-=j/2;break;case"bottom":H-=j}switch(o){case"center":K-=G/2;break;case"right":K-=G}U={left:K,top:H,width:G+W.width,height:j+W.height,color:M.backdropColor}}T.push({label:r,font:u,textOffset:h,options:{rotation:I,color:F,strokeColor:z,strokeWidth:B,textAlign:V,textBaseline:_,translation:[a,i],backdrop:U}})}return T}},{key:"_getXAxisLabelAlignment",value:function(){var e=this.options,t=e.position,n=e.ticks;if(-Bv(this.labelRotation))return"top"===t?"left":"right";var r="center";return"start"===n.align?r="left":"end"===n.align?r="right":"inner"===n.align&&(r="inner"),r}},{key:"_getYAxisLabelAlignment",value:function(e){var t,n,r=this.options,a=r.position,i=r.ticks,o=i.crossAlign,s=i.mirror,u=i.padding,c=e+u,l=this._getLabelSizes().widest.width;return"left"===a?s?(n=this.right+u,"near"===o?t="left":"center"===o?(t="center",n+=l/2):(t="right",n+=l)):(n=this.right-c,"near"===o?t="right":"center"===o?(t="center",n-=l/2):(t="left",n=this.left)):"right"===a?s?(n=this.left+u,"near"===o?t="right":"center"===o?(t="center",n-=l/2):(t="left",n-=l)):(n=this.left+c,"near"===o?t="left":"center"===o?(t="center",n+=l/2):(t="right",n=this.right)):t="right",{textAlign:t,x:n}}},{key:"_computeLabelArea",value:function(){if(!this.options.ticks.mirror){var e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}}},{key:"drawBackground",value:function(){var e=this.ctx,t=this.options.backgroundColor,n=this.left,r=this.top,a=this.width,i=this.height;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,a,i),e.restore())}},{key:"getLineWidthForValue",value:function(e){var t=this.options.grid;if(!this._isVisible()||!t.display)return 0;var n=this.ticks.findIndex((function(t){return t.value===e}));return n>=0?t.setContext(this.getContext(n)).lineWidth:0}},{key:"drawGrid",value:function(e){var t,n,r=this.options.grid,a=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),o=function(e,t,n){n.width&&n.color&&(a.save(),a.lineWidth=n.width,a.strokeStyle=n.color,a.setLineDash(n.borderDash||[]),a.lineDashOffset=n.borderDashOffset,a.beginPath(),a.moveTo(e.x,e.y),a.lineTo(t.x,t.y),a.stroke(),a.restore())};if(r.display)for(t=0,n=i.length;t<n;++t){var s=i[t];r.drawOnChartArea&&o({x:s.x1,y:s.y1},{x:s.x2,y:s.y2},s),r.drawTicks&&o({x:s.tx1,y:s.ty1},{x:s.tx2,y:s.ty2},{color:s.tickColor,width:s.tickWidth,borderDash:s.tickBorderDash,borderDashOffset:s.tickBorderDashOffset})}}},{key:"drawBorder",value:function(){var e=this.chart,t=this.ctx,n=this.options,r=n.border,a=n.grid,i=r.setContext(this.getContext()),o=r.display?i.width:0;if(o){var s,u,c,l,h=a.setContext(this.getContext(0)).lineWidth,d=this._borderValue;this.isHorizontal()?(s=Eg(e,this.left,o)-o/2,u=Eg(e,this.right,h)+h/2,c=l=d):(c=Eg(e,this.top,o)-o/2,l=Eg(e,this.bottom,h)+h/2,s=u=d),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(s,c),t.lineTo(u,l),t.stroke(),t.restore()}}},{key:"drawLabels",value:function(e){if(this.options.ticks.display){var t=this.ctx,n=this._computeLabelArea();n&&Dg(t,n);var r,a=ye(this.getLabelItems(e));try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.options,s=i.font;Bg(t,i.label,0,i.textOffset,s,o)}}catch(u){a.e(u)}finally{a.f()}n&&Pg(t)}}},{key:"drawTitle",value:function(){var e=this.ctx,t=this.options,n=t.position,r=t.title,a=t.reverse;if(r.display){var i=Xg(r.font),o=Zg(r.padding),s=r.align,u=i.lineHeight/2;"bottom"===n||"center"===n||av(n)?(u+=o.bottom,rv(r.text)&&(u+=i.lineHeight*(r.text.length-1))):u+=o.top;var c=function(e,t,n,r){var a,i,o,s=e.top,u=e.left,c=e.bottom,l=e.right,h=e.chart,d=h.chartArea,f=h.scales,p=0,m=c-s,v=l-u;if(e.isHorizontal()){if(i=ag(r,u,l),av(n)){var g=Object.keys(n)[0],y=n[g];o=f[g].getPixelForValue(y)+m-t}else o="center"===n?(d.bottom+d.top)/2+m-t:vx(e,n,t);a=l-u}else{if(av(n)){var b=Object.keys(n)[0],x=n[b];i=f[b].getPixelForValue(x)-v+t}else i="center"===n?(d.left+d.right)/2-v+t:vx(e,n,t);o=ag(r,c,s),p="left"===n?-Rv:Rv}return{titleX:i,titleY:o,maxWidth:a,rotation:p}}(this,u,n,s),l=c.titleX,h=c.titleY,d=c.maxWidth,f=c.rotation;Bg(e,r.text,0,0,i,{color:r.color,maxWidth:d,rotation:f,textAlign:kx(s,n,a),textBaseline:"middle",translation:[l,h]})}}},{key:"draw",value:function(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}},{key:"_layers",value:function(){var e=this,t=this.options,r=t.ticks&&t.ticks.z||0,a=sv(t.grid&&t.grid.z,-1),i=sv(t.border&&t.border.z,0);return this._isVisible()&&this.draw===n.prototype.draw?[{z:a,draw:function(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:i,draw:function(){e.drawBorder()}},{z:r,draw:function(t){e.drawLabels(t)}}]:[{z:r,draw:function(t){e.draw(t)}}]}},{key:"getMatchingVisibleMetas",value:function(e){var t,n,r=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",i=[];for(t=0,n=r.length;t<n;++t){var o=r[t];o[a]!==this.id||e&&o.type!==e||i.push(o)}return i}},{key:"_resolveTickFontOptions",value:function(e){return Xg(this.options.ticks.setContext(this.getContext(e)).font)}},{key:"_maxDigits",value:function(){var e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}]),n}(fx),Cx=function(){function e(t,n,r){Se(this,e),this.type=t,this.scope=n,this.override=r,this.items=Object.create(null)}return Te(e,[{key:"isForType",value:function(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}},{key:"register",value:function(e){var t,n=Object.getPrototypeOf(e);(function(e){return"id"in e&&"defaults"in e})(n)&&(t=this.register(n));var r=this.items,a=e.id,i=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,function(e,t,n){var r=mv(Object.create(null),[n?Ig.get(n):{},Ig.get(t),e.defaults]);Ig.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((function(n){var r=n.split("."),a=r.pop(),i=[e].concat(r).join("."),o=t[n].split("."),s=o.pop(),u=o.join(".");Ig.route(i,a,u,s)}))}(t,e.defaultRoutes);e.descriptors&&Ig.describe(t,e.descriptors)}(e,i,t),this.override&&Ig.override(e.id,e.overrides)),i}},{key:"get",value:function(e){return this.items[e]}},{key:"unregister",value:function(e){var t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in Ig[r]&&(delete Ig[r][n],this.override&&delete xg[n])}}]),e}();var Ix=function(){function e(){Se(this,e),this.controllers=new Cx(ub,"datasets",!0),this.elements=new Cx(fx,"elements"),this.plugins=new Cx(Object,"plugins"),this.scales=new Cx(Sx,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}return Te(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}},{key:"addControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}},{key:"addElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}},{key:"addScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}},{key:"getController",value:function(e){return this._get(e,this.controllers,"controller")}},{key:"getElement",value:function(e){return this._get(e,this.elements,"element")}},{key:"getPlugin",value:function(e){return this._get(e,this.plugins,"plugin")}},{key:"getScale",value:function(e){return this._get(e,this.scales,"scale")}},{key:"removeControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}},{key:"removeElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}},{key:"removePlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}},{key:"removeScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}},{key:"_each",value:function(e,t,n){var r=this;(0,ke.Z)(t).forEach((function(t){var a=n||r._getRegistryForType(t);n||a.isForType(t)||a===r.plugins&&t.id?r._exec(e,a,t):lv(t,(function(t){var a=n||r._getRegistryForType(t);r._exec(e,a,t)}))}))}},{key:"_exec",value:function(e,t,n){var r=wv(e);cv(n["before"+r],[],n),t[e](n),cv(n["after"+r],[],n)}},{key:"_getRegistryForType",value:function(e){for(var t=0;t<this._typedRegistries.length;t++){var n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}},{key:"_get",value:function(e,t,n){var r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}]),e}(),Tx=new Ix,_x=function(){function e(){Se(this,e),this._init=[]}return Te(e,[{key:"notify",value:function(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));var a=r?this._descriptors(e).filter(r):this._descriptors(e),i=this._notify(a,e,t,n);return"afterDestroy"===t&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall")),i}},{key:"_notify",value:function(e,t,n,r){r=r||{};var a,i=ye(e);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.plugin;if(!1===cv(s[n],[t,r,o.options],s)&&r.cancelable)return!1}}catch(u){i.e(u)}finally{i.f()}return!0}},{key:"invalidate",value:function(){nv(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}},{key:"_descriptors",value:function(e){if(this._cache)return this._cache;var t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}},{key:"_createDescriptors",value:function(e,t){var n=e&&e.config,r=sv(n.options&&n.options.plugins,{}),a=function(e){for(var t={},n=[],r=Object.keys(Tx.plugins.items),a=0;a<r.length;a++)n.push(Tx.getPlugin(r[a]));for(var i=e.plugins||[],o=0;o<i.length;o++){var s=i[o];-1===n.indexOf(s)&&(n.push(s),t[s.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){var a,i=t.plugins,o=t.localIds,s=[],u=e.getContext(),c=ye(i);try{for(c.s();!(a=c.n()).done;){var l=a.value,h=l.id,d=Ex(n[h],r);null!==d&&s.push({plugin:l,options:Nx(e.config,{plugin:l,local:o[h]},d,u)})}}catch(f){c.e(f)}finally{c.f()}return s}(e,a,r,t):[]}},{key:"_notifyStateChanges",value:function(e){var t=this._oldCache||[],n=this._cache,r=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.plugin.id===t.plugin.id}))}))};this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}]),e}();function Ex(e,t){return t||!1!==e?!0===e?{}:e:null}function Nx(e,t,n,r){var a=t.plugin,i=t.local,o=e.pluginScopeKeys(a),s=e.getOptionScopes(n,o);return i&&a.defaults&&s.push(a.defaults),e.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Rx(e,t){var n=Ig.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Ax(e){if("x"===e||"y"===e||"r"===e)return e}function Ox(e){if(Ax(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a],s=o.axis||("top"===(u=o.position)||"bottom"===u?"x":"left"===u||"right"===u?"y":void 0)||e.length>1&&Ax(e[0].toLowerCase());if(s)return s}var u;throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Dx(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Px(e,t){var n=xg[e.type]||{scales:{}},r=t.scales||{},a=Rx(e.type,t),i=Object.create(null);return Object.keys(r).forEach((function(t){var o=r[t];if(!av(o))return console.error("Invalid scale configuration for scale: ".concat(t));if(o._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));var s=Ox(t,o,function(e,t){if(t.data&&t.data.datasets){var n=t.data.datasets.filter((function(t){return t.xAxisID===e||t.yAxisID===e}));if(n.length)return Dx(e,"x",n[0])||Dx(e,"y",n[0])}return{}}(t,e),Ig.scales[o.type]),u=function(e,t){return e===t?"_index_":"_value_"}(s,a),c=n.scales||{};i[t]=vv(Object.create(null),[{axis:s},o,c[s],c[u]])})),e.data.datasets.forEach((function(n){var a=n.type||e.type,o=n.indexAxis||Rx(a,t),s=(xg[a]||{}).scales||{};Object.keys(s).forEach((function(e){var t=function(e,t){var n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,o),a=n[t+"AxisID"]||t;i[a]=i[a]||Object.create(null),vv(i[a],[{axis:t},r[a],s[e]])}))})),Object.keys(i).forEach((function(e){var t=i[e];vv(t,[Ig.scales[t.type],Ig.scale])})),i}function Mx(e){var t=e.options||(e.options={});t.plugins=sv(t.plugins,{}),t.scales=Px(e,t)}function Lx(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}var Fx=new Map,zx=new Set;function Bx(e,t){var n=Fx.get(e);return n||(n=t(),Fx.set(e,n),zx.add(n)),n}var Vx=function(e,t,n){var r=xv(t,n);void 0!==r&&e.add(r)},Ux=function(){function e(t){Se(this,e),this._config=function(e){return(e=e||{}).data=Lx(e.data),Mx(e),e}(t),this._scopeCache=new Map,this._resolverCache=new Map}return Te(e,[{key:"platform",get:function(){return this._config.platform}},{key:"type",get:function(){return this._config.type},set:function(e){this._config.type=e}},{key:"data",get:function(){return this._config.data},set:function(e){this._config.data=Lx(e)}},{key:"options",get:function(){return this._config.options},set:function(e){this._config.options=e}},{key:"plugins",get:function(){return this._config.plugins}},{key:"update",value:function(){var e=this._config;this.clearCache(),Mx(e)}},{key:"clearCache",value:function(){this._scopeCache.clear(),this._resolverCache.clear()}},{key:"datasetScopeKeys",value:function(e){return Bx(e,(function(){return[["datasets.".concat(e),""]]}))}},{key:"datasetAnimationScopeKeys",value:function(e,t){return Bx("".concat(e,".transition.").concat(t),(function(){return[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]}))}},{key:"datasetElementScopeKeys",value:function(e,t){return Bx("".concat(e,"-").concat(t),(function(){return[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]}))}},{key:"pluginScopeKeys",value:function(e){var t=e.id,n=this.type;return Bx("".concat(n,"-plugin-").concat(t),(function(){return[["plugins.".concat(t)].concat((0,ke.Z)(e.additionalOptionScopes||[]))]}))}},{key:"_cachedScopes",value:function(e,t){var n=this._scopeCache,r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}},{key:"getOptionScopes",value:function(e,t,n){var r=this.options,a=this.type,i=this._cachedScopes(e,n),o=i.get(t);if(o)return o;var s=new Set;t.forEach((function(t){e&&(s.add(e),t.forEach((function(t){return Vx(s,e,t)}))),t.forEach((function(e){return Vx(s,r,e)})),t.forEach((function(e){return Vx(s,xg[a]||{},e)})),t.forEach((function(e){return Vx(s,Ig,e)})),t.forEach((function(e){return Vx(s,wg,e)}))}));var u=Array.from(s);return 0===u.length&&u.push(Object.create(null)),zx.has(t)&&i.set(t,u),u}},{key:"chartOptionScopes",value:function(){var e=this.options,t=this.type;return[e,xg[t]||{},Ig.datasets[t]||{},{type:t},Ig,wg]}},{key:"resolveNamedOptions",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""],a={$shared:!0},i=Wx(this._resolverCache,e,r),o=i.resolver,s=i.subPrefixes,u=o;(function(e,t){var n,r=ey(e),a=r.isScriptable,i=r.isIndexable,o=ye(t);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=a(s),c=i(s),l=(c||u)&&e[s];if(u&&(Sv(l)||jx(l))||c&&rv(l))return!0}}catch(h){o.e(h)}finally{o.f()}return!1})(o,t)&&(a.$shared=!1,u=Jg(o,n=Sv(n)?n():n,this.createResolver(e,n,s)));var c,l=ye(t);try{for(l.s();!(c=l.n()).done;){var h=c.value;a[h]=u[h]}}catch(d){l.e(d)}finally{l.f()}return a}},{key:"createResolver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0,a=Wx(this._resolverCache,e,n).resolver;return av(t)?Jg(a,t,void 0,r):a}}]),e}();function Wx(e,t,n){var r=e.get(t);r||(r=new Map,e.set(t,r));var a=n.join(),i=r.get(a);i||(i={resolver:$g(t,n),subPrefixes:n.filter((function(e){return!e.toLowerCase().includes("hover")}))},r.set(a,i));return i}var jx=function(e){return av(e)&&Object.getOwnPropertyNames(e).reduce((function(t,n){return t||Sv(e[n])}),!1)};var Gx=["top","bottom","left","right","chartArea"];function Hx(e,t){return"top"===e||"bottom"===e||-1===Gx.indexOf(e)&&"x"===t}function Kx(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function qx(e){var t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),cv(n&&n.onComplete,[e],t)}function Zx(e){var t=e.chart,n=t.options.animation;cv(n&&n.onProgress,[e],t)}function Xx(e){return by()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var Yx={},Qx=function(e){var t=Xx(e);return Object.values(Yx).filter((function(e){return e.canvas===t})).pop()};function $x(e,t,n){for(var r=0,a=Object.keys(e);r<a.length;r++){var i=a[r],o=+i;if(o>=t){var s=e[i];delete e[i],(n>0||o>t)&&(e[o+n]=s)}}}function Jx(e,t,n){return e.options.clip?e[n]:t[n]}var ew=function(){function e(t,n){var r=this;Se(this,e);var a=this.config=new Ux(n),i=Xx(t),o=Qx(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");var s=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||function(e){return!by()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Qb:dx}(i)),this.platform.updateConfig(a);var u=this.platform.acquireContext(i,s.aspectRatio),c=u&&u.canvas,l=c&&c.height,h=c&&c.width;this.id=tv(),this.ctx=u,this.canvas=c,this.width=h,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _x,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){var n;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}((function(e){return r.update(e)}),s.resizeDelay||0),this._dataChanges=[],Yx[this.id]=this,u&&c?(Ky.listen(this,"complete",qx),Ky.listen(this,"progress",Zx),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}return Te(e,[{key:"aspectRatio",get:function(){var e=this.options,t=e.aspectRatio,n=e.maintainAspectRatio,r=this.width,a=this.height,i=this._aspectRatio;return nv(t)?n&&i?i:a?r/a:null:t}},{key:"data",get:function(){return this.config.data},set:function(e){this.config.data=e}},{key:"options",get:function(){return this._options},set:function(e){this.config.options=e}},{key:"registry",get:function(){return Tx}},{key:"_initialize",value:function(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ny(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}},{key:"clear",value:function(){return Ng(this.canvas,this.ctx),this}},{key:"stop",value:function(){return Ky.stop(this),this}},{key:"resize",value:function(e,t){Ky.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}},{key:"_resize",value:function(e,t){var n=this.options,r=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(r,e,t,a),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,Ny(this,o,!0)&&(this.notifyPlugins("resize",{size:i}),cv(n.onResize,[this,i],this),this.attached&&this._doResize(s)&&this.render())}},{key:"ensureScalesHaveIDs",value:function(){lv(this.options.scales||{},(function(e,t){e.id=t}))}},{key:"buildOrUpdateScales",value:function(){var e=this,t=this.options,n=t.scales,r=this.scales,a=Object.keys(r).reduce((function(e,t){return e[t]=!1,e}),{}),i=[];n&&(i=i.concat(Object.keys(n).map((function(e){var t=n[e],r=Ox(e,t),a="r"===r,i="x"===r;return{options:t,dposition:a?"chartArea":i?"bottom":"left",dtype:a?"radialLinear":i?"category":"linear"}})))),lv(i,(function(n){var i=n.options,o=i.id,s=Ox(o,i),u=sv(i.type,n.dtype);void 0!==i.position&&Hx(i.position,s)===Hx(n.dposition)||(i.position=n.dposition),a[o]=!0;var c=null;o in r&&r[o].type===u?c=r[o]:(c=new(Tx.getScale(u))({id:o,type:u,ctx:e.ctx,chart:e}),r[c.id]=c);c.init(i,t)})),lv(a,(function(e,t){e||delete r[t]})),lv(r,(function(t){Zb(e,t,t.options),Kb(e,t)}))}},{key:"_updateMetasets",value:function(){var e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((function(e,t){return e.index-t.index})),n>t){for(var r=t;r<n;++r)this._destroyDatasetMeta(r);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Kx("order","index"))}},{key:"_removeUnreferencedMetasets",value:function(){var e=this,t=this._metasets,n=this.data.datasets;t.length>n.length&&delete this._stacks,t.forEach((function(t,r){0===n.filter((function(e){return e===t._dataset})).length&&e._destroyDatasetMeta(r)}))}},{key:"buildOrUpdateControllers",value:function(){var e,t,n=[],r=this.data.datasets;for(this._removeUnreferencedMetasets(),e=0,t=r.length;e<t;e++){var a=r[e],i=this.getDatasetMeta(e),o=a.type||this.config.type;if(i.type&&i.type!==o&&(this._destroyDatasetMeta(e),i=this.getDatasetMeta(e)),i.type=o,i.indexAxis=a.indexAxis||Rx(o,this.options),i.order=a.order||0,i.index=e,i.label=""+a.label,i.visible=this.isDatasetVisible(e),i.controller)i.controller.updateIndex(e),i.controller.linkScales();else{var s=Tx.getController(o),u=Ig.datasets[o],c=u.datasetElementType,l=u.dataElementType;Object.assign(s,{dataElementType:Tx.getElement(l),datasetElementType:c&&Tx.getElement(c)}),i.controller=new s(this,e),n.push(i.controller)}}return this._updateMetasets(),n}},{key:"_resetElements",value:function(){var e=this;lv(this.data.datasets,(function(t,n){e.getDatasetMeta(n).controller.reset()}),this)}},{key:"reset",value:function(){this._resetElements(),this.notifyPlugins("reset")}},{key:"update",value:function(e){var t=this.config;t.update();var n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1!==this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})){var a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");for(var i=0,o=0,s=this.data.datasets.length;o<s;o++){var u=this.getDatasetMeta(o).controller,c=!r&&-1===a.indexOf(u);u.buildOrUpdateElements(c),i=Math.max(+u.getMaxOverflow(),i)}i=this._minPadding=n.layout.autoPadding?i:0,this._updateLayout(i),r||lv(a,(function(e){e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Kx("z","_idx"));var l=this._active,h=this._lastEvent;h?this._eventHandler(h,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}}},{key:"_updateScales",value:function(){var e=this;lv(this.scales,(function(t){qb(e,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}},{key:"_checkEventBindings",value:function(){var e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Cv(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}},{key:"_updateHiddenIndices",value:function(){var e,t=this._hiddenIndices,n=ye(this._getUniformDataChanges()||[]);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.method,i=r.start,o=r.count;$x(t,i,"_removeElements"===a?-o:o)}}catch(s){n.e(s)}finally{n.f()}}},{key:"_getUniformDataChanges",value:function(){var e=this._dataChanges;if(e&&e.length){this._dataChanges=[];for(var t=this.data.datasets.length,n=function(t){return new Set(e.filter((function(e){return e[0]===t})).map((function(e,t){return t+","+e.splice(1).join(",")})))},r=n(0),a=1;a<t;a++)if(!Cv(r,n(a)))return;return Array.from(r).map((function(e){return e.split(",")})).map((function(e){return{method:e[1],start:+e[2],count:+e[3]}}))}}},{key:"_updateLayout",value:function(e){var t=this;if(!1!==this.notifyPlugins("beforeLayout",{cancelable:!0})){Xb(this,this.width,this.height,e);var n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],lv(this.boxes,(function(e){var n;r&&"chartArea"===e.position||(e.configure&&e.configure(),(n=t._layers).push.apply(n,(0,ke.Z)(e._layers())))}),this),this._layers.forEach((function(e,t){e._idx=t})),this.notifyPlugins("afterLayout")}}},{key:"_updateDatasets",value:function(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(var t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(var r=0,a=this.data.datasets.length;r<a;++r)this._updateDataset(r,Sv(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}},{key:"_updateDataset",value:function(e,t){var n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}},{key:"render",value:function(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Ky.has(this)?this.attached&&!Ky.running(this)&&Ky.start(this):(this.draw(),qx({chart:this})))}},{key:"draw",value:function(){var e;if(this._resizeBeforeDraw){var t=this._resizeBeforeDraw,n=t.width,r=t.height;this._resize(n,r),this._resizeBeforeDraw=null}if(this.clear(),!(this.width<=0||this.height<=0)&&!1!==this.notifyPlugins("beforeDraw",{cancelable:!0})){var a=this._layers;for(e=0;e<a.length&&a[e].z<=0;++e)a[e].draw(this.chartArea);for(this._drawDatasets();e<a.length;++e)a[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}}},{key:"_getSortedDatasetMetas",value:function(e){var t,n,r=this._sortedMetasets,a=[];for(t=0,n=r.length;t<n;++t){var i=r[t];e&&!i.visible||a.push(i)}return a}},{key:"getSortedVisibleDatasetMetas",value:function(){return this._getSortedDatasetMetas(!0)}},{key:"_drawDatasets",value:function(){if(!1!==this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})){for(var e=this.getSortedVisibleDatasetMetas(),t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}}},{key:"_drawDataset",value:function(e){var t=this.ctx,n=e._clip,r=!n.disabled,a=function(e,t){var n=e.xScale,r=e.yScale;return n&&r?{left:Jx(n,t,"left"),right:Jx(n,t,"right"),top:Jx(r,t,"top"),bottom:Jx(r,t,"bottom")}:t}(e,this.chartArea),i={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",i)&&(r&&Dg(t,{left:!1===n.left?0:a.left-n.left,right:!1===n.right?this.width:a.right+n.right,top:!1===n.top?0:a.top-n.top,bottom:!1===n.bottom?this.height:a.bottom+n.bottom}),e.controller.draw(),r&&Pg(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}},{key:"isPointInArea",value:function(e){return Og(e,this.chartArea,this._minPadding)}},{key:"getElementsAtEventForMode",value:function(e,t,n,r){var a=Db.modes[t];return"function"===typeof a?a(this,e,n,r):[]}},{key:"getDatasetMeta",value:function(e){var t=this.data.datasets[e],n=this._metasets,r=n.filter((function(e){return e&&e._dataset===t})).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}},{key:"getContext",value:function(){return this.$context||(this.$context=Qg(null,{chart:this,type:"chart"}))}},{key:"getVisibleDatasetCount",value:function(){return this.getSortedVisibleDatasetMetas().length}},{key:"isDatasetVisible",value:function(e){var t=this.data.datasets[e];if(!t)return!1;var n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}},{key:"setDatasetVisibility",value:function(e,t){this.getDatasetMeta(e).hidden=!t}},{key:"toggleDataVisibility",value:function(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}},{key:"getDataVisibility",value:function(e){return!this._hiddenIndices[e]}},{key:"_updateVisibility",value:function(e,t,n){var r=n?"show":"hide",a=this.getDatasetMeta(e),i=a.controller._resolveAnimations(void 0,r);kv(t)?(a.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),i.update(a,{visible:n}),this.update((function(t){return t.datasetIndex===e?r:void 0})))}},{key:"hide",value:function(e,t){this._updateVisibility(e,t,!1)}},{key:"show",value:function(e,t){this._updateVisibility(e,t,!0)}},{key:"_destroyDatasetMeta",value:function(e){var t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}},{key:"_stop",value:function(){var e,t;for(this.stop(),Ky.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}},{key:"destroy",value:function(){this.notifyPlugins("beforeDestroy");var e=this.canvas,t=this.ctx;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Ng(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Yx[this.id],this.notifyPlugins("afterDestroy")}},{key:"toBase64Image",value:function(){var e;return(e=this.canvas).toDataURL.apply(e,arguments)}},{key:"bindEvents",value:function(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}},{key:"bindUserEvents",value:function(){var e=this,t=this._listeners,n=this.platform,r=function(t,n,r){t.offsetX=n,t.offsetY=r,e._eventHandler(t)};lv(this.options.events,(function(a){return function(r,a){n.addEventListener(e,r,a),t[r]=a}(a,r)}))}},{key:"bindResponsiveEvents",value:function(){var e=this;this._responsiveListeners||(this._responsiveListeners={});var t,n=this._responsiveListeners,r=this.platform,a=function(t,a){r.addEventListener(e,t,a),n[t]=a},i=function(t,a){n[t]&&(r.removeEventListener(e,t,a),delete n[t])},o=function(t,n){e.canvas&&e.resize(t,n)},s=function n(){i("attach",n),e.attached=!0,e.resize(),a("resize",o),a("detach",t)};t=function(){e.attached=!1,i("resize",o),e._stop(),e._resize(0,0),a("attach",s)},r.isAttached(this.canvas)?s():t()}},{key:"unbindEvents",value:function(){var e=this;lv(this._listeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._listeners={},lv(this._responsiveListeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._responsiveListeners=void 0}},{key:"updateHoverStyle",value:function(e,t,n){var r,a,i,o=n?"set":"remove";for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+o+"DatasetHoverStyle"](),a=0,i=e.length;a<i;++a){var s=(r=e[a])&&this.getDatasetMeta(r.datasetIndex).controller;s&&s[o+"HoverStyle"](r.element,r.datasetIndex,r.index)}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e){var t=this,n=this._active||[],r=e.map((function(e){var n=e.datasetIndex,r=e.index,a=t.getDatasetMeta(n);if(!a)throw new Error("No dataset found at index "+n);return{datasetIndex:n,element:a.data[r],index:r}}));!hv(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}},{key:"notifyPlugins",value:function(e,t,n){return this._plugins.notify(this,e,t,n)}},{key:"isPluginEnabled",value:function(e){return 1===this._plugins._cache.filter((function(t){return t.plugin.id===e})).length}},{key:"_updateHoverStyles",value:function(e,t,n){var r=this.options.hover,a=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.datasetIndex===t.datasetIndex&&e.index===t.index}))}))},i=a(t,e),o=n?e:a(e,t);i.length&&this.updateHoverStyle(i,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}},{key:"_eventHandler",value:function(e,t){var n=this,r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=function(t){return(t.options.events||n.options.events).includes(e.native.type)};if(!1!==this.notifyPlugins("beforeEvent",r,a)){var i=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(i||r.changed)&&this.render(),this}}},{key:"_handleEvent",value:function(e,t,n){var r=this._active,a=void 0===r?[]:r,i=this.options,o=t,s=this._getActiveElements(e,a,n,o),u=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),c=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,u);n&&(this._lastEvent=null,cv(i.onHover,[e,s,this],this),u&&cv(i.onClick,[e,s,this],this));var l=!hv(s,a);return(l||t)&&(this._active=s,this._updateHoverStyles(s,a,t)),this._lastEvent=c,l}},{key:"_getActiveElements",value:function(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;var a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}],[{key:"register",value:function(){Tx.add.apply(Tx,arguments),tw()}},{key:"unregister",value:function(){Tx.remove.apply(Tx,arguments),tw()}}]),e}();function tw(){return lv(ew.instances,(function(e){return e._plugins.invalidate()}))}function nw(e,t,n,r){var a=Hg(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),i=(n-t)/2,o=Math.min(i,r*t/2),s=function(e){var t=(n-Math.min(i,e))*r/2;return qv(e,0,Math.min(i,t))};return{outerStart:s(a.outerStart),outerEnd:s(a.outerEnd),innerStart:qv(a.innerStart,0,o),innerEnd:qv(a.innerEnd,0,o)}}function rw(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function aw(e,t,n,r,a,i){var o=t.x,s=t.y,u=t.startAngle,c=t.pixelMargin,l=t.innerRadius,h=Math.max(t.outerRadius+r+n-c,0),d=l>0?l+r+n+c:0,f=0,p=a-u;if(r){var m=((l>0?l-r:0)+(h>0?h-r:0))/2;f=(p-(0!==m?p*m/(m+r):p))/2}var v=(p-Math.max(.001,p*h-n/Iv)/h)/2,g=u+v+f,y=a-v-f,b=nw(t,d,h,y-g),x=b.outerStart,w=b.outerEnd,k=b.innerStart,S=b.innerEnd,C=h-x,I=h-w,T=g+x/C,_=y-w/I,E=d+k,N=d+S,R=g+k/E,A=y-S/N;if(e.beginPath(),i){var O=(T+_)/2;if(e.arc(o,s,h,T,O),e.arc(o,s,h,O,_),w>0){var D=rw(I,_,o,s);e.arc(D.x,D.y,w,_,y+Rv)}var P=rw(N,y,o,s);if(e.lineTo(P.x,P.y),S>0){var M=rw(N,A,o,s);e.arc(M.x,M.y,S,y+Rv,A+Math.PI)}var L=(y-S/d+(g+k/d))/2;if(e.arc(o,s,d,y-S/d,L,!0),e.arc(o,s,d,L,g+k/d,!0),k>0){var F=rw(E,R,o,s);e.arc(F.x,F.y,k,R+Math.PI,g-Rv)}var z=rw(C,g,o,s);if(e.lineTo(z.x,z.y),x>0){var B=rw(C,T,o,s);e.arc(B.x,B.y,x,g-Rv,T)}}else{e.moveTo(o,s);var V=Math.cos(T)*h+o,U=Math.sin(T)*h+s;e.lineTo(V,U);var W=Math.cos(_)*h+o,j=Math.sin(_)*h+s;e.lineTo(W,j)}e.closePath()}function iw(e,t,n,r,a){var i=t.fullCircles,o=t.startAngle,s=t.circumference,u=t.options,c=u.borderWidth,l=u.borderJoinStyle,h=u.borderDash,d=u.borderDashOffset,f="inner"===u.borderAlign;if(c){e.setLineDash(h||[]),e.lineDashOffset=d,f?(e.lineWidth=2*c,e.lineJoin=l||"round"):(e.lineWidth=c,e.lineJoin=l||"bevel");var p=t.endAngle;if(i){aw(e,t,n,r,p,a);for(var m=0;m<i;++m)e.stroke();isNaN(s)||(p=o+(s%Tv||Tv))}f&&function(e,t,n){var r=t.startAngle,a=t.pixelMargin,i=t.x,o=t.y,s=t.outerRadius,u=t.innerRadius,c=a/s;e.beginPath(),e.arc(i,o,s,r-c,n+c),u>a?(c=a/u,e.arc(i,o,u,n+c,r-c,!0)):e.arc(i,o,a,n+Rv,r-Rv),e.closePath(),e.clip()}(e,t,p),i||(aw(e,t,n,r,p,a),e.stroke())}}(0,_.Z)(ew,"defaults",Ig),(0,_.Z)(ew,"instances",Yx),(0,_.Z)(ew,"overrides",xg),(0,_.Z)(ew,"registry",Tx),(0,_.Z)(ew,"version","4.4.0"),(0,_.Z)(ew,"getChart",Qx);var ow=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),r=t.call(this),(0,_.Z)(xe(r),"circumference",void 0),(0,_.Z)(xe(r),"endAngle",void 0),(0,_.Z)(xe(r),"fullCircles",void 0),(0,_.Z)(xe(r),"innerRadius",void 0),(0,_.Z)(xe(r),"outerRadius",void 0),(0,_.Z)(xe(r),"pixelMargin",void 0),(0,_.Z)(xe(r),"startAngle",void 0),r.options=void 0,r.circumference=void 0,r.startAngle=void 0,r.endAngle=void 0,r.innerRadius=void 0,r.outerRadius=void 0,r.pixelMargin=0,r.fullCircles=0,e&&Object.assign(xe(r),e),r}return Te(n,[{key:"inRange",value:function(e,t,n){var r=Wv(this.getProps(["x","y"],n),{x:e,y:t}),a=r.angle,i=r.distance,o=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),s=o.startAngle,u=o.endAngle,c=o.innerRadius,l=o.outerRadius,h=o.circumference,d=(this.options.spacing+this.options.borderWidth)/2,f=sv(h,u-s)>=Tv||Kv(a,s,u),p=Zv(i,c+d,l+d);return f&&p}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),n=t.x,r=t.y,a=t.startAngle,i=t.endAngle,o=t.innerRadius,s=t.outerRadius,u=this.options,c=u.offset,l=(a+i)/2,h=(o+s+u.spacing+c)/2;return{x:n+Math.cos(l)*h,y:r+Math.sin(l)*h}}},{key:"tooltipPosition",value:function(e){return this.getCenterPoint(e)}},{key:"draw",value:function(e){var t=this.options,n=this.circumference,r=(t.offset||0)/4,a=(t.spacing||0)/2,i=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>Tv?Math.floor(n/Tv):0,!(0===n||this.innerRadius<0||this.outerRadius<0)){e.save();var o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*r,Math.sin(o)*r);var s=r*(1-Math.sin(Math.min(Iv,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,a){var i=t.fullCircles,o=t.startAngle,s=t.circumference,u=t.endAngle;if(i){aw(e,t,n,r,u,a);for(var c=0;c<i;++c)e.fill();isNaN(s)||(u=o+(s%Tv||Tv))}aw(e,t,n,r,u,a),e.fill()}(e,this,s,a,i),iw(e,this,s,a,i),e.restore()}}}]),n}(fx);function sw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=sv(n.borderCapStyle,t.borderCapStyle),e.setLineDash(sv(n.borderDash,t.borderDash)),e.lineDashOffset=sv(n.borderDashOffset,t.borderDashOffset),e.lineJoin=sv(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=sv(n.borderWidth,t.borderWidth),e.strokeStyle=sv(n.borderColor,t.borderColor)}function uw(e,t,n){e.lineTo(n.x,n.y)}function cw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.length,a=n.start,i=void 0===a?0:a,o=n.end,s=void 0===o?r-1:o,u=t.start,c=t.end,l=Math.max(i,u),h=Math.min(s,c),d=i<u&&s<u||i>c&&s>c;return{count:r,start:l,loop:t.loop,ilen:h<l&&!d?r+h-l:h-l}}function lw(e,t,n,r){var a,i,o,s=t.points,u=t.options,c=cw(s,n,r),l=c.count,h=c.start,d=c.loop,f=c.ilen,p=function(e){return e.stepped?Mg:e.tension||"monotone"===e.cubicInterpolationMode?Lg:uw}(u),m=r||{},v=m.move,g=void 0===v||v,y=m.reverse;for(a=0;a<=f;++a)(i=s[(h+(y?f-a:a))%l]).skip||(g?(e.moveTo(i.x,i.y),g=!1):p(e,o,i,y,u.stepped),o=i);return d&&p(e,o,i=s[(h+(y?f:0))%l],y,u.stepped),!!d}function hw(e,t,n,r){var a,i,o,s,u,c,l=t.points,h=cw(l,n,r),d=h.count,f=h.start,p=h.ilen,m=r||{},v=m.move,g=void 0===v||v,y=m.reverse,b=0,x=0,w=function(e){return(f+(y?p-e:e))%d},k=function(){s!==u&&(e.lineTo(b,u),e.lineTo(b,s),e.lineTo(b,c))};for(g&&(i=l[w(0)],e.moveTo(i.x,i.y)),a=0;a<=p;++a)if(!(i=l[w(a)]).skip){var S=i.x,C=i.y,I=0|S;I===o?(C<s?s=C:C>u&&(u=C),b=(x*b+S)/++x):(k(),e.lineTo(S,C),o=I,x=0,s=u=C),c=C}k()}function dw(e){var t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?hw:lw}(0,_.Z)(ow,"id","arc"),(0,_.Z)(ow,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),(0,_.Z)(ow,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,_.Z)(ow,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e}});var fw="function"===typeof Path2D;function pw(e,t,n,r){fw&&!t.options.segment?function(e,t,n,r){var a=t._path;a||(a=t._path=new Path2D,t.path(a,n,r)&&a.closePath()),sw(e,t.options),e.stroke(a)}(e,t,n,r):function(e,t,n,r){var a,i=t.segments,o=t.options,s=dw(t),u=ye(i);try{for(u.s();!(a=u.n()).done;){var c=a.value;sw(e,o,c.style),e.beginPath(),s(e,t,c,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}}catch(l){u.e(l)}finally{u.f()}}(e,t,n,r)}var mw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).animated=!0,r.options=void 0,r._chart=void 0,r._loop=void 0,r._fullLoop=void 0,r._path=void 0,r._points=void 0,r._segments=void 0,r._decimated=!1,r._pointsUpdated=!1,r._datasetIndex=void 0,e&&Object.assign(xe(r),e),r}return Te(n,[{key:"updateControlPoints",value:function(e,t){var n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){var r=n.spanGaps?this._loop:this._fullLoop;yy(this._points,n,e,r,t),this._pointsUpdated=!0}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}},{key:"segments",get:function(){return this._segments||(this._segments=function(e,t){var n=e.points,r=e.options.spanGaps,a=n.length;if(!a)return[];var i=!!e._loop,o=function(e,t,n,r){var a=0,i=t-1;if(n&&!r)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,n&&(i+=a);i>a&&e[i%t].skip;)i--;return{start:a,end:i%=t}}(n,a,i,r),s=o.start,u=o.end;return Wy(e,!0===r?[{start:s,end:u,loop:i}]:function(e,t,n,r){var a,i=e.length,o=[],s=t,u=e[t];for(a=t+1;a<=n;++a){var c=e[a%i];c.skip||c.stop?u.skip||(r=!1,o.push({start:t%i,end:(a-1)%i,loop:r}),t=s=c.stop?a:null):(s=a,u.skip&&(t=a)),u=c}return null!==s&&o.push({start:t%i,end:s%i,loop:r}),o}(n,s,u<s?u+a:u,!!e._fullLoop&&0===s&&u===a-1),n,t)}(this,this.options.segment))}},{key:"first",value:function(){var e=this.segments,t=this.points;return e.length&&t[e[0].start]}},{key:"last",value:function(){var e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}},{key:"interpolate",value:function(e,t){var n=this.options,r=e[t],a=this.points,i=Uy(this,{property:t,start:r,end:r});if(i.length){var o,s,u=[],c=function(e){return e.stepped?Dy:e.tension||"monotone"===e.cubicInterpolationMode?Py:Oy}(n);for(o=0,s=i.length;o<s;++o){var l=i[o],h=l.start,d=l.end,f=a[h],p=a[d];if(f!==p){var m=c(f,p,Math.abs((r-f[t])/(p[t]-f[t])),n.stepped);m[t]=e[t],u.push(m)}else u.push(f)}return 1===u.length?u[0]:u}}},{key:"pathSegment",value:function(e,t,n){return dw(this)(e,this,t,n)}},{key:"path",value:function(e,t,n){var r=this.segments,a=dw(this),i=this._loop;t=t||0,n=n||this.points.length-t;var o,s=ye(r);try{for(s.s();!(o=s.n()).done;){i&=a(e,this,o.value,{start:t,end:t+n-1})}}catch(u){s.e(u)}finally{s.f()}return!!i}},{key:"draw",value:function(e,t,n,r){var a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),pw(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}]),n}(fx);function vw(e,t,n,r){var a=e.options,i=e.getProps([n],r)[n];return Math.abs(t-i)<a.radius+a.hitRadius}(0,_.Z)(mw,"id","line"),(0,_.Z)(mw,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,_.Z)(mw,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,_.Z)(mw,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e&&"fill"!==e}});var gw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),r=t.call(this),(0,_.Z)(xe(r),"parsed",void 0),(0,_.Z)(xe(r),"skip",void 0),(0,_.Z)(xe(r),"stop",void 0),r.options=void 0,r.parsed=void 0,r.skip=void 0,r.stop=void 0,e&&Object.assign(xe(r),e),r}return Te(n,[{key:"inRange",value:function(e,t,n){var r=this.options,a=this.getProps(["x","y"],n),i=a.x,o=a.y;return Math.pow(e-i,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}},{key:"inXRange",value:function(e,t){return vw(this,e,"x",t)}},{key:"inYRange",value:function(e,t){return vw(this,e,"y",t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"size",value:function(e){var t=(e=e||this.options||{}).radius||0;return 2*((t=Math.max(t,t&&e.hoverRadius||0))+(t&&e.borderWidth||0))}},{key:"draw",value:function(e,t){var n=this.options;this.skip||n.radius<.1||!Og(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Rg(e,n,this.x,this.y))}},{key:"getRange",value:function(){var e=this.options||{};return e.radius+e.hitRadius}}]),n}(fx);function yw(e,t){var n,r,a,i,o,s=e.getProps(["x","y","base","width","height"],t),u=s.x,c=s.y,l=s.base,h=s.width,d=s.height;return e.horizontal?(o=d/2,n=Math.min(u,l),r=Math.max(u,l),a=c-o,i=c+o):(n=u-(o=h/2),r=u+o,a=Math.min(c,l),i=Math.max(c,l)),{left:n,top:a,right:r,bottom:i}}function bw(e,t,n,r){return e?0:qv(t,n,r)}function xw(e){var t=yw(e),n=t.right-t.left,r=t.bottom-t.top,a=function(e,t,n){var r=e.options.borderWidth,a=e.borderSkipped,i=Kg(r);return{t:bw(a.top,i.top,0,n),r:bw(a.right,i.right,0,t),b:bw(a.bottom,i.bottom,0,n),l:bw(a.left,i.left,0,t)}}(e,n/2,r/2),i=function(e,t,n){var r=e.getProps(["enableBorderRadius"]).enableBorderRadius,a=e.options.borderRadius,i=qg(a),o=Math.min(t,n),s=e.borderSkipped,u=r||av(a);return{topLeft:bw(!u||s.top||s.left,i.topLeft,0,o),topRight:bw(!u||s.top||s.right,i.topRight,0,o),bottomLeft:bw(!u||s.bottom||s.left,i.bottomLeft,0,o),bottomRight:bw(!u||s.bottom||s.right,i.bottomRight,0,o)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:i},inner:{x:t.left+a.l,y:t.top+a.t,w:n-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,i.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(a.b,a.r))}}}}function ww(e,t,n,r){var a=null===t,i=null===n,o=e&&!(a&&i)&&yw(e,r);return o&&(a||Zv(t,o.left,o.right))&&(i||Zv(n,o.top,o.bottom))}function kw(e,t){e.rect(t.x,t.y,t.w,t.h)}function Sw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.x!==n.x?-t:0,a=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-r,o=(e.y+e.h!==n.y+n.h?t:0)-a;return{x:e.x+r,y:e.y+a,w:e.w+i,h:e.h+o,radius:e.radius}}(0,_.Z)(gw,"id","point"),(0,_.Z)(gw,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,_.Z)(gw,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Cw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).options=void 0,r.horizontal=void 0,r.base=void 0,r.width=void 0,r.height=void 0,r.inflateAmount=void 0,e&&Object.assign(xe(r),e),r}return Te(n,[{key:"draw",value:function(e){var t,n=this.inflateAmount,r=this.options,a=r.borderColor,i=r.backgroundColor,o=xw(this),s=o.inner,u=o.outer,c=(t=u.radius).topLeft||t.topRight||t.bottomLeft||t.bottomRight?Vg:kw;e.save(),u.w===s.w&&u.h===s.h||(e.beginPath(),c(e,Sw(u,n,s)),e.clip(),c(e,Sw(s,-n,u)),e.fillStyle=a,e.fill("evenodd")),e.beginPath(),c(e,Sw(s,n)),e.fillStyle=i,e.fill(),e.restore()}},{key:"inRange",value:function(e,t,n){return ww(this,e,t,n)}},{key:"inXRange",value:function(e,t){return ww(this,e,null,t)}},{key:"inYRange",value:function(e,t){return ww(this,null,e,t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","base","horizontal"],e),n=t.x,r=t.y,a=t.base,i=t.horizontal;return{x:i?(n+a)/2:n,y:i?r:(r+a)/2}}},{key:"getRange",value:function(e){return"x"===e?this.width/2:this.height/2}}]),n}(fx);(0,_.Z)(Cw,"id","bar"),(0,_.Z)(Cw,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,_.Z)(Cw,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Iw=function(e,t){var n=e.boxHeight,r=void 0===n?t:n,a=e.boxWidth,i=void 0===a?t:a;return e.usePointStyle&&(r=Math.min(r,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:r,itemHeight:Math.max(t,r)}},Tw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this))._added=!1,r.legendHitBoxes=[],r._hoveredItem=null,r.doughnutMode=!1,r.chart=e.chart,r.options=e.options,r.ctx=e.ctx,r.legendItems=void 0,r.columnSizes=void 0,r.lineWidths=void 0,r.maxHeight=void 0,r.maxWidth=void 0,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.height=void 0,r.width=void 0,r._margins=void 0,r.position=void 0,r.weight=void 0,r.fullSize=void 0,r}return Te(n,[{key:"update",value:function(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}},{key:"buildLabels",value:function(){var e=this,t=this.options.labels||{},n=cv(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter((function(n){return t.filter(n,e.chart.data)}))),t.sort&&(n=n.sort((function(n,r){return t.sort(n,r,e.chart.data)}))),this.options.reverse&&n.reverse(),this.legendItems=n}},{key:"fit",value:function(){var e=this.options,t=this.ctx;if(e.display){var n,r,a=e.labels,i=Xg(a.font),o=i.size,s=this._computeTitleHeight(),u=Iw(a,o),c=u.boxWidth,l=u.itemHeight;t.font=i.string,this.isHorizontal()?(n=this.maxWidth,r=this._fitRows(s,o,c,l)+10):(r=this.maxHeight,n=this._fitCols(s,i,c,l)+10),this.width=Math.min(n,e.maxWidth||this.maxWidth),this.height=Math.min(r,e.maxHeight||this.maxHeight)}else this.width=this.height=0}},{key:"_fitRows",value:function(e,t,n,r){var a=this.ctx,i=this.maxWidth,o=this.options.labels.padding,s=this.legendHitBoxes=[],u=this.lineWidths=[0],c=r+o,l=e;a.textAlign="left",a.textBaseline="middle";var h=-1,d=-c;return this.legendItems.forEach((function(e,f){var p=n+t/2+a.measureText(e.text).width;(0===f||u[u.length-1]+p+2*o>i)&&(l+=c,u[u.length-(f>0?0:1)]=0,d+=c,h++),s[f]={left:0,top:d,row:h,width:p,height:r},u[u.length-1]+=p+o})),l}},{key:"_fitCols",value:function(e,t,n,r){var a=this.ctx,i=this.maxHeight,o=this.options.labels.padding,s=this.legendHitBoxes=[],u=this.columnSizes=[],c=i-e,l=o,h=0,d=0,f=0,p=0;return this.legendItems.forEach((function(e,i){var m=function(e,t,n,r,a){var i=function(e,t,n,r){var a=e.text;a&&"string"!==typeof a&&(a=a.reduce((function(e,t){return e.length>t.length?e:t})));return t+n.size/2+r.measureText(a).width}(r,e,t,n),o=function(e,t,n){var r=e;"string"!==typeof t.text&&(r=_w(t,n));return r}(a,r,t.lineHeight);return{itemWidth:i,itemHeight:o}}(n,t,a,e,r),v=m.itemWidth,g=m.itemHeight;i>0&&d+g+2*o>c&&(l+=h+o,u.push({width:h,height:d}),f+=h+o,p++,h=d=0),s[i]={left:f,top:d,col:p,width:v,height:g},h=Math.max(h,v),d+=g+o})),l+=h,u.push({width:h,height:d}),l}},{key:"adjustHitBoxes",value:function(){if(this.options.display){var e=this._computeTitleHeight(),t=this.legendHitBoxes,n=this.options,r=n.align,a=n.labels.padding,i=My(n.rtl,this.left,this.width);if(this.isHorizontal()){var o,s=0,u=ag(r,this.left+a,this.right-this.lineWidths[s]),c=ye(t);try{for(c.s();!(o=c.n()).done;){var l=o.value;s!==l.row&&(s=l.row,u=ag(r,this.left+a,this.right-this.lineWidths[s])),l.top+=this.top+e+a,l.left=i.leftForLtr(i.x(u),l.width),u+=l.width+a}}catch(v){c.e(v)}finally{c.f()}}else{var h,d=0,f=ag(r,this.top+e+a,this.bottom-this.columnSizes[d].height),p=ye(t);try{for(p.s();!(h=p.n()).done;){var m=h.value;m.col!==d&&(d=m.col,f=ag(r,this.top+e+a,this.bottom-this.columnSizes[d].height)),m.top=f,m.left+=this.left+a,m.left=i.leftForLtr(i.x(m.left),m.width),f+=m.height+a}}catch(v){p.e(v)}finally{p.f()}}}}},{key:"isHorizontal",value:function(){return"top"===this.options.position||"bottom"===this.options.position}},{key:"draw",value:function(){if(this.options.display){var e=this.ctx;Dg(e,this),this._draw(),Pg(e)}}},{key:"_draw",value:function(){var e,t=this,n=this.options,r=this.columnSizes,a=this.lineWidths,i=this.ctx,o=n.align,s=n.labels,u=Ig.color,c=My(n.rtl,this.left,this.width),l=Xg(s.font),h=s.padding,d=l.size,f=d/2;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;var p=Iw(s,d),m=p.boxWidth,v=p.boxHeight,g=p.itemHeight,y=this.isHorizontal(),b=this._computeTitleHeight();e=y?{x:ag(o,this.left+h,this.right-a[0]),y:this.top+h+b,line:0}:{x:this.left+h,y:ag(o,this.top+b+h,this.bottom-r[0].height),line:0},Ly(this.ctx,n.textDirection);var x=g+h;this.legendItems.forEach((function(p,w){i.strokeStyle=p.fontColor,i.fillStyle=p.fontColor;var k=i.measureText(p.text).width,S=c.textAlign(p.textAlign||(p.textAlign=s.textAlign)),C=m+f+k,I=e.x,T=e.y;if(c.setWidth(t.width),y?w>0&&I+C+h>t.right&&(T=e.y+=x,e.line++,I=e.x=ag(o,t.left+h,t.right-a[e.line])):w>0&&T+x>t.bottom&&(I=e.x=I+r[e.line].width+h,e.line++,T=e.y=ag(o,t.top+b+h,t.bottom-r[e.line].height)),function(e,t,n){if(!(isNaN(m)||m<=0||isNaN(v)||v<0)){i.save();var r=sv(n.lineWidth,1);if(i.fillStyle=sv(n.fillStyle,u),i.lineCap=sv(n.lineCap,"butt"),i.lineDashOffset=sv(n.lineDashOffset,0),i.lineJoin=sv(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=sv(n.strokeStyle,u),i.setLineDash(sv(n.lineDash,[])),s.usePointStyle){var a={radius:v*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},o=c.xPlus(e,m/2);Ag(i,a,o,t+f,s.pointStyleWidth&&m)}else{var l=t+Math.max((d-v)/2,0),h=c.leftForLtr(e,m),p=qg(n.borderRadius);i.beginPath(),Object.values(p).some((function(e){return 0!==e}))?Vg(i,{x:h,y:l,w:m,h:v,radius:p}):i.rect(h,l,m,v),i.fill(),0!==r&&i.stroke()}i.restore()}}(c.x(I),T,p),I=function(e,t,n,r){return e===(r?"left":"right")?n:"center"===e?(t+n)/2:t}(S,I+m+f,y?I+C:t.right,n.rtl),function(e,t,n){Bg(i,n.text,e,t+g/2,l,{strikethrough:n.hidden,textAlign:c.textAlign(n.textAlign)})}(c.x(I),T,p),y)e.x+=C+h;else if("string"!==typeof p.text){var _=l.lineHeight;e.y+=_w(p,_)+h}else e.y+=x})),Fy(this.ctx,n.textDirection)}},{key:"drawTitle",value:function(){var e=this.options,t=e.title,n=Xg(t.font),r=Zg(t.padding);if(t.display){var a,i=My(e.rtl,this.left,this.width),o=this.ctx,s=t.position,u=n.size/2,c=r.top+u,l=this.left,h=this.width;if(this.isHorizontal())h=Math.max.apply(Math,(0,ke.Z)(this.lineWidths)),a=this.top+c,l=ag(e.align,l,this.right-h);else{var d=this.columnSizes.reduce((function(e,t){return Math.max(e,t.height)}),0);a=c+ag(e.align,this.top,this.bottom-d-e.labels.padding-this._computeTitleHeight())}var f=ag(s,l,l+h);o.textAlign=i.textAlign(rg(s)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,Bg(o,t.text,f,a,n)}}},{key:"_computeTitleHeight",value:function(){var e=this.options.title,t=Xg(e.font),n=Zg(e.padding);return e.display?t.lineHeight+n.height:0}},{key:"_getLegendItemAt",value:function(e,t){var n,r,a;if(Zv(e,this.left,this.right)&&Zv(t,this.top,this.bottom))for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(Zv(e,(r=a[n]).left,r.left+r.width)&&Zv(t,r.top,r.top+r.height))return this.legendItems[n];return null}},{key:"handleEvent",value:function(e){var t=this.options;if(function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t)){var n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){var r=this._hoveredItem,a=function(e,t){return null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index}(r,n);r&&!a&&cv(t.onLeave,[e,r,this],this),this._hoveredItem=n,n&&!a&&cv(t.onHover,[e,n,this],this)}else n&&cv(t.onClick,[e,n,this],this)}}}]),n}(fx);function _w(e,t){return t*(e.text?e.text.length:0)}var Ew={id:"legend",_element:Tw,start:function(e,t,n){var r=e.legend=new Tw({ctx:e.ctx,options:n,chart:e});Zb(e,r,n),Kb(e,r)},stop:function(e){qb(e,e.legend),delete e.legend},beforeUpdate:function(e,t,n){var r=e.legend;Zb(e,r,n),r.options=n},afterUpdate:function(e){var t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent:function(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick:function(e,t,n){var r=t.datasetIndex,a=n.chart;a.isDatasetVisible(r)?(a.hide(r),t.hidden=!0):(a.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:function(e){return e.chart.options.color},boxWidth:40,padding:10,generateLabels:function(e){var t=e.data.datasets,n=e.legend.options.labels,r=n.usePointStyle,a=n.pointStyle,i=n.textAlign,o=n.color,s=n.useBorderRadius,u=n.borderRadius;return e._getSortedDatasetMetas().map((function(e){var n=e.controller.getStyle(r?0:void 0),c=Zg(n.borderWidth);return{text:t[e.index].label,fillStyle:n.backgroundColor,fontColor:o,hidden:!e.visible,lineCap:n.borderCapStyle,lineDash:n.borderDash,lineDashOffset:n.borderDashOffset,lineJoin:n.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:n.borderColor,pointStyle:a||n.pointStyle,rotation:n.rotation,textAlign:i||n.textAlign,borderRadius:s&&(u||n.borderRadius),datasetIndex:e.index}}),this)}},title:{color:function(e){return e.chart.options.color},display:!1,position:"center",text:""}},descriptors:{_scriptable:function(e){return!e.startsWith("on")},labels:{_scriptable:function(e){return!["generateLabels","filter","sort"].includes(e)}}}},Nw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).chart=e.chart,r.options=e.options,r.ctx=e.ctx,r._padding=void 0,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.width=void 0,r.height=void 0,r.position=void 0,r.weight=void 0,r.fullSize=void 0,r}return Te(n,[{key:"update",value:function(e,t){var n=this.options;if(this.left=0,this.top=0,n.display){this.width=this.right=e,this.height=this.bottom=t;var r=rv(n.text)?n.text.length:1;this._padding=Zg(n.padding);var a=r*Xg(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}else this.width=this.height=this.right=this.bottom=0}},{key:"isHorizontal",value:function(){var e=this.options.position;return"top"===e||"bottom"===e}},{key:"_drawArgs",value:function(e){var t,n,r,a=this.top,i=this.left,o=this.bottom,s=this.right,u=this.options,c=u.align,l=0;return this.isHorizontal()?(n=ag(c,i,s),r=a+e,t=s-i):("left"===u.position?(n=i+e,r=ag(c,o,a),l=-.5*Iv):(n=s-e,r=ag(c,a,o),l=.5*Iv),t=o-a),{titleX:n,titleY:r,maxWidth:t,rotation:l}}},{key:"draw",value:function(){var e=this.ctx,t=this.options;if(t.display){var n=Xg(t.font),r=n.lineHeight/2+this._padding.top,a=this._drawArgs(r),i=a.titleX,o=a.titleY,s=a.maxWidth,u=a.rotation;Bg(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:u,textAlign:rg(t.align),textBaseline:"middle",translation:[i,o]})}}}]),n}(fx);var Rw={id:"title",_element:Nw,start:function(e,t,n){!function(e,t){var n=new Nw({ctx:e.ctx,options:t,chart:e});Zb(e,n,t),Kb(e,n),e.titleBlock=n}(e,n)},stop:function(e){var t=e.titleBlock;qb(e,t),delete e.titleBlock},beforeUpdate:function(e,t,n){var r=e.titleBlock;Zb(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Aw=(new WeakMap,{average:function(e){if(!e.length)return!1;var t,n,r=0,a=0,i=0;for(t=0,n=e.length;t<n;++t){var o=e[t].element;if(o&&o.hasValue()){var s=o.tooltipPosition();r+=s.x,a+=s.y,++i}}return{x:r/i,y:a/i}},nearest:function(e,t){if(!e.length)return!1;var n,r,a,i=t.x,o=t.y,s=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){var u=e[n].element;if(u&&u.hasValue()){var c=jv(t,u.getCenterPoint());c<s&&(s=c,a=u)}}if(a){var l=a.tooltipPosition();i=l.x,o=l.y}return{x:i,y:o}}});function Ow(e,t){return t&&(rv(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Dw(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Pw(e,t){var n=t.element,r=t.datasetIndex,a=t.index,i=e.getDatasetMeta(r).controller,o=i.getLabelAndValue(a),s=o.label,u=o.value;return{chart:e,label:s,parsed:i.getParsed(a),raw:e.data.datasets[r].data[a],formattedValue:u,dataset:i.getDataset(),dataIndex:a,datasetIndex:r,element:n}}function Mw(e,t){var n=e.chart.ctx,r=e.body,a=e.footer,i=e.title,o=t.boxWidth,s=t.boxHeight,u=Xg(t.bodyFont),c=Xg(t.titleFont),l=Xg(t.footerFont),h=i.length,d=a.length,f=r.length,p=Zg(t.padding),m=p.height,v=0,g=r.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0);(g+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),g)&&(m+=f*(t.displayColors?Math.max(s,u.lineHeight):u.lineHeight)+(g-f)*u.lineHeight+(g-1)*t.bodySpacing);d&&(m+=t.footerMarginTop+d*l.lineHeight+(d-1)*t.footerSpacing);var y=0,b=function(e){v=Math.max(v,n.measureText(e).width+y)};return n.save(),n.font=c.string,lv(e.title,b),n.font=u.string,lv(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?o+2+t.boxPadding:0,lv(r,(function(e){lv(e.before,b),lv(e.lines,b),lv(e.after,b)})),y=0,n.font=l.string,lv(e.footer,b),n.restore(),{width:v+=p.width,height:m}}function Lw(e,t,n,r){var a=n.x,i=n.width,o=e.width,s=e.chartArea,u=s.left,c=s.right,l="center";return"center"===r?l=a<=(u+c)/2?"left":"right":a<=i/2?l="left":a>=o-i/2&&(l="right"),function(e,t,n,r){var a=r.x,i=r.width,o=n.caretSize+n.caretPadding;return"left"===e&&a+i+o>t.width||"right"===e&&a-i-o<0||void 0}(l,e,t,n)&&(l="center"),l}function Fw(e,t,n){var r=n.yAlign||t.yAlign||function(e,t){var n=t.y,r=t.height;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||Lw(e,t,n,r),yAlign:r}}function zw(e,t,n,r){var a=e.caretSize,i=e.caretPadding,o=e.cornerRadius,s=n.xAlign,u=n.yAlign,c=a+i,l=qg(o),h=l.topLeft,d=l.topRight,f=l.bottomLeft,p=l.bottomRight,m=function(e,t){var n=e.x,r=e.width;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,s),v=function(e,t,n){var r=e.y,a=e.height;return"top"===t?r+=n:r-="bottom"===t?a+n:a/2,r}(t,u,c);return"center"===u?"left"===s?m+=c:"right"===s&&(m-=c):"left"===s?m-=Math.max(h,f)+a:"right"===s&&(m+=Math.max(d,p)+a),{x:qv(m,0,r.width-t.width),y:qv(v,0,r.height-t.height)}}function Bw(e,t,n){var r=Zg(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function Vw(e){return Ow([],Dw(e))}function Uw(e,t){var n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}var Ww={beforeTitle:ev,title:function(e){if(e.length>0){var t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:ev,beforeBody:ev,beforeLabel:ev,label:function(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;var t=e.dataset.label||"";t&&(t+=": ");var n=e.formattedValue;return nv(n)||(t+=n),t},labelColor:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor:function(){return this.options.bodyColor},labelPointStyle:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ev,afterBody:ev,beforeFooter:ev,footer:ev,afterFooter:ev};function jw(e,t,n,r){var a=e[t].call(n,r);return"undefined"===typeof a?Ww[t].call(n,r):a}var Gw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).opacity=0,r._active=[],r._eventPosition=void 0,r._size=void 0,r._cachedAnimations=void 0,r._tooltipItems=[],r.$animations=void 0,r.$context=void 0,r.chart=e.chart,r.options=e.options,r.dataPoints=void 0,r.title=void 0,r.beforeBody=void 0,r.body=void 0,r.afterBody=void 0,r.footer=void 0,r.xAlign=void 0,r.yAlign=void 0,r.x=void 0,r.y=void 0,r.height=void 0,r.width=void 0,r.caretX=void 0,r.caretY=void 0,r.labelColors=void 0,r.labelPointStyles=void 0,r.labelTextColors=void 0,r}return Te(n,[{key:"initialize",value:function(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}},{key:"_resolveAnimations",value:function(){var e=this._cachedAnimations;if(e)return e;var t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,a=new Yy(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}},{key:"getContext",value:function(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,Qg(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}},{key:"getTitle",value:function(e,t){var n=t.callbacks,r=jw(n,"beforeTitle",this,e),a=jw(n,"title",this,e),i=jw(n,"afterTitle",this,e),o=[];return o=Ow(o,Dw(r)),o=Ow(o,Dw(a)),o=Ow(o,Dw(i))}},{key:"getBeforeBody",value:function(e,t){return Vw(jw(t.callbacks,"beforeBody",this,e))}},{key:"getBody",value:function(e,t){var n=this,r=t.callbacks,a=[];return lv(e,(function(e){var t={before:[],lines:[],after:[]},i=Uw(r,e);Ow(t.before,Dw(jw(i,"beforeLabel",n,e))),Ow(t.lines,jw(i,"label",n,e)),Ow(t.after,Dw(jw(i,"afterLabel",n,e))),a.push(t)})),a}},{key:"getAfterBody",value:function(e,t){return Vw(jw(t.callbacks,"afterBody",this,e))}},{key:"getFooter",value:function(e,t){var n=t.callbacks,r=jw(n,"beforeFooter",this,e),a=jw(n,"footer",this,e),i=jw(n,"afterFooter",this,e),o=[];return o=Ow(o,Dw(r)),o=Ow(o,Dw(a)),o=Ow(o,Dw(i))}},{key:"_createItems",value:function(e){var t,n,r=this,a=this._active,i=this.chart.data,o=[],s=[],u=[],c=[];for(t=0,n=a.length;t<n;++t)c.push(Pw(this.chart,a[t]));return e.filter&&(c=c.filter((function(t,n,r){return e.filter(t,n,r,i)}))),e.itemSort&&(c=c.sort((function(t,n){return e.itemSort(t,n,i)}))),lv(c,(function(t){var n=Uw(e.callbacks,t);o.push(jw(n,"labelColor",r,t)),s.push(jw(n,"labelPointStyle",r,t)),u.push(jw(n,"labelTextColor",r,t))})),this.labelColors=o,this.labelPointStyles=s,this.labelTextColors=u,this.dataPoints=c,c}},{key:"update",value:function(e,t){var n,r=this.options.setContext(this.getContext()),a=this._active,i=[];if(a.length){var o=Aw[r.position].call(this,a,this._eventPosition);i=this._createItems(r),this.title=this.getTitle(i,r),this.beforeBody=this.getBeforeBody(i,r),this.body=this.getBody(i,r),this.afterBody=this.getAfterBody(i,r),this.footer=this.getFooter(i,r);var s=this._size=Mw(this,r),u=Object.assign({},o,s),c=Fw(this.chart,r,u),l=zw(r,u,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,n={opacity:1,x:l.x,y:l.y,width:s.width,height:s.height,caretX:o.x,caretY:o.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=i,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}},{key:"drawCaret",value:function(e,t,n,r){var a=this.getCaretPosition(e,n,r);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}},{key:"getCaretPosition",value:function(e,t,n){var r,a,i,o,s,u,c=this.xAlign,l=this.yAlign,h=n.caretSize,d=qg(n.cornerRadius),f=d.topLeft,p=d.topRight,m=d.bottomLeft,v=d.bottomRight,g=e.x,y=e.y,b=t.width,x=t.height;return"center"===l?(s=y+x/2,"left"===c?(a=(r=g)-h,o=s+h,u=s-h):(a=(r=g+b)+h,o=s-h,u=s+h),i=r):(a="left"===c?g+Math.max(f,m)+h:"right"===c?g+b-Math.max(p,v)-h:this.caretX,"top"===l?(s=(o=y)-h,r=a-h,i=a+h):(s=(o=y+x)+h,r=a+h,i=a-h),u=o),{x1:r,x2:a,x3:i,y1:o,y2:s,y3:u}}},{key:"drawTitle",value:function(e,t,n){var r,a,i,o=this.title,s=o.length;if(s){var u=My(n.rtl,this.x,this.width);for(e.x=Bw(this,n.titleAlign,n),t.textAlign=u.textAlign(n.titleAlign),t.textBaseline="middle",r=Xg(n.titleFont),a=n.titleSpacing,t.fillStyle=n.titleColor,t.font=r.string,i=0;i<s;++i)t.fillText(o[i],u.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+a,i+1===s&&(e.y+=n.titleMarginBottom-a)}}},{key:"_drawColorBox",value:function(e,t,n,r,a){var i=this.labelColors[n],o=this.labelPointStyles[n],s=a.boxHeight,u=a.boxWidth,c=Xg(a.bodyFont),l=Bw(this,"left",a),h=r.x(l),d=s<c.lineHeight?(c.lineHeight-s)/2:0,f=t.y+d;if(a.usePointStyle){var p={radius:Math.min(u,s)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},m=r.leftForLtr(h,u)+u/2,v=f+s/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,Rg(e,p,m,v),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,Rg(e,p,m,v)}else{e.lineWidth=av(i.borderWidth)?Math.max.apply(Math,(0,ke.Z)(Object.values(i.borderWidth))):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;var g=r.leftForLtr(h,u),y=r.leftForLtr(r.xPlus(h,1),u-2),b=qg(i.borderRadius);Object.values(b).some((function(e){return 0!==e}))?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Vg(e,{x:g,y:f,w:u,h:s,radius:b}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),Vg(e,{x:y,y:f+1,w:u-2,h:s-2,radius:b}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(g,f,u,s),e.strokeRect(g,f,u,s),e.fillStyle=i.backgroundColor,e.fillRect(y,f+1,u-2,s-2))}e.fillStyle=this.labelTextColors[n]}},{key:"drawBody",value:function(e,t,n){var r,a,i,o,s,u,c,l=this.body,h=n.bodySpacing,d=n.bodyAlign,f=n.displayColors,p=n.boxHeight,m=n.boxWidth,v=n.boxPadding,g=Xg(n.bodyFont),y=g.lineHeight,b=0,x=My(n.rtl,this.x,this.width),w=function(n){t.fillText(n,x.x(e.x+b),e.y+y/2),e.y+=y+h},k=x.textAlign(d);for(t.textAlign=d,t.textBaseline="middle",t.font=g.string,e.x=Bw(this,k,n),t.fillStyle=n.bodyColor,lv(this.beforeBody,w),b=f&&"right"!==k?"center"===d?m/2+v:m+2+v:0,o=0,u=l.length;o<u;++o){for(r=l[o],a=this.labelTextColors[o],t.fillStyle=a,lv(r.before,w),i=r.lines,f&&i.length&&(this._drawColorBox(t,e,o,x,n),y=Math.max(g.lineHeight,p)),s=0,c=i.length;s<c;++s)w(i[s]),y=g.lineHeight;lv(r.after,w)}b=0,y=g.lineHeight,lv(this.afterBody,w),e.y-=h}},{key:"drawFooter",value:function(e,t,n){var r,a,i=this.footer,o=i.length;if(o){var s=My(n.rtl,this.x,this.width);for(e.x=Bw(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=s.textAlign(n.footerAlign),t.textBaseline="middle",r=Xg(n.footerFont),t.fillStyle=n.footerColor,t.font=r.string,a=0;a<o;++a)t.fillText(i[a],s.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+n.footerSpacing}}},{key:"drawBackground",value:function(e,t,n,r){var a=this.xAlign,i=this.yAlign,o=e.x,s=e.y,u=n.width,c=n.height,l=qg(r.cornerRadius),h=l.topLeft,d=l.topRight,f=l.bottomLeft,p=l.bottomRight;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(o+h,s),"top"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+u-d,s),t.quadraticCurveTo(o+u,s,o+u,s+d),"center"===i&&"right"===a&&this.drawCaret(e,t,n,r),t.lineTo(o+u,s+c-p),t.quadraticCurveTo(o+u,s+c,o+u-p,s+c),"bottom"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+f,s+c),t.quadraticCurveTo(o,s+c,o,s+c-f),"center"===i&&"left"===a&&this.drawCaret(e,t,n,r),t.lineTo(o,s+h),t.quadraticCurveTo(o,s,o+h,s),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}},{key:"_updateAnimationTarget",value:function(e){var t=this.chart,n=this.$animations,r=n&&n.x,a=n&&n.y;if(r||a){var i=Aw[e.position].call(this,this._active,this._eventPosition);if(!i)return;var o=this._size=Mw(this,e),s=Object.assign({},i,this._size),u=Fw(t,e,s),c=zw(e,s,u,t);r._to===c.x&&a._to===c.y||(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=o.width,this.height=o.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,c))}}},{key:"_willRender",value:function(){return!!this.opacity}},{key:"draw",value:function(e){var t=this.options.setContext(this.getContext()),n=this.opacity;if(n){this._updateAnimationTarget(t);var r={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;var i=Zg(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,r,t),Ly(e,t.textDirection),a.y+=i.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),Fy(e,t.textDirection),e.restore())}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e,t){var n=this,r=this._active,a=e.map((function(e){var t=e.datasetIndex,r=e.index,a=n.chart.getDatasetMeta(t);if(!a)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:a.data[r],index:r}})),i=!hv(r,a),o=this._positionChanged(a,t);(i||o)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}},{key:"handleEvent",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;var r=this.options,a=this._active||[],i=this._getActiveElements(e,a,t,n),o=this._positionChanged(i,e),s=t||!hv(i,a)||o;return s&&(this._active=i,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),s}},{key:"_getActiveElements",value:function(e,t,n,r){var a=this.options;if("mouseout"===e.type)return[];if(!r)return t;var i=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&i.reverse(),i}},{key:"_positionChanged",value:function(e,t){var n=this.caretX,r=this.caretY,a=this.options,i=Aw[a.position].call(this,e,t);return!1!==i&&(n!==i.x||r!==i.y)}}]),n}(fx);(0,_.Z)(Gw,"positioners",Aw);var Hw={id:"tooltip",_element:Gw,positioners:Aw,afterInit:function(e,t,n){n&&(e.tooltip=new Gw({chart:e,options:n}))},beforeUpdate:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw:function(e){var t=e.tooltip;if(t&&t._willRender()){var n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",rt(rt({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent:function(e,t){if(e.tooltip){var n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:function(e,t){return t.bodyFont.size},boxWidth:function(e,t){return t.bodyFont.size},multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Ww},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:function(e){return"filter"!==e&&"itemSort"!==e&&"external"!==e},_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function Kw(e,t,n,r){var a=e.indexOf(t);return-1===a?function(e,t,n,r){return"string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n}(e,t,n,r):a!==e.lastIndexOf(t)?n:a}function qw(e){var t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var Zw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e))._startValue=void 0,r._valueRange=0,r._addedLabels=[],r}return Te(n,[{key:"init",value:function(e){var t=this._addedLabels;if(t.length){var r,a=this.getLabels(),i=ye(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.index,u=o.label;a[s]===u&&a.splice(s,1)}}catch(c){i.e(c)}finally{i.f()}this._addedLabels=[]}me(pe(n.prototype),"init",this).call(this,e)}},{key:"parse",value:function(e,t){if(nv(e))return null;var n=this.getLabels();return function(e,t){return null===e?null:qv(Math.round(e),0,t)}(t=isFinite(t)&&n[t]===e?t:Kw(n,e,sv(t,e),this._addedLabels),n.length-1)}},{key:"determineDataLimits",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.getMinMax(!0),a=r.min,i=r.max;"ticks"===this.options.bounds&&(t||(a=0),n||(i=this.getLabels().length-1)),this.min=a,this.max=i}},{key:"buildTicks",value:function(){var e=this.min,t=this.max,n=this.options.offset,r=[],a=this.getLabels();a=0===e&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(var i=e;i<=t;i++)r.push({value:i});return r}},{key:"getLabelForValue",value:function(e){return qw.call(this,e)}},{key:"configure",value:function(){me(pe(n.prototype),"configure",this).call(this),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}},{key:"getPixelForValue",value:function(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getValueForPixel",value:function(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}},{key:"getBasePixel",value:function(){return this.bottom}}]),n}(Sx);function Xw(e,t){var n,r,a,i,o=[],s=e.bounds,u=e.step,c=e.min,l=e.max,h=e.precision,d=e.count,f=e.maxTicks,p=e.maxDigits,m=e.includeBounds,v=u||1,g=f-1,y=t.min,b=t.max,x=!nv(c),w=!nv(l),k=!nv(d),S=(b-y)/(p+1),C=Lv((b-y)/g/v)*v;if(C<1e-14&&!x&&!w)return[{value:y},{value:b}];(i=Math.ceil(b/C)-Math.floor(y/C))>g&&(C=Lv(i*C/g/v)*v),nv(h)||(n=Math.pow(10,h),C=Math.ceil(C*n)/n),"ticks"===s?(r=Math.floor(y/C)*C,a=Math.ceil(b/C)*C):(r=y,a=b),x&&w&&u&&function(e,t){var n=Math.round(e);return n-t<=e&&n+t>=e}((l-c)/u,C/1e3)?(C=(l-c)/(i=Math.round(Math.min((l-c)/C,f))),r=c,a=l):k?C=((a=w?l:a)-(r=x?c:r))/(i=d-1):i=Mv(i=(a-r)/C,Math.round(i),C/1e3)?Math.round(i):Math.ceil(i);var I=Math.max(Uv(C),Uv(r));n=Math.pow(10,nv(h)?I:h),r=Math.round(r*n)/n,a=Math.round(a*n)/n;var T=0;for(x&&(m&&r!==c?(o.push({value:c}),r<c&&T++,Mv(Math.round((r+T*C)*n)/n,c,Yw(c,S,e))&&T++):r<c&&T++);T<i;++T){var _=Math.round((r+T*C)*n)/n;if(w&&_>l)break;o.push({value:_})}return w&&m&&a!==l?o.length&&Mv(o[o.length-1].value,l,Yw(l,S,e))?o[o.length-1].value=l:o.push({value:l}):w&&a!==l||o.push({value:a}),o}function Yw(e,t,n){var r=n.horizontal,a=Bv(n.minRotation),i=(r?Math.sin(a):Math.cos(a))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}(0,_.Z)(Zw,"id","category"),(0,_.Z)(Zw,"defaults",{ticks:{callback:qw}});var Qw=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e)).start=void 0,r.end=void 0,r._startValue=void 0,r._endValue=void 0,r._valueRange=0,r}return Te(n,[{key:"parse",value:function(e,t){return nv(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}},{key:"handleTickRangeOptions",value:function(){var e=this.options.beginAtZero,t=this.getUserBounds(),n=t.minDefined,r=t.maxDefined,a=this.min,i=this.max,o=function(e){return a=n?a:e},s=function(e){return i=r?i:e};if(e){var u=Pv(a),c=Pv(i);u<0&&c<0?s(0):u>0&&c>0&&o(0)}if(a===i){var l=0===i?1:Math.abs(.05*i);s(i+l),e||o(a-l)}this.min=a,this.max=i}},{key:"getTickLimit",value:function(){var e,t=this.options.ticks,n=t.maxTicksLimit,r=t.stepSize;return r?(e=Math.ceil(this.max/r)-Math.floor(this.min/r)+1)>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}},{key:"computeTickLimit",value:function(){return Number.POSITIVE_INFINITY}},{key:"buildTicks",value:function(){var e=this.options,t=e.ticks,n=this.getTickLimit(),r=Xw({maxTicks:n=Math.max(2,n),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&zv(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}},{key:"configure",value:function(){var e=this.ticks,t=this.min,r=this.max;if(me(pe(n.prototype),"configure",this).call(this),this.options.offset&&e.length){var a=(r-t)/Math.max(e.length-1,1)/2;t-=a,r+=a}this._startValue=t,this._endValue=r,this._valueRange=r-t}},{key:"getLabelForValue",value:function(e){return gg(e,this.chart.options.locale,this.options.ticks.format)}}]),n}(Sx),$w=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=iv(t)?t:0,this.max=iv(n)?n:1,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){var e=this.isHorizontal(),t=e?this.width:this.height,n=Bv(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/r))}},{key:"getPixelForValue",value:function(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}]),n}(Qw);(0,_.Z)($w,"id","linear"),(0,_.Z)($w,"defaults",{ticks:{callback:bg.formatters.numeric}});var Jw=function(e){return Math.floor(Dv(e))},ek=function(e,t){return Math.pow(10,Jw(e)+t)};function tk(e){return 1===e/Math.pow(10,Jw(e))}function nk(e,t,n){var r=Math.pow(10,n),a=Math.floor(e/r);return Math.ceil(t/r)-a}function rk(e,t){var n=t.min,r=t.max;n=ov(e.min,n);for(var a=[],i=Jw(n),o=function(e,t){for(var n=Jw(t-e);nk(e,t,n)>10;)n++;for(;nk(e,t,n)<10;)n--;return Math.min(n,Jw(e))}(n,r),s=o<0?Math.pow(10,Math.abs(o)):1,u=Math.pow(10,o),c=i>o?Math.pow(10,i):0,l=Math.round((n-c)*s)/s,h=Math.floor((n-c)/u/10)*u*10,d=Math.floor((l-h)/Math.pow(10,o)),f=ov(e.min,Math.round((c+h+d*Math.pow(10,o))*s)/s);f<r;)a.push({value:f,major:tk(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(d=2,s=++o>=0?1:s),f=Math.round((c+h+d*Math.pow(10,o))*s)/s;var p=ov(e.max,f);return a.push({value:p,major:tk(p),significand:d}),a}var ak=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e)).start=void 0,r.end=void 0,r._startValue=void 0,r._valueRange=0,r}return Te(n,[{key:"parse",value:function(e,t){var n=Qw.prototype.parse.apply(this,[e,t]);if(0!==n)return iv(n)&&n>0?n:null;this._zero=!0}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=iv(t)?Math.max(0,t):null,this.max=iv(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!iv(this._userMin)&&(this.min=t===ek(this.min,0)?ek(this.min,-1):ek(this.min,0)),this.handleTickRangeOptions()}},{key:"handleTickRangeOptions",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.min,a=this.max,i=function(e){return r=t?r:e},o=function(e){return a=n?a:e};r===a&&(r<=0?(i(1),o(10)):(i(ek(r,-1)),o(ek(a,1)))),r<=0&&i(ek(a,-1)),a<=0&&o(ek(r,1)),this.min=r,this.max=a}},{key:"buildTicks",value:function(){var e=this.options,t=rk({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&zv(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}},{key:"getLabelForValue",value:function(e){return void 0===e?"0":gg(e,this.chart.options.locale,this.options.ticks.format)}},{key:"configure",value:function(){var e=this.min;me(pe(n.prototype),"configure",this).call(this),this._startValue=Dv(e),this._valueRange=Dv(this.max)-Dv(e)}},{key:"getPixelForValue",value:function(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Dv(e)-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){var t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}]),n}(Sx);function ik(e){var t=e.ticks;if(t.display&&e.display){var n=Zg(t.backdropPadding);return sv(t.font&&t.font.size,Ig.font.size)+n.height}return 0}function ok(e,t,n,r,a){return e===r||e===a?{start:t-n/2,end:t+n/2}:e<r||e>a?{start:t-n,end:t}:{start:t,end:t+n}}function sk(e){for(var t,n,r,a={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},i=Object.assign({},a),o=[],s=[],u=e._pointLabels.length,c=e.options.pointLabels,l=c.centerPointLabels?Iv/u:0,h=0;h<u;h++){var d=c.setContext(e.getPointLabelContext(h));s[h]=d.padding;var f=e.getPointPosition(h,e.drawingArea+s[h],l),p=Xg(d.font),m=(t=e.ctx,n=p,r=rv(r=e._pointLabels[h])?r:[r],{w:_g(t,n.string,r),h:r.length*n.lineHeight});o[h]=m;var v=Hv(e.getIndexAngle(h)+l),g=Math.round(Vv(v));uk(i,a,v,ok(g,f.x,m.w,0,180),ok(g,f.y,m.h,90,270))}e.setCenterPoint(a.l-i.l,i.r-a.r,a.t-i.t,i.b-a.b),e._pointLabelItems=function(e,t,n){for(var r,a=[],i=e._pointLabels.length,o=e.options,s=o.pointLabels,u=s.centerPointLabels,c=s.display,l={extra:ik(o)/2,additionalAngle:u?Iv/i:0},h=0;h<i;h++){l.padding=n[h],l.size=t[h];var d=ck(e,h,l);a.push(d),"auto"===c&&(d.visible=lk(d,r),d.visible&&(r=d))}return a}(e,o,s)}function uk(e,t,n,r,a){var i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n)),s=0,u=0;r.start<t.l?(s=(t.l-r.start)/i,e.l=Math.min(e.l,t.l-s)):r.end>t.r&&(s=(r.end-t.r)/i,e.r=Math.max(e.r,t.r+s)),a.start<t.t?(u=(t.t-a.start)/o,e.t=Math.min(e.t,t.t-u)):a.end>t.b&&(u=(a.end-t.b)/o,e.b=Math.max(e.b,t.b+u))}function ck(e,t,n){var r=e.drawingArea,a=n.extra,i=n.additionalAngle,o=n.padding,s=n.size,u=e.getPointPosition(t,r+a+o,i),c=Math.round(Vv(Hv(u.angle+Rv))),l=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(u.y,s.h,c),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),d=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(u.x,s.w,h);return{visible:!0,x:u.x,y:l,textAlign:h,left:d,top:l,right:d+s.w,bottom:l+s.h}}function lk(e,t){if(!t)return!0;var n=e.left,r=e.top,a=e.right,i=e.bottom;return!(Og({x:n,y:r},t)||Og({x:n,y:i},t)||Og({x:a,y:r},t)||Og({x:a,y:i},t))}function hk(e,t,n){var r=n.left,a=n.top,i=n.right,o=n.bottom,s=t.backdropColor;if(!nv(s)){var u=qg(t.borderRadius),c=Zg(t.backdropPadding);e.fillStyle=s;var l=r-c.left,h=a-c.top,d=i-r+c.width,f=o-a+c.height;Object.values(u).some((function(e){return 0!==e}))?(e.beginPath(),Vg(e,{x:l,y:h,w:d,h:f,radius:u}),e.fill()):e.fillRect(l,h,d,f)}}function dk(e,t,n,r){var a=e.ctx;if(n)a.arc(e.xCenter,e.yCenter,t,0,Tv);else{var i=e.getPointPosition(0,t);a.moveTo(i.x,i.y);for(var o=1;o<r;o++)i=e.getPointPosition(o,t),a.lineTo(i.x,i.y)}}(0,_.Z)(ak,"id","logarithmic"),(0,_.Z)(ak,"defaults",{ticks:{callback:bg.formatters.logarithmic,major:{enabled:!0}}});var fk=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e)).xCenter=void 0,r.yCenter=void 0,r.drawingArea=void 0,r._pointLabels=[],r._pointLabelItems=[],r}return Te(n,[{key:"setDimensions",value:function(){var e=this._padding=Zg(ik(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!1),t=e.min,n=e.max;this.min=iv(t)&&!isNaN(t)?t:0,this.max=iv(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){return Math.ceil(this.drawingArea/ik(this.options))}},{key:"generateTickLabels",value:function(e){var t=this;Qw.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((function(e,n){var r=cv(t.options.pointLabels.callback,[e,n],t);return r||0===r?r:""})).filter((function(e,n){return t.chart.getDataVisibility(n)}))}},{key:"fit",value:function(){var e=this.options;e.display&&e.pointLabels.display?sk(this):this.setCenterPoint(0,0,0,0)}},{key:"setCenterPoint",value:function(e,t,n,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,r))}},{key:"getIndexAngle",value:function(e){return Hv(e*(Tv/(this._pointLabels.length||1))+Bv(this.options.startAngle||0))}},{key:"getDistanceFromCenterForValue",value:function(e){if(nv(e))return NaN;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}},{key:"getValueForDistanceFromCenter",value:function(e){if(nv(e))return NaN;var t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}},{key:"getPointLabelContext",value:function(e){var t=this._pointLabels||[];if(e>=0&&e<t.length){var n=t[e];return function(e,t,n){return Qg(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}},{key:"getPointPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getIndexAngle(e)-Rv+n;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}},{key:"getPointPositionForValue",value:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}},{key:"getBasePosition",value:function(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}},{key:"getPointLabelPosition",value:function(e){var t=this._pointLabelItems[e];return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"drawBackground",value:function(){var e=this.options,t=e.backgroundColor,n=e.grid.circular;if(t){var r=this.ctx;r.save(),r.beginPath(),dk(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}},{key:"drawGrid",value:function(){var e,t,n,r=this,a=this.ctx,i=this.options,o=i.angleLines,s=i.grid,u=i.border,c=this._pointLabels.length;if(i.pointLabels.display&&function(e,t){for(var n=e.ctx,r=e.options.pointLabels,a=t-1;a>=0;a--){var i=e._pointLabelItems[a];if(i.visible){var o=r.setContext(e.getPointLabelContext(a));hk(n,o,i);var s=Xg(o.font),u=i.x,c=i.y,l=i.textAlign;Bg(n,e._pointLabels[a],u,c+s.lineHeight/2,s,{color:o.color,textAlign:l,textBaseline:"middle"})}}}(this,c),s.display&&this.ticks.forEach((function(e,n){if(0!==n){t=r.getDistanceFromCenterForValue(e.value);var a=r.getContext(n),i=s.setContext(a),o=u.setContext(a);!function(e,t,n,r,a){var i=e.ctx,o=t.circular,s=t.color,u=t.lineWidth;!o&&!r||!s||!u||n<0||(i.save(),i.strokeStyle=s,i.lineWidth=u,i.setLineDash(a.dash),i.lineDashOffset=a.dashOffset,i.beginPath(),dk(e,n,o,r),i.closePath(),i.stroke(),i.restore())}(r,i,t,c,o)}})),o.display){for(a.save(),e=c-1;e>=0;e--){var l=o.setContext(this.getPointLabelContext(e)),h=l.color,d=l.lineWidth;d&&h&&(a.lineWidth=d,a.strokeStyle=h,a.setLineDash(l.borderDash),a.lineDashOffset=l.borderDashOffset,t=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),n=this.getPointPosition(e,t),a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(n.x,n.y),a.stroke())}a.restore()}}},{key:"drawBorder",value:function(){}},{key:"drawLabels",value:function(){var e=this,t=this.ctx,n=this.options,r=n.ticks;if(r.display){var a,i,o=this.getIndexAngle(0);t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(o),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((function(o,s){if(0!==s||n.reverse){var u=r.setContext(e.getContext(s)),c=Xg(u.font);if(a=e.getDistanceFromCenterForValue(e.ticks[s].value),u.showLabelBackdrop){t.font=c.string,i=t.measureText(o.label).width,t.fillStyle=u.backdropColor;var l=Zg(u.backdropPadding);t.fillRect(-i/2-l.left,-a-c.size/2-l.top,i+l.width,c.size+l.height)}Bg(t,o.label,0,-a,c,{color:u.color,strokeColor:u.textStrokeColor,strokeWidth:u.textStrokeWidth})}})),t.restore()}}},{key:"drawTitle",value:function(){}}]),n}(Qw);(0,_.Z)(fk,"id","radialLinear"),(0,_.Z)(fk,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:bg.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:function(e){return e},padding:5,centerPointLabels:!1}}),(0,_.Z)(fk,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,_.Z)(fk,"descriptors",{angleLines:{_fallback:"grid"}});var pk={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},mk=Object.keys(pk);function vk(e,t){return e-t}function gk(e,t){if(nv(t))return null;var n=e._adapter,r=e._parseOpts,a=r.parser,i=r.round,o=r.isoWeekday,s=t;return"function"===typeof a&&(s=a(s)),iv(s)||(s="string"===typeof a?n.parse(s,a):n.parse(s)),null===s?null:(i&&(s="week"!==i||!Fv(o)&&!0!==o?n.startOf(s,i):n.startOf(s,"isoWeek",o)),+s)}function yk(e,t,n,r){for(var a=mk.length,i=mk.indexOf(e);i<a-1;++i){var o=pk[mk[i]],s=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(s*o.size))<=r)return mk[i]}return mk[a-1]}function bk(e,t,n){if(n){if(n.length){var r=Xv(n,t),a=r.lo,i=r.hi;e[n[a]>=t?n[a]:n[i]]=!0}}else e[t]=!0}function xk(e,t,n){var r,a,i=[],o={},s=t.length;for(r=0;r<s;++r)o[a=t[r]]=r,i.push({value:a,major:!1});return 0!==s&&n?function(e,t,n,r){var a,i,o=e._adapter,s=+o.startOf(t[0].value,r),u=t[t.length-1].value;for(a=s;a<=u;a=+o.add(a,1,r))(i=n[a])>=0&&(t[i].major=!0);return t}(e,i,o,n):i}var wk=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e))._cache={data:[],labels:[],all:[]},r._unit="day",r._majorUnit=void 0,r._offsets={},r._normalized=!1,r._parseOpts=void 0,r}return Te(n,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.time||(e.time={}),a=this._adapter=new Tb._date(e.adapters.date);a.init(t),vv(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},me(pe(n.prototype),"init",this).call(this,e),this._normalized=t.normalized}},{key:"parse",value:function(e,t){return void 0===e?null:gk(this,e)}},{key:"beforeLayout",value:function(){me(pe(n.prototype),"beforeLayout",this).call(this),this._cache={data:[],labels:[],all:[]}}},{key:"determineDataLimits",value:function(){var e=this.options,t=this._adapter,n=e.time.unit||"day",r=this.getUserBounds(),a=r.min,i=r.max,o=r.minDefined,s=r.maxDefined;function u(e){o||isNaN(e.min)||(a=Math.min(a,e.min)),s||isNaN(e.max)||(i=Math.max(i,e.max))}o&&s||(u(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||u(this.getMinMax(!1))),a=iv(a)&&!isNaN(a)?a:+t.startOf(Date.now(),n),i=iv(i)&&!isNaN(i)?i:+t.endOf(Date.now(),n)+1,this.min=Math.min(a,i-1),this.max=Math.max(a+1,i)}},{key:"_getLabelBounds",value:function(){var e=this.getLabelTimestamps(),t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}},{key:"buildTicks",value:function(){var e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);var a=this.min,i=function(e,t,n){for(var r=0,a=e.length;r<a&&e[r]<t;)r++;for(;a>r&&e[a-1]>n;)a--;return r>0||a<e.length?e.slice(r,a):e}(r,a,this.max);return this._unit=t.unit||(n.autoSkip?yk(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(e,t,n,r,a){for(var i=mk.length-1;i>=mk.indexOf(n);i--){var o=mk[i];if(pk[o].common&&e._adapter.diff(a,r,o)>=t-1)return o}return mk[n?mk.indexOf(n):0]}(this,i.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(var t=mk.indexOf(e)+1,n=mk.length;t<n;++t)if(pk[mk[t]].common)return mk[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&i.reverse(),xk(this,i,this._majorUnit)}},{key:"afterAutoSkip",value:function(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((function(e){return+e.value})))}},{key:"initOffsets",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,a=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),a=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);var i=n.length<3?.5:.25;r=qv(r,0,i),a=qv(a,0,i),this._offsets={start:r,end:a,factor:1/(r+1+a)}}},{key:"_generate",value:function(){var e,t,n=this._adapter,r=this.min,a=this.max,i=this.options,o=i.time,s=o.unit||yk(o.minUnit,r,a,this._getLabelCapacity(r)),u=sv(i.ticks.stepSize,1),c="week"===s&&o.isoWeekday,l=Fv(c)||!0===c,h={},d=r;if(l&&(d=+n.startOf(d,"isoWeek",c)),d=+n.startOf(d,l?"day":s),n.diff(a,r,s)>1e5*u)throw new Error(r+" and "+a+" are too far apart with stepSize of "+u+" "+s);var f="data"===i.ticks.source&&this.getDataTimestamps();for(e=d,t=0;e<a;e=+n.add(e,u,s),t++)bk(h,e,f);return e!==a&&"ticks"!==i.bounds&&1!==t||bk(h,e,f),Object.keys(h).sort(vk).map((function(e){return+e}))}},{key:"getLabelForValue",value:function(e){var t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}},{key:"format",value:function(e,t){var n=this.options.time.displayFormats,r=this._unit,a=t||n[r];return this._adapter.format(e,a)}},{key:"_tickFormatFunction",value:function(e,t,n,r){var a=this.options,i=a.ticks.callback;if(i)return cv(i,[e,t,n],this);var o=a.time.displayFormats,s=this._unit,u=this._majorUnit,c=s&&o[s],l=u&&o[u],h=n[t],d=u&&l&&h&&h.major;return this._adapter.format(e,r||(d?l:c))}},{key:"generateTickLabels",value:function(e){var t,n,r;for(t=0,n=e.length;t<n;++t)(r=e[t]).label=this._tickFormatFunction(r.value,t,e)}},{key:"getDecimalForValue",value:function(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}},{key:"getPixelForValue",value:function(e){var t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}},{key:"_getLabelSize",value:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,r=Bv(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(r),i=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:n*a+o*i,h:n*i+o*a}}},{key:"_getLabelCapacity",value:function(e){var t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,a=this._tickFormatFunction(e,0,xk(this,[e],this._majorUnit),r),i=this._getLabelSize(a),o=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return o>0?o:1}},{key:"getDataTimestamps",value:function(){var e,t,n=this._cache.data||[];if(n.length)return n;var r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}},{key:"getLabelTimestamps",value:function(){var e,t,n=this._cache.labels||[];if(n.length)return n;var r=this.getLabels();for(e=0,t=r.length;e<t;++e)n.push(gk(this,r[e]));return this._cache.labels=this._normalized?n:this.normalize(n)}},{key:"normalize",value:function(e){return eg(e.sort(vk))}}]),n}(Sx);function kk(e,t,n){var r,a,i,o,s=0,u=e.length-1;if(n){if(t>=e[s].pos&&t<=e[u].pos){var c=Yv(e,"pos",t);s=c.lo,u=c.hi}var l=e[s];r=l.pos,i=l.time;var h=e[u];a=h.pos,o=h.time}else{if(t>=e[s].time&&t<=e[u].time){var d=Yv(e,"time",t);s=d.lo,u=d.hi}var f=e[s];r=f.time,i=f.pos;var p=e[u];a=p.time,o=p.pos}var m=a-r;return m?i+(o-i)*(t-r)/m:i}(0,_.Z)(wk,"id","time"),(0,_.Z)(wk,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});var Sk=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e))._table=[],r._minPos=void 0,r._tableRange=void 0,r}return Te(n,[{key:"initOffsets",value:function(){var e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=kk(t,this.min),this._tableRange=kk(t,this.max)-this._minPos,me(pe(n.prototype),"initOffsets",this).call(this,e)}},{key:"buildLookupTable",value:function(e){var t,n,r,a,i,o=this.min,s=this.max,u=[],c=[];for(t=0,n=e.length;t<n;++t)(a=e[t])>=o&&a<=s&&u.push(a);if(u.length<2)return[{time:o,pos:0},{time:s,pos:1}];for(t=0,n=u.length;t<n;++t)i=u[t+1],r=u[t-1],a=u[t],Math.round((i+r)/2)!==a&&c.push({time:a,pos:t/(n-1)});return c}},{key:"_generate",value:function(){var e=this.min,t=this.max,r=me(pe(n.prototype),"getDataTimestamps",this).call(this);return r.includes(e)&&r.length||r.splice(0,0,e),r.includes(t)&&1!==r.length||r.push(t),r.sort((function(e,t){return e-t}))}},{key:"_getTimestampsForTable",value:function(){var e=this._cache.all||[];if(e.length)return e;var t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e}},{key:"getDecimalForValue",value:function(e){return(kk(this._table,e)-this._minPos)/this._tableRange}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return kk(this._table,n*this._tableRange+this._minPos,!0)}}]),n}(wk);(0,_.Z)(Sk,"id","timeseries"),(0,_.Z)(Sk,"defaults",wk.defaults);var Ck=n(3366);var Ik=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],Tk="label";function _k(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Ek(e,t){e.labels=t}function Nk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tk,r=[];e.datasets=t.map((function(t){var a=e.datasets.find((function(e){return e[n]===t[n]}));return a&&t.data&&!r.includes(a)?(r.push(a),Object.assign(a,t),a):rt({},t)}))}function Rk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tk,n={labels:[],datasets:[]};return Ek(n,e.labels),Nk(n,e.datasets,t),n}function Ak(e,t){var n=e.height,r=void 0===n?150:n,a=e.width,i=void 0===a?300:a,o=e.redraw,s=void 0!==o&&o,u=e.datasetIdKey,c=e.type,l=e.data,h=e.options,d=e.plugins,f=void 0===d?[]:d,p=e.fallbackContent,m=e.updateMode,v=function(e,t){if(null==e)return{};var n,r,a=(0,Ck.Z)(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Ik),g=(0,S.useRef)(null),y=(0,S.useRef)(),b=function(){g.current&&(y.current=new ew(g.current,{type:c,data:Rk(l,u),options:h&&rt({},h),plugins:f}),_k(t,y.current))},x=function(){_k(t,null),y.current&&(y.current.destroy(),y.current=null)};return(0,S.useEffect)((function(){!s&&y.current&&h&&function(e,t){var n=e.options;n&&t&&Object.assign(n,t)}(y.current,h)}),[s,h]),(0,S.useEffect)((function(){!s&&y.current&&Ek(y.current.config.data,l.labels)}),[s,l.labels]),(0,S.useEffect)((function(){!s&&y.current&&l.datasets&&Nk(y.current.config.data,l.datasets,u)}),[s,l.datasets]),(0,S.useEffect)((function(){y.current&&(s?(x(),setTimeout(b)):y.current.update(m))}),[s,h,l.labels,l.datasets,m]),(0,S.useEffect)((function(){y.current&&(x(),setTimeout(b))}),[c]),(0,S.useEffect)((function(){return b(),function(){return x()}}),[]),S.createElement("canvas",Object.assign({ref:g,role:"img",height:r,width:i},v),p)}var Ok=(0,S.forwardRef)(Ak);function Dk(e,t){return ew.register(t),(0,S.forwardRef)((function(t,n){return S.createElement(Ok,Object.assign({},t,{ref:n,type:e}))}))}var Pk=Dk("line",xb),Mk=Dk("bar",gb);ew.register(Zw,$w,Cw,gw,mw,Rw,Hw,Ew);var Lk=function(){for(var e=JSON.parse(localStorage.getItem("userTrainingData")),t=[],n=0;n<7;n++)t.push(j()().add(-n,"day").format("MM/DD"));t.reverse();var r=[],a=[],i=[],o=e[j()().format("YYYY/MM/DD")].training;for(n=0;n<7;n++)void 0!==e[j()().add(-n,"day").format("YYYY/MM/DD")]?(o=e[j()().add(-n,"day").format("YYYY/MM/DD")].training,r.push(o.AbsTraining),a.push(o.LegTraining),i.push(o.PectoralTraining)):(r.push(0),a.push(0),i.push(0));r.reverse(),a.reverse(),i.reverse();var s=[30,20,30,30,65,20,20,20,20,12,44,43],u=Object.keys(e).reverse().reverse(),c=[0],l=[0],h=[0];u.forEach((function(t,n){c.push(c[n]+e[t].training.AbsTraining),l.push(l[n]+e[t].training.LegTraining),h.push(h[n]+e[t].training.PectoralTraining)})),u.reverse().push(0),u.reverse();var d={labels:t,datasets:[{label:"\u4e0a\u4f53\u8d77\u3053\u3057",data:t.map((function(e,t){return r[t]})),backgroundColor:"rgb(255, 99, 132)"},{label:"\u8155\u7acb\u3066\u4f0f\u305b",data:t.map((function(e,t){return i[t]})),backgroundColor:"rgb(75, 192, 192)"},{label:"\u30b9\u30af\u30ef\u30c3\u30c8",data:t.map((function(e,t){return a[t]})),backgroundColor:"rgb(53, 162, 235)"}]},f={labels:u,datasets:[{label:"\u4e0a\u4f53\u8d77\u3053\u3057",data:u.map((function(e,t){return c[t]})),backgroundColor:"rgb(255, 99, 132)"},{label:"\u8155\u7acb\u3066\u4f0f\u305b",data:u.map((function(e,t){return h[t]})),backgroundColor:"rgb(75, 192, 192)"},{label:"\u30b9\u30af\u30ef\u30c3\u30c8",data:u.map((function(e,t){return l[t]})),backgroundColor:"rgb(53, 162, 235)"}]},p={labels:[1,2,3,4,5,6,7,8,9,10,11,12],datasets:[{label:"\u6d88\u8cbb\u30ab\u30ed\u30ea\u30fc",data:[1,2,3,4,5,6,7,8,9,10,11,12].map((function(e,t){return s[t]})),backgroundColor:"rgb(255, 99, 132)"}]};return(0,M.jsxs)("div",{className:"GraphContents Main",children:[(0,M.jsx)("div",{className:"GraphContent",children:(0,M.jsx)(Mk,{options:{plugins:{title:{display:!0,text:"\u7b4b\u30c8\u30ec\u56de\u6570"}},responsive:!0,scales:{x:{stacked:!0},y:{stacked:!0}}},data:d,height:300,width:500})}),(0,M.jsx)("div",{className:"GraphContent",children:(0,M.jsx)(Pk,{options:{responsive:!0,interaction:{mode:"index",intersect:!1},stacked:!1,plugins:{title:{display:!0,text:"\u7d2f\u8a08\u56de\u6570"}},scales:{y:{type:"linear",display:!0,position:"left"},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1}}}},data:f,height:300,width:500})}),(0,M.jsx)("div",{className:"GraphContent",children:(0,M.jsx)(Pk,{options:{responsive:!0,interaction:{mode:"index",intersect:!1},stacked:!1,plugins:{title:{display:!0,text:"\u63a8\u5b9a\u6d88\u8cbb\u30ab\u30ed\u30ea\u30fc"}},scales:{y:{type:"linear",display:!0,position:"left"},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1}}}},data:p,height:300,width:500})})]})};function Fk(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,he(e,t)}var zk=n(2007),Bk=n.n(zk),Vk=n(7462);function Uk(e){return"/"===e.charAt(0)}function Wk(e,t){for(var n=t,r=n+1,a=e.length;r<a;n+=1,r+=1)e[n]=e[r];e.pop()}var jk=function(e,t){void 0===t&&(t="");var n,r=e&&e.split("/")||[],a=t&&t.split("/")||[],i=e&&Uk(e),o=t&&Uk(t),s=i||o;if(e&&Uk(e)?a=r:r.length&&(a.pop(),a=a.concat(r)),!a.length)return"/";if(a.length){var u=a[a.length-1];n="."===u||".."===u||""===u}else n=!1;for(var c=0,l=a.length;l>=0;l--){var h=a[l];"."===h?Wk(a,l):".."===h?(Wk(a,l),c++):c&&(Wk(a,l),c--)}if(!s)for(;c--;c)a.unshift("..");!s||""===a[0]||a[0]&&Uk(a[0])||a.unshift("");var d=a.join("/");return n&&"/"!==d.substr(-1)&&(d+="/"),d},Gk=!0,Hk="Invariant failed";function Kk(e,t){if(!e){if(Gk)throw new Error(Hk);var n="function"===typeof t?t():t,r=n?"".concat(Hk,": ").concat(n):Hk;throw new Error(r)}}function qk(e){return"/"===e.charAt(0)?e:"/"+e}function Zk(e){return"/"===e.charAt(0)?e.substr(1):e}function Xk(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function Yk(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function Qk(e){var t=e.pathname,n=e.search,r=e.hash,a=t||"/";return n&&"?"!==n&&(a+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(a+="#"===r.charAt(0)?r:"#"+r),a}function $k(e,t,n,r){var a;"string"===typeof e?(a=function(e){var t=e||"/",n="",r="",a=t.indexOf("#");-1!==a&&(r=t.substr(a),t=t.substr(0,a));var i=t.indexOf("?");return-1!==i&&(n=t.substr(i),t=t.substr(0,i)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e),a.state=t):(void 0===(a=(0,Vk.Z)({},e)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==t&&void 0===a.state&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(i){throw i instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):i}return n&&(a.key=n),r?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=jk(a.pathname,r.pathname)):a.pathname=r.pathname:a.pathname||(a.pathname="/"),a}function Jk(){var e=null;var t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,a){if(null!=e){var i="function"===typeof e?e(t,n):e;"string"===typeof i?"function"===typeof r?r(i,a):a(!0):a(!1!==i)}else a(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}var eS=!("undefined"===typeof window||!window.document||!window.document.createElement);function tS(e,t){t(window.confirm(e))}var nS="popstate",rS="hashchange";function aS(){try{return window.history.state||{}}catch(e){return{}}}function iS(e){void 0===e&&(e={}),eS||Kk(!1);var t=window.history,n=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),r=!(-1===window.navigator.userAgent.indexOf("Trident")),a=e,i=a.forceRefresh,o=void 0!==i&&i,s=a.getUserConfirmation,u=void 0===s?tS:s,c=a.keyLength,l=void 0===c?6:c,h=e.basename?Yk(qk(e.basename)):"";function d(e){var t=e||{},n=t.key,r=t.state,a=window.location,i=a.pathname+a.search+a.hash;return h&&(i=Xk(i,h)),$k(i,r,n)}function f(){return Math.random().toString(36).substr(2,l)}var p=Jk();function m(e){(0,Vk.Z)(_,e),_.length=t.length,p.notifyListeners(_.location,_.action)}function v(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||b(d(e.state))}function g(){b(d(aS()))}var y=!1;function b(e){if(y)y=!1,m();else{p.confirmTransitionTo(e,"POP",u,(function(t){t?m({action:"POP",location:e}):function(e){var t=_.location,n=w.indexOf(t.key);-1===n&&(n=0);var r=w.indexOf(e.key);-1===r&&(r=0);var a=n-r;a&&(y=!0,S(a))}(e)}))}}var x=d(aS()),w=[x.key];function k(e){return h+Qk(e)}function S(e){t.go(e)}var C=0;function I(e){1===(C+=e)&&1===e?(window.addEventListener(nS,v),r&&window.addEventListener(rS,g)):0===C&&(window.removeEventListener(nS,v),r&&window.removeEventListener(rS,g))}var T=!1;var _={length:t.length,action:"POP",location:x,createHref:k,push:function(e,r){var a="PUSH",i=$k(e,r,f(),_.location);p.confirmTransitionTo(i,a,u,(function(e){if(e){var r=k(i),s=i.key,u=i.state;if(n)if(t.pushState({key:s,state:u},null,r),o)window.location.href=r;else{var c=w.indexOf(_.location.key),l=w.slice(0,c+1);l.push(i.key),w=l,m({action:a,location:i})}else window.location.href=r}}))},replace:function(e,r){var a="REPLACE",i=$k(e,r,f(),_.location);p.confirmTransitionTo(i,a,u,(function(e){if(e){var r=k(i),s=i.key,u=i.state;if(n)if(t.replaceState({key:s,state:u},null,r),o)window.location.replace(r);else{var c=w.indexOf(_.location.key);-1!==c&&(w[c]=i.key),m({action:a,location:i})}else window.location.replace(r)}}))},go:S,goBack:function(){S(-1)},goForward:function(){S(1)},block:function(e){void 0===e&&(e=!1);var t=p.setPrompt(e);return T||(I(1),T=!0),function(){return T&&(T=!1,I(-1)),t()}},listen:function(e){var t=p.appendListener(e);return I(1),function(){I(-1),t()}}};return _}var oS="hashchange",sS={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+Zk(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:Zk,decodePath:qk},slash:{encodePath:qk,decodePath:qk}};function uS(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function cS(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function lS(e){window.location.replace(uS(window.location.href)+"#"+e)}function hS(e){void 0===e&&{},eS||Kk(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),r=n.getUserConfirmation,a=void 0===r?tS:r,i=n.hashType,o=void 0===i?"slash":i,s=e.basename?Yk(qk(e.basename)):"",u=sS[o],c=u.encodePath,l=u.decodePath;function h(){var e=l(cS());return s&&Xk(e,s),$k(e)}var d=Jk();function f(e){(0,Vk.Z)(I,e),I.length=t.length,d.notifyListeners(I.location,I.action)}var p=!1,m=null;function v(){var e=cS(),t=c(e);if(e!==t)lS(t);else{var n=h(),r=I.location;if(!p&&function(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash}(r,n))return;if(m===Qk(n))return;null,function(e){if(p)!1,f();else{var t="POP";d.confirmTransitionTo(e,t,a,(function(n){n?f({action:t,location:e}):function(e){var t=I.location,n=x.lastIndexOf(Qk(t));-1===n&&0;var r=x.lastIndexOf(Qk(e));-1===r&&0;var a=n-r;a&&(!0,w(a))}(e)}))}}(n)}}var g=cS(),y=c(g);g!==y&&lS(y);var b=h(),x=[Qk(b)];function w(e){t.go(e)}var k=0;function S(e){1===(k+=e)&&1===e?window.addEventListener(oS,v):0===k&&window.removeEventListener(oS,v)}var C=!1;var I={length:t.length,action:"POP",location:b,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&uS(window.location.href),n+"#"+c(s+Qk(e))},push:function(e,t){var n="PUSH",r=$k(e,void 0,void 0,I.location);d.confirmTransitionTo(r,n,a,(function(e){if(e){var t=Qk(r),a=c(s+t);if(cS()!==a){t,function(e){window.location.hash=e}(a);var i=x.lastIndexOf(Qk(I.location)),o=x.slice(0,i+1);o.push(t),o,f({action:n,location:r})}else f()}}))},replace:function(e,t){var n="REPLACE",r=$k(e,void 0,void 0,I.location);d.confirmTransitionTo(r,n,a,(function(e){if(e){var t=Qk(r),a=c(s+t);cS()!==a&&(t,lS(a));var i=x.indexOf(Qk(I.location));-1!==i&&(x[i]=t),f({action:n,location:r})}}))},go:w,goBack:function(){w(-1)},goForward:function(){w(1)},block:function(e){void 0===e&&!1;var t=d.setPrompt(e);return C||(S(1),!0),function(){return C&&(!1,S(-1)),t()}},listen:function(e){var t=d.appendListener(e);return S(1),function(){S(-1),t()}}};return I}function dS(e,t,n){return Math.min(Math.max(e,t),n)}var fS=n(3813),pS=n.n(fS),mS=(n(8228),n(2110),1073741823),vS="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{};var gS=S.createContext||function(e,t){var n,r,a="__create-react-context-"+function(){var e="__global_unique_id__";return vS[e]=(vS[e]||0)+1}()+"__",i=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).emitter=function(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,r){e=n,t.forEach((function(t){return t(e,r)}))}}}(t.props.value),t}Fk(n,e);var r=n.prototype;return r.getChildContext=function(){var e;return(e={})[a]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,r=this.props.value,a=e.value;!function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(r,a)?(n="function"===typeof t?t(r,a):mS,0!==(n|=0)&&this.emitter.set(e.value,n)):n=0}},r.render=function(){return this.props.children},n}(S.Component);i.childContextTypes=((n={})[a]=Bk().object.isRequired,n);var o=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){0!==((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}Fk(n,t);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?mS:t},r.componentDidMount=function(){this.context[a]&&this.context[a].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?mS:e},r.componentWillUnmount=function(){this.context[a]&&this.context[a].off(this.onUpdate)},r.getValue=function(){return this.context[a]?this.context[a].get():e},r.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(S.Component);return o.contextTypes=((r={})[a]=Bk().object,r),{Provider:i,Consumer:o}},yS=function(e){var t=gS();return t.displayName=e,t},bS=yS("Router-History"),xS=yS("Router"),wS=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}Fk(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return S.createElement(xS.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},S.createElement(bS.Provider,{children:this.props.children||null,value:this.props.history}))},t}(S.Component);S.Component;S.Component;var kS={},SS=1e4,CS=0;function IS(e,t){void 0===t&&(t={}),("string"===typeof t||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,a=n.exact,i=void 0!==a&&a,o=n.strict,s=void 0!==o&&o,u=n.sensitive,c=void 0!==u&&u;return[].concat(r).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var r=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=kS[n]||(kS[n]={});if(r[e])return r[e];var a=[],i={regexp:pS()(e,a,t),keys:a};return CS<SS&&(r[e]=i,CS++),i}(n,{end:i,strict:s,sensitive:c}),a=r.regexp,o=r.keys,u=a.exec(e);if(!u)return null;var l=u[0],h=u.slice(1),d=e===l;return i&&!d?null:{path:n,url:"/"===n&&""===l?"/":l,isExact:d,params:o.reduce((function(e,t,n){return e[t.name]=h[n],e}),{})}}),null)}var TS=function(e){function t(){return e.apply(this,arguments)||this}return Fk(t,e),t.prototype.render=function(){var e=this;return S.createElement(xS.Consumer,null,(function(t){t||Kk(!1);var n=e.props.location||t.location,r=e.props.computedMatch?e.props.computedMatch:e.props.path?IS(n.pathname,e.props):t.match,a=(0,Vk.Z)({},t,{location:n,match:r}),i=e.props,o=i.children,s=i.component,u=i.render;return Array.isArray(o)&&function(e){return 0===S.Children.count(e)}(o)&&(o=null),S.createElement(xS.Provider,{value:a},a.match?o?"function"===typeof o?o(a):o:s?S.createElement(s,a):u?u(a):null:"function"===typeof o?o(a):null)}))},t}(S.Component);function _S(e){return"/"===e.charAt(0)?e:"/"+e}function ES(e,t){if(!e)return t;var n=_S(e);return 0!==t.pathname.indexOf(n)?t:(0,Vk.Z)({},t,{pathname:t.pathname.substr(n.length)})}function NS(e){return"string"===typeof e?e:Qk(e)}function RS(e){return function(){Kk(!1)}}function AS(){}S.Component;var OS=function(e){function t(){return e.apply(this,arguments)||this}return Fk(t,e),t.prototype.render=function(){var e=this;return S.createElement(xS.Consumer,null,(function(t){t||Kk(!1);var n,r,a=e.props.location||t.location;return S.Children.forEach(e.props.children,(function(e){if(null==r&&S.isValidElement(e)){n=e;var i=e.props.path||e.props.from;r=i?IS(a.pathname,(0,Vk.Z)({},e.props,{path:i})):t.match}})),r?S.cloneElement(n,{location:a,computedMatch:r}):null}))},t}(S.Component);S.useContext;var DS=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).history=iS(t.props),t}return Fk(t,e),t.prototype.render=function(){return S.createElement(wS,{history:this.history,children:this.props.children})},t}(S.Component);S.Component;var PS=function(e,t){return"function"===typeof e?e(t):e},MS=function(e,t){return"string"===typeof e?$k(e,null,null,t):e},LS=function(e){return e},FS=S.forwardRef;"undefined"===typeof FS&&(FS=LS);var zS=FS((function(e,t){var n=e.innerRef,r=e.navigate,a=e.onClick,i=(0,Ck.Z)(e,["innerRef","navigate","onClick"]),o=i.target,s=(0,Vk.Z)({},i,{onClick:function(e){try{a&&a(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||o&&"_self"!==o||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),r())}});return s.ref=LS!==FS&&t||n,S.createElement("a",s)}));var BS=FS((function(e,t){var n=e.component,r=void 0===n?zS:n,a=e.replace,i=e.to,o=e.innerRef,s=(0,Ck.Z)(e,["component","replace","to","innerRef"]);return S.createElement(xS.Consumer,null,(function(e){e||Kk(!1);var n=e.history,u=MS(PS(i,e.location),e.location),c=u?n.createHref(u):"",l=(0,Vk.Z)({},s,{href:c,navigate:function(){var t=PS(i,e.location),r=Qk(e.location)===Qk(MS(t));(a||r?n.replace:n.push)(t)}});return LS!==FS?l.ref=t||o:l.innerRef=o,S.createElement(r,l)}))})),VS=function(e){return e},US=S.forwardRef;"undefined"===typeof US&&(US=VS);US((function(e,t){var n=e["aria-current"],r=void 0===n?"page":n,a=e.activeClassName,i=void 0===a?"active":a,o=e.activeStyle,s=e.className,u=e.exact,c=e.isActive,l=e.location,h=e.sensitive,d=e.strict,f=e.style,p=e.to,m=e.innerRef,v=(0,Ck.Z)(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return S.createElement(xS.Consumer,null,(function(e){e||Kk(!1);var n=l||e.location,a=MS(PS(p,n),n),g=a.pathname,y=g&&g.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),b=y?IS(n.pathname,{path:y,exact:u,sensitive:h,strict:d}):null,x=!!(c?c(b,n):b),w="function"===typeof s?s(x):s,k="function"===typeof f?f(x):f;x&&(w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(w,i),k=(0,Vk.Z)({},k,o));var C=(0,Vk.Z)({"aria-current":x&&r||null,className:w,style:k,to:a},v);return VS!==US?C.ref=t||m:C.innerRef=m,S.createElement(BS,C)}))}));var WS=function(){var e=localStorage.getItem("UserId"),t=(0,S.useState)(0),n=(0,U.Z)(t,2),r=n[0],a=n[1],i=(0,S.useState)(0),o=(0,U.Z)(i,2),s=o[0],u=o[1],c=(0,S.useState)(0),l=(0,U.Z)(c,2),h=l[0],d=l[1];return(0,M.jsx)("div",{className:"Main",children:(0,M.jsxs)("div",{className:"setting",children:[(0,M.jsx)("div",{className:"Profile",children:(0,M.jsxs)("p",{children:["UserId : ",e]})}),(0,M.jsxs)("div",{className:"TrainingTarget",children:[(0,M.jsx)("h2",{className:"TragetTitle",children:"\u76ee\u6a19\u8a2d\u5b9a"}),(0,M.jsx)("label",{className:"InputLabel",children:"\u8179\u7b4b : "}),(0,M.jsx)("input",{type:"number",className:"TragetInput",value:r,onChange:function(e){return a(e.target.value)},required:!0}),(0,M.jsx)("label",{className:"InputLabel",children:"\u8db3\u7b4b : "}),(0,M.jsx)("input",{type:"number",className:"TargetInput",value:s,onChange:function(e){return u(e.target.value)},required:!0}),(0,M.jsx)("label",{className:"InputLabel",children:"\u80f8\u7b4b : "}),(0,M.jsx)("input",{type:"number",className:"TargetInput",value:h,onChange:function(e){return d(e.target.value)},required:!0})]})]})})},jS=n(2509),GS=function(){function e(t,n){Se(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return Te(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),HS=function(){function e(){Se(this,e)}return Te(e,[{key:"refCount",value:function(e){return KS("refCount")}},{key:"incRef",value:function(e){return KS("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return KS("time")}},{key:"read",value:function(e){return KS("read")}},{key:"readSync",value:function(e){return KS("readSync")}},{key:"readToGPU",value:function(e,t){return KS("readToGPU")}},{key:"numDataIds",value:function(){return KS("numDataIds")}},{key:"disposeData",value:function(e,t){return KS("disposeData")}},{key:"write",value:function(e,t,n){return KS("write")}},{key:"move",value:function(e,t,n,r,a){return KS("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return KS("createTensorFromGPUData")}},{key:"memory",value:function(){return KS("memory")}},{key:"floatPrecision",value:function(){return KS("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return KS("dispose")}}]),e}();function KS(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function qS(e){return e%2===0?e:e+1}function ZS(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function XS(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function YS(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function QS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";YS(tC(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function $S(e){YS(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function JS(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function eC(e){return 0===e.length}function tC(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function nC(e){return e%1===0}function rC(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function aC(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function iC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function s(){if(e())a();else{o++;var u=t(o);null!=n&&o>=n?i():null!=r?r(s,u):setTimeout(s,u)}}()}))}function oC(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function sC(e,t){var n=t.length;return YS((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),YS(e.every((function(e){return nC(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function uC(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:sC(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function cC(e,t){return lC(e,t)}function lC(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function hC(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function dC(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function fC(e){return"string"===typeof e||e instanceof String}function pC(e){return Array.isArray(e)?pC(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":"number"===typeof e?"float32":fC(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function mC(e){return!!(e&&e.constructor&&e.call&&e.apply)}function vC(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function gC(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function yC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var s=t[0],u=t.slice(1),c=u.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<s;l++)a[l]=yC(e+l*c,u,n,r);return a}function bC(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return yC(0,e,t,n)}function xC(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function wC(e,t){for(var n=kC(e,t),r=0;r<n.length;r++)n[r]=1;return n}function kC(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function SC(e){e.forEach((function(t){YS(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function CC(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function IC(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function TC(e){return e&&e.then&&"function"===typeof e.then}var _C="tfjsflags",EC=function(){function e(t){Se(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=NC,this.populateURLFlags()}return Te(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(RC().getBool("IS_TEST")||RC().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];RC().getBool("IS_TEST")||RC().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(TC(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getString",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(_C in t)t[_C].split(",").forEach((function(t){var n=t.split(":"),r=(0,U.Z)(n,2),a=r[0],i=r[1];e.urlFlags[a]=function(e,t){var n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,i)}))}}}]),e}();function NC(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function RC(){return OC}var AC,OC=null;function DC(){if(null==AC){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}AC=e}return AC}function PC(e,t){var n=function(){var e=DC();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var MC="Abs",LC="Acos",FC="Acosh",zC="Add",BC="AddN",VC="All",UC="Any",WC="ArgMax",jC="ArgMin",GC="Asin",HC="Asinh",KC="Atan",qC="Atanh",ZC="Atan2",XC="AvgPool",YC="AvgPoolGrad",QC="AvgPool3D",$C="AvgPool3DGrad",JC="BatchMatMul",eI="BatchToSpaceND",tI="Bincount",nI="BitwiseAnd",rI="BroadcastArgs",aI="Cast",iI="Ceil",oI="ClipByValue",sI="Complex",uI="ComplexAbs",cI="Concat",lI="Conv2D",hI="Conv2DBackpropFilter",dI="Conv2DBackpropInput",fI="Conv3D",pI="Conv3DBackpropFilterV2",mI="Conv3DBackpropInputV2",vI="Cos",gI="Cosh",yI="Cumprod",bI="Cumsum",xI="CropAndResize",wI="DenseBincount",kI="DepthToSpace",SI="DepthwiseConv2dNative",CI="DepthwiseConv2dNativeBackpropFilter",II="DepthwiseConv2dNativeBackpropInput",TI="Diag",_I="Dilation2D",EI="Draw",NI="RealDiv",RI="Einsum",AI="Elu",OI="EluGrad",DI="Erf",PI="Equal",MI="Exp",LI="ExpandDims",FI="Expm1",zI="FFT",BI="Fill",VI="FlipLeftRight",UI="Floor",WI="FloorDiv",jI="FusedBatchNorm",GI="GatherV2",HI="GatherNd",KI="Greater",qI="GreaterEqual",ZI="Identity",XI="IFFT",YI="Imag",QI="IsFinite",$I="IsInf",JI="IsNan",eT="LeakyRelu",tT="Less",nT="LessEqual",rT="LinSpace",aT="Log",iT="Log1p",oT="LogicalAnd",sT="LogicalNot",uT="LogicalOr",cT="LRN",lT="LRNGrad",hT="Max",dT="Maximum",fT="MaxPool",pT="MaxPoolGrad",mT="MaxPool3D",vT="MaxPool3DGrad",gT="MaxPoolWithArgmax",yT="Mean",bT="Min",xT="Minimum",wT="MirrorPad",kT="Mod",ST="Multinomial",CT="Multiply",IT="Neg",TT="NotEqual",_T="NonMaxSuppressionV3",ET="NonMaxSuppressionV4",NT="NonMaxSuppressionV5",RT="OnesLike",AT="OneHot",OT="Pack",DT="PadV2",PT="Pow",MT="Prelu",LT="Prod",FT="RaggedGather",zT="RaggedRange",BT="RaggedTensorToTensor",VT="Range",UT="Real",WT="Reciprocal",jT="Relu",GT="Reshape",HT="ResizeNearestNeighbor",KT="ResizeNearestNeighborGrad",qT="ResizeBilinear",ZT="ResizeBilinearGrad",XT="Relu6",YT="Reverse",QT="Round",$T="Rsqrt",JT="ScatterNd",e_="TensorScatterUpdate",t_="SearchSorted",n_="Select",r_="Selu",a_="Slice",i_="Sin",o_="Sinh",s_="Sign",u_="Sigmoid",c_="Softplus",l_="Sqrt",h_="Sum",d_="SpaceToBatchND",f_="SplitV",p_="Softmax",m_="SparseFillEmptyRows",v_="SparseReshape",g_="SparseSegmentMean",y_="SparseSegmentSum",b_="SparseToDense",x_="SquaredDifference",w_="Square",k_="StaticRegexReplace",S_="StridedSlice",C_="StringNGrams",I_="StringSplit",T_="StringToHashBucketFast",__="Sub",E_="Tan",N_="Tanh",R_="Tile",A_="TopK",O_="Transform",D_="Transpose",P_="Unique",M_="Unpack",L_="UnsortedSegmentSum",F_="ZerosLike",z_="Step",B_="FromPixels",V_="RotateWithOffset",U_="_FusedMatMul",W_="FusedConv2D",j_="FusedDepthwiseConv2D";function G_(){var e;RC().getBool("IS_TEST")||RC().getBool("PROD")||(e=console).warn.apply(e,arguments)}var H_=PC("kernelRegistry",(function(){return new Map})),K_=PC("gradRegistry",(function(){return new Map}));function q_(e,t){var n=Q_(e,t);return H_.get(n)}function Z_(e){return K_.get(e)}function X_(e){for(var t=H_.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=(0,U.Z)(i,2),s=o[0],u=o[1],c=s.split("_");(0,U.Z)(c,1)[0]===e&&n.push(u)}return n}function Y_(e){var t=e.kernelName,n=e.backendName,r=Q_(t,n);H_.has(r)&&G_("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),H_.set(r,e)}function Q_(e,t){return"".concat(t,"_").concat(e)}function $_(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var J_=n(8097),eE=n.n(J_)()||J_;function tE(e){return eE.fromString(e,!0,16)}var nE=tE("c3a5c85c97cb3127"),rE=tE("b492b66fbe98f273"),aE=tE("9ae16a3b2f90404f");function iE(e){return e.xor(e.shru(47))}function oE(e,t,n){var r=e.slice(t,t+n);return eE.fromBytes(Array.from(r),!0,!0)}function sE(e,t){return oE(e,t,8)}function uE(e,t){return oE(e,t,4)}function cE(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function lE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tE("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function hE(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=cE(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(cE(a,44)),[a.add(r),i.add(o)]}(sE(e,t),sE(e,t+8),sE(e,t+16),sE(e,t+24),n,r)}function dE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=eE.fromNumber(81,!0);if(t<=32)return t<=16?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=aE.add(2*t),r=sE(e,0).add(aE),a=sE(e,t-8);return lE(cE(a,37).mul(n).add(r),cE(r,25).add(a).mul(n),n)}if(t>=4){var i=aE.add(2*t);return lE(uE(e,0).shl(3).add(t),uE(e,t-4),i)}if(t>0){var o=e[0]+(e[t>>1]<<8),s=t+(e[t-1]<<2);return iE(aE.mul(o).xor(nE.mul(s))).mul(aE)}return aE}(e,t):function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=aE.add(2*t),r=sE(e,0).mul(rE),a=sE(e,8),i=sE(e,t-8).mul(n),o=sE(e,t-16).mul(aE);return lE(cE(r.add(a),43).add(cE(i,30)).add(o),r.add(cE(a.add(aE),18)).add(i),n)}(e,t);if(t<=64)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=aE.add(2*t),r=sE(e,0).mul(aE),a=sE(e,8),i=sE(e,t-8).mul(n),o=sE(e,t-16).mul(aE),s=cE(r.add(a),43).add(cE(i,30)).add(o),u=lE(s,r.add(cE(a.add(aE),18)).add(i),n),c=sE(e,16).mul(n),l=sE(e,24),h=s.add(sE(e,t-32)).mul(n),d=u.add(sE(e,t-24)).mul(n);return lE(cE(c.add(l),43).add(cE(h,30)).add(d),c.add(cE(l.add(r),18)).add(h),n)}(e,t);var r=n,a=n.mul(rE).add(113),i=iE(a.mul(aE).add(113)).mul(aE),o=[eE.UZERO,eE.UZERO],s=[eE.UZERO,eE.UZERO];r=r.mul(aE).add(sE(e,0));var u=0,c=64*(t-1>>6),l=c+(t-1&63)-63;do{r=cE(r.add(a).add(o[0]).add(sE(e,u+8)),37).mul(rE),a=cE(a.add(o[1]).add(sE(e,u+48)),42).mul(rE),r=r.xor(s[1]),a=a.add(o[0]).add(sE(e,u+40)),i=cE(i.add(s[0]),33).mul(rE),o=hE(e,u,o[1].mul(rE),r.add(s[0])),s=hE(e,u+32,i.add(s[1]),a.add(sE(e,u+16)));var h=[r,i];i=h[0],r=h[1],u+=64}while(u!==c);var d=rE.add(i.and(255).shl(1));u=l,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=cE(r.add(a).add(o[0]).add(sE(e,u+8)),37).mul(d),a=cE(a.add(o[1]).add(sE(e,u+48)),42).mul(d),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(sE(e,u+40))),i=cE(i.add(s[0]),33).mul(d),o=hE(e,u,o[1].mul(d),r.add(s[0])),s=hE(e,u+32,i.add(s[1]),a.add(sE(e,u+16)));var f=[r,i];return i=f[0],r=f[1],lE(lE(o[0],s[0],d).add(iE(a).mul(nE)).add(i),lE(o[1],s[1],d).add(r),d)}function fE(e,t){return"string"===t?vE(e):pE([e],t)}function pE(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=bE(e)),RC().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function mE(){return RC().platform.now()}function vE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",RC().platform.encode(e,t)}function gE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",RC().platform.decode(e,t)}function yE(e){return null!=RC().platform.isTypedArray?RC().platform.isTypedArray(e):$_(e)}function bE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||TC(e)||null==e||yE(e)&&n)t.push(e);else if(Array.isArray(e)||yE(e))for(var r=0;r<e.length;++r)bE(e[r],t,n);else{for(var a=-1,i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];/^([1-9]+[0-9]*|0)$/.test(s)&&(a=Math.max(a,Number(s)))}for(var u=0;u<=a;u++)bE(e[u],t,n)}return t}var xE=function(){function e(t,n){Se(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new wE)}return Te(e,[{key:"profileKernel",value:function(e,t,n){var r,a,i=function(){r=n()},o=mE();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();var s,u=ye(r);try{for(u.s();!(s=u.n()).done;){s.value.dataSync()}}catch(h){u.e(h)}finally{u.f()}a=Promise.resolve({kernelMs:mE()-o})}if(RC().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var c=function(){var t=r[l];t.data().then((function(n){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(n,t.dtype,e)}))},l=0;l<r.length;l++)c();return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var wE=function(){function e(){Se(this,e)}return Te(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?aC("".concat(r,"ms"),9):r.error,s=aC(e,25),u=t.rank,c=t.size,l=aC(t.shape.toString(),14),h="";for(var d in a){var f=a[d];if(null!=f){var p=f.shape||t.shape,m=p.length;h+="".concat(d,": ").concat(m,"D ").concat(m>0?p:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();var kE=20,SE=3,CE=7;function IE(e,t,n,r){var a=gC(t),i=function(e,t,n,r){var a=JS(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?NE(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,h=0;h<i;h++)o[h]=Math.max(o[h],TE(u[l+h],0,n).length);return o}(e,t,n,a),o=t.length,s=EE(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function TE(e,t,n){return aC(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(CE))," + ")+"".concat(parseFloat(e[1].toFixed(CE)),"j"):fC(e)?"'".concat(e,"'"):"bool"===n?_E(e):parseFloat(e.toFixed(CE)).toString(),t)}function _E(e){return 0===e?"false":"true"}function EE(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u)return"complex64"===n?[TE(NE(e)[0],0,n)]:"bool"===n?[_E(e[0])]:[e[0].toString()];if(1===u){if(s>kE){var c=SE*o,l=Array.from(e.slice(0,c)),h=Array.from(e.slice((s-SE)*o,s*o));return"complex64"===n&&(l=NE(l),h=NE(h)),["["+l.map((function(e,t){return TE(e,a[t],n)})).join(", ")+", ..., "+h.map((function(e,t){return TE(e,a[s-SE+t],n)})).join(", ")+"]"]}return["["+("complex64"===n?NE(e):Array.from(e)).map((function(e,t){return TE(e,a[t],n)})).join(", ")+"]"]}var d=t.slice(1),f=r.slice(1),p=r[0]*o,m=[];if(s>kE){for(var v=0;v<SE;v++){var g=v*p,y=g+p;m.push.apply(m,(0,ke.Z)(EE(e.slice(g,y),d,n,f,a,!1)))}m.push("...");for(var b=s-SE;b<s;b++){var x=b*p,w=x+p;m.push.apply(m,(0,ke.Z)(EE(e.slice(x,w),d,n,f,a,b===s-1)))}}else for(var k=0;k<s;k++){var S=k*p,C=S+p;m.push.apply(m,(0,ke.Z)(EE(e.slice(S,C),d,n,f,a,k===s-1)))}var I=2===u?",":"";m[0]="["+(s>0?m[0]+I:"");for(var T=1;T<m.length-1;T++)m[T]=" "+m[T]+I;for(var _=",\n",E=2;E<u;E++)_+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(i?"":_),m}function NE(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var RE=function(){function e(t,n,r){var a=this;if(Se(this,e),this.dtype=n,this.shape=t.slice(),this.size=JS(t),null!=r){var i=r.length;YS(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||lC(n,this.size),this.strides=gC(t)}return Te(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),YS(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return AE().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),AE=null,OE=null;var DE=function(){function e(t,n,r,a){Se(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=JS(t),this.strides=gC(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return Te(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",OE.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return OE.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",bC(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return bC(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=N(T().mark((function e(){var t,n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=AE().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return gE(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),AE().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=AE().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return gE(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,AE().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(AE().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return OE.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),OE.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return IE(this.dataSync(),this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),OE.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),AE().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(DE,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),PC("Tensor",(function(){return DE}));var PE,ME,LE,FE,zE,BE=function(e){be(n,e);var t=we(n);function n(e,r,a,i){var o;return Se(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return Te(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!tC(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));AE().disposeTensor(this),this.dataId=e.dataId,AE().incRef(this,null)}},{key:"dispose",value:function(){AE().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(DE);Object.defineProperty(BE,Symbol.hasInstance,{value:function(e){return e instanceof DE&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(PE||(PE={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ME||(ME={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(LE||(LE={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(FE||(FE={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(zE||(zE={}));var VE={float32:FE,int32:ME,bool:LE,complex64:zE};function UE(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return VE[e][t]}function WE(e){return UE(e,"int32")}function jE(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function GE(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function HE(e,t){if(e.dtype===t.dtype)return[e,t];var n=UE(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function KE(e){var t=[];return qE(e,t,new Set),t}function qE(e,t,n){if(null!=e)if(e instanceof DE)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),qE(o,t,n))}}}function ZE(e){return null!=e.kernelName}var XE=function(){function e(){Se(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return Te(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),YE=function(){function e(t){Se(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new XE}return Te(e,[{key:"ready",value:function(){var e=N(T().mark((function e(){var t,n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(G_("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new xE(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;X_(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;X_(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof HS||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,G_("Initialization of backend ".concat(e," failed")),G_(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return G_("Initialization of backend ".concat(e," failed")),G_(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=JE.runKernel(ZI,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return JE.runKernel(aI,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=q_(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=ZE(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(ZE(e)){var l=e.kernelName,h=e.inputs,d=e.attrs;null==this.backendName&&this.backend;var f=q_(l,this.backendName);YS(null!=f,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=f.kernelFunc({inputs:h,attrs:d,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var s=a.getTensorsForGradient(l,h,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var p=e.forwardFunc,m=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return p(a.backend,m)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var v,g=e.inputs,y=e.attrs,b=ZE(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(v=a.profiler.profileKernel(c,g,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(v),t=v.outputs):t=n()})),o&&this.addTapeNode(c,g,t,b,i,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(g).map((function(e){return null!=g[e]?g[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:v.timeMs,extraInfo:v.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this,n=e.map((function(e){return t.keep(t.clone(e))}));return n}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Z_(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(YS(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&fC(e[0])&&(a=e.map((function(e){return vE(e)})));var i=r.write(a,t,n),o=new DE(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new DE(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new BE(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*dC(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof BE||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*dC(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,(0,ke.Z)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=ye(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=Z_(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=kC(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=KE(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(YS(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));YS(i instanceof DE,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],h=!1,d=0;d<t.length;d++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var f={};f[n.id]=!0;for(var p={},m=e.length-1;m>=0;m--)for(var v=e[m],g=v.inputs,y=0;y<v.outputs.length;y++)if(f[v.outputs[y].id]){for(var b in g)f[g[b].id]=!0,p[v.id]=!0;break}for(var x=[],w=0;w<e.length;w++){var k=e[w];if(a[k.id]&&p[k.id]){var S={};for(var C in k.inputs){var I=k.inputs[C];r[I.id]&&(S[C]=I)}var T=Object.assign({},k);T.inputs=S,T.outputs=k.outputs,x.push(T)}}return x}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?function(e){var t=wC(JS(e),"float32");return JE.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(var a=function(){var a=t[i],o=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[t];if(!tC(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var u=e[o.id];e[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},i=t.length-1;i>=0;i--)a()}(e,o,(function(e){return r.tidy(e)}),eN);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=ye(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return YS(mC(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;YS(r.every((function(e){return e instanceof DE})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));return t.runKernelFunc({forwardFunc:function(t,n){return YS((i=e.apply(void 0,[].concat(r,[n]))).value instanceof DE,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),YS(mC(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},backwardsFunc:function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];YS(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),YS(a.every((function(e){return e instanceof DE})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o},inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=mE(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=mE()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new XE,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function QE(){var e=DC();if(null==e._tfengine){var t=new EC(e);e._tfengine=new YE(t)}return function(e){OC=e}(e._tfengine.ENV),function(e){AE=e}((function(){return e._tfengine})),e._tfengine}YE.nextTensorId=0,YE.nextVariableId=0;var $E,JE=QE();function eN(e,t){var n={a:e,b:t};return JE.runKernel(zC,n)}function tN(e){if(void 0!==$E)return $E;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function nN(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var rN=RC();function aN(e,t){var n=e;if(yE(e))return"string"===t?[]:[e.length];if(jE(e)){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if(GE(e))return[e.buffer.size/(null==t?4:dC(t))];if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||yE(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&RC().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&iN(e,a,[]),a}function iN(e,t,n){if(n=n||[],Array.isArray(e)||yE(e)){YS(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),YS(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)iN(e[a],r,n.concat(a))}else YS(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function oN(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function sN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof DE)return oN(r,e.dtype,t,n),e;var a=pC(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),oN(r,a,t,n),null==e||!yE(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=aN(e,a);yE(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?pE(e,a):bE(e,[],!0);return JE.makeTensor(s,o,a)}function uN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((function(e,a){return sN(e,"".concat(t,"[").concat(a,"]"),n,r)}))}rN.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),rN.registerFlag("IS_BROWSER",(function(){return nN()})),rN.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),rN.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),rN.registerFlag("IS_SAFARI",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)})),rN.registerFlag("PROD",(function(){return!1})),rN.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return rN.getBool("DEBUG")})),rN.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),rN.registerFlag("IS_TEST",(function(){return!1})),rN.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return rN.getBool("DEBUG")})),rN.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),rN.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),rN.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var cN="__op";function lN(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=cN;var a=function(){JE.startScope(n);try{var e=r.apply(void 0,arguments);return TC(e)&&console.error("Cannot return a Promise inside of tidy."),JE.endScope(e),e}catch(t){throw JE.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var hN=lN({complex_:function(e,t){var n=sN(e,"real","complex"),r=sN(t,"imag","complex");QS(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return JE.runKernel(sI,a)}});function dN(e,t,n,r){if(null==r)r=pC(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(GE(e)||jE(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return JE.backend.createTensorFromGPUData(e,t||n,r)}if(!yE(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){SC(t);var a=JS(t),i=JS(n);YS(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==JS(t.slice(o));YS(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return yE(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?pE(e,r):bE(e,[],!0),JE.makeTensor(e,t,r)}function fN(e,t,n){return dN(e,t,aN(e,n),n)}var pN={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},mN=function(){function e(t){if(Se(this,e),this.shards=[],this.previousShardIndex=0,null!=t&&(t instanceof Array||(t=[t]),0!==(t=t.map((function(e){return yE(e)?e.buffer:e}))).length)){this.bufferUniformSize=t[0].byteLength;for(var n=0,r=0;r<t.length;r++){var a=t[r];r!==t.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);var i=n+a.byteLength;this.shards.push({buffer:a,start:n,end:i}),n=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}return Te(e,[{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e)return new ArrayBuffer(0);var n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));for(var r=new ArrayBuffer(t-e),a=new Uint8Array(r),i=0,o=n;o<this.shards.length;o++){var s=this.shards[o],u=e+i-s.start,c=i,l=Math.min(t,s.end)-s.start,h=new Uint8Array(s.buffer,u,l-u);if(a.set(h,c),i+=h.length,t<s.end)break}return r}},{key:"findShardForByte",value:function(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;var n=function(e,t){var n=0,r=e.length;for(;n<=r;){var a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}],[{key:"join",value:function(t){return new e(t).slice()}}]),e}();var vN=4;function gN(e,t){return yN.apply(this,arguments)}function yN(){return yN=N(T().mark((function e(t,n){var r,a,i,o,s,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=T().mark((function e(){var o,u,c,l;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i[s],"float32"===(u=Array.isArray(t)?t[s].tensor:t[o]).dtype||"int32"===u.dtype||"bool"===u.dtype||"string"===u.dtype||"complex64"===u.dtype){e.next=4;break}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(u.dtype));case 4:c={name:o,shape:u.shape,dtype:u.dtype},"string"===u.dtype?(l=new Promise(function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,c;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+vN*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)s=n[o],c=new Uint8Array(new Uint32Array([s.length]).buffer),a.set(c,i),i+=vN,a.set(s,i),i+=s.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.push(l)):a.push(u.data()),null!=n&&(c.group=n),r.push(c);case 8:case"end":return e.stop()}}),e)})),s=0;case 5:if(!(s<i.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:++s,e.next=5;break;case 10:return e.next=12,Promise.all(a);case 12:return u=e.sent,e.abrupt("return",{data:xN(u),specs:r});case 14:case"end":return e.stop()}}),e)}))),yN.apply(this,arguments)}function bN(e,t){var n,r,a=new mN(e),i={},o=0,s=ye(t);try{for(s.s();!(r=s.n()).done;){var u=r.value,c=u.name,l=u.dtype,h=u.shape,d=JS(h),f=void 0;if("quantization"in u){var p=u.quantization;if("uint8"===p.dtype||"uint16"===p.dtype){if(!("min"in p)||!("scale"in p))throw new Error("Weight ".concat(u.name," with quantization ").concat(p.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==p.dtype)throw new Error("Weight ".concat(u.name," has unknown ")+"quantization dtype ".concat(p.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==l)throw new Error("Weight ".concat(u.name," is quantized with ").concat(p.dtype," ")+"which only supports weights of type float32 not ".concat(l,"."))}var m=pN[p.dtype],v=a.slice(o,o+d*m),g="uint8"===p.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===l)if("uint8"===p.dtype||"uint16"===p.dtype){f=new Float32Array(g.length);for(var y=0;y<g.length;y++){var b=g[y];f[y]=b*p.scale+p.min}}else{if("float16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type float32.");void 0===n&&(n=DN()),f=n(g)}else{if("int32"!==l)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(l));if("uint8"!==p.dtype&&"uint16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type int32.");f=new Int32Array(g.length);for(var x=0;x<g.length;x++){var w=g[x];f[x]=Math.round(w*p.scale+p.min)}}o+=d*m}else if("string"===l){var k=JS(u.shape);f=[];for(var S=0;S<k;S++){var C=new Uint32Array(a.slice(o,o+vN))[0];o+=vN;var I=new Uint8Array(a.slice(o,o+C));f.push(I),o+=C}}else{var T=pN[l],_=a.slice(o,o+d*T);if("float32"===l)f=new Float32Array(_);else if("int32"===l)f=new Int32Array(_);else if("bool"===l)f=new Uint8Array(_);else{if("complex64"!==l)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(l));f=new Float32Array(_);for(var E=new Float32Array(f.length/2),N=new Float32Array(f.length/2),R=0;R<E.length;R++)E[R]=f[2*R],N[R]=f[2*R+1];var A=fN(E,h,"float32"),O=fN(N,h,"float32");i[c]=hN(A,O),A.dispose(),O.dispose()}o+=d*T}"complex64"!==l&&(i[c]=fN(f,h,l))}}catch(D){s.e(D)}finally{s.f()}return i}function xN(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var wN="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function kN(e){return wN?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function SN(e){if(wN)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function CN(e){if(wN){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function IN(e){return mN.join(e)}function TN(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function _N(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function EN(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function NN(e,t){return RN.apply(this,arguments)}function RN(){return RN=N(T().mark((function e(t,n){var r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:i=e.sent,o=(0,U.Z)(i,2),r=o[0],a=o[1];case 7:return e.abrupt("return",EN(t,r,a));case 8:case"end":return e.stop()}}),e)}))),RN.apply(this,arguments)}function AN(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:kN(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:kN(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new mN(e.weightData).byteLength}}function ON(e){var t,n=[],r=ye(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push.apply(n,(0,ke.Z)(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function DN(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var PN=function(){function e(){Se(this,e),this.saveRouters=[],this.loadRouters=[]}return Te(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),MN=function(e){return PN.registerSaveRouter(e)},LN=function(e){return PN.registerLoadRouter(e)},FN=function(e){return PN.getSaveHandlers(e)},zN=function(e,t){return PN.getLoadHandlers(e,t)},BN="tensorflowjs",VN="models_store",UN="model_info_store";function WN(){if(!RC().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function jN(e){var t=e.result;t.createObjectStore(VN,{keyPath:"modelPath"}),t.createObjectStore(UN,{keyPath:"modelPath"})}var GN=function(){function e(t){if(Se(this,e),this.indexedDB=WN(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return Te(e,[{key:"save",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(BN,1);a.onupgradeneeded=function(){return jN(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(VN,"readonly"),s=o.objectStore(VN).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{t.weightData=mN.join(t.weightData);var u,c,l=AN(t),h=i.transaction(UN,"readwrite"),d=h.objectStore(UN);try{u=d.put({modelPath:n.modelPath,modelArtifactsInfo:l})}catch(f){return r(f)}u.onsuccess=function(){var a,o=(c=i.transaction(VN,"readwrite")).objectStore(VN);try{a=o.put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l})}catch(f){return r(f)}a.onsuccess=function(){return e({modelArtifactsInfo:l})},a.onerror=function(e){var t=(d=h.objectStore(UN)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},u.onerror=function(e){return i.close(),r(u.error)},h.oncomplete=function(){null==c?i.close():c.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();GN.URL_SCHEME="indexeddb://";var HN=function(e){return RC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(GN.URL_SCHEME)?(t=e.slice(GN.URL_SCHEME.length),new GN(t)):null;var t};function KN(e){return e.startsWith(GN.URL_SCHEME)?e.slice(GN.URL_SCHEME.length):e}PN.registerSaveRouter(HN),PN.registerLoadRouter(HN);var qN=function(){function e(){Se(this,e),this.indexedDB=WN()}return Te(e,[{key:"listModels",value:function(){var e=N(T().mark((function e(){var t=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(BN,1);r.onupgradeneeded=function(){return jN(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(UN,"readonly"),i=a.objectStore(UN).getAll();i.onsuccess=function(){var t,n={},r=ye(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=N(T().mark((function e(t){var n=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=KN(t),e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(BN,1);a.onupgradeneeded=function(){return jN(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(UN,"readwrite"),s=o.objectStore(UN),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(VN,"readwrite")).objectStore(VN).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ZN="/",XN="tensorflowjs_models",YN="info",QN="model_topology",$N="weight_specs",JN="weight_data",eR="model_metadata";function tR(e){return{info:[XN,e,YN].join(ZN),topology:[XN,e,QN].join(ZN),weightSpecs:[XN,e,$N].join(ZN),weightData:[XN,e,JN].join(ZN),modelMetadata:[XN,e,eR].join(ZN)}}function nR(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function rR(e){var t=e.split(ZN);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(ZN)}function aR(e){return e.startsWith(iR.URL_SCHEME)?e.slice(iR.URL_SCHEME.length):e}var iR=function(){function e(t){if(Se(this,e),!RC().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=tR(this.modelPath)}return Te(e,[{key:"save",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=AN(t),i=mN.join(t.weightData),e.prev=8,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,SN(i)),o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),e.abrupt("return",{modelArtifactsInfo:a});case 18:throw e.prev=18,e.t0=e.catch(8),nR(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 22:case"end":return e.stop()}}),e,this,[[8,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=CN(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();iR.URL_SCHEME="localstorage://";var oR=function(e){return RC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(iR.URL_SCHEME)?(t=e.slice(iR.URL_SCHEME.length),new iR(t)):null;var t};PN.registerSaveRouter(oR),PN.registerLoadRouter(oR);var sR=function(){function e(){Se(this,e),YS(RC().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),YS("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return Te(e,[{key:"listModels",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=XN+ZN,r=ZN+YN,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=rR(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=aR(t),n=tR(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),nR(n),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),uR="://",cR=function(){function e(){Se(this,e),this.managers={}}return Te(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){YS(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(uR)&&(t=t.slice(0,t.indexOf(uR))),YS(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();YS(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function lR(e){if(-1===e.indexOf(uR))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(cR.getSchemes().join(",")));return{scheme:e.split(uR)[0],path:e.split(uR)[1]}}function hR(e,t){return dR.apply(this,arguments)}function dR(){return dR=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>2&&void 0!==f[2]&&f[2],YS(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),YS((a=PN.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),YS(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],YS((o=PN.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),YS(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=lR(t).scheme,c=lR(t).path,l=u===lR(t).scheme,e.next=15,i.load();case 15:if(h=e.sent,!r||!l){e.next=19;break}return e.next=19,cR.getManager(u).removeModel(c);case 19:return e.next=21,s.save(h);case 21:if(d=e.sent,!r||l){e.next=25;break}return e.next=25,cR.getManager(u).removeModel(c);case 25:return e.abrupt("return",d.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),dR.apply(this,arguments)}function fR(){return pR.apply(this,arguments)}function pR(){return(pR=N(T().mark((function e(){var t,n,r,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=cR.getSchemes(),n={},r=ye(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,cR.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+uR+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function mR(e){return vR.apply(this,arguments)}function vR(){return(vR=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=lR(t),r=cR.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gR(e,t){return yR.apply(this,arguments)}function yR(){return(yR=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",hR(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bR(e,t){return xR.apply(this,arguments)}function xR(){return(xR=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",hR(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wR=function(){function e(){Se(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return Te(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&RC().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return $_(e)}}]),e}();if(RC().get("IS_BROWSER")){RC().setPlatform("browser",new wR);try{cR.registerManager(iR.URL_SCHEME,new sR)}catch(N8){}try{cR.registerManager(GN.URL_SCHEME,new qN)}catch(N8){}}var kR,SR=function(){return n(5410)};var CR=function(){function e(){Se(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return Te(e,[{key:"fetch",value:function(e,t){return null!=RC().global.fetch?RC().global.fetch(e,t):(null==kR&&(kR=SR()),kR(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();function IR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",SC(e),new RE(e,t,n)}RC().get("IS_NODE")&&!RC().get("IS_BROWSER")&&RC().setPlatform("node",new CR);var TR=lN({cast_:function(e,t){var n=sN(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return JE.runKernel(aI,r,a)}});var _R=lN({clone_:function(e){var t={x:sN(e,"x","clone","string_or_numeric")};return JE.runKernel(ZI,t)}});function ER(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}function NR(){return JE}function RR(e,t){return JE.tidy(e,t)}function AR(e){KE(e).forEach((function(e){return e.dispose()}))}function OR(e){return JE.keep(e)}function DR(){return JE.backendName}function PR(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return JE.registerBackend(e,t,n)}function MR(){return JE.backend}QE(),OE={buffer:IR,cast:TR,clone:_R,print:ER},function(e){e}((function(e){RC().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}));var LR=lN({add_:function(e,t){var n=sN(e,"a","add"),r=sN(t,"b","add"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(zC,o)}});var FR=lN({floorDiv_:function(e,t){var n=sN(e,"a","floorDiv"),r=sN(t,"b","floorDiv"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(WI,o)}});var zR=lN({div_:function(e,t){var n=sN(e,"a","div"),r=sN(t,"b","div"),a=HE(n,r),i=(0,U.Z)(a,2);if(n=i[0],r=i[1],"int32"===n.dtype&&"int32"===r.dtype)return FR(n,r);var o={a:n,b:r};return JE.runKernel(NI,o,{})}});var BR=lN({mul_:function(e,t){var n=sN(e,"a","mul"),r=sN(t,"b","mul"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(CT,o)}});var VR=lN({sqrt_:function(e){var t={x:sN(e,"x","sqrt","float32")};return JE.runKernel(l_,t)}});var UR=lN({square_:function(e){var t=sN(e,"x","square");return JE.runKernel("Square",{x:t},{})}});var WR=lN({zerosLike_:function(e){var t={x:sN(e,"x","zerosLike")};return JE.runKernel(F_,t)}});function jR(e){return JE.customGrad(e)}function GR(e,t){if((yE(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&yE(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return dN(e,[],[],t)}var HR=new Map,KR=new Map,qR=function(){function e(){Se(this,e)}return Te(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),ZR=function(){function e(){Se(this,e),this.classNameMap={}}return Te(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function XR(e,t,n){YS(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),YS("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),YS(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);var r=t+">"+n;return ZR.register(e),HR.set(r,e),KR.set(e,r),e}var YR=function(e){be(n,e);var t=we(n);function n(){return Se(this,n),t.apply(this,arguments)}return Te(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return AR(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){YS(mC(e),(function(){return"The f passed in variableGrads(f) must be a function"})),YS(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof BE})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],JE.registeredVariables)t.push(JE.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),YS(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=JE.gradients(e,t,null,!0),s=o.value,u=o.grads;YS(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),YS(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&AR(this.iterations_)}},{key:"saveIterations",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:GR(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(qR);Object.defineProperty(YR,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var QR=function(e){be(n,e);var t=we(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Se(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=JE.backend.epsilon()),a}return Te(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=JE.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:RR((function(){return WR(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:RR((function(){return WR(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;RR((function(){var e=LR(BR(o,t.rho),BR(UR(i),1-t.rho)),n=BR(zR(VR(LR(s,t.epsilon)),VR(LR(o,t.epsilon))),i),r=LR(BR(s,t.rho),BR(UR(n),1-t.rho));o.assign(e),s.assign(r);var u=LR(BR(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(AR(this.accumulatedGrads.map((function(e){return e.variable}))),AR(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,ke.Z)(this.accumulatedGrads),(0,ke.Z)(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(YR);function $R(e,t,n){SC(e);var r={shape:e,value:t,dtype:n=n||pC(t)};return JE.runKernel(BI,{},r)}var JR=function(e){be(n,e);var t=we(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Se(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return Te(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=JE.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:RR((function(){return $R(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;RR((function(){var e=LR(o,UR(i));o.assign(e);var n=LR(BR(zR(i,VR(LR(e,JE.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&AR(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(YR);var eA=lN({pow_:function(e,t){var n=sN(e,"base","pow"),r=sN(t,"exp","pow"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(PT,o)}});var tA=lN({sub_:function(e,t){var n=sN(e,"a","sub"),r=sN(t,"b","sub"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(__,o)}}),nA=function(e){be(n,e);var t=we(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Se(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],RR((function(){i.accBeta1=GR(r).variable(),i.accBeta2=GR(a).variable()})),null==o&&(i.epsilon=JE.backend.epsilon()),i}return Te(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);RR((function(){var r=tA(1,t.accBeta1),a=tA(1,t.accBeta2);n.forEach((function(n,i){var o=JE.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:RR((function(){return WR(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:RR((function(){return WR(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=LR(BR(u,t.beta1),BR(s,1-t.beta1)),h=LR(BR(c,t.beta2),BR(UR(s),1-t.beta2)),d=zR(l,r),f=zR(h,a);u.assign(l),c.assign(h);var p=LR(BR(zR(d,LR(VR(f),t.epsilon)),-t.learningRate),o);o.assign(p)}})),t.accBeta1.assign(BR(t.accBeta1,t.beta1)),t.accBeta2.assign(BR(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&AR(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&AR(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,ke.Z)(this.accumulatedFirstMoment),(0,ke.Z)(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){var n,r=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,RR((function(){r.accBeta1.assign(eA(r.beta1,r.iterations_+1)),r.accBeta2.assign(eA(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(YR);var rA=lN({abs_:function(e){var t=sN(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return JE.runKernel(uI,n)}var r={x:t};return JE.runKernel(MC,r)}});function aA(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function iA(e,t){for(var n=Math.max(e.length,t.length),r=new Array(n),a=0;a<n;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)r[n-a-1]=o;else if(1===o)r[n-a-1]=i;else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}r[n-a-1]=i}}return r}var oA=lN({maximum_:function(e,t){var n=sN(e,"a","maximum"),r=sN(t,"b","maximum"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],"bool"===n.dtype&&(n=TR(n,"int32"),r=TR(r,"int32")),iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(dT,o)}}),sA=function(e){be(n,e);var t=we(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Se(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],RR((function(){i.iteration=GR(0).variable(),i.accBeta1=GR(r).variable()})),null==o&&(i.epsilon=JE.backend.epsilon()),i}return Te(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);RR((function(){var r=tA(1,t.accBeta1),a=zR(-t.learningRate,LR(BR(t.iteration,t.decay),1));n.forEach((function(n,i){var o=JE.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:WR(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:WR(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=LR(BR(u,t.beta1),BR(s,1-t.beta1)),h=BR(c,t.beta2),d=rA(s),f=oA(h,d);u.assign(l),c.assign(f);var p=LR(BR(zR(a,r),zR(l,LR(f,t.epsilon))),o);o.assign(p)}})),t.iteration.assign(LR(t.iteration,1)),t.accBeta1.assign(BR(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&AR(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&AR(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(YR),uA=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return Te(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);n.forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=JE.registeredVariables[n];RR((function(){var e=LR(BR(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=OR(GR(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(YR),cA=function(e){be(n,e);var t=we(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Se(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=GR(a.momentum),a}return Te(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=JE.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:RR((function(){return WR(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&RR((function(){var e,n=LR(BR(t.m,i),o);e=t.useNesterov?LR(BR(t.c,LR(o,BR(n,t.m))),a):LR(BR(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&AR(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(uA),lA=function(e){be(n,e);var t=we(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Se(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=JE.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return Te(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=JE.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:RR((function(){return WR(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:RR((function(){return WR(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:RR((function(){return WR(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;RR((function(){var e=LR(BR(s,t.decay),BR(UR(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=LR(BR(n,t.decay),BR(o,1-t.decay)),c=zR(BR(o,t.learningRate),VR(tA(e,LR(UR(i),t.epsilon)))),l=LR(BR(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var h=tA(a,l);a.assign(h)}else{var d=LR(BR(s,t.decay),BR(UR(o),1-t.decay)),f=LR(BR(u,t.momentum),zR(BR(o,t.learningRate),VR(LR(d,t.epsilon))));s.assign(d),u.assign(f);var p=tA(a,f);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&AR(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&AR(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&AR(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=N(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,ke.Z)(this.accumulatedMeanSquares),(0,ke.Z)(this.accumulatedMoments)),this.centered&&t.push.apply(t,(0,ke.Z)(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=N(T().mark((function e(t){var n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(YR),hA=[QR,JR,nA,sA,cA,lA,uA];function dA(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var fA=function(){function e(t){if(Se(this,e),!RC().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return Te(e,[{key:"save",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=mN.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=8;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 8:return a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=_N(t,a),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(s=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,s.href=o,e.next=16,dA((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 16:if(null==t.weightData){e.next=22;break}return(u=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=r,e.next=22,dA((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 22:return e.abrupt("return",{modelArtifactsInfo:AN(t)});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();fA.URL_SCHEME="downloads://";var pA=function(){function e(t){if(Se(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return Te(e,[{key:"load",value:function(){var e=N(T().mark((function e(){var t=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=NN(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=ye(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,(0,ke.Z)(o.weights)),a.push.apply(a,(0,ke.Z)(o.paths))}}catch(N8){i.e(N8)}finally{i.f()}var s=this.checkManifestAndWeightFiles(e),u=a.map((function(e){return n.loadWeightsFile(e,s[e])}));return Promise.all(u).then((function(e){return[r,e]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return TN(e.name)})),i={},o=ye(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=TN(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(N8){o.e(N8)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function mA(e){return new pA(e)}function vA(e,t,n,r){!function(e){YS(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){YS(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),YS(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),YS(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function gA(e,t){return yA.apply(this,arguments)}function yA(){return(yA=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?RC().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,vA(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,vA(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return h=e.t1,e.abrupt("return",h);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bA(e){return xA.apply(this,arguments)}function xA(){return xA=N(T().mark((function e(t){var n,r,a,i,o=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=wA((function(e){return gA(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),xA.apply(this,arguments)}function wA(e){return function(){var t=N(T().mark((function t(n){var r,a,i,o,s,u,c,l,h,d,f,p,m=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:"",a=m.length>2?m[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=pN[r]*JS(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=15,e(h);case 15:return d=t.sent,f={},p=0,l.forEach((function(e){var t=n[e].paths.length,r=new mN(d.slice(p,p+t));o[e].forEach((function(e){var t=bN(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)f[n]=t[n]})),p+=t})),t.abrupt("return",f);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}PN.registerSaveRouter((function(e){return RC().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(fA.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new fA(e)}(e.slice(fA.URL_SCHEME.length)):null}));var kA=function(){function e(t,n){if(Se(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(YS("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=RC().platform.fetch,YS(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&YS(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return Te(e,[{key:"save",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=_N(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&(i=mN.join(t.weightData),n.body.append("model.weights.bin",new Blob([i],{type:"application/octet-stream"}),"model.weights.bin")),e.next=10,this.fetch(this.path,n);case 10:if(!(o=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:AN(t),responses:[o]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i,o=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",NN(n,(function(e){return o.loadWeights(e)})));case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,d,f,p,m,v,g;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=SA(n),a=(0,U.Z)(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=ON(t),c=[],l=[],h=ye(t);try{for(h.s();!(d=h.n()).done;){f=d.value,p=ye(f.paths);try{for(p.s();!(m=p.n()).done;)v=m.value,null!=this.weightUrlConverter?l.push(this.weightUrlConverter(v)):c.push(s+v+o)}catch(N8){p.e(N8)}finally{p.f()}}}catch(N8){h.e(N8)}finally{h.f()}if(!this.weightUrlConverter){e.next=17;break}return e.t0=c.push,e.t1=c,e.t2=ke.Z,e.next=14,Promise.all(l);case 14:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 17:return e.next=19,gA(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return g=e.sent,e.abrupt("return",[u,g]);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function SA(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function CA(e){return null!=e.match(kA.URL_SCHEME_REGEX)}kA.URL_SCHEME_REGEX=/^https?:\/\//;var IA=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return CA(e)})):CA(e))?TA(e,t):null};function TA(e,t){return new kA(e,t)}function _A(e,t){return TA(e,t)}PN.registerSaveRouter(IA),PN.registerLoadRouter(IA);var EA,NA=function(){function e(t){Se(this,e),this.modelArtifacts=t}return Te(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),RA=function(){function e(t){Se(this,e),this.saveHandler=t}return Te(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),AA=Te((function e(t){Se(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function OA(e,t,n,r){var a=arguments;return new AA(DA.apply(void 0,(0,ke.Z)(a)))}function DA(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new NA(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new NA({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new NA({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function PA(e){return new RA(e)}function MA(e){return new RA(e)}function LA(e,t,n){if($S(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=aN(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return dN(e,t,r,n)}var FA=!1;function zA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(null!=q_(B_,JE.backendName)){var u={pixels:e},c={numChannels:t};return JE.runKernel(B_,u,c)}var l,h,d=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],f=(0,U.Z)(d,2),p=f[0],m=f[1];if(o)l=e.getContext("2d").getImageData(0,0,p,m).data;else if(r||n)l=e.data;else if(i||a||s){if(null==EA)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");EA=new OffscreenCanvas(1,1).getContext("2d")}else EA=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});EA.canvas.width=p,EA.canvas.height=m,EA.drawImage(e,0,0,p,m),l=EA.getImageData(0,0,p,m).data}if(4===t)h=new Int32Array(l);else{var v=p*m;h=new Int32Array(v*t);for(var g=0;g<v;g++)for(var y=0;y<t;++y)h[g*t+y]=l[4*g+y]}return LA(h,[m,p,t],"int32")}function BA(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));var t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,".")+" Please use float32 or int32 tensors.")}function VA(e,t){return UA.apply(this,arguments)}function UA(){return UA=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=sN(t,"img","toPixels"),t instanceof DE||(r=TR(a=r,"int32"),a.dispose()),BA(r),i=r.shape.slice(0,2),o=(0,U.Z)(i,2),s=o[0],u=o[1],c=2===r.rank?1:r.shape[2],e.next=7,r.data();case 7:l=e.sent,h="float32"===r.dtype?255:1,d=new Uint8ClampedArray(u*s*4),f=0;case 11:if(!(f<s*u)){e.next=36;break}p=[0,0,0,255],m=0;case 14:if(!(m<c)){e.next=28;break}if(v=l[f*c+m],"float32"!==r.dtype){e.next=21;break}if(!(v<0||v>1)){e.next=19;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(v,"."));case 19:e.next=24;break;case 21:if("int32"!==r.dtype){e.next=24;break}if(!(v<0||v>255)){e.next=24;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(v,"."));case 24:1===c?(p[0]=v*h,p[1]=v*h,p[2]=v*h):p[m]=v*h;case 25:m++,e.next=14;break;case 28:d[(g=4*f)+0]=Math.round(p[0]),d[g+1]=Math.round(p[1]),d[g+2]=Math.round(p[2]),d[g+3]=Math.round(p[3]);case 33:++f,e.next=11;break;case 36:return null!=n&&(FA||null!=q_(EI,JE.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),FA=!0),n.width=u,n.height=s,y=n.getContext("2d"),b=new ImageData(d,u,s),y.putImageData(b,0,0)),r!==t&&r.dispose(),e.abrupt("return",d);case 39:case"end":return e.stop()}}),e)}))),UA.apply(this,arguments)}var WA=lN({fromPixels_:zA}),jA=-2,GA=-1;function HA(e,t,n){var r=e.shape.length;YS(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),YS(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){YS(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function KA(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function qA(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function ZA(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function XA(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat((0,ke.Z)(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){YS(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat((0,ke.Z)(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(YS(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function YA(e,t,n,r,a,i,o,s,u){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},d=0;d<h.dims;d++)l&&0!==(1<<d&s)&&h.numAddAxisAfterEllipsis++,1<<d&o&&(l=!0);l||(h.ellipsisMask|=1<<h.dims,h.dims++);var f={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(jA),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(GA),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(h,f);for(var p=!0,m=!0,v=!0,g=[],y=[],b=0;b<e.length;++b){if(0===f.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var x=!!(f.shrinkAxisMask&1<<b),w=e[b];if(-1!==w){var k=[f.beginMask&1<<b,f.endMask&1<<b],S=[f.strides[b]>0?0:-1,f.strides[b]>0?w:w-1];if(x&&f.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&1===f.strides[b];var C=!!(f.beginMask&1<<b&&f.endMask&1<<b);if(f.beginValid&&f.endValid){if(x){var I=f.begin[b]<0?w+f.begin[b]:f.begin[b];if(f.begin[b]=I,f.end[b]=f.begin[b]+1,I<0||I>=w)throw Error("slice index ".concat(f.begin[b]," of dimension ").concat(b," out of bounds."))}else f.begin[b]=QA(f.begin[b],0,f.strides[b],w,k,S),f.end[b]=QA(f.end[b],1,f.strides[b],w,k,S);var T=1===f.strides[b]&&0===f.begin[b]&&f.end[b]===w;p=p&&T,m=m&&(0===b&&1===f.strides[b]||T)}else p=p&&1===f.strides[b]&&C,m=m&&(0===b&&1===f.strides[b]||C);var _=void 0,E=!1;if(f.beginValid&&f.endValid?(_=f.end[b]-f.begin[b],E=!0):x?(_=1,E=!0):C&&w>=0&&(_=f.strides[b]<0?-w:w,E=!0),E){var N=void 0;N=0===_||_<0!==f.strides[b]<0?0:Math.trunc(_/f.strides[b])+(_%f.strides[b]!==0?1:0),g.push(N)}else g.push(-1)}else g.push(x?1:-1)}for(var R=0;R<f.finalShapeGatherIndices.length;++R){var A=f.finalShapeGatherIndices[R];A>=0?y.push(g[A]):A===jA&&y.push(1)}var O=y.filter((function(e,t){return f.finalShapeGatherIndices[t]!==jA}));return{finalShapeSparse:O,finalShape:y,isIdentity:p,sliceDim0:m,isSimpleSlice:v,begin:f.begin,end:f.end,strides:f.strides}}function QA(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}var $A=lN({acos_:function(e){var t={x:sN(e,"x","acos")};return JE.runKernel(LC,t)}});var JA=lN({acosh_:function(e){var t={x:sN(e,"x","acosh")};return JE.runKernel(FC,t)}});var eO=lN({addN_:function(e){YS(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),YS(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return sN(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!tC(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return JE.runKernel(BC,r)}});var tO=lN({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:sN(e,"x","all","bool")},a={axis:t,keepDims:n};return JE.runKernel(VC,r,a)}});var nO=lN({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:sN(e,"x","any","bool")},a={axis:t,keepDims:n};return JE.runKernel(UC,r,a)}});var rO=lN({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:sN(e,"x","argMax")},r={axis:t};return JE.runKernel(WC,n,r)}});var aO=lN({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:sN(e,"x","argMin")},r={axis:t};return JE.runKernel(jC,n,r)}});var iO=lN({asin_:function(e){var t={x:sN(e,"x","asin")};return JE.runKernel(GC,t)}});var oO=lN({asinh_:function(e){var t={x:sN(e,"x","asinh")};return JE.runKernel(HC,t)}});var sO=lN({atan_:function(e){var t={x:sN(e,"x","atan")};return JE.runKernel(KC,t)}});var uO=lN({atan2_:function(e,t){var n=sN(e,"a","atan2"),r=sN(t,"b","atan2"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(ZC,o)}});var cO=lN({atanh_:function(e){var t={x:sN(e,"x","atanh")};return JE.runKernel(qC,t)}});function lO(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3];return fO(e,[].concat((0,ke.Z)(t),[o]),n,i,r,null,null,SO(a))}function hO(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=vO(t),c=(0,U.Z)(u,2),l=c[0],h=c[1];if("channelsLast"===s)o=[l,h,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[l,h,e[1],e[1]]}return fO(e,o,n,r,a,i,!1,s)}function dO(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=gO(t),l=(0,U.Z)(c,3),h=l[0],d=l[1],f=l[2];if("NDHWC"===u)s="channelsLast",o=[h,d,f,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,d,f,e[1],e[1]]}return pO(e,o,n,r,a,!1,s,i)}function fO(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,l=-1,h=-1;if("channelsLast"===s){var d=(0,U.Z)(e,4);u=d[0],c=d[1],l=d[2],h=d[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var f=(0,U.Z)(e,4);u=f[0],h=f[1],c=f[2],l=f[3]}var p,m=(0,U.Z)(t,4),v=m[0],g=m[1],y=m[3],b=vO(n),x=(0,U.Z)(b,2),w=x[0],k=x[1],S=vO(r),C=(0,U.Z)(S,2),I=C[0],T=C[1],_=yO(v,I),E=yO(g,T),N=function(e,t,n,r,a,i,o,s,u){var c,l,h;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var d=function(e,t,n,r,a){null==r&&(r=mO(e,t,n));var i=e[0],o=e[1],s=bO((i-t+2*r)/n+1,a),u=bO((o-t+2*r)/n+1,a);return[s,u]}([t,n],i,r,e,s);l=d[0],h=d[1]}else if("same"===e){l=Math.ceil(t/r),h=Math.ceil(n/a);var f=Math.max(0,(l-1)*r+i-t),p=Math.max(0,(h-1)*a+o-n),m=Math.floor(f/2),v=f-m,g=Math.floor(p/2);c={top:m,bottom:v,left:g,right:p-g,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],x="channelsLast"===u?e[2][0]:e[3][0],w="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:x,right:w,type:0===y&&0===b&&0===x&&0===w?"VALID":"EXPLICIT"},l=bO((t-i+y+b)/r+1,s),h=bO((n-o+x+w)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}(a,c,l,w,k,_,E,i,s),R=N.padInfo,A=N.outHeight,O=N.outWidth,D=o?y*h:y;return"channelsFirst"===s?p=[u,D,A,O]:"channelsLast"===s&&(p=[u,A,O,D]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:h,outHeight:A,outWidth:O,outChannels:D,padInfo:R,strideHeight:w,strideWidth:k,filterHeight:v,filterWidth:g,effectiveFilterHeight:_,effectiveFilterWidth:E,dilationHeight:I,dilationWidth:T,inShape:e,outShape:p,filterShape:t}}function pO(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,l=-1,h=-1,d=-1;if("channelsLast"===o){var f=(0,U.Z)(e,5);u=f[0],c=f[1],l=f[2],h=f[3],d=f[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var p=(0,U.Z)(e,5);u=p[0],d=p[1],c=p[2],l=p[3],h=p[4]}var m,v=(0,U.Z)(t,5),g=v[0],y=v[1],b=v[2],x=v[4],w=gO(n),k=(0,U.Z)(w,3),S=k[0],C=k[1],I=k[2],T=gO(r),_=(0,U.Z)(T,3),E=_[0],N=_[1],R=_[2],A=yO(g,E),O=yO(y,N),D=yO(b,R),P=function(e,t,n,r,a,i,o,s,u,c,l){var h,d,f,p;"valid"===e&&(e=0);if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,i){null==a&&(a=mO(e,t[0],r[0]));for(var o=[0,0,0,n],s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=bO((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,u,c],1,[a,i,o],e,l);d=m[0],f=m[1],p=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var v=((d=Math.ceil(t/a))-1)*a+s-t,g=((f=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(v/2),x=v-b,w=Math.floor(g/2),k=g-w,S=Math.floor(y/2);h={top:w,bottom:k,left:S,right:y-S,front:b,back:x,type:"SAME"}}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(a,c,l,h,S,C,I,A,O,D,s),M=P.padInfo,L=P.outDepth,F=P.outHeight,z=P.outWidth,B=i?x*d:x;return"channelsFirst"===o?m=[u,B,L,F,z]:"channelsLast"===o&&(m=[u,L,F,z,B]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:h,inChannels:d,outDepth:L,outHeight:F,outWidth:z,outChannels:B,padInfo:M,strideDepth:S,strideHeight:C,strideWidth:I,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:A,effectiveFilterHeight:O,effectiveFilterWidth:D,dilationDepth:E,dilationHeight:N,dilationWidth:R,inShape:e,outShape:m,filterShape:t}}function mO(e,t,n){var r=yO(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function vO(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function gO(e){return"number"===typeof e?[e,e,e]:e}function yO(e,t){return t<=1?e:e+(e-1)*(t-1)}function bO(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function xO(e){var t=vO(e),n=(0,U.Z)(t,3),r=n[0],a=n[1],i=n[2];return 1===r&&1===a&&1===i}function wO(e,t){return xO(e)||xO(t)}function kO(e){return vO(e).every((function(e){return e>0}))}function SO(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function CO(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)YS(nC(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){YS(nC(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}var IO=lN({reshape_:function(e,t){var n={x:sN(e,"x","reshape","string_or_numeric")},r={shape:t};return JE.runKernel(GT,n,r)}});var TO=lN({avgPool_:function(e,t,n,r,a){var i=sN(e,"x","avgPool","float32");YS(wO(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=IO(i,[1,i.shape[0],i.shape[1],i.shape[2]])),YS(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),CO("avgPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=JE.runKernel(XC,u,c);return l=TR(l,i.dtype),s?IO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var _O=lN({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=sN(e,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=IO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),YS(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),YS("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),YS("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),CO("avgPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=JE.runKernel(QC,c,l);return h=TR(h,s.dtype),u?IO(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var EO=lN({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;YS(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=uN(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return _R(n[0]);var r=n,a={axis:t};return JE.runKernel(cI,r,a)}});var NO=lN({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=sN(e,"a","matMul"),i=sN(t,"b","matMul"),o=HE(a,i),s=(0,U.Z)(o,2),u={a:a=s[0],b:i=s[1]},c={transposeA:n,transposeB:r};return JE.runKernel(JC,u,c)}});var RO=lN({sigmoid_:function(e){var t={x:sN(e,"x","sigmoid","float32")};return JE.runKernel(u_,t)}});var AO=lN({slice_:function(e,t,n){var r=sN(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return JE.runKernel(a_,a,i)}});var OO=lN({tanh_:function(e){var t={x:sN(e,"x","tanh","float32")};return JE.runKernel(N_,t)}});var DO=lN({basicLSTMCell_:function(e,t,n,r,a,i){var o=sN(e,"forgetBias","basicLSTMCell"),s=sN(t,"lstmKernel","basicLSTMCell"),u=sN(n,"lstmBias","basicLSTMCell"),c=sN(r,"data","basicLSTMCell"),l=sN(a,"c","basicLSTMCell"),h=sN(i,"h","basicLSTMCell"),d=EO([c,h],1),f=NO(d,s),p=LR(f,u),m=p.shape[0],v=p.shape[1]/4,g=[m,v],y=AO(p,[0,0],g),b=AO(p,[0,v],g),x=AO(p,[0,2*v],g),w=AO(p,[0,3*v],g),k=LR(BR(RO(y),OO(b)),BR(l,RO(LR(o,x))));return[k,BR(OO(k),RO(w))]}});var PO=lN({batchToSpaceND_:function(e,t,n){var r=sN(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));YS(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),YS(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),YS(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return JE.runKernel(eI,i,o)}});var MO=lN({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=sN(e,"x","batchNorm"),c=sN(t,"mean","batchNorm"),l=sN(n,"variance","batchNorm");null!=a&&(o=sN(a,"scale","batchNorm")),null!=r&&(s=sN(r,"offset","batchNorm")),YS(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),YS(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),YS(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(e){return 0===e.rank||1===e.rank?IO(e,[1,1,1,e.size]):2===e.rank?IO(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?IO(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),d={x:h,scale:o,offset:s,mean:c,variance:l},f={varianceEpsilon:i},p=JE.runKernel(jI,d,f);return IO(p,u.shape)}});var LO=lN({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=sN(e,"x","batchNorm"),c=sN(t,"mean","batchNorm"),l=sN(n,"variance","batchNorm");return null!=a&&(o=sN(a,"scale","batchNorm")),null!=r&&(s=sN(r,"offset","batchNorm")),YS(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),YS(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),YS(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&YS(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&YS(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),MO(u,c,l,s,o,i)}});var FO=lN({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=sN(e,"x","batchNorm"),c=sN(t,"mean","batchNorm"),l=sN(n,"variance","batchNorm");return null!=a&&(o=sN(a,"scale","batchNorm")),null!=r&&(s=sN(r,"offset","batchNorm")),YS(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),YS(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),YS(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&YS(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&YS(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),MO(u,c,l,s,o,i)}});var zO=lN({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=sN(e,"x","batchNorm"),c=sN(t,"mean","batchNorm"),l=sN(n,"variance","batchNorm");return null!=a&&(o=sN(a,"scale","batchNorm")),null!=r&&(s=sN(r,"offset","batchNorm")),YS(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),YS(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),YS(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&YS(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&YS(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),MO(u,c,l,s,o,i)}});var BO=lN({bincount_:function(e,t,n){var r=sN(e,"x","bincount"),a=sN(t,"weights","bincount");YS("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),YS(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),YS(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return JE.runKernel(tI,i,o)}});var VO=lN({bitwiseAnd_:function(e,t){var n=sN(e,"x","bitwiseAnd"),r=sN(t,"y","bitwiseAnd");if(!tC(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));var a={a:n,b:r};return JE.runKernel(nI,a)}});var UO=lN({broadcastArgs_:function(e,t){var n=sN(e,"s0","broadcastArgs","int32"),r=sN(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var a={s0:n,s1:r};return JE.runKernel(rI,a)}});var WO=lN({broadcastTo_:function(e,t){var n=sN(e,"broadcastTo","x"),r=n.shape;if(SC(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=IO(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return _R(n);var u={x:n},c={reps:o};return JE.runKernel(R_,u,c)}});var jO=lN({ceil_:function(e){var t={x:sN(e,"x","ceil","float32")};return JE.runKernel(iI,t)}});var GO=lN({clipByValue_:function(e,t,n){var r=sN(e,"x","clipByValue");if(YS(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return $R(r.shape,t,r.dtype);var a={x:r},i={clipValueMin:t,clipValueMax:n};return JE.runKernel(oI,a,i)}});var HO=lN({concat1d_:function(e){return EO(e,0)}});var KO=lN({concat2d_:function(e,t){return EO(e,t)}});var qO=lN({concat3d_:function(e,t){return EO(e,t)}});var ZO=lN({concat4d_:function(e,t){return EO(e,t)}});var XO=lN({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=sN(e,"x","conv2d","float32"),u=sN(t,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=IO(s,[1,s.shape[0],s.shape[1],s.shape[2]])),YS(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),YS(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),CO("conv2d",r,o);var h="NHWC"===a?c.shape[3]:c.shape[1];YS(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),YS(wO(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),YS(kO(i),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),YS(kO(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var d={x:c,filter:u},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=JE.runKernel(lI,d,f);return l?IO(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var YO=lN({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=sN(e,"x","conv1d"),u=sN(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=IO(s,[1,s.shape[0],s.shape[1]])),YS(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),YS(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),CO("conv1d",r,o),YS(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),YS(wO(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),YS(kO(i),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),YS(kO(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),YS("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=IO(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=IO(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=XO(d,h,[1,n],r,"NHWC",[1,i],o);return IO(f,l?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}});var QO=lN({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;YS(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=IO(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),YS(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),YS(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),YS(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],h="NHWC"===i?u.shape[3]:u.shape[1];YS(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),YS(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),CO("conv2dDerInput",a,o);var d={dy:u,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},p=JE.runKernel(dI,d,f);return c?IO(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var $O=lN({conv2dTranspose_:function(e,t,n,r,a,i){var o=sN(e,"x","conv2dTranspose"),s=sN(t,"filter","conv2dTranspose");return QO(n,o,s,r,a,"NHWC",i)}});var JO=lN({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=sN(e,"x","conv3d"),s=sN(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=IO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),YS(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),YS(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),YS(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),YS(wO(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),YS("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),YS(kO(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),YS(kO(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},d=JE.runKernel(fI,l,h);return c?IO(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var eD=lN({conv3DBackpropInput_:function(e,t,n,r,a){YS(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=IO(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];YS(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),YS(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),YS(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),YS(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),YS(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},d=JE.runKernel(mI,l,h);return s?IO(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var tD=lN({conv3dTranspose_:function(e,t,n,r,a){var i=sN(e,"x","conv3dTranspose"),o=sN(t,"filter","conv3dTranspose");return eD(n,i,o,r,a)}});var nD=lN({cos_:function(e){var t={x:sN(e,"x","cos","float32")};return JE.runKernel(vI,t)}});var rD=lN({cosh_:function(e){var t={x:sN(e,"x","cosh","float32")};return JE.runKernel(gI,t)}});var aD=lN({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:sN(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return JE.runKernel(yI,a,i)}});var iD=lN({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:sN(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return JE.runKernel(bI,a,i)}});var oD=lN({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=sN(e,"x","denseBincount"),i=sN(t,"weights","denseBincount");YS("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),YS(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),YS(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),YS(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},s={size:n,binaryOutput:r};return JE.runKernel(wI,o,s)}});var sD=lN({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=sN(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];YS(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),YS(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),YS(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),YS(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return JE.runKernel(kI,s,u)}});var uD=lN({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=sN(e,"x","depthwiseConv2d","float32"),u=sN(t,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=IO(s,[1,s.shape[0],s.shape[1],s.shape[2]])),YS(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),YS(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var h="NHWC"===a?c.shape[3]:c.shape[1];YS(h===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),CO("depthwiseConv2d",r,o);var d={x:c,filter:u},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=JE.runKernel(SI,d,f);return l?IO(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var cD=lN({diag_:function(e){var t={x:sN(e,"x","diag")};return JE.runKernel(TI,t)}});var lD=lN({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=sN(e,"x","dilation2d"),s=sN(t,"filter","dilation2d");YS(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),YS(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),YS("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,c=!1;3===o.rank&&(u=IO(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),YS(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},h={strides:n,pad:r,dilations:a},d=JE.runKernel(_I,l,h);return c?IO(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var hD=lN({equal_:function(e,t){var n=sN(e,"a","equal","string_or_numeric"),r=sN(t,"b","equal","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(PI,o)}});var dD=lN({where_:function(e,t,n){var r=sN(t,"a","where"),a=sN(n,"b","where"),i=sN(e,"condition","where","bool"),o=iA(iA(i.shape,r.shape),a.shape),s={condition:WO(i,o),t:WO(r,o),e:WO(a,o)};return JE.runKernel(n_,s)}});var fD=lN({divNoNan_:function(e,t){var n=sN(e,"a","div"),r=sN(t,"b","div"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1];var o=zR(n,r),s=WR(o),u=hD(r,s);return dD(u,s,o)}});var pD=lN({dot_:function(e,t){var n=sN(e,"t1","dot"),r=sN(t,"t2","dot");YS((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(YS(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=IO(n,[1,-1]),s=IO(r,[-1,1]),u=NO(o,s);return IO(u,[])}if(1===n.rank&&2===r.rank){var c=IO(n,[1,-1]),l=IO(r,[r.shape[0],r.shape[1]]),h=NO(c,l);return IO(h,[h.size])}if(2===n.rank&&1===r.rank){var d=IO(r,[-1,1]),f=NO(n,d);return IO(f,[f.size])}var p=IO(r,[r.shape[0],r.shape[1]]);return NO(n,p)}});var mD=lN({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map((function(e,t){return sN(e,"tensors".concat(t),"einsum")})),i={equation:e};return JE.runKernel(RI,a,i)}});var vD=lN({elu_:function(e){var t={x:sN(e,"x","elu","float32")};return JE.runKernel(AI,t)}});var gD=lN({ensureShape_:function(e,t){var n=sN(e,"x","ensureShape","string_or_numeric");if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});var yD=lN({erf_:function(e){var t=sN(e,"x","erf");YS("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=TR(t,"float32"));var n={x:t};return JE.runKernel(DI,n)}});function bD(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function xD(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function wD(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function kD(e,t,n){YS(bD(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function SD(e,t){if(bD(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function CD(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function ID(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var TD=lN({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:sN(e,"x","max")},a={reductionIndices:t,keepDims:n};return JE.runKernel(hT,r,a)}});var _D=lN({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:sN(e,"x","min")},a={axis:t,keepDims:n};return JE.runKernel(bT,r,a)}});var ED=lN({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=sN(e,"x","sum");"bool"===r.dtype&&(r=TR(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return JE.runKernel(h_,a,i)}});function ND(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return rA(e);if(1!==e.rank&&null===n)return ND(IO(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return ED(rA(e),n);if(t===1/0)return TD(rA(e),n);if(t===-1/0)return _D(rA(e),n);if("euclidean"===t||2===t)return VR(ED(eA(rA(e),GR(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return TD(ED(rA(e),n[0]),n[1]-1);if(t===1/0)return TD(ED(rA(e),n[1]),n[0]);if(t===-1/0)return _D(ED(rA(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return VR(ED(UR(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var RD=lN({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=ND(e=sN(e,"x","norm"),t,n),i=a.shape;if(r){var o=sC(n,e.shape);i=wD(a.shape,o)}return IO(a,i)}});var AD=lN({euclideanNorm_:function(e){return RD(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});var OD=lN({exp_:function(e){var t={x:sN(e,"x","exp")};return JE.runKernel(MI,t)}});var DD=lN({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=sN(e,"x","expandDims","string_or_numeric");YS(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return JE.runKernel(LI,r,a)}});var PD=lN({expm1_:function(e){var t={x:sN(e,"x","expm1")};return JE.runKernel(FI,t)}});var MD=lN({tile_:function(e,t){var n=sN(e,"x","tile","string_or_numeric");YS(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return JE.runKernel(R_,r,a)}});var LD=lN({eye_:function(e,t,n){null==t&&(t=e);for(var r=IR([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t,i=0;i<a;++i)r.set(1,i,i);var o=IO(r.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return MD(DD(o,0),[n[0],1,1]);if(2===n.length)return MD(DD(DD(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return MD(DD(DD(DD(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var FD=lN({floor_:function(e){var t={x:sN(e,"x","floor","float32")};return JE.runKernel(UI,t)}});var zD=lN({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a={x:sN(e,"x","gather"),indices:sN(t,"indices","gather","int32")},i={axis:n,batchDims:r};return JE.runKernel(GI,a,i)}});var BD=lN({greater_:function(e,t){var n=sN(e,"a","greater","string_or_numeric"),r=sN(t,"b","greater","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(KI,o)}});var VD=lN({greaterEqual_:function(e,t){var n=sN(e,"a","greaterEqual","string_or_numeric"),r=sN(t,"b","greaterEqual","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(qI,o)}});var UD=lN({imag_:function(e){var t={input:sN(e,"input","imag")};return JE.runKernel(YI,t)}});var WD=lN({isFinite_:function(e){var t={x:sN(e,"x","isFinite")};return JE.runKernel(QI,t)}});var jD=lN({isInf_:function(e){var t={x:sN(e,"x","isInf")};return JE.runKernel($I,t)}});var GD=lN({isNaN_:function(e){var t={x:sN(e,"x","isNaN")};return JE.runKernel(JI,t)}});var HD=lN({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:sN(e,"x","leakyRelu")},r={alpha:t};return JE.runKernel(eT,n,r)}});var KD=lN({less_:function(e,t){var n=sN(e,"a","less","string_or_numeric"),r=sN(t,"b","less","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(tT,o)}});var qD=lN({lessEqual_:function(e,t){var n=sN(e,"a","lessEqual","string_or_numeric"),r=sN(t,"b","lessEqual","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(nT,o)}});function ZD(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return JE.runKernel(rT,{},r)}var XD=lN({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=sN(e,"x","localResponseNormalization");YS(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),YS(nC(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=IO(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=JE.runKernel(cT,u,c);return s?IO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var YD=lN({log_:function(e){var t={x:sN(e,"x","log","float32")};return JE.runKernel(aT,t)}});var QD=lN({log1p_:function(e){var t={x:sN(e,"x","log1p")};return JE.runKernel(iT,t)}});var $D=lN({neg_:function(e){var t={x:sN(e,"x","neg")};return JE.runKernel(IT,t)}});var JD=lN({softplus_:function(e){var t={x:sN(e,"x","softplus")};return JE.runKernel(c_,t)}});var eP=lN({logSigmoid_:function(e){var t=sN(e,"x","logSigmoid"),n=jR((function(e){return{value:$D(JD($D(e))),gradFunc:function(t){return BR(t,RO($D(e)))}}}));return n(t)}});var tP=lN({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=sN(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=jR((function(e,n){var r=TD(e,t,!0),a=tA(e,r),i=tA(TR(a,"float32"),YD(ED(OD(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=(0,U.Z)(n,1)[0],a=OD(r);return tA(e,BR(ED(e,t,!0),a))}}}));return r(n)}});var nP=lN({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=sN(e,"x","logSumExp"),a=sC(t,r.shape),i=TD(r,a,!0),o=tA(r,i),s=OD(o),u=ED(s,a),c=YD(u),l=LR(IO(i,c.shape),c);if(n){var h=wD(l.shape,a);return IO(l,h)}return l}});var rP=lN({logicalAnd_:function(e,t){var n=sN(e,"a","logicalAnd","bool"),r=sN(t,"b","logicalAnd","bool");iA(n.shape,r.shape);var a={a:n,b:r};return JE.runKernel(oT,a)}});var aP=lN({logicalNot_:function(e){var t={x:sN(e,"x","logicalNot","bool")};return JE.runKernel(sT,t)}});var iP=lN({logicalOr_:function(e,t){var n=sN(e,"a","logicalOr","bool"),r=sN(t,"b","logicalOr","bool");iA(n.shape,r.shape);var a={a:n,b:r};return JE.runKernel(uT,a)}});var oP=lN({logicalXor_:function(e,t){var n=sN(e,"a","logicalXor","bool"),r=sN(t,"b","logicalXor","bool");return iA(n.shape,r.shape),rP(iP(e,t),aP(rP(e,t)))}}),sP=2147483648;var uP=lN({searchSorted_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",r=sN(e,"sortedSequence","searchSorted"),a=sN(t,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=IO(r,[-1,i]),u=IO(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(JS(u.shape)>=sP)throw new Error("values tensor size must less than ".concat(sP));if(s.shape[1]>=sP)throw new Error("trailing dim_size must less than ".concat(sP," for int32 output type, was ").concat(s.shape[1]));var c={sortedSequence:s,values:u},l={side:n};return JE.runKernel(t_,c,l)}});function cP(e,t){return uP(e,t,"left")}var lP=lN({maxPool_:function(e,t,n,r,a){var i=sN(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=IO(i,[1,i.shape[0],i.shape[1],i.shape[2]])),YS(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),YS(wO(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),CO("maxPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=JE.runKernel(fT,u,c);return s?IO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var hP=lN({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=sN(e,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=IO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),YS(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),YS("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),CO("maxPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=JE.runKernel(mT,c,l);return u?IO(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var dP=lN({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={x:sN(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=JE.runKernel(gT,i,o);return{result:s[0],indexes:s[1]}}});var fP=lN({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:sN(e,"x","mean")},a={axis:t,keepDims:n};return JE.runKernel(yT,r,a)}});function pP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(SC(e),"complex64"===t){var n=pP(e,"float32"),r=pP(e,"float32");return hN(n,r)}var a=kC(JS(e),t);return JE.makeTensor(a,e,t)}function mP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(SC(e),"complex64"===t){var n=mP(e,"float32"),r=pP(e,"float32");return hN(n,r)}var a=wC(JS(e),t);return JE.makeTensor(a,e,t)}function vP(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).indexing,r=void 0===n?"xy":n;if("xy"!==r&&"ij"!==r)throw new TypeError("".concat(r," is not a valid third argument to meshgrid"));if(void 0===e)return[];var a=sN(e,"x","meshgrid",e instanceof DE?e.dtype:"float32");if(void 0===t)return[a];var i=sN(t,"y","meshgrid",t instanceof DE?t.dtype:"float32"),o=JS(a.shape),s=JS(i.shape);return"xy"===r?(a=IO(a,[1,-1]),i=IO(i,[-1,1]),[NO(mP([s,1],a.dtype),a),NO(i,mP([1,o],i.dtype))]):(a=IO(a,[-1,1]),i=IO(i,[1,-1]),[NO(a,mP([1,s],a.dtype)),NO(mP([o,1],i.dtype),i)])}var gP=lN({minimum_:function(e,t){var n=sN(e,"a","minimum"),r=sN(t,"b","minimum"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],"bool"===n.dtype&&(n=TR(n,"int32"),r=TR(r,"int32")),iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(xT,o)}});var yP=lN({mirrorPad_:function(e,t,n){YS("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=sN(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");YS(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){YS(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),YS(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return JE.runKernel(wT,u,s)}});var bP=lN({mod_:function(e,t){var n=sN(e,"a","mod"),r=sN(t,"b","mod"),a=HE(n,r),i=(0,U.Z)(a,2),o={a:n=i[0],b:r=i[1]};return JE.runKernel(kT,o)}});var xP=lN({moments_:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=sC(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=sN(e,"x","moments")).shape),r=fP(e,n,t),a=r.shape;t||(a=wD(r.shape,n));var i=UR(tA(TR(e,"float32"),IO(r,a)));return{mean:r,variance:fP(i,n,t)}}});var wP=lN({multiRNNCell_:function(e,t,n,r){for(var a=sN(t,"data","multiRNNCell"),i=uN(n,"c","multiRNNCell"),o=uN(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}for(var h=[],d=[],f=0;f<u.length;f+=2)h.push(u[f]),d.push(u[f+1]);return[h,d]}});var kP=lN({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=sN(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s={logits:1===o?IO(a,[1,-1]):a},u={numSamples:t,seed:n,normalized:r},c=JE.runKernel(ST,s,u);return 1===o?IO(c,[c.size]):c}});var SP=lN({notEqual_:function(e,t){var n=sN(e,"a","notEqual","string_or_numeric"),r=sN(t,"b","notEqual","string_or_numeric"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(TT,o)}});var CP=lN({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var i={indices:sN(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return JE.runKernel(AT,i,o)}});var IP=lN({onesLike_:function(e){var t={x:sN(e,"x","onesLike")};return JE.runKernel(RT,t)}});var TP=lN({outerProduct_:function(e,t){var n=sN(e,"v1","outerProduct"),r=sN(t,"v2","outerProduct");YS(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=IO(n,[-1,1]),i=IO(r,[1,-1]);return NO(a,i)}});var _P=lN({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=sN(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return JE.runKernel(DT,i,a)}});var EP=lN({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return YS(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),_P(e,[t],n)}});var NP=lN({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return YS(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_P(e,t,n)}});var RP=lN({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return YS(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_P(e,t,n)}});var AP=lN({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return YS(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),_P(e,t,n)}});var OP=lN({spaceToBatchND_:function(e,t,n){var r=sN(e,"x","spaceToBatchND");YS(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),YS(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),YS(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return JE.runKernel(d_,a,i)}});var DP=lN({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var s=sN(e,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=IO(s,[1,s.shape[0],s.shape[1],s.shape[2]])),YS(wO(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var l,h=hO(u.shape,t,i,a,r),d=[h.dilationHeight,h.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})),r=n.map((function(e){return e-1})),a=r.map((function(e){return Math.floor(e/2)})),i=r.map((function(e,t){return e-a[t]}));return r.map((function(e,t){return[a[t],i[t]]}))}([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var f=1===d[0]&&1===d[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([h.inHeight,h.inWidth],d,l),m=(0,U.Z)(p,2),v=m[0],g=m[1],y=f?r:"valid",b=f?u:OP(u,d,v),x=("avg"===n?function(){return TO(b,t,i,y,o)}:function(){return lP(b,t,i,y,o)})(),w=f?x:PO(x,d,g);return c?IO(w,[w.shape[1],w.shape[2],w.shape[3]]):w}});var PP=lN({prelu_:function(e,t){var n={x:sN(e,"x","prelu"),alpha:sN(t,"alpha","prelu")};return JE.runKernel(MT,n)}});var MP=lN({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=sN(e,"x","prod");"bool"===r.dtype&&(r=TR(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return JE.runKernel(LT,a,i)}});var LP=lN({raggedGather_:function(e,t,n,r){var a={paramsNestedSplits:e.map((function(e,t){return sN(e,"tensors".concat(t),"raggedGather","int32")})),paramsDenseValues:sN(t,"paramsDenseValues","raggedGather"),indices:sN(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=JE.runKernel(FT,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});var FP=lN({raggedRange_:function(e,t,n){var r=sN(e,"starts","raggedRange"),a={starts:r,limits:sN(t,"limits","raggedRange",r.dtype),deltas:sN(n,"deltas","raggedRange",r.dtype)},i=JE.runKernel(zT,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});var zP=lN({raggedTensorToTensor_:function(e,t,n,r,a){var i=sN(e,"shape","raggedTensorToTensor","int32"),o=sN(t,"values","raggedTensorToTensor"),s={shape:i,values:o,defaultValue:sN(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(e,t){return sN(e,"tensors".concat(t),"raggedTensorToTensor","int32")}))},u={rowPartitionTypes:a};return JE.runKernel(BT,s,u)}});var BP=lN({rand_:function(e,t,n){SC(e);var r=JS(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return JE.makeTensor(a,e,n)}}),VP=n(6699),UP=function(){function e(t,n,r,a,i){Se(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=VP.alea(o.toString())}return Te(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),WP=function(){function e(t,n,r,a){Se(this,e),this.alpha=t,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=VP.alea(i.toString()),this.randn=new UP(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return Te(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),jP=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(Se(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=VP.alea(i)}return Te(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var GP=lN({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(SC(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new WP(t,n,r,a),o=IR(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var HP=lN({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(SC(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new UP(t,n,r,!1,a),o=IR(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var KP=lN({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return HP(e,0,1,t,n)}});var qP=lN({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;SC(e);for(var i=IR(e,r),o=new jP(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});var ZP=lN({randomUniformInt_:function(e,t,n,r){return qP(e,t,n,"int32",r)}});function XP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return JE.runKernel(VT,{},a)}var YP=lN({real_:function(e){var t={input:sN(e,"input","real")};return JE.runKernel(UT,t)}});var QP=lN({reciprocal_:function(e){var t={x:sN(e,"x","reciprocal")};return JE.runKernel(WT,t)}});var $P=lN({relu_:function(e){var t={x:sN(e,"x","relu")};return JE.runKernel(jT,t)}});var JP=lN({relu6_:function(e){var t={x:sN(e,"x","relu6")};return JE.runKernel(XT,t)}});var eM=lN({reverse_:function(e,t){var n={x:sN(e,"x","reverse")},r={dims:t};return JE.runKernel(YT,n,r)}});var tM=lN({reverse1d_:function(e){var t=sN(e,"x","reverse");return YS(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),eM(t,0)}});var nM=lN({reverse2d_:function(e,t){var n=sN(e,"x","reverse");return YS(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),eM(n,t)}});var rM=lN({reverse3d_:function(e,t){var n=sN(e,"x","reverse");return YS(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),eM(n,t)}});var aM=lN({reverse4d_:function(e,t){var n=sN(e,"x","reverse");return YS(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),eM(n,t)}});var iM=lN({round_:function(e){var t={x:sN(e,"x","round")};return JE.runKernel(QT,t)}});var oM=lN({rsqrt_:function(e){var t={x:sN(e,"x","rsqrt","float32")};return JE.runKernel($T,t)}});var sM=lN({selu_:function(e){var t={x:sN(e,"x","selu")};return JE.runKernel(r_,t)}});var uM=lN({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=sN(e,"x","separableConv2d"),u=sN(t,"depthwiseFilter","separableConv2d"),c=sN(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=IO(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");YS(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),YS(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),YS(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),YS(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),YS(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var d=u.shape[2],f=u.shape[3];YS(c.shape[2]===d*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*f,", ")+"but got ".concat(c.shape[2],".")}));var p=uD(l,u,r,a,o,i),m=XO(p,c,1,"valid",o);return h?IO(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});function cM(){return cM=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=sN(t,"x","setdiff1d"),a=sN(n,"y","setdiff1d"),YS(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),YS(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),YS(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return i=e.sent,e.next=10,a.data();case 10:for(o=e.sent,s=new Set(o),u=0,c=0;c<i.length;c++)s.has(i[c])||u++;for(l=new RE([u],r.dtype),h=new RE([u],"int32"),d=0,f=0;d<i.length;d++)s.has(i[d])||(l.values[f]=i[d],h.values[f]=d,f++);return e.abrupt("return",[l.toTensor(),h.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),cM.apply(this,arguments)}var lM=function(e,t){return cM.apply(this,arguments)};var hM=lN({sign_:function(e){var t={x:sN(e,"x","sign")};return JE.runKernel(s_,t)}});var dM=lN({sin_:function(e){var t={x:sN(e,"x","sin","float32")};return JE.runKernel(i_,t)}});var fM=lN({sinh_:function(e){var t={x:sN(e,"x","sinh")};return JE.runKernel(o_,t)}});var pM=lN({slice1d_:function(e,t,n){var r=sN(e,"x","slice1d");return YS(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),AO(r,[t],[n])}});var mM=lN({slice2d_:function(e,t,n){var r=sN(e,"x","slice2d");return YS(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),AO(r,t,n)}});var vM=lN({slice3d_:function(e,t,n){var r=sN(e,"x","slice3d");return YS(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),AO(r,t,n)}});var gM=lN({slice4d_:function(e,t,n){var r=sN(e,"x","slice4d");return YS(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),AO(r,t,n)}});var yM=lN({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=sN(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return JE.runKernel(p_,r,a)}});var bM=lN({fft_:function(e){YS("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return JE.runKernel(zI,t)}});var xM=lN({ifft_:function(e){YS("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return JE.runKernel(XI,t)}});var wM=lN({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=IO(e,[r,n]);t=xM(a)}else{var i=[r,2*(n-1)],o=IO(YP(e),[r,n]),s=IO(UD(e),[r,n]),u=eM(AO(o,[0,1],[r,n-2]),1),c=BR(eM(AO(s,[0,1],[r,n-2]),1),GR(-1)),l=EO([o,u],1),h=EO([s,c],1),d=IO(hN(l,h),[i[0],i[1]]);t=xM(d)}if(t=YP(t),3===e.rank&&0!==e.shape[0]){var f=t,p=e.shape[0];t=IO(t,[p,t.shape[0]/p,t.shape[1]]),f.dispose()}return t}});var kM=lN({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={x:sN(e,"x","split")},a={numOrSizeSplits:t,axis:n};return JE.runKernel(f_,r,a)}});var SM=lN({rfft_:function(e,t){YS("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=AO(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=EO([e,pP(s)],e.shape.length-1),r=t}else n=e;var u=WR(n),c=IO(hN(n,u),[a,r]),l=bM(c),h=Math.floor(r/2)+1,d=YP(l),f=UD(l),p=kM(d,[h,r-h],d.shape.length-1),m=kM(f,[h,r-h],f.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=h,IO(hN(p[0],m[0]),v)}});var CM=lN({squaredDifference_:function(e,t){var n=sN(e,"a","squaredDifference"),r=sN(t,"b","squaredDifference"),a=HE(n,r),i=(0,U.Z)(a,2);n=i[0],r=i[1],iA(n.shape,r.shape);var o={a:n,b:r};return JE.runKernel(x_,o,{})}});var IM=lN({squeeze_:function(e,t){var n=sN(e,"x","squeeze","string_or_numeric");return IO(n,uC(n.shape,t).newShape)}});var TM=lN({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=uN(e,"tensors","stack","string_or_numeric");YS(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&YS(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return JE.runKernel(OT,r,a)}});var _M=lN({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:sN(e,"x","step")},r={alpha:t};return JE.runKernel(z_,n,r)}});var EM=lN({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c={x:sN(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return JE.runKernel(S_,c,l)}});var NM=lN({tan_:function(e){var t={x:sN(e,"x","tan","float32")};return JE.runKernel(E_,t)}});function RM(e,t){$S(e);var n=aN(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return dN(e,null,n,t)}function AM(e,t,n){if($S(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=aN(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return dN(e,t,r,n)}function OM(e,t,n){if($S(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=aN(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return dN(e,t,r,n)}function DM(e,t,n){if($S(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=aN(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return dN(e,t,r,n)}function PM(e,t,n){if($S(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=aN(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return dN(e,t=t||r,r,n)}function MM(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}(n,t,e)}function LM(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:JS(t.shape)/u,sliceSize:o,strides:[].concat((0,ke.Z)(gC(n.slice(0,a))),[1]),outputSize:JS(n)}}var FM=lN({tensorScatterUpdate_:function(e,t,n){var r=sN(e,"tensor","tensorScatterupdate"),a=sN(t,"indices","tensorScatterupdate","int32"),i=sN(n,"updates","tensorScatterupdate");if(MM(i,a,r.shape),r.dtype!==i.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(i.dtype,"."));var o={tensor:r,indices:a,updates:i};return JE.runKernel(e_,o,{})}});var zM=lN({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=sN(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=JE.runKernel(A_,i,o),u=(0,U.Z)(s,2);return{values:u[0],indices:u[1]}}});var BM=lN({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(SC(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new UP(t,n,r,!0,a),o=IR(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var VM=lN({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=sN(e,"x","unique","string_or_numeric");YS(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=JE.runKernel(P_,r,a),o=(0,U.Z)(i,2);return{values:o[0],indices:o[1]}}});var UM=lN({unsortedSegmentSum_:function(e,t,n){var r=sN(e,"x","unsortedSegmentSum"),a=sN(t,"segmentIds","unsortedSegmentSum","int32");YS(nC(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return JE.runKernel(L_,i,o)}});var WM=lN({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=sN(e,"x","unstack","string_or_numeric");YS(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return JE.runKernel(M_,r,a)}});function jM(e,t){return uP(e,t,"right")}function GM(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return JE.makeVariable(e,t,n,r)}function HM(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=IR(e,"int32"),i=IR([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}function KM(){return(KM=N(T().mark((function e(t){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=sN(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=HM(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qM=function(e){return KM.apply(this,arguments)};function ZM(){return ZM=N(T().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=sN(t,"tensor","boolMask"),i=sN(n,"mask","boolMask","bool"),o=null==r?0:r,s=i.rank,u=a.shape,YS(s>0,(function(){return"mask cannot be scalar"})),QS(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+s;l++)c*=u[l];return h=u.slice(0,o).concat([c],u.slice(o+s)),d=IO(a,h),f=IO(i,[-1]),e.next=14,qM(f);case 14:return p=e.sent,m=IM(p,[1]),v=zD(d,m,o),t!==a&&a.dispose(),n!==i&&i.dispose(),m.dispose(),d.dispose(),f.dispose(),p.dispose(),e.abrupt("return",v);case 24:case"end":return e.stop()}}),e)}))),ZM.apply(this,arguments)}var XM=function(e,t,n){return ZM.apply(this,arguments)};var YM=lN({transpose_:function(e,t,n){var r=sN(e,"x","transpose");if(null==t&&(t=r.shape.map((function(e,t){return t})).reverse()),YS(r.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){YS(e>=0&&e<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)}))})),r.rank<=1)return r.clone();var a={x:r},i={perm:t};return"complex64"===r.dtype?RR((function(){var e=YP(r),t=UD(r);return e=JE.runKernel(D_,{x:e},i),t=JE.runKernel(D_,{x:t},i),n&&(t=$D(t)),hN(e,t)})):JE.runKernel(D_,a,i)}});var QM=lN({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=sN(e,"v","movingAverage"),o=sN(t,"x","movingAverage"),s=sN(n,"decay","movingAverage");!function(e,t){YS(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}(i,o),YS(tC(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=GR(1),c=tA(u,s),l=BR(tA(o,i),c);if(a){YS(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=sN(r,"step","movingAverage");l=zR(l,tA(u,eA(s,h)))}return LR(i,l)}});var $M=lN({scatterND_:function(e,t,n){SC(n);var r=sN(e,"indices","scatterND","int32"),a=sN(t,"updates","scatterND");MM(a,r,n);var i={indices:r,updates:a},o={shape:n};return JE.runKernel(JT,i,o)}});var JM=lN({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;SC(n);var a=sN(e,"sparseIndices","sparseToDense","int32"),i=sN(t,"sparseValues","sparseToDense","string_or_numeric"),o=sN(r,"defaultValue","sparseToDense",i.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o);var s={sparseIndices:a,sparseValues:i,defaultValue:o},u={outputShape:n};return JE.runKernel(b_,s,u)}});var eL=lN({gatherND_:function(e,t){var n=sN(t,"indices","gatherND","int32"),r={params:sN(e,"x","gatherND","string_or_numeric"),indices:n};return JE.runKernel(HI,r)}});var tL=lN({dropout_:function(e,t,n,r){var a=sN(e,"x","dropout");if(YS("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),YS(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof DE?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(tC(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=zR(FD(LR(qP(i,0,1,"float32",r),o)),o);return BR(a,s)}});function nL(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function rL(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return RM(a,"float32")}function aL(){return aL=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,a=sN(t,"predictions","inTopK"),i=sN(n,"targets","inTopK"),YS(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),YS(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),QS(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],YS(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return s=e.sent,e.next=13,i.data();case 13:u=e.sent,c=s.length/o,l=o,h=cC("bool",c),d=0;case 17:if(!(d<c)){e.next=35;break}for(f=d*l,p=s.subarray(f,f+l),m=[],v=0;v<p.length;v++)m.push({value:p[v],index:v});m.sort((function(e,t){return t.value-e.value})),h[d]=0,g=0;case 25:if(!(g<r)){e.next=32;break}if(m[g].index!==u[d]){e.next=29;break}return h[d]=1,e.abrupt("break",32);case 29:g++,e.next=25;break;case 32:d++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",fN(h,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)}))),aL.apply(this,arguments)}var iL=function(e,t){return aL.apply(this,arguments)};var oL=lN({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=IO(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=IO(t,[1,t.shape[0],t.shape[1],t.shape[2]])),YS(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),YS(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),YS(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];YS(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),YS(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),CO("conv2dDerFilter",a,o);var h={x:s,dy:u},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return JE.runKernel(hI,h,d)}});function sL(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return BR(e,_M(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function uL(e,t){var n=t,r=function(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}(e.shape,t.shape);return r.length>0&&(n=ED(n,r)),IO(n,e.shape)}function cL(e,t,n,r){if("linear"===t)return e;if("relu"===t)return $P(e);if("elu"===t)return vD(e);if("relu6"===t)return JP(e);if("prelu"===t)return PP(e,n);if("leakyrelu"===t)return HD(e,r);if("sigmoid"===t)return RO(e);throw new Error("Unknown fused activation ".concat(t,"."))}var lL=function(e,t){return!(e>0)||"linear"===t};var hL=lN({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights,p=e.leakyreluAlpha;if(d=d||"linear",!1===lL(JE.state.gradientDepth,d)){YS("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var m=XO(t,n,r,a,o,u,c);return null!=l&&(m=LR(m,l)),cL(m,d,f,p)}var v=sN(t,"x","conv2d","float32"),g=sN(n,"filter","conv2d","float32"),y=v,b=!1;3===v.rank&&(b=!0,y=IO(v,[1,v.shape[0],v.shape[1],v.shape[2]])),YS(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),YS(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),CO("fused conv2d",a,c);var x="NHWC"===o?y.shape[3]:y.shape[1];YS(g.shape[2]===x,(function(){return"Error in conv2d: depth of input (".concat(x,") must match ")+"input depth for filter ".concat(g.shape[2],".")})),YS(wO(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")}));var w,k,S=fO(y.shape,g.shape,r,u,a,c);if(null!=l){var C=HE(w=sN(l,"bias","fused conv2d"),v),I=(0,U.Z)(C,1);w=I[0],"NHWC"===o?iA(S.outShape,w.shape):(YS(w.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(w.shape.length,".")})),YS(0===w.shape.length||w.shape[0]===S.outChannels||1===w.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(w.shape,") is not ")+"compatible with the number of output channels "+"(".concat(S.outChannels,")")})))}if(null!=f){var T=f.shape;if(YS(T.length<=1||3===T.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(T.length,".")})),1===T.length)YS(1===T[0]||T[0]===S.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(T,") is not compatible with the number of output ")+"channels (".concat(S.outChannels,").")}));else if(3===T.length)try{iA(T,S.outShape)}catch(D){var _="Error in fused conv2d: PReLU activation weights (".concat(T,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(S.outShape,").");throw Error(_)}k=sN(f,"prelu weights","fused conv2d")}var E=function(e,t){YS("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=(0,U.Z)(t,4),i=n[0],s=n[1],c=n[2],l=n[3],h=sL(e,c,d);YS(xO(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var f=[QO(s.shape,h,i,r,a),oL(s,h,i.shape,r,a)];if(null!=l){var p=uL(l,h);f.push(p)}return f},N={x:y,filter:g,bias:w,preluActivationWeights:k},R={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:d,leakyreluAlpha:p};if(null==l){var A=jR((function(e,t,n){var r=JE.runKernel(W_,N,R);return n([t,e,r]),b&&(r=IO(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:E}}));return A(y,g)}var O=jR((function(e,t,n,r){var a=JE.runKernel(W_,N,R);return r([t,e,a,n]),b&&(a=IO(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:E}}));return O(y,g,w)}});var dL=lN({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=IO(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=IO(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return JE.runKernel(CI,c,l)}});var fL=lN({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=IO(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},h=JE.runKernel(II,c,l);return u?IO(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var pL=lN({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights,p=e.leakyreluAlpha;if(!1===lL(JE.state.gradientDepth,d)){var m=uD(t,n,r,a,o,u,c);return null!=l&&(m=LR(m,l)),cL(m,d,f,p)}var v=sN(t,"x","depthwiseConv2d","float32"),g=sN(n,"filter","depthwiseConv2d","float32"),y=v,b=!1;3===v.rank&&(b=!0,y=IO(v,[1,v.shape[0],v.shape[1],v.shape[2]])),YS(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),YS(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),YS(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==u&&(u=[1,1]),YS(wO(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(u,"'")})),CO("fused depthwiseConv2d",a,c);var x,w,k=fO(y.shape,g.shape,r,u,a,c,!0);if(null!=l){var S=HE(x=sN(l,"bias","fused conv2d"),v),C=(0,U.Z)(S,1);x=C[0],iA(k.outShape,x.shape)}null!=f&&(w=sN(f,"prelu weights","fused depthwiseConv2d"));var I=function(e,t){YS(xO(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var n=(0,U.Z)(t,4),i=n[0],o=n[1],s=n[2],l=n[3],h=sL(e,s,d),f=fL(o.shape,h,i,r,a,u,c),p=dL(o,h,i.shape,r,a,u,c);return null!=l?[f,p,uL(x,h)]:[f,p]},T={x:y,filter:g,bias:x,preluActivationWeights:w},_={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:d,leakyreluAlpha:p};if(null==l){var E=jR((function(e,t,n){var r=JE.runKernel(j_,T,_);return n([t,e,r]),b&&(r=IO(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:I}}));return E(y,g)}var N=jR((function(e,t,n,r){var a=JE.runKernel(j_,T,_);return r([t,e,a,n]),b&&(a=IO(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:I}}));return N(y,g,x)}});var mL=lN({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,c=void 0===u?"linear":u,l=e.preluActivationWeights,h=e.leakyreluAlpha,d=void 0===h?.2:h;if(!1===lL(JE.state.gradientDepth,c)){var f=NO(t,n,a,o);return null!=s&&(f=LR(f,s)),cL(f,c,l,d)}var p=sN(t,"a","fused matMul"),m=sN(n,"b","fused matMul"),v=HE(p,m),g=(0,U.Z)(v,2);p=g[0],m=g[1];var y=a?p.shape[p.rank-2]:p.shape[p.rank-1],b=o?m.shape[m.rank-1]:m.shape[m.rank-2],x=a?p.shape[p.rank-1]:p.shape[p.rank-2],w=o?m.shape[m.rank-2]:m.shape[m.rank-1],k=p.shape.slice(0,-2),S=m.shape.slice(0,-2),C=JS(k),I=JS(S);YS(y===b,(function(){return"Error in fused matMul: inner shapes (".concat(y,") and (")+"".concat(b,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(m.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var T,_,E=iA(p.shape.slice(0,-2),m.shape.slice(0,-2)).concat([x,w]),N=IO(p,a?[C,y,x]:[C,x,y]),R=IO(m,o?[I,w,b]:[I,b,w]);if(null!=s){var A=HE(T=sN(s,"bias","fused matMul"),p);T=(0,U.Z)(A,1)[0],iA(E,T.shape)}null!=l&&(_=sN(l,"prelu weights","fused matMul"));var O=function(e,t){var n,r,i=(0,U.Z)(t,4),u=i[0],l=i[1],h=i[2],d=i[3],f=sL(IO(e,h.shape),h,c);return a||o?!a&&o?(n=NO(f,l,!1,!1),r=NO(f,u,!0,!1)):a&&!o?(n=NO(l,f,!1,!0),r=NO(u,f,!1,!1)):(n=NO(l,f,!0,!0),r=NO(f,u,!0,!0)):(n=NO(f,l,!1,!0),r=NO(u,f,!0,!1)),null!=s?[n,r,uL(d,f)]:[n,r]},D={a:N,b:R,bias:T,preluActivationWeights:_},P={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:d};if(null==s){var M=jR((function(e,t,n){var r=JE.runKernel(U_,D,P);return n([e,t,r]),{value:IO(r,E),gradFunc:O}}));return M(N,R)}var L=jR((function(e,t,n,r){var a=JE.runKernel(U_,D,P);return r([e,t,a,n]),{value:IO(a,E),gradFunc:O}}));return L(N,R,T)}});var vL=lN({hammingWindow_:function(e){return rL(e,.54,.46)}});var gL=lN({hannWindow_:function(e){return rL(e,.5,.5)}});var yL=lN({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(AO(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=EO([AO(e,i,t-s),$R([s],a)]);o.push(u),i+=n}return 0===o.length?AM([],[0,t]):IO(EO(o),[o.length,t])}});var bL=lN({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gL;null==r&&(r=nL(t));var i=yL(e,t,n),o=BR(i,a(t));return SM(o,r)}});var xL=lN({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=sN(e,"image","cropAndResize"),s=sN(t,"boxes","cropAndResize","float32"),u=sN(n,"boxInd","cropAndResize","int32"),c=s.shape[0];YS(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),YS(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),YS(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),YS(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),YS(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),YS("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},h={method:a,extrapolationValue:i,cropSize:r};return JE.runKernel(xI,l,h)}});var wL=lN({flipLeftRight_:function(e){var t=sN(e,"image","flipLeftRight","float32");YS(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return JE.runKernel(VI,n,{})}});var kL=lN({grayscaleToRGB_:function(e){var t=sN(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];YS(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),YS(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,MD(t,a)}});var SL=lN({rgbToGrayscale_:function(e){var t=sN(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];YS(t.rank>=2,(function(){return"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),YS(3===r,(function(){return"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")}));var a,i=t.dtype,o=TR(t,"float32"),s=RM([.2989,.587,.114]);switch(t.rank){case 2:a=mD("ij,j->i",o,s);break;case 3:a=mD("ijk,k->ij",o,s);break;case 4:a=mD("ijkl,l->ijk",o,s);break;case 5:a=mD("ijklm,m->ijkl",o,s);break;case 6:a=mD("ijklmn,n->ijklm",o,s);break;default:throw new Error("Not a valid tensor rank.")}return a=DD(a,-1),TR(a,i)}});var CL=lN({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=sN(e,"image","rotateWithOffset","float32");YS(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r};return JE.runKernel(V_,i,o)}});function IL(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),YS(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),YS(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),YS(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),YS(1===t.rank,(function(){return"scores must be a 1D tensor"})),YS(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),YS(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var TL=lN({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=sN(e,"boxes","nonMaxSuppression","float32"),o=sN(t,"scores","nonMaxSuppression","float32"),s=IL(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return JE.runKernel(_T,{boxes:i,scores:o},u)}});function _L(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||EL)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function EL(e,t){return e>t?1:e<t?-1:0}function NL(e,t,n,r,a){return OL(e,t,n,r,a,0)}function RL(e,t,n,r,a,i){return OL(e,t,n,r,a,0,!1,i,!0)}function AL(e,t,n,r,a,i){return OL(e,t,n,r,a,i,!0)}function OL(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(ML);for(var h=i>0?-.5/i:0,d=[],f=[];d.length<n&&c.length>0;){var p=c.pop(),m=p.score,v=p.boxIndex,g=p.suppressBeginIndex;if(m<a)break;for(var y=!1,b=d.length-1;b>=g;--b){var x=DL(e,v,d[b]);if(x>=r){y=!0;break}if(p.score=p.score*PL(r,h,x),p.score<=a)break}p.suppressBeginIndex=d.length,y||(p.score===m?(d.push(v),f.push(p.score)):p.score>a&&_L(c,p,ML))}var w=d.length,k=n-w;s&&k>0&&(d.push.apply(d,(0,ke.Z)(new Array(k).fill(0))),f.push.apply(f,(0,ke.Z)(new Array(k).fill(0))));var S={selectedIndices:d};return o&&(S.selectedScores=f),u&&(S.validOutputs=w),S}function DL(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),f=(s-i)*(u-o),p=(h-c)*(d-l);if(f<=0||p<=0)return 0;var m=Math.max(i,c),v=Math.max(o,l),g=Math.min(s,h),y=Math.min(u,d),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(f+p-b)}function PL(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function ML(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function LL(){return LL=N(T().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=sN(t,"boxes","nonMaxSuppressionAsync"),s=sN(n,"scores","nonMaxSuppressionAsync"),u=IL(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return c=e.sent,l=c[0],h=c[1],d=NL(l,h,r,a,i),f=d.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",RM(f,"int32"));case 17:case"end":return e.stop()}}),e)}))),LL.apply(this,arguments)}var FL=function(e,t,n){return LL.apply(this,arguments)};var zL=lN({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=sN(e,"boxes","nonMaxSuppression"),s=sN(t,"scores","nonMaxSuppression"),u=IL(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},h=JE.runKernel(NT,c,l);return{selectedIndices:h[0],selectedScores:h[1]}}});function BL(){return BL=N(T().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.length>3&&void 0!==v[3]?v[3]:.5,i=v.length>4&&void 0!==v[4]?v[4]:Number.NEGATIVE_INFINITY,o=v.length>5&&void 0!==v[5]?v[5]:0,s=sN(t,"boxes","nonMaxSuppressionAsync"),u=sN(n,"scores","nonMaxSuppressionAsync"),c=IL(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return l=e.sent,h=l[0],d=l[1],f=AL(h,d,r,a,i,o),p=f.selectedIndices,m=f.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:RM(p,"int32"),selectedScores:RM(m)});case 19:case"end":return e.stop()}}),e)}))),BL.apply(this,arguments)}var VL=function(e,t,n){return BL.apply(this,arguments)};var UL=lN({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=sN(e,"boxes","nonMaxSuppression"),s=sN(t,"scores","nonMaxSuppression"),u=IL(o,s,n,r,a,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i},h=JE.runKernel(ET,c,l);return{selectedIndices:h[0],validOutputs:h[1]}}});function WL(){return WL=N(T().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],s=sN(t,"boxes","nonMaxSuppressionAsync"),u=sN(n,"scores","nonMaxSuppressionAsync"),c=IL(s,u,r,a,i,null),l=c.maxOutputSize,h=c.iouThreshold,d=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return f=e.sent,p=(0,U.Z)(f,2),m=p[0],v=p[1],g=RL(m,v,l,h,d,o),y=g.selectedIndices,b=g.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:RM(y,"int32"),validOutputs:GR(b,"int32")});case 19:case"end":return e.stop()}}),e)}))),WL.apply(this,arguments)}var jL=function(e,t,n){return WL.apply(this,arguments)};var GL=lN({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=sN(e,"images","resizeBilinear");YS(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),YS(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),YS(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=IO(a,[1,a.shape[0],a.shape[1],a.shape[2]])),(0,U.Z)(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=JE.runKernel(qT,s,u);return o?IO(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var HL=lN({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=sN(e,"images","resizeNearestNeighbor");YS(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),YS(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),YS("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),YS(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=IO(a,[1,a.shape[0],a.shape[1],a.shape[2]])),(0,U.Z)(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=JE.runKernel(HT,s,u);return o?IO(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var KL=lN({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,u=sN(e,"image","threshold"),c=u.shape[0]*u.shape[1],l=BR(RM([s]),255);if(YS(3===u.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(u.rank,".")})),YS(3===u.shape[2]||1===u.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(u.shape[2],".")})),YS("int32"===u.dtype||"float32"===u.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(u.dtype,".")})),YS("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===u.shape[2]){var h=kM(u,[1,1,1],-1),d=(0,U.Z)(h,3);t=d[0],n=d[1],r=d[2];var f=BR(t,.2989),p=BR(n,.587),m=BR(r,.114);a=LR(LR(f,p),m)}else a=e;"otsu"===i&&(l=function(e,t){for(var n,r,a,i,o,s,u=RM([-1]),c=RM([0]),l=RM([0]),h=0;h<e.size-1;h++){n=AO(e,0,h+1),r=AO(e,h+1),o=zR(ED(n),t),s=zR(ED(r),t);var d=ED(BR(n,XP(0,n.size)));a=zR(d,ED(n));var f=$R(r.shape,n.size),p=LR(XP(0,r.size),f),m=BR(r,p);i=zR(ED(m),ED(r));var v=tA(a,i),g=tA(a,i),y=BR(o,s);l=BR(BR(y,v),g);var b=BD(l,c);c=dD(b,l,c),u=dD(b,RM([h]),u)}return u}(BO(TR(iM(a),"int32"),fN([]),256),c));var v=o?qD(a,l):BD(a,l);return TR(BR(v,255),"int32")}});var qL=lN({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=sN(e,"image","transform","float32"),s=sN(t,"transforms","transform","float32");YS(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),YS(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),YS(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return JE.runKernel(O_,u,c)}});var ZL=lN({bandPart_:function(e,t,n){var r=sN(e,"a","bandPart");YS(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a,i,o=r.shape,s=r.shape.slice(-2),u=(0,U.Z)(s,2),c=u[0],l=u[1];"number"===typeof t?(YS(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),YS(t<=c,(function(){return"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(c,").")})),a=sN(t<0?c:t,"numLower","bandPart")):(YS("int32"===t.dtype,(function(){return"bandPart(): numLower's dtype must be an int32."})),a=dD(KD(t,0),c,gP(t,c))),"number"===typeof n?(YS(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")})),YS(n<=l,(function(){return"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(l,").")})),i=sN(n<0?l:n,"numUpper","bandPart")):(YS("int32"===n.dtype,(function(){return"bandPart(): numUpper's dtype must be an int32."})),i=dD(KD(n,0),l,gP(n,l)));var h=IO(XP(0,c,1,"int32"),[-1,1]),d=XP(0,l,1,"int32"),f=tA(h,d),p=rP(qD(f,a),VD(f,$D(i))),m=pP([c,l],r.dtype);return IO(TM(WM(IO(r,[-1,c,l])).map((function(e){return dD(p,e,m)}))),o)}});var XL=lN({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,YS(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){YS(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}else t=!0,e=kM(e,e.shape[0],0).map((function(e){return IM(e,[0])}));YS(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var i=[],o=e,s=function(e){i.push(JE.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=BR(ED(BR(i[n],t)),i[n]);t=tA(t,r)}return zR(t,RD(t,"euclidean"))})))},u=0;u<e.length;++u)s(u);return t?TM(i,0):i}});function YL(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return JE.tidy((function(){YS(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=LD(n),i=_R(e),o=AM([[1]],[1,1]),s=_R(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,l=JE.tidy((function(){var t=AO(i,[e,e],[n-e,1]),u=RD(t),c=AO(i,[e,e],[1,1]),l=dD(BD(c,0),AM([[-1]]),AM([[1]])),h=tA(c,BR(l,u)),d=zR(t,h);s=1===d.shape[0]?_R(o):EO([o,AO(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var f=$D(zR(NO(l,h),u)),p=AO(i,[e,0],[n-e,r]),m=BR(f,s),v=YM(s);if(0===e)i=tA(p,NO(m,NO(v,p)));else{var g=tA(p,NO(m,NO(v,p)));i=EO([AO(i,[0,0],[e,r]),g],0)}var y=YM(m),b=AO(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=tA(b,NO(NO(b,s),y));else{var x=tA(b,NO(NO(b,s),y));a=EO([AO(a,[0,0],[n,e]),x],1)}return[s,i,a]})),h=(0,U.Z)(l,3);s=h[0],i=h[1],a=h[2],AR([t,u,c])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=AO(a,[0,0],[n,r]),i=AO(i,[0,0],[r,r])),[a,i]}))}var QL,$L=lN({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(YS(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return YL(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=WM(IO(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=YL(e,t),r=(0,U.Z)(n,2),o=r[0],s=r[1];a.push(o),i.push(s)})),[IO(TM(a,0),e.shape),IO(TM(i,0),e.shape)]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(QL||(QL={}));var JL=lN({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:QL.SUM_BY_NONZERO_WEIGHTS,r=sN(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=sN(t,"weights","computeWeightedLoss"));var i=null==a?r:BR(r,a);if(n===QL.NONE)return i;if(n===QL.SUM)return ED(i);if(n===QL.MEAN){if(null==a)return fP(i);var o=r.size/a.size,s=zR(ED(i),ED(a));return o>1?zR(s,GR(o)):s}if(n===QL.SUM_BY_NONZERO_WEIGHTS){if(null==a)return zR(ED(i),GR(r.size));var u=BR(a,mP(r.shape)),c=TR(ED(SP(u,GR(0))),"float32");return zR(ED(i),c)}throw Error("Unknown reduction: ".concat(n))}});var eF=lN({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:QL.SUM_BY_NONZERO_WEIGHTS,a=sN(e,"labels","absoluteDifference"),i=sN(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=sN(n,"weights","absoluteDifference")),QS(a.shape,i.shape,"Error in absoluteDifference: ");var s=rA(tA(a,i));return JL(s,o,r)}});var tF=lN({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:QL.SUM_BY_NONZERO_WEIGHTS,i=sN(e,"labels","cosineDistance"),o=sN(t,"predictions","cosineDistance"),s=null;null!=r&&(s=sN(r,"weights","cosineDistance")),QS(i.shape,o.shape,"Error in cosineDistance: ");var u=GR(1),c=tA(u,ED(BR(i,o),n,!0));return JL(c,s,a)}});var nF=lN({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:QL.SUM_BY_NONZERO_WEIGHTS,a=sN(e,"labels","hingeLoss"),i=sN(t,"predictions","hingeLoss"),o=null;null!=n&&(o=sN(n,"weights","hingeLoss")),QS(a.shape,i.shape,"Error in hingeLoss: ");var s=GR(1);a=tA(BR(GR(2),a),s);var u=$P(tA(s,BR(a,i)));return JL(u,o,r)}});var rF=lN({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:QL.SUM_BY_NONZERO_WEIGHTS,i=sN(e,"labels","huberLoss"),o=sN(t,"predictions","huberLoss"),s=null;null!=n&&(s=sN(n,"weights","huberLoss")),QS(i.shape,o.shape,"Error in huberLoss: ");var u=GR(r),c=rA(tA(o,i)),l=gP(c,u),h=tA(c,l),d=LR(BR(GR(.5),UR(l)),BR(u,h));return JL(d,s,a)}});var aF=lN({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:QL.SUM_BY_NONZERO_WEIGHTS,i=sN(e,"labels","logLoss"),o=sN(t,"predictions","logLoss"),s=null;null!=n&&(s=sN(n,"weights","logLoss")),QS(i.shape,o.shape,"Error in logLoss: ");var u=GR(1),c=GR(r),l=$D(BR(i,YD(LR(o,c)))),h=BR(tA(u,i),YD(LR(tA(u,o),c))),d=tA(l,h);return JL(d,s,a)}});var iF=lN({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:QL.SUM_BY_NONZERO_WEIGHTS,a=sN(e,"labels","meanSquaredError"),i=sN(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=sN(n,"weights","meanSquaredError")),QS(a.shape,i.shape,"Error in meanSquaredError: ");var s=CM(a,i);return JL(s,o,r)}});var oF=lN({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:QL.SUM_BY_NONZERO_WEIGHTS,i=sN(e,"multiClassLabels","sigmoidCrossEntropy"),o=sN(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=sN(n,"weights","sigmoidCrossEntropy")),QS(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=GR(r),c=GR(1),l=GR(.5);i=LR(BR(i,tA(c,u)),BR(l,u))}var h=function(e,t){var n=sN(e,"labels","sigmoidCrossEntropyWithLogits"),r=sN(t,"logits","sigmoidCrossEntropyWithLogits");QS(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=$P(r),i=BR(r,n),o=QD(OD($D(rA(r))));return LR(tA(a,i),o)}(i,o);return JL(h,s,a)}});var sF=lN({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:QL.SUM_BY_NONZERO_WEIGHTS,i=sN(e,"onehotLabels","softmaxCrossEntropy"),o=sN(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=sN(n,"weights","softmaxCrossEntropy")),QS(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=GR(r),c=GR(1),l=GR(i.shape[1]);i=LR(BR(i,tA(c,u)),zR(u,l))}var h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=jR((function(e,t,r){var a=nP(t,[n],!0),i=tA(TR(t,"float32"),a);r([e,i]);var o=$D(BR(i,e));return{value:ED(o,[n]),gradFunc:function(e,t){var r=(0,U.Z)(t,2),a=r[0],i=r[1],o=wD(e.shape,[n]);return[BR(IO(e,o),tA(TR(a,"float32"),OD(i))),BR(IO(e,o),tA(OD(i),TR(a,"float32")))]}}}));return r(e,t)}(i,o);return JL(h,s,a)}});var uF=lN({sparseFillEmptyRows_:function(e,t,n,r){var a=sN(e,"indices","sparseFillEmptyRows","int32"),i=sN(t,"values","sparseFillEmptyRows"),o=sN(n,"denseShape","sparseFillEmptyRows","int32"),s=sN(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));var u={indices:a,values:i,denseShape:o,defaultValue:s},c=JE.runKernel(m_,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});var cF=lN({sparseReshape_:function(e,t,n){var r=sN(e,"inputIndices","sparseReshape","int32"),a=sN(t,"inputShape","sparseReshape","int32"),i=sN(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},s=JE.runKernel(v_,o);return{outputIndices:s[0],outputShape:s[1]}}});var lF=lN({sparseSegmentMean_:function(e,t,n){var r=sN(e,"data","sparseSegmentMean"),a=sN(t,"indices","sparseSegmentMean","int32"),i=sN(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return JE.runKernel(g_,o)}});var hF=lN({sparseSegmentSum_:function(e,t,n){var r=sN(e,"data","sparseSegmentSum"),a=sN(t,"indices","sparseSegmentSum","int32"),i=sN(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return JE.runKernel(y_,o)}});var dF=lN({stringNGrams_:function(e,t,n,r,a,i,o,s){var u=sN(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=sN(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},h={data:u,dataSplits:c},d=JE.runKernel(C_,h,l);return{nGrams:d[0],nGramsSplits:d[1]}}});var fF=lN({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=sN(e,"input","stringSplit","string"),a=sN(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},s=JE.runKernel(I_,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});var pF=lN({stringToHashBucketFast_:function(e,t){var n=sN(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return JE.runKernel(T_,a,r)}});var mF,vF=lN({staticRegexReplace_:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=sN(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return JE.runKernel(k_,{x:a},i)}}),gF={fft:bM,ifft:xM,rfft:SM,irfft:wM},yF={hammingWindow:vL,hannWindow:gL,frame:yL,stft:bL},bF={flipLeftRight:wL,grayscaleToRGB:kL,resizeNearestNeighbor:HL,resizeBilinear:GL,rgbToGrayscale:SL,rotateWithOffset:CL,cropAndResize:xL,nonMaxSuppression:TL,nonMaxSuppressionAsync:FL,nonMaxSuppressionWithScore:zL,nonMaxSuppressionWithScoreAsync:VL,nonMaxSuppressionPadded:UL,nonMaxSuppressionPaddedAsync:jL,threshold:KL,transform:qL},xF={bandPart:ZL,gramSchmidt:XL,qr:$L},wF={absoluteDifference:eF,computeWeightedLoss:JL,cosineDistance:tF,hingeLoss:nF,huberLoss:rF,logLoss:aF,meanSquaredError:iF,sigmoidCrossEntropy:oF,softmaxCrossEntropy:sF},kF={sparseFillEmptyRows:uF,sparseReshape:cF,sparseSegmentMean:lF,sparseSegmentSum:hF},SF={stringNGrams:dF,stringSplit:fF,stringToHashBucketFast:pF,staticRegexReplace:vF},CF="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function IF(e,t){var n=e[0].length;e.forEach((function(e,t){YS(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),YS(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)YS(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function TF(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(mF||(mF={}));var _F=30;function EF(e){return e<=_F?e:vC(e,Math.floor(Math.sqrt(e)))}function NF(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function RF(e,t,n){var r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var a=t.length,i=0;i<a;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(a+1))}return r}function AF(e,t){var n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(var r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{for(var a=[],i=[],o=1;o<e;++o)o>=2*t+1||o%2===1?i.push(o):a.push(o);n.push.apply(n,a),n.push(0),n.push.apply(n,i)}return n}function OF(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function DF(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function PF(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function MF(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===JS(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,h=i;h<n;++h)l*=u[h],c.push(u[h]);var d=[].concat((0,ke.Z)(gC(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,d]}var LF=1.7580993408473768,FF=1.0507009873554805,zF=.3275911,BF=.254829592,VF=-.284496736,UF=1.421413741,WF=-1.453152027,jF=1.061405429;function GF(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}var HF,KF,qF="->",ZF=/->/g,XF=",",YF="...";function QF(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(ZF,"").length)/qF.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(qF,'").'));var r=e.split(qF),a=(0,U.Z)(r,2),i=a[0],o=a[1];YS(-1===i.indexOf(YF),(function(){return'The ellipsis notation ("'.concat(YF,'") is not supported yet.')}));var s=i.split(XF),u=s.length;if(t!==u)throw new Error("Expected ".concat(u," input tensors, received ").concat(t));if(u>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var c=[],l=function(){var e=o[h];if(!s.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===c.indexOf(e)&&c.push(e)},h=0;h<o.length;++h)l();for(var d=0;d<i.length;++d){var f=i[d];-1===c.indexOf(f)&&f!==XF&&c.push(f)}for(var p=new Array(s.length),m=0;m<u;++m){if(new Set(s[m].split("")).size!==s[m].length)throw new Error("Found duplicate axes in input component ".concat(s[m],". ")+"Support for duplicate axes in input is not implemented yet.");p[m]=[];for(var v=0;v<s[m].length;++v)p[m].push(c.indexOf(s[m][v]))}for(var g=c.length,y=[],b=o.length;b<g;++b)y.push(b);return{allDims:c,summedDims:y,idDims:p}}function $F(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function JF(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:YS(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function ez(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=ye(nz(t,r[s]));try{for(c.s();!(u=c.n()).done;){var l=u.value;-1===o.indexOf(l)&&(a[s].push(l),o.push(l))}}catch(N8){c.e(N8)}finally{c.f()}}return{path:r,steps:a}}function tz(e){return e.every((function(e,t){return e===t}))}function nz(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function rz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)YS(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);YS(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}YS(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function az(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function iz(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function oz(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function sz(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function uz(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function cz(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,h=1,d=0;d<r;++d)u.push(e.shape[d]),c*=e.shape[d];for(var f=r;f<n;f++)u.push(e.shape[f]),l*=e.shape[f];for(var p=r;p<a;p++)u.push(t.shape[p]);for(var m=n+1;m<i;m++)u.push(e.shape[m]),h*=e.shape[m];return{batchSize:c,sliceSize:h,outerSize:l,dimSize:s,outputShape:u}}function lz(e){try{return e.map((function(e){return gE(e)}))}catch(N8){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(N8))}}!function(){var e,t=ye(hA);try{for(t.s();!(e=t.n()).done;){XR(e.value)}}catch(N8){t.e(N8)}finally{t.f()}}(),RC().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(HF||(HF={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(KF||(KF={}));var hz={};function dz(e){return hz[e]}function fz(e,t,n,r,a){var i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd,u=o<0?t.inputNames.length+o:o;if("tensor"===i.type)return pz(t.inputNames[u],n,r,a);if("tensors"===i.type){var c=t.inputs.slice(o,s),l=t.inputNames.slice(o,s).filter((function(e,t){var n;return"NoOp"!==(null===(n=c[t])||void 0===n?void 0:n.op)}));return l.map((function(e){return pz(e,n,r,a)}))}var h=pz(t.inputNames[u],n,r,a),d=h.dataSync();return"number"===i.type?d[0]:bC(h.shape,d)}var f=t.attrParams[e];return f&&f.value}function pz(e,t,n,r){var a=yz(e,n),i=(0,U.Z)(a,2),o=i[0],s=i[1];if(null!=r){var u=r.getHashTableHandleByName(o);if(null!=u)return u}var c=n.currentContextIds.find((function(e){return!!t[gz(o,e)]}));return void 0!==c?t[gz(o,c)][s]:void 0}function mz(e,t,n){return t[gz(e,n.currentContextId)]}function vz(e,t){var n=yz(e,t),r=(0,U.Z)(n,3),a=r[0],i=r[1],o=r[2];return[gz(a,t&&t.currentContextId),i,o]}function gz(e,t){return t?"".concat(e,"-").concat(t):e}function yz(e,t){if(""===e)return["",0,void 0];var n=null!=t&&null!=t.parseNodeNameCache;if(n){var r=t.parseNodeNameCache.get(e);if(null!=r)return r}var a,i=e.split(":");if(1===i.length)a=[e,0,void 0];else{var o=i[0],s=3===i.length?i[1]:void 0;a=[o,Number(i[i.length-1]),s]}return n&&t.parseNodeNameCache.set(e,a),a}function bz(e,t,n){var r=fz("pad",e,t,n);if("explicit"===r){r=fz("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function xz(e){return e.kept?e:_R(e)}var wz=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kz=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Sz=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Cz=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Iz=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Tz=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_z=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Ez=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Nz=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Rz=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Az=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Oz=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Dz=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Pz=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Mz=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Lz=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Fz=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],zz=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Bz=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Vz=function(){function e(){var t;Se(this,e);var n=[r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w],k=(t=[]).concat.apply(t,(0,ke.Z)(n.map((function(e){return e.json}))));this.opMappers=k.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Te(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.node,a=[],i=[],o=[],s=r.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?a.push(e[n.name]):"Const"===n.op?i.push(e[n.name]):null!=n.input&&0!==n.input.length||o.push(e[n.name]),e}),{}),u=[],c=[],l={},h={};null!=n&&(l=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));var d=Object.keys(s);d.forEach((function(e){var t=s[e];t.inputNames.forEach((function(e,n){var r=vz(e),a=(0,U.Z)(r,3),i=a[0],o=a[2],u=s[i];if(null!=u.outputs){var c=u.outputs.indexOf(o);if(-1!==c){var l="".concat(i,":").concat(c);t.inputNames[n]=l}}t.inputs.push(u),u.children.push(t)}))})),0===Object.keys(h).length?d.forEach((function(e){var t=s[e];0===t.children.length&&c.push(t)})):Object.keys(h).forEach((function(e){var t=vz(e),n=(0,U.Z)(t,1)[0],r=s[n];null!=r&&(r.signatureKey=h[e],c.push(r))})),Object.keys(l).length>0?Object.keys(l).forEach((function(e){var t=vz(e),n=(0,U.Z)(t,1)[0],r=s[n];r&&(r.signatureKey=l[e],u.push(r))})):u=a;var f={};null!=e.library&&null!=e.library.function&&(f=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var p={nodes:s,inputs:u,outputs:c,weights:i,placeholders:a,signature:n,functions:f};return o.length>0&&(p.initNodes=o),p}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=dz(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.slice(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=Wz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Wz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=$z(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=$z(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=Gz(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=Gz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=Qz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Qz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=jz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=jz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=eB(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=eB(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=Yz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Yz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=Jz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Jz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=qz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=qz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=Zz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Zz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=Kz(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Kz(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=vz(e.name),n=(0,U.Z)(t,1)[0],r={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Hz(e.type),type:"dtype"}},children:[]};r.signatureKey=e.name,i.push(r),a[n]=r})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e,n){var r=vz(e),i=(0,U.Z)(r,3),o=i[0],s=i[2],u=a[o];if(null!=u.outputs){var c=u.outputs.indexOf(s);if(-1!==c){var l="".concat(o,":").concat(c);t.inputNames[n]=l}}t.inputs.push(u),u.children.push(t)}))}));var s=e.ret;e.signature.outputArg.forEach((function(e){var t=vz(s[e.name]),n=(0,U.Z)(t,2),r=n[0],i=n[1],u=a[r];null!=u&&(u.defaultOutput=i,o.push(u))}));var u=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function Uz(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=RC().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function Wz(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?Uz(a.s,r):n}function jz(e,t,n){var r=e[t];return r?r.b:n}function Gz(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function Hz(e){switch("string"===typeof e&&(e=HF[e]),e){case HF.DT_FLOAT:case HF.DT_HALF:return"float32";case HF.DT_INT32:case HF.DT_INT64:case HF.DT_INT8:case HF.DT_UINT8:return"int32";case HF.DT_BOOL:return"bool";case HF.DT_DOUBLE:return"float32";case HF.DT_STRING:return"string";default:return null}}function Kz(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function qz(e,t,n){var r=e[t];return r&&r.type?Hz(r.type):n}function Zz(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return Hz(e)})):n}function Xz(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function Yz(e,t,n){var r=e[t];return r&&r.shape?Xz(r.shape):n}function Qz(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function $z(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return Uz(e,r)})):n}function Jz(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return Xz(e)})):n}function eB(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var tB=function(){function e(t,n,r){var a=this;Se(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return Te(e,[{key:"getInput",value:function(e){return pz(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return pz(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Gz(this.node.rawAttrs,e,t);if(null!=n.s)return Wz(this.node.rawAttrs,e,t);if(null!=n.b)return jz(this.node.rawAttrs,e,t);if(null!=n.shape)return Yz(this.node.rawAttrs,e,t);if(null!=n.type)return qz(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Qz(this.node.rawAttrs,e,t);if(null!=n.list.s)return $z(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Jz(this.node.rawAttrs,e,t);if(null!=n.list.b)return eB(this.node.rawAttrs,e,t);if(null!=n.list.type)return Zz(this.node.rawAttrs,e,t)}return t}}]),e}();function nB(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){YS(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var r=0;r<e.length;r++){var a=e[r],i=t[r];YS(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function rB(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function aB(e,t,n){var r=iB(e,n),a=!rB(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=iB(e.shape,r)})),!rB(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function iB(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var oB=function(){function e(t,n,r,a,i,o,s){Se(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=GR(0),OR(this.idTensor)}return Te(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),nB(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,OR(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return fN([],[0].concat(this.elementShape));var r=this.readMany(e);return nB(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),TM(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return fN([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return nB(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),EO(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,(0,ke.Z)(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,WM(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];RR((function(){t=IO(t,[1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],i];o[s]=IO(AO(t,u,c),n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)}}]),e}(),sB=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Se(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));nB(n,e.shape,"TensorList shape mismatch: "),OR(e)})),this.idTensor=GR(0),this.maxNumElements=a,OR(this.idTensor)}return Te(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e((0,ke.Z)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));nB(e,this.elementShape,"TensorList shape mismatch: ");var a=aB(this.elementShape,this.tensors,e);return RR((function(){var e=n.tensors.map((function(e){return IO(e,a)}));return TM(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=aB(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,nB(r.shape,e,"TensorList shape mismatch: "),IO(r,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(nB(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");OR(e),this.tensors.push(e)}},{key:"resize",value:function(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));var n=new e([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(var r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));nB(this.tensors[e].shape,t,"TensorList shape mismatch: ");var r=aB(this.elementShape,this.tensors,t);return IO(this.tensors[e],r)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));nB(this.elementShape,t.shape,"TensorList shape mismatch: "),OR(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));nB(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=aB(this.elementShape,this.tensors,n);return 0===e.length?fN([],[0].concat(a)):RR((function(){var t=e.map((function(e){return IO(r.tensors[e],a)}));return TM(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));nB(this.elementShape,t,"TensorList shape mismatch: ");var r=aB(this.elementShape,this.tensors,t);return 0===this.size()?fN([],[0].concat(r)):RR((function(){var e=n.tensors.map((function(e){return IO(e,r)}));return EO(e,0)}))}}]),e}();function uB(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));nB(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=WM(e);return new sB(a,t,r)}function cB(e,t,n,r){return new sB([],e,t,r)}function lB(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,(0,ke.Z)(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new sB([],n,e.dtype,r),o=WM(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}function hB(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=iB(e.shape.slice(1),n),o=0===r?0:e.size/r,s=RR((function(){var n=[];e=IO(e,[1,r,o]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,t[s],o];n[s]=IO(AO(e,u,c),i)}return e.dispose(),n})),u=new sB([],n,e.dtype,t.length),c=0;c<s.length;c++)u.setItem(c,s[c]);return u}var dB=function(){var e=N(T().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,k,S,C,I,_,E,N,R,A,O,D,P,M,L,F,z,B,V,U,W,j,G,H,K,q,Z,X,Y,Q,$,J,ee,te,ne,re,ae,ie,oe,se,ue,ce,le,he,de,fe,pe,me,ve,ge,ye,be,xe,we,ke,Se,Ce,Ie,Te,_e,Ee,Ne,Re,Ae,Oe,De,Pe,Me,Le,Fe,ze,Be,Ve,Ue,We,je,Ge,He,Ke,qe,Ze,Xe,Ye,Qe,$e,Je,et,tt,nt,rt,at,it,ot;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?33:"Switch"===e.t0?35:"Merge"===e.t0?46:"Enter"===e.t0?51:"Exit"===e.t0?55:"NextIteration"===e.t0?58:"TensorArrayV3"===e.t0?61:"TensorArrayWriteV3"===e.t0?71:"TensorArrayReadV3"===e.t0?77:"TensorArrayGatherV3"===e.t0?81:"TensorArrayScatterV3"===e.t0?86:"TensorArrayConcatV3"===e.t0?92:"TensorArraySplitV3"===e.t0?96:"TensorArraySizeV3"===e.t0?102:"TensorArrayCloseV3"===e.t0?105:"TensorListSetItem"===e.t0?109:"TensorListGetItem"===e.t0?115:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?121:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?128:"TensorListGather"===e.t0?136:"TensorListStack"===e.t0?142:"TensorListFromTensor"===e.t0?148:"TensorListConcat"===e.t0||"TensorListConcatV2"===e.t0?154:"TensorListPushBack"===e.t0?159:"TensorListPopBack"===e.t0?164:"TensorListSplit"===e.t0?169:"TensorListLength"===e.t0?175:"TensorListResize"===e.t0?178:184;break;case 3:return a=fz("thenBranch",t,n,r),i=fz("elseBranch",t,n,r),o=fz("cond",t,n,r),s=fz("args",t,n,r),e.next=9,o.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[i].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 15:return u=fz("body",t,n,r),c=fz("cond",t,n,r),l=fz("args",t,n,r),e.next=20,r.functionMap[c].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 20:return h=e.sent,d=l.map((function(e){return e.id})),e.next=24,h[0].data();case 24:f=e.sent,h.forEach((function(e){e.kept||-1!==d.indexOf(e.id)||e.dispose()})),p=l,m=T().mark((function e(){var t,n,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p,e.next=3,r.functionMap[u].executeFunctionAsync(p,r.tensorArrayMap,r.tensorListMap);case 3:return p=e.sent,n=p.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==d.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[c].executeFunctionAsync(p,r.tensorArrayMap,r.tensorListMap);case 8:return a=e.sent,e.next=11,a[0].data();case 11:f=e.sent,a.forEach((function(e){e.kept||-1!==d.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 28:if(!f[0]){e.next=32;break}return e.delegateYield(m(),"t1",30);case 30:e.next=28;break;case 32:return e.abrupt("return",p);case 33:return v=fz("pred",t,n,r),e.abrupt("return",[xz(v)]);case 35:return g=fz("pred",t,n,r),(y=fz("data",t,n,r)).kept||(y=xz(y)),e.next=40,g.data();case 40:if(!e.sent[0]){e.next=44;break}e.t2=[void 0,y],e.next=45;break;case 44:e.t2=[y,void 0];case 45:return e.abrupt("return",e.t2);case 46:if(b=t.inputNames.find((function(e){return void 0!==pz(e,n,r)})),!b){e.next=50;break}return x=pz(b,n,r),e.abrupt("return",[xz(x)]);case 50:return e.abrupt("return",void 0);case 51:return w=fz("frameName",t,n,r),k=fz("tensor",t,n,r),r.enterFrame(w),e.abrupt("return",[xz(k)]);case 55:return S=fz("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[xz(S)]);case 58:return C=fz("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[xz(C)]);case 61:return I=fz("size",t,n,r),_=fz("dtype",t,n,r),E=fz("elementShape",t,n,r),N=fz("dynamicSize",t,n,r),R=fz("clearAfterRead",t,n,r),A=fz("identicalElementShapes",t,n,r),O=fz("name",t,n,r),D=new oB(O,_,I,E,A,N,R),r.addTensorArray(D),e.abrupt("return",[D.idTensor,GR(1)]);case 71:return P=fz("tensorArrayId",t,n,r),M=fz("index",t,n,r),L=fz("tensor",t,n,r),(F=r.getTensorArray(P.id)).write(M,L),e.abrupt("return",[F.idTensor]);case 77:return z=fz("tensorArrayId",t,n,r),B=fz("index",t,n,r),V=r.getTensorArray(z.id),e.abrupt("return",[V.read(B)]);case 81:return U=fz("tensorArrayId",t,n,r),W=fz("indices",t,n,r),j=fz("dtype",t,n,r),G=r.getTensorArray(U.id),e.abrupt("return",[G.gather(W,j)]);case 86:return H=fz("tensorArrayId",t,n,r),K=fz("indices",t,n,r),q=fz("tensor",t,n,r),(Z=r.getTensorArray(H.id)).scatter(K,q),e.abrupt("return",[Z.idTensor]);case 92:return X=fz("tensorArrayId",t,n,r),Y=r.getTensorArray(X.id),Q=fz("dtype",t,n,r),e.abrupt("return",[Y.concat(Q)]);case 96:return $=fz("tensorArrayId",t,n,r),J=fz("tensor",t,n,r),ee=fz("lengths",t,n,r),(te=r.getTensorArray($.id)).split(ee,J),e.abrupt("return",[te.idTensor]);case 102:return ne=fz("tensorArrayId",t,n,r),re=r.getTensorArray(ne.id),e.abrupt("return",[GR(re.size(),"int32")]);case 105:return ae=fz("tensorArrayId",t,n,r),(ie=r.getTensorArray(ae.id)).clearAndClose(),e.abrupt("return",[ie.idTensor]);case 109:return oe=fz("tensorListId",t,n,r),se=fz("index",t,n,r),ue=fz("tensor",t,n,r),(ce=r.getTensorList(oe.id)).setItem(se,ue),e.abrupt("return",[ce.idTensor]);case 115:return le=fz("tensorListId",t,n,r),he=fz("index",t,n,r),de=fz("elementShape",t,n,r),fe=fz("elementDType",t,n,r),pe=r.getTensorList(le.id),e.abrupt("return",[pe.getItem(he,de,fe)]);case 121:return me=fz("indices",t,n,r),ve=fz("tensor",t,n,r),ge=fz("elementShape",t,n,r),ye=fz("numElements",t,n,r),be=lB(ve,me,ge,ye),r.addTensorList(be),e.abrupt("return",[be.idTensor]);case 128:return xe=fz("elementShape",t,n,r),we=fz("elementDType",t,n,r),ke="TensorListReserve"===t.op?"numElements":"maxNumElements",Se=fz(ke,t,n,r),Ce="TensorListReserve"===t.op?-1:Se,Ie=cB(xe,we,0,Ce),r.addTensorList(Ie),e.abrupt("return",[Ie.idTensor]);case 136:return Te=fz("tensorListId",t,n,r),_e=fz("indices",t,n,r),Ee=fz("elementShape",t,n,r),Ne=fz("elementDType",t,n,r),Re=r.getTensorList(Te.id),e.abrupt("return",[Re.gather(_e,Ne,Ee)]);case 142:return Ae=fz("tensorListId",t,n,r),Oe=fz("elementShape",t,n,r),De=fz("elementDType",t,n,r),Pe=fz("numElements",t,n,r),Me=r.getTensorList(Ae.id),e.abrupt("return",[Me.stack(Oe,De,Pe)]);case 148:return Le=fz("tensor",t,n,r),Fe=fz("elementShape",t,n,r),ze=fz("elementDType",t,n,r),Be=uB(Le,Fe,ze),r.addTensorList(Be),e.abrupt("return",[Be.idTensor]);case 154:return Ve=fz("tensorListId",t,n,r),Ue=r.getTensorList(Ve.id),We=fz("dtype",t,n,r),je=fz("elementShape",t,n,r),e.abrupt("return",[Ue.concat(We,je)]);case 159:return Ge=fz("tensorListId",t,n,r),He=fz("tensor",t,n,r),(Ke=r.getTensorList(Ge.id)).pushBack(He),e.abrupt("return",[Ke.idTensor]);case 164:return qe=fz("tensorListId",t,n,r),Ze=fz("elementShape",t,n,r),Xe=fz("elementDType",t,n,r),Ye=r.getTensorList(qe.id),e.abrupt("return",[Ye.popBack(Ze,Xe)]);case 169:return Qe=fz("tensor",t,n,r),$e=fz("elementShape",t,n,r),Je=fz("lengths",t,n,r),et=hB(Qe,Je,$e),r.addTensorList(et),e.abrupt("return",[et.idTensor]);case 175:return tt=fz("tensorListId",t,n,r),nt=r.getTensorList(tt.id),e.abrupt("return",[GR(nt.size(),"int32")]);case 178:return rt=fz("tensorListId",t,n,r),at=fz("size",t,n,r),it=r.getTensorList(rt.id),ot=it.resize(at),r.addTensorList(ot),e.abrupt("return",[ot.idTensor]);case 184:throw TypeError("Node type ".concat(t.op," is not implemented"));case 185:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function fB(e,t,n){var r=fz("fusedOps",e,t,n),a=(0,U.Z)(r,2),i=a[0],o=a[1],s="biasadd"===i,u=!s,c="prelu"===o,l="fusedbatchnorm"===i,h=fz("numArgs",e,t,n);if(s){if(c&&2!==h)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&s&&1!==h)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var d=fz("strides",e,t,n),f=bz(e,t,n),p=fz("dataFormat",e,t,n).toUpperCase(),m=fz("dilations",e,t,n),v=fz("args",e,t,n),g=(0,U.Z)(v,2),y=g[0],b=g[1];return u&&(b=y,y=void 0),{stride:d,pad:f,dataFormat:p,dilations:m,biasArg:y,preluArg:b,activationFunc:o,leakyreluAlpha:fz("leakyreluAlpha",e,t,n)}}function pB(e,t,n){return{boxes:fz("boxes",e,t,n),scores:fz("scores",e,t,n),maxOutputSize:fz("maxOutputSize",e,t,n),iouThreshold:fz("iouThreshold",e,t,n),scoreThreshold:fz("scoreThreshold",e,t,n),softNmsSigma:fz("softNmsSigma",e,t,n)}}var mB=function(){var e=N(T().mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,S,C,I,_,E,N,R,A,O=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=O.length>4&&void 0!==O[4]?O[4]:k,e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?4:"NonMaxSuppressionV4"===e.t0?9:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?15:"Where"===e.t0?20:"ListDiff"===e.t0?27:28;break;case 4:return o=pB(t,n,r),s=o.boxes,u=o.scores,c=o.maxOutputSize,l=o.iouThreshold,h=o.scoreThreshold,d=o.softNmsSigma,e.next=7,i.image.nonMaxSuppressionWithScoreAsync(s,u,c,l,h,d);case 7:return f=e.sent,e.abrupt("return",[f.selectedIndices,f.selectedScores]);case 9:return p=pB(t,n,r),m=p.boxes,v=p.scores,g=p.maxOutputSize,y=p.iouThreshold,b=p.scoreThreshold,x=fz("padToMaxOutputSize",t,n,r),e.next=13,i.image.nonMaxSuppressionPaddedAsync(m,v,g,y,b,x);case 13:return w=e.sent,e.abrupt("return",[w.selectedIndices,w.validOutputs]);case 15:return S=pB(t,n,r),C=S.boxes,I=S.scores,_=S.maxOutputSize,E=S.iouThreshold,N=S.scoreThreshold,e.next=18,i.image.nonMaxSuppressionAsync(C,I,_,E,N);case 18:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 20:return R=i.cast(fz("condition",t,n,r),"bool"),e.next=23,i.whereAsync(R);case 23:return e.t2=e.sent,A=[e.t2],R.dispose(),e.abrupt("return",A);case 27:return e.abrupt("return",i.setdiff1dAsync(fz("x",t,n,r),fz("y",t,n,r)));case 28:throw TypeError("Node type ".concat(t.op," is not implemented"));case 29:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),vB=function(){function e(t,n){Se(this,e),this.keyDType=t,this.valueDType=n,this.handle=GR(0),this.tensorMap=new Map,OR(this.handle)}return Te(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return GR(this.size(),"int32")}},{key:"import",value:function(){var e=N(T().mark((function e(t,n){var r,a=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",RR((function(){var e=WM(n),t=r.length,i=e.length;YS(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<t;o++){var s=r[o],u=e[o];OR(u),a.tensorMap.set(s,u)}return a.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=N(T().mark((function e(t,n){var r,a=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",RR((function(){for(var e=[],t=0;t<r.length;t++){var i=r[t],o=a.findWithDefault(i,n);e.push(o)}return TM(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),gB=function(){var e=N(T().mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p,m,v,g,y;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"InitializeTable"===e.t0||"InitializeTableV2"===e.t0||"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?13:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?21:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?29:32;break;case 3:if(null==(i=a.getHashTableHandleByName(t.name))){e.next=8;break}return e.abrupt("return",[i]);case 8:return o=fz("keyDType",t,n,r),s=fz("valueDType",t,n,r),u=new vB(o,s),a.addHashTable(t.name,u),e.abrupt("return",[u.handle]);case 13:return c=fz("tableHandle",t,n,r,a),l=fz("keys",t,n,r),h=fz("values",t,n,r),d=a.getHashTableById(c.id),e.next=19,d.import(l,h);case 19:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 21:return f=fz("tableHandle",t,n,r,a),p=fz("keys",t,n,r),m=fz("defaultValue",t,n,r),v=a.getHashTableById(f.id),e.next=27,v.find(p,m);case 27:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 29:return g=fz("tableHandle",t,n,r,a),y=a.getHashTableById(g.id),e.abrupt("return",[y.tensorSize()]);case 32:throw TypeError("Node type ".concat(t.op," is not implemented"));case 33:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}();function yB(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:RR,i=function(e,t,n){switch(e.category){case"arithmetic":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(fz("a",e,t,n),fz("b",e,t,n))];case"AddN":return[r.addN(fz("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(fz("a",e,t,n),fz("b",e,t,n))];case"Mul":return[r.mul(fz("a",e,t,n),fz("b",e,t,n))];case"RealDiv":case"Div":return[r.div(fz("a",e,t,n),fz("b",e,t,n))];case"DivNoNan":return[r.divNoNan(fz("a",e,t,n),fz("b",e,t,n))];case"FloorDiv":return[r.floorDiv(fz("a",e,t,n),fz("b",e,t,n))];case"Sub":return[r.sub(fz("a",e,t,n),fz("b",e,t,n))];case"Minimum":return[r.minimum(fz("a",e,t,n),fz("b",e,t,n))];case"Maximum":return[r.maximum(fz("a",e,t,n),fz("b",e,t,n))];case"Pow":return[r.pow(fz("a",e,t,n),fz("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(fz("a",e,t,n),fz("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(fz("x",e,t,n))];case"Acos":return[r.acos(fz("x",e,t,n))];case"Acosh":return[r.acosh(fz("x",e,t,n))];case"Asin":return[r.asin(fz("x",e,t,n))];case"Asinh":return[r.asinh(fz("x",e,t,n))];case"Atan":return[r.atan(fz("x",e,t,n))];case"Atan2":return[r.atan2(fz("x",e,t,n),fz("y",e,t,n))];case"Atanh":return[r.atanh(fz("x",e,t,n))];case"Ceil":return[r.ceil(fz("x",e,t,n))];case"Complex":return[r.complex(fz("real",e,t,n),fz("imag",e,t,n))];case"Cos":return[r.cos(fz("x",e,t,n))];case"Cosh":return[r.cosh(fz("x",e,t,n))];case"Elu":return[r.elu(fz("x",e,t,n))];case"Erf":return[r.erf(fz("x",e,t,n))];case"Exp":return[r.exp(fz("x",e,t,n))];case"Expm1":return[r.expm1(fz("x",e,t,n))];case"Floor":return[r.floor(fz("x",e,t,n))];case"Log":return[r.log(fz("x",e,t,n))];case"Log1p":return[r.log1p(fz("x",e,t,n))];case"Imag":return[r.imag(fz("x",e,t,n))];case"Neg":return[r.neg(fz("x",e,t,n))];case"Reciprocal":return[r.reciprocal(fz("x",e,t,n))];case"Real":return[r.real(fz("x",e,t,n))];case"Relu":return[r.relu(fz("x",e,t,n))];case"Round":return[r.round(fz("x",e,t,n))];case"Selu":return[r.selu(fz("x",e,t,n))];case"Sigmoid":return[r.sigmoid(fz("x",e,t,n))];case"Sin":return[r.sin(fz("x",e,t,n))];case"Sign":return[r.sign(fz("x",e,t,n))];case"Sinh":return[r.sinh(fz("x",e,t,n))];case"Softplus":return[r.softplus(fz("x",e,t,n))];case"Sqrt":return[r.sqrt(fz("x",e,t,n))];case"Square":return[r.square(fz("x",e,t,n))];case"Tanh":return[r.tanh(fz("x",e,t,n))];case"Tan":return[r.tan(fz("x",e,t,n))];case"ClipByValue":return[r.clipByValue(fz("x",e,t,n),fz("clipValueMin",e,t,n),fz("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(fz("x",e,t,n))];case"Rsqrt":return[r.rsqrt(pz(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(fz("x",e,t,n),fz("alpha",e,t,n))];case"Prelu":return[r.prelu(fz("x",e,t,n),fz("alpha",e,t,n))];case"IsNan":return[r.isNaN(pz(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(pz(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(pz(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return dB(e,t,n);case"convolution":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Conv1D":var a=fz("stride",e,t,n),i=fz("pad",e,t,n),o=fz("dataFormat",e,t,n).toUpperCase(),s=fz("dilation",e,t,n);return[r.conv1d(fz("x",e,t,n),fz("filter",e,t,n),a,i,o,s)];case"Conv2D":var u=fz("strides",e,t,n),c=bz(e,t,n),l=fz("dataFormat",e,t,n).toUpperCase(),h=fz("dilations",e,t,n);return[r.conv2d(fz("x",e,t,n),fz("filter",e,t,n),[u[1],u[2]],c,l,[h[1],h[2]])];case"_FusedConv2D":var d=fB(e,t,n),f=d.stride,p=d.pad,m=d.dataFormat,v=d.dilations,g=d.biasArg,y=d.preluArg,b=d.activationFunc,x=d.leakyreluAlpha;return[r.fused.conv2d({x:fz("x",e,t,n),filter:fz("filter",e,t,n),strides:[f[1],f[2]],pad:p,dataFormat:m,dilations:[v[1],v[2]],bias:g,activation:b,preluActivationWeights:y,leakyreluAlpha:x})];case"FusedDepthwiseConv2dNative":var w=fB(e,t,n),S=w.stride,C=w.pad,I=w.dataFormat,T=w.dilations,_=w.biasArg,E=w.preluArg,N=w.activationFunc,R=w.leakyreluAlpha;return[r.fused.depthwiseConv2d({x:fz("x",e,t,n),filter:fz("filter",e,t,n),strides:[S[1],S[2]],pad:C,dataFormat:I,dilations:[T[1],T[2]],bias:_,activation:N,preluActivationWeights:E,leakyreluAlpha:R})];case"Conv2DBackpropInput":case"Conv2dTranspose":var A=fz("outputShape",e,t,n),O=fz("strides",e,t,n),D=bz(e,t,n);return[r.conv2dTranspose(fz("x",e,t,n),fz("filter",e,t,n),A,[O[1],O[2]],D)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var P=fz("strides",e,t,n),M=bz(e,t,n),L=fz("dilations",e,t,n),F=fz("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(fz("input",e,t,n),fz("filter",e,t,n),[P[1],P[2]],M,F,[L[1],L[2]])];case"Conv3D":var z=fz("strides",e,t,n),B=fz("pad",e,t,n),V=fz("dataFormat",e,t,n).toUpperCase(),U=fz("dilations",e,t,n);return[r.conv3d(fz("x",e,t,n),fz("filter",e,t,n),[z[1],z[2],z[3]],B,V,[U[1],U[2],U[3]])];case"AvgPool":var W=fz("strides",e,t,n),j=fz("pad",e,t,n),G=fz("kernelSize",e,t,n);return[r.avgPool(fz("x",e,t,n),[G[1],G[2]],[W[1],W[2]],j)];case"MaxPool":var H=fz("strides",e,t,n),K=fz("pad",e,t,n),q=fz("kernelSize",e,t,n);return[r.maxPool(fz("x",e,t,n),[q[1],q[2]],[H[1],H[2]],K)];case"MaxPoolWithArgmax":var Z=fz("strides",e,t,n),X=fz("pad",e,t,n),Y=fz("kernelSize",e,t,n),Q=fz("includeBatchInIndex",e,t,n),$=r.maxPoolWithArgmax(fz("x",e,t,n),[Y[1],Y[2]],[Z[1],Z[2]],X,Q);return[$.result,$.indexes];case"AvgPool3D":var J=fz("strides",e,t,n),ee=fz("pad",e,t,n),te=fz("kernelSize",e,t,n);return[r.avgPool3d(fz("x",e,t,n),[te[1],te[2],te[3]],[J[1],J[2],J[3]],ee)];case"MaxPool3D":var ne=fz("strides",e,t,n),re=fz("pad",e,t,n),ae=fz("kernelSize",e,t,n);return[r.maxPool3d(fz("x",e,t,n),[ae[1],ae[2],ae[3]],[ne[1],ne[2],ne[3]],re)];case"Dilation2D":var ie=fz("strides",e,t,n),oe=fz("pad",e,t,n),se=fz("dilations",e,t,n),ue=ie[1],ce=ie[2],le=se[1],he=se[2];return[r.dilation2d(fz("x",e,t,n),fz("filter",e,t,n),[ue,ce],oe,[le,he],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Fill":var a=fz("shape",e,t,n),i=fz("dtype",e,t,n),o=fz("value",e,t,n);return[r.fill(a,o,i)];case"LinSpace":var s=fz("start",e,t,n),u=fz("stop",e,t,n),c=fz("num",e,t,n);return[r.linspace(s,u,c)];case"Multinomial":var l=fz("logits",e,t,n),h=fz("numSamples",e,t,n),d=fz("seed",e,t,n);return[r.multinomial(l,h,d)];case"OneHot":var f=fz("indices",e,t,n),p=fz("depth",e,t,n),m=fz("onValue",e,t,n),v=fz("offValue",e,t,n),g=fz("dtype",e,t,n);return[r.oneHot(f,p,m,v,g)];case"Ones":return[r.ones(fz("shape",e,t,n),fz("dtype",e,t,n))];case"OnesLike":return[r.onesLike(fz("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(fz("shape",e,t,n),fz("dtype",e,t,n),fz("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(fz("shape",e,t,n),fz("minval",e,t,n),fz("maxval",e,t,n),fz("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(fz("shape",e,t,n),fz("minval",e,t,n),fz("maxval",e,t,n),fz("seed",e,t,n))];case"Range":var y=fz("start",e,t,n),b=fz("stop",e,t,n),x=fz("step",e,t,n);return[r.range(y,b,x,fz("dtype",e,t,n))];case"TruncatedNormal":var w=fz("shape",e,t,n),S=fz("mean",e,t,n),C=fz("stdDev",e,t,n),I=fz("seed",e,t,n);return[r.truncatedNormal(w,S,C,fz("dtype",e,t,n),I)];case"Zeros":return[r.zeros(fz("shape",e,t,n),fz("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(fz("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return mB(e,t,n);case"evaluation":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"LowerBound":var a=fz("sortedSequence",e,t,n),i=fz("values",e,t,n);return[r.lowerBound(a,i)];case"TopKV2":var o=fz("x",e,t,n),s=fz("k",e,t,n),u=fz("sorted",e,t,n),c=r.topk(o,s,u);return[c.values,c.indices];case"UpperBound":var l=fz("sortedSequence",e,t,n),h=fz("values",e,t,n);return[r.upperBound(l,h)];case"Unique":var d=fz("x",e,t,n),f=r.unique(d);return[f.values,f.indices];case"UniqueV2":var p=fz("x",e,t,n),m=fz("axis",e,t,n),v=r.unique(p,m);return[v.values,v.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"ResizeBilinear":var a=fz("images",e,t,n),i=fz("size",e,t,n),o=fz("alignCorners",e,t,n),s=fz("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)];case"ResizeNearestNeighbor":var u=fz("images",e,t,n),c=fz("size",e,t,n),l=fz("alignCorners",e,t,n),h=fz("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(u,[c[0],c[1]],l,h)];case"CropAndResize":var d=fz("image",e,t,n),f=fz("boxes",e,t,n),p=fz("boxInd",e,t,n),m=fz("cropSize",e,t,n),v=fz("method",e,t,n),g=fz("extrapolationValue",e,t,n);return[r.image.cropAndResize(d,f,p,m,v,g)];case"ImageProjectiveTransformV3":var y=fz("images",e,t,n),b=fz("transforms",e,t,n),x=fz("outputShape",e,t,n),w=fz("fillValue",e,t,n),S=fz("interpolation",e,t,n),C=fz("fillMode",e,t,n);return[r.image.transform(y,b,S.toLowerCase(),C.toLowerCase(),w,x)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var a=fz("default",e,t,n);return[pz(e.name,t,n)||a];case"Placeholder":return[pz(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[xz(fz("x",e,t,n))];case"IdentityN":return fz("x",e,t,n).map((function(e){return xz(e)}));case"Shape":return[r.tensor1d(fz("x",e,t,n).shape,"int32")];case"ShapeN":return fz("x",e,t,n).map((function(e){return r.tensor1d(e.shape)}));case"Size":return[r.scalar(fz("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(fz("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":var i=fz("x",e,t,n),o=fz("data",e,t,n),s=fz("message",e,t,n),u=fz("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[i];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Equal":return[r.equal(fz("a",e,t,n),fz("b",e,t,n))];case"NotEqual":return[r.notEqual(fz("a",e,t,n),fz("b",e,t,n))];case"Greater":return[r.greater(fz("a",e,t,n),fz("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(fz("a",e,t,n),fz("b",e,t,n))];case"Less":return[r.less(fz("a",e,t,n),fz("b",e,t,n))];case"LessEqual":return[r.lessEqual(fz("a",e,t,n),fz("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(fz("a",e,t,n),fz("b",e,t,n))];case"LogicalNot":return[r.logicalNot(fz("a",e,t,n))];case"LogicalOr":return[r.logicalOr(fz("a",e,t,n),fz("b",e,t,n))];case"Select":case"SelectV2":return[r.where(fz("condition",e,t,n),fz("a",e,t,n),fz("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(fz("a",e,t,n),fz("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(fz("a",e,t,n),fz("b",e,t,n),fz("transposeA",e,t,n),fz("transposeB",e,t,n))];case"Einsum":return[r.einsum.apply(r,[fz("equation",e,t,n)].concat((0,ke.Z)(fz("tensors",e,t,n))))];case"Transpose":return[r.transpose(fz("x",e,t,n),fz("perm",e,t,n))];case"_FusedMatMul":var a=fz("fusedOps",e,t,n),i=(0,U.Z)(a,2),o=i[0],s=i[1],u="biasadd"===o,c="prelu"===s,l=fz("numArgs",e,t,n),h=fz("leakyreluAlpha",e,t,n);if(u){if(c&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var d=fz("args",e,t,n),f=(0,U.Z)(d,2),p=f[0],m=f[1];return[r.fused.matMul({a:fz("a",e,t,n),b:fz("b",e,t,n),transposeA:fz("transposeA",e,t,n),transposeB:fz("transposeB",e,t,n),bias:p,activation:s,preluActivationWeights:m,leakyreluAlpha:h})];case"MatrixBandPart":return[r.linalg.bandPart(fz("a",e,t,n),fz("numLower",e,t,n),fz("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(fz("x",e,t,n),fz("axis",e,t,n),fz("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(fz("x",e,t,n),fz("mean",e,t,n),fz("variance",e,t,n),fz("offset",e,t,n),fz("scale",e,t,n),fz("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(fz("x",e,t,n),fz("radius",e,t,n),fz("bias",e,t,n),fz("alpha",e,t,n),fz("beta",e,t,n))];case"Softmax":return[r.softmax(fz("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(fz("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"ragged":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"RaggedGather":var a=r.raggedGather(fz("paramsNestedSplits",e,t,n),fz("paramsDenseValues",e,t,n),fz("indices",e,t,n),fz("outputRaggedRank",e,t,n)),i=a.outputNestedSplits,o=a.outputDenseValues;return i.concat(o);case"RaggedRange":var s=r.raggedRange(fz("starts",e,t,n),fz("limits",e,t,n),fz("splits",e,t,n));return[s.rtNestedSplits,s.rtDenseValues];case"RaggedTensorToTensor":return[r.raggedTensorToTensor(fz("shape",e,t,n),fz("values",e,t,n),fz("defaultValue",e,t,n),fz("rowPartitionTensors",e,t,n),fz("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Max":var a=fz("axis",e,t,n),i=fz("keepDims",e,t,n);return[r.max(fz("x",e,t,n),a,i)];case"Mean":var o=fz("axis",e,t,n),s=fz("keepDims",e,t,n);return[r.mean(fz("x",e,t,n),o,s)];case"Min":var u=fz("axis",e,t,n),c=fz("keepDims",e,t,n);return[r.min(fz("x",e,t,n),u,c)];case"Sum":var l=fz("axis",e,t,n),h=fz("keepDims",e,t,n);return[r.sum(fz("x",e,t,n),l,h)];case"All":var d=fz("axis",e,t,n),f=fz("keepDims",e,t,n);return[r.all(fz("x",e,t,n),d,f)];case"Any":var p=fz("axis",e,t,n),m=fz("keepDims",e,t,n);return[r.any(fz("x",e,t,n),p,m)];case"ArgMax":var v=fz("axis",e,t,n);return[r.argMax(fz("x",e,t,n),v)];case"ArgMin":var g=fz("axis",e,t,n);return[r.argMin(fz("x",e,t,n),g)];case"Prod":var y=fz("axis",e,t,n),b=fz("keepDims",e,t,n);return[r.prod(fz("x",e,t,n),y,b)];case"Cumprod":var x=fz("axis",e,t,n),w=fz("exclusive",e,t,n),S=fz("reverse",e,t,n);return[r.cumprod(fz("x",e,t,n),x,w,S)];case"Cumsum":var C=fz("axis",e,t,n),I=fz("exclusive",e,t,n),T=fz("reverse",e,t,n);return[r.cumsum(fz("x",e,t,n),C,I,T)];case"Bincount":var _=fz("x",e,t,n),E=fz("weights",e,t,n),N=fz("size",e,t,n);return[r.bincount(_,E,N)];case"DenseBincount":var R=fz("x",e,t,n),A=fz("weights",e,t,n),O=fz("size",e,t,n),D=fz("binaryOutput",e,t,n);return[r.denseBincount(R,A,O,D)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"ConcatV2":case"Concat":var a=fz("n",e,t,n),i=fz("axis",e,t,n),o=fz("tensors",e,t,n);return o=o.slice(0,a),[r.concat(o,i)];case"Gather":var s=fz("x",e,t,n),u=fz("indices",e,t,n);return[r.gather(s,r.cast(u,"int32"),0)];case"GatherV2":var c=fz("axis",e,t,n),l=fz("batchDims",e,t,n),h=fz("x",e,t,n),d=fz("indices",e,t,n);return[r.gather(h,r.cast(d,"int32"),c,l)];case"Reverse":for(var f=fz("dims",e,t,n),p=[],m=0;m<f.length;m++)f[m]&&p.push(m);var v=fz("x",e,t,n);return[r.reverse(v,p)];case"ReverseV2":var g=fz("axis",e,t,n),y=fz("x",e,t,n);return[r.reverse(y,g)];case"Slice":var b=fz("begin",e,t,n),x=fz("size",e,t,n);return[r.slice(fz("x",e,t,n),b,x)];case"StridedSlice":var w=fz("begin",e,t,n),S=fz("end",e,t,n),C=fz("strides",e,t,n),I=fz("beginMask",e,t,n),T=fz("endMask",e,t,n),_=fz("ellipsisMask",e,t,n),E=fz("newAxisMask",e,t,n),N=fz("shrinkAxisMask",e,t,n),R=fz("x",e,t,n);return[r.stridedSlice(R,w,S,C,I,T,_,E,N)];case"Pack":return RR((function(){var a=fz("axis",e,t,n),i=fz("tensors",e,t,n),o=i[0].shape,s=r.squeeze(i[0]).shape,u=i.map((function(e){var t=tC(e.shape,o);if(!t&&!tC(r.squeeze(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,o)}));return[r.stack(u,a)]}));case"Unpack":var A=fz("axis",e,t,n),O=fz("tensor",e,t,n);return r.unstack(O,A);case"Tile":var D=fz("reps",e,t,n);return[r.tile(fz("x",e,t,n),D)];case"Split":case"SplitV":var P=fz("axis",e,t,n),M=fz("numOrSizeSplits",e,t,n),L=fz("x",e,t,n);return r.split(L,M,P);case"ScatterNd":var F=fz("indices",e,t,n),z=fz("values",e,t,n),B=fz("shape",e,t,n);return[r.scatterND(F,z,B)];case"GatherNd":var V=fz("x",e,t,n),U=fz("indices",e,t,n);return[r.gatherND(V,U)];case"SparseToDense":var W=fz("sparseIndices",e,t,n),j=fz("outputShape",e,t,n),G=fz("sparseValues",e,t,n),H=fz("defaultValue",e,t,n);return[r.sparseToDense(W,G,j,G.dtype===H.dtype?H:r.cast(H,G.dtype))];case"TensorScatterUpdate":var K=fz("indices",e,t,n),q=fz("values",e,t,n),Z=fz("tensor",e,t,n);return[r.tensorScatterUpdate(Z,K,q)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"sparse":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"SparseFillEmptyRows":var a=r.sparse.sparseFillEmptyRows(fz("indices",e,t,n),fz("values",e,t,n),fz("denseShape",e,t,n),fz("defaultValue",e,t,n));return[a.outputIndices,a.outputValues,a.emptyRowIndicator,a.reverseIndexMap];case"SparseReshape":var i=r.sparse.sparseReshape(fz("inputIndices",e,t,n),fz("inputShape",e,t,n),fz("newShape",e,t,n));return[i.outputIndices,i.outputShape];case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(fz("data",e,t,n),fz("indices",e,t,n),fz("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(fz("data",e,t,n),fz("indices",e,t,n),fz("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"FFT":return[r.fft(fz("x",e,t,n))];case"IFFT":return[r.ifft(fz("x",e,t,n))];case"RFFT":return[r.rfft(fz("x",e,t,n))];case"IRFFT":return[r.irfft(fz("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"string":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(fz("input",e,t,n),fz("pattern",e,t,n),fz("rewrite",e,t,n),fz("replaceGlobal",e,t,n))];case"StringNGrams":var a=r.string.stringNGrams(fz("data",e,t,n),fz("dataSplits",e,t,n),fz("separator",e,t,n),fz("nGramWidths",e,t,n),fz("leftPad",e,t,n),fz("rightPad",e,t,n),fz("padWidth",e,t,n),fz("preserveShortSequences",e,t,n));return[a.nGrams,a.nGramsSplits];case"StringSplit":var i=r.string.stringSplit(fz("input",e,t,n),fz("delimiter",e,t,n),fz("skipEmpty",e,t,n));return[i.indices,i.values,i.shape];case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(fz("input",e,t,n),fz("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return a((function(){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(e.op){case"Cast":return[r.cast(fz("x",e,t,n),fz("dtype",e,t,n))];case"ExpandDims":var a=fz("axis",e,t,n);return[r.expandDims(fz("x",e,t,n),a)];case"Squeeze":var i=fz("axis",e,t,n);return[r.squeeze(fz("x",e,t,n),i)];case"Reshape":return[r.reshape(fz("x",e,t,n),fz("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(fz("x",e,t,n),fz("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(fz("x",e,t,n),fz("padding",e,t,n),fz("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(fz("x",e,t,n),fz("padding",e,t,n),fz("constantValue",e,t,n))];case"SpaceToBatchND":var o=fz("blockShape",e,t,n),s=fz("paddings",e,t,n);return[r.spaceToBatchND(fz("x",e,t,n),o,s)];case"BatchToSpaceND":var u=fz("blockShape",e,t,n),c=fz("crops",e,t,n);return[r.batchToSpaceND(fz("x",e,t,n),u,c)];case"DepthToSpace":var l=fz("blockSize",e,t,n),h=fz("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(fz("x",e,t,n),l,h)];case"BroadcastTo":return[r.broadcastTo(fz("x",e,t,n),fz("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(fz("s0",e,t,n),fz("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"hash_table":return gB(e,t,n,r);case"custom":var i=dz(e.op);if(i&&i.customExecutor)return i.customExecutor(new tB(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return TC(i)?i.then((function(e){return[].concat(e)})):[].concat(i)}var bB=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;Se(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return Te(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function xB(e,t,n,r){var a=new Set,i=[],o=null,s=null,u=new Set,c=new Set(Object.keys(e).map((function(e){return yz(e)[0]})));r=r||[];for(var l=new Set(r.map((function(e){return yz(e.name)[0]}))),h=(0,ke.Z)(t);h.length>0;){var d=h.pop();(TB(d)||_B(d)||EB(d))&&null==o&&(s=(o=d).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(d.name),null==n[d.name]&&(c.has(d.name)||l.has(d.name)||(0!==d.inputs.length?d.inputs.forEach((function(e){u.has(e.name)||(u.add(e.name),h.push(e))})):i.push(d.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}function wB(e,t){var n=t.usedNodes,r=t.inputs,a=Object.keys(r).map((function(e){return yz(e)[0]})).map((function(t){return e.nodes[t]})),i=e.initNodes||[],o=function(e){return n.has("string"===typeof e?e:e.name)};function s(e){return(0,ke.Z)(new Map(e.map((function(e){return[e.name,e]}))).values())}var u,c=s([].concat((0,ke.Z)(a),(0,ke.Z)(e.weights),(0,ke.Z)(i))).filter(o),l=s([].concat((0,ke.Z)(c),(0,ke.Z)(Object.values(e.nodes)))).filter(o),h=new Map(l.map((function(e){return[e.name,e]}))),d={},f=ye(l);try{for(f.s();!(u=f.n()).done;){var p=u.value;d[p.name]=d[p.name]||0;var m,v=ye(p.children);try{for(v.s();!(m=v.n()).done;){var g=m.value;o(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}}catch(N8){v.e(N8)}finally{v.f()}}}catch(N8){f.e(N8)}finally{f.f()}for(var y=Object.entries(d).filter((function(e){return 0===(0,U.Z)(e,2)[1]})).map((function(e){return(0,U.Z)(e,1)[0]})),b=(0,ke.Z)(y);y.length>0;){var x,w=y.pop(),k=ye(h.get(w).children.filter(o));try{for(k.s();!(x=k.n()).done;){var S=x.value;0===--d[S.name]&&(b.push(S.name),y.push(S.name))}}catch(N8){k.e(N8)}finally{k.f()}}var C=function(e,t){var n=new Map(e.map((function(e){return[e.name,e]}))),r=t.map((function(e){return e.name})),a=new Set(r);for(;r.length>0;){var i,o=r.pop(),s=ye(n.get(o).children);try{for(s.s();!(i=s.n()).done;){var u=i.value;n.has(u.name)&&!a.has(u.name)&&(a.add(u.name),r.push(u.name))}}catch(N8){s.e(N8)}finally{s.f()}}var c=e.filter((function(e){return a.has(e.name)}));return c}(b.map((function(e){return h.get(e)})),c);return function(e,t){var n,r=new Map(e.map((function(e,t){return[e.name,t]}))),a=new Set(t.map((function(e){return e.name}))),i=function(e){return a.has("string"===typeof e?e:e.name)},o=new Set(e.map((function(e){return e.name}))),s=function(e){return o.has("string"===typeof e?e:e.name)},u=ye(e);try{for(u.s();!(n=u.n()).done;){var c,l=n.value,h=ye(l.children.filter(s));try{for(h.s();!(c=h.n()).done;){var d=c.value;if(!r.has(d.name))throw new kB("Child ".concat(d.name," of node ").concat(l.name," is unreachable."));if(r.get(l.name)>r.get(d.name))throw new kB("Node ".concat(l.name," is scheduled to run after its child ").concat(d.name,"."))}}catch(N8){h.e(N8)}finally{h.f()}if(!i(l)){var f,p=ye(l.inputs);try{for(p.s();!(f=p.n()).done;){var m=f.value;if(!r.has(m.name))throw new kB("Input ".concat(m.name," of node ").concat(l.name," is unreachable."));if(r.get(m.name)>r.get(l.name))throw new kB("Node ".concat(l.name," is scheduled to run before its input ").concat(m.name,"."))}}catch(N8){p.e(N8)}finally{p.f()}}}}catch(N8){u.e(N8)}finally{u.f()}}(C,c),C}var kB=function(e){be(n,e);var t=we(n);function n(e){return Se(this,n),t.call(this,"NodesExecutionOrderError: ".concat(e))}return Te(n)}(ve(Error));var SB=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),CB=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),IB=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function TB(e){return SB.has(e.op)}function _B(e){return CB.has(e.op)}function EB(e){return IB.has(e.op)}var NB=function(){function e(t,n){var r=this;Se(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return Te(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,(0,ke.Z)(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}},{key:"compile",value:function(e,t){var n=xB(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}var u=wB(this.graph,n),c=function(e){for(var t=new Map(e.map((function(e,t){return[e.name,t]}))),n=Number.MAX_SAFE_INTEGER,r=e.map((function(e,t){return TB(e)?n:t})),a=function(e){var n=r[t.get(e.name)];return null==n?-1:n},i=e.map((function(e,t){return e.children.map(a).reduce((function(e,t){return Math.max(e,t)}),r[t])})),o=new Map,s=0;s<e.length;++s){var u=i[s];if(u!==n){var c=e[s],l=e[u];o.has(l.name)||o.set(l.name,[]),o.get(l.name).push(c)}}return o}(u);return{orderedNodes:u,nodeLiveUntilMap:c}}},{key:"cloneAndKeepTensor",value:function(e){if(null==e)return null;var t=e.clone();return OR(t),t}},{key:"cloneTensorList",value:function(e){var t=this;if(!e)return null;var n=e.map((function(e){return t.cloneAndKeepTensor(e)}));return n}},{key:"cloneTensorMap",value:function(e){var t=this;return Object.fromEntries(Object.entries(e).map((function(e){var n=(0,U.Z)(e,2),r=n[0],a=n[1];return[r,t.cloneTensorList(a)]})))}},{key:"execute",value:function(e,t){var n=this;this.disposeIntermediateTensors(),e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[yz(e)[0]]})),i=t.map((function(e){return yz(e)[0]})),o=new Set(i),s=i.map((function(e){return n.graph.nodes[e]}));0===s.length&&(s=this._outputs);var u=this.getCompilationKey(a,s),c=this.compiledMap.get(u);null==c&&(c=this.compile(e,s),this.compiledMap.set(u,c));try{this.keepIntermediateTensors=RC().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}var l={},h={};return RR((function(){var r=new bB(n.weightMap,l,h,n.functionExecutorMap,n.parseNodeNameCache),a=Object.assign({},n.weightMap);n.keepIntermediateTensors&&(n.clonedTensorsMap=n.cloneTensorMap(n.weightMap)),Object.keys(e).forEach((function(t){var i=yz(t,r),o=(0,U.Z)(i,2),s=o[0],u=[];u[o[1]]=e[t],a[s]=u,n.keepIntermediateTensors&&(n.clonedTensorsMap[s]=n.cloneTensorList(u))}));var i,s=n.getFrozenTensorIds(a),u=c,d=u.orderedNodes,f=u.nodeLiveUntilMap,p=ye(d);try{for(p.s();!(i=p.n()).done;){var m=i.value;if(!a[m.name]){var v=yB(m,a,r,n._resourceManager);if(TC(v))throw new Error("The execution of the op '".concat(m.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[m.name]=v,n.keepIntermediateTensors&&(n.clonedTensorsMap[m.name]=n.cloneTensorList(v)),n.checkTensorForDisposalWithNodeLiveUntilInfo(m,a,r,s,o,f.get(m.name))}}}catch(N8){p.e(N8)}finally{p.f()}return null==n.parent&&r.dispose(s),t.map((function(e){return pz(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){if(!TB(t)&&!i.has(e)){var s,u=ye(n[e]);try{for(u.s();!(s=u.n()).done;){var c=s.value;null!=c&&(o[c.id]=(o[c.id]||0)+t.children.length)}}catch(N8){u.e(N8)}finally{u.f()}var l,h=ye(t.inputs);try{for(h.s();!(l=h.n()).done;){var d=l.value;if(!TB(d)){var f=mz(d.name,n,r);if(null!=f){var p,m=ye(f);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(v&&!v.kept&&!a.has(v.id)){var g=o[v.id];1===g?(v.dispose(),delete o[v.id]):null!=g&&o[v.id]--}}}catch(N8){m.e(N8)}finally{m.f()}}}}}catch(N8){h.e(N8)}finally{h.f()}}}},{key:"checkTensorForDisposalWithNodeLiveUntilInfo",value:function(e,t,n,r,a,i){function o(e){return TB(e)||a.has(e.name)}if(!TB(e)&&null!=i){var s,u=ye(i);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(!o(c)){var l,h=ye(mz(c.name,t,n));try{for(h.s();!(l=h.n()).done;){var d=l.value;!d||d.kept||r.has(d.id)||d.dispose()}}catch(N8){h.e(N8)}finally{h.f()}}}}catch(N8){u.e(N8)}finally{u.f()}}}},{key:"executeAsync",value:function(){var e=N(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"disposeIntermediateTensors",value:function(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((function(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&!r.isDisposed&&r.dispose()}}catch(N8){n.e(N8)}finally{n.f()}})),this.clonedTensorsMap=null)}},{key:"getIntermediateTensors",value:function(){return this.clonedTensorsMap}},{key:"_executeAsync",value:function(){var e=N(T().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d.length>2&&void 0!==d[2]&&d[2],a=d.length>3&&void 0!==d[3]?d[3]:{},i=d.length>4&&void 0!==d[4]?d[4]:{},this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=RC().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}return o=new bB(this.weightMap,a,i,this.functionExecutorMap,this.parseNodeNameCache),this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),e.next=10,this.executeWithControlFlow(t,o,n,r);case 10:return s=e.sent,u=n.map((function(e){return pz(e,s,o)})),c=u.map((function(e){return e.id})),l=Object.keys(t).map((function(e){return t[e].id})),h=new Set([].concat((0,ke.Z)(c),(0,ke.Z)(l),(0,ke.Z)(this.weightIds))),Object.values(s).forEach((function(e){e.forEach((function(e){!e||e.isDisposed||h.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(h),e.abrupt("return",u);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=N(T().mark((function e(t,n,r){var a,i=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[i.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=N(T().mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,k,S=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return S.graph.nodes[yz(e)[0]]})),s=r.map((function(e){return yz(e)[0]})),u=new Set(s),0===(c=s.map((function(e){return S.graph.nodes[e]}))).length&&(c=this._outputs),l=xB(t,c,this.weightMap,this._initNodes),h=l.usedNodes,d=l.missingInputs,f=l.dynamicNode,p=l.syncInputs,m=[].concat((0,ke.Z)(o),(0,ke.Z)(this.graph.weights),(0,ke.Z)(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),v=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=yz(e),r=(0,U.Z)(n,2),a=r[0],i=[];i[r[1]]=t[e],v[a]=i})),g={},y=this.getFrozenTensorIds(v),b={};case 13:if(!(m.length>0)){e.next=19;break}return x=this.processStack(o,m,n,v,b,y,u,g,h),e.next=17,Promise.all(x);case 17:e.next=13;break;case 19:if(null!=f||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((w=c.filter((function(e){return!TB(e)&&!pz(e.name,v,n)})).map((function(e){return e.name}))).length>0)){e.next=25;break}throw k="",null!=f&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(p,"]")),new Error("Cannot compute the outputs [".concat(w,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(d,"]. ").concat(k));case 25:return e.abrupt("return",v);case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],h=function(){var e=t.pop();n.currentContext=e.contexts;var h="";if("Enter"===e.node.op&&fz("isConstant",e.node,r,n)){var d=vz(e.node.name,n),f=(0,U.Z)(d,1);h=f[0]}if(null==r[e.node.name]){var p=yB(e.node,r,n,c._resourceManager);if(!h){var m=vz(e.node.name,n),v=(0,U.Z)(m,1);h=v[0]}var g=n.currentContext;TC(p)?l.push(p.then((function(l){return r[h]=l,c.keepIntermediateTensors&&(c.clonedTensorsMap[h]=c.cloneTensorList(l)),n.currentContext=g,c.checkTensorForDisposal(h,e.node,r,n,i,o,s),c.processChildNodes(e.node,t,n,r,a,u),l}))):(r[h]=p,c.keepIntermediateTensors&&(c.clonedTensorsMap[h]=c.cloneTensorList(p)),c.checkTensorForDisposal(h,e.node,r,n,i,o,s),c.processChildNodes(e.node,t,n,r,a,u))}else c.processChildNodes(e.node,t,n,r,a,u)};t.length>0;)h();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=vz(e.name,n),s=(0,U.Z)(o,1)[0];!a[s]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!pz(e,r,n)}))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!pz(e,r,n)}))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=yz(n),i=(0,U.Z)(a,1)[0],o=t.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===r.shape.length&&r.shape.every((function(e,t){return-1===s[t]||s[t]===e}));YS(u,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(s,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&YS(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t,n,r={};for(var a in e){var i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=i?r[i.name]=e[a]:r[a]=e[a]}return r}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=yz(e),r=(0,U.Z)(n,1)[0];return null==t.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){var n,r,a=null===(r=null===(n=t._signature)||void 0===n?void 0:n.outputs)||void 0===r?void 0:r[e];return null!=a?a.name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=yz(e),r=(0,U.Z)(n,1)[0];if(!t.graph.nodes[r])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),RB=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Se(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return Te(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),AB="?tfjs-format=file",OB="model.json",DB=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;Se(this,t),this.modelUrl=n,this.loadOptions=r,this.version="n/a",this.io=a,null==r&&(this.loadOptions={}),this.resourceManager=new RB}return Te(t,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"modelStructuredOutputKeys",get:function(){return this.structuredOutputKeys}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{var t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=this;if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");var t=this.handler.load();return TC(t)?t.then((function(t){return e.loadSync(t)})):this.loadSync(t)}},{key:"loadSync",value:function(e){this.artifacts=e;var t=this.artifacts.modelTopology,n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){var r=this.artifacts.userDefinedMetadata;null!=r.signature&&(n=r.signature),null!=r.structuredOutputKeys&&(this.structuredOutputKeys=r.structuredOutputKeys)}this.signature=n,this.version="".concat(t.versions.producer,".").concat(t.versions.minConsumer);var a=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new NB(Vz.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var i=Vz.Instance.transformGraph(e.modelInitializer);this.initializer=new NB(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}},{key:"save",value:function(){var e=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=this.io.getSaveHandlers(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addStructuredOutputNames",value:function(e){var t=this;if(this.structuredOutputKeys){var n={};return(e instanceof DE?[e]:e).forEach((function(e,r){return n[t.structuredOutputKeys[r]]=e})),n}return e}},{key:"predict",value:function(e,t){var n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}},{key:"predictAsync",value:function(){var e=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.executeAsync(t,this.outputNodes);case 2:return r=e.sent,e.abrupt("return",this.addStructuredOutputNames(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"normalizeInputs",value:function(e){var t,n=this;if(!(e instanceof DE)&&!Array.isArray(e)){var r=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=r)for(var a in r){var i=r[a];null!=i.resourceId&&(e[a]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];var o=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+o!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-o," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));var s=0;return this.inputNodes.reduce((function(t,r){var a,i,o,u=null===(o=null===(i=null===(a=n.signature)||void 0===a?void 0:a.inputs)||void 0===i?void 0:i[r])||void 0===o?void 0:o.resourceId;return t[r]=null!=u?n.resourceIdToCapturedInput[u]:e[s++],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"executeInitializerGraph",value:function(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}},{key:"executeInitializerGraphAsync",value:function(){var e=N(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.initializer){e.next=2;break}return e.abrupt("return",[]);case 2:if(null!=this.initializerSignature){e.next=6;break}return e.abrupt("return",this.initializer.executeAsync({},[]));case 6:return e.abrupt("return",this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResourceIdToCapturedInput",value:function(e){if(this.resourceIdToCapturedInput={},this.initializerSignature)for(var t=this.initializerSignature.outputs,n=Object.keys(t),r=0;r<n.length;r++){var a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}},{key:"execute",value:function(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=N(T().mark((function e(t,n){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.resourceIdToCapturedInput){e.next=6;break}return e.t0=this,e.next=4,this.executeInitializerGraphAsync();case 4:e.t1=e.sent,e.t0.setResourceIdToCapturedInput.call(e.t0,e.t1);case 6:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=10,this.executor.executeAsync(t,n);case 10:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getIntermediateTensors",value:function(){return this.executor.getIntermediateTensors()}},{key:"disposeIntermediateTensors",value:function(){this.executor.disposeIntermediateTensors()}},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&AR(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}]),t}();function PB(e){return MB.apply(this,arguments)}function MB(){return MB=N(T().mark((function t(n){var r,a,i,o=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},a=o.length>2&&void 0!==o[2]?o[2]:e,null!=n){t.next=4;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 4:return null==r&&(r={}),r.fromTFHub&&"string"===typeof n&&(n=LB(n)),i=new DB(n,r,a),t.next=9,i.load();case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t)}))),MB.apply(this,arguments)}function LB(e){return e.endsWith("/")||(e+="/"),"".concat(e).concat(OB).concat(AB)}var FB=RC();FB.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",(function(){return 15})),FB.registerFlag("WEBGPU_CPU_FORWARD",(function(){return!0})),FB.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",(function(){return-1})),FB.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",(function(){return!0})),FB.registerFlag("WEBGPU_USE_LOW_POWER_GPU",(function(){return!1})),FB.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e3})),FB.registerFlag("WEBGPU_USE_PROFILE_TOOL",(function(){return!1})),FB.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",(function(){return!0})),FB.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",(function(){return!1})),FB.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",(function(){return 0})),FB.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",(function(){return!1})),FB.registerFlag("WEBGPU_PRINT_SHADER",(function(){return""})),FB.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",(function(){return!1}));var zB=function(){function e(t){Se(this,e),t&&(this.vendor=t.vendor,this.architecture=t.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}return Te(e,[{key:"getIntelGPUGeneration",value:function(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}},{key:"isIntel",value:function(){return"intel"===this.vendor}}]),e}(),BB=function(){function e(t){Se(this,e),this.device=t,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}return Te(e,[{key:"acquireBuffer",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=VB(e,t);return a?(this.freeBuffers.has(i)||this.freeBuffers.set(i,[]),this.freeBuffers.get(i).length>0?(n=this.freeBuffers.get(i).pop(),this.numFreeBuffers--):(n=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e)):(n=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(i)||this.usedBuffers.set(i,[]),this.usedBuffers.get(i).push(n),this.numUsedBuffers++,this.numBytesUsed+=e,n}},{key:"releaseBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==this.freeBuffers.size){var n=e.size,r=VB(n,e.usage),a=this.usedBuffers.get(r),i=a.indexOf(e);if(i<0)throw new Error("Cannot find the buffer in buffer manager");a[i]=a[a.length-1],a.pop(),this.numUsedBuffers--,this.numBytesUsed-=n,t?(this.freeBuffers.get(r).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=n)}}},{key:"getNumUsedBuffers",value:function(){return this.numUsedBuffers}},{key:"getNumFreeBuffers",value:function(){return this.numFreeBuffers}},{key:"dispose",value:function(){this.freeBuffers.forEach((function(e,t){e.forEach((function(e){e.destroy()}))})),this.usedBuffers.forEach((function(e,t){e.forEach((function(e){e.destroy()}))})),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}]),e}();function VB(e,t){return"".concat(e,"_").concat(t)}var UB=function(){function e(t){Se(this,e),this.device=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}return Te(e,[{key:"acquireTexture",value:function(e,t,n,r){var a=e*t*jB(n),i=WB(e,t,n,r);if(this.freeTextures.has(i)||this.freeTextures.set(i,[]),this.usedTextures.has(i)||this.usedTextures.set(i,[]),this.numBytesUsed+=a,this.numUsedTextures++,this.freeTextures.get(i).length>0){this.numFreeTextures--;var o=this.freeTextures.get(i).shift();return this.usedTextures.get(i).push(o),o}this.numBytesAllocated+=a;var s=this.device.createTexture({size:[e,t],format:n,usage:r});return this.usedTextures.get(i).push(s),s}},{key:"releaseTexture",value:function(e){if(0!==this.freeTextures.size){var t=e.width,n=e.height,r=e.format,a=WB(t,n,r,e.usage);this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.freeTextures.get(a).push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures.get(a),o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1);var s=t*n*jB(r);this.numBytesUsed-=s}}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){this.freeTextures.forEach((function(e,t){e.forEach((function(e){e.destroy()}))})),this.usedTextures.forEach((function(e,t){e.forEach((function(e){e.destroy()}))})),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}}]),e}();function WB(e,t,n,r){return"".concat(e,"_").concat(t,"_").concat(n,"_").concat(r)}function jB(e){if("rgba8unorm"===e)return 16;throw new Error("".concat(e," is not supported!"))}function GB(e,t){if(Math.max.apply(Math,(0,ke.Z)(e))>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");var n=e.length,r=e.map((function(e){return"".concat(t,".").concat("xyzwuv"[e])})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}var HB,KB=function(e,t,n){return"int32"===n?"atomicAdd(".concat(e,", bitcast<i32>(").concat(t,"));"):"\n          {\n            var oldValue = 0;\n            loop {\n              let newValueF32 = bitcast<f32>(oldValue) + (".concat(t,");\n              let newValue = bitcast<i32>(newValueF32);\n              let res = atomicCompareExchangeWeak(").concat(e,", oldValue, newValue);\n              if res.exchanged {\n                break;\n              }\n              oldValue = res.old_value;\n            }\n          }")};!function(e){e[e.FROM_PIXELS=0]="FROM_PIXELS",e[e.DRAW=1]="DRAW"}(HB||(HB={}));var qB=function(e,t,n,r,a){var i=function(e,t,n){var r,a,i=[],o=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,i.push("\n\n      var<private> localId: vec3<u32>;\n      var<private> localIndex: u32;\n      var<private> globalId: vec3<u32>;\n      var<private> numWorkgroups: vec3<u32>;\n      var<private> workgroupId: vec3<u32>;\n\n      // Only used when the y/z dimension of workgroup size is 1.\n      fn getGlobalIndex() -> i32 {\n        ".concat(rV(n)?"  return i32(globalId.x);":"  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +\n                workgroupId.y * numWorkgroups.x + workgroupId.x) * ".concat(o,"u +\n                localIndex);\n        "),"\n      }\n    ")),null!=n.pixelsOpType){var s=n.pixelsOpType===HB.FROM_PIXELS?"@group(0) @binding(0) var<storage, read_write> result: array<".concat(aV(t.dtype,n.outputComponent),">;"):"@group(0) @binding(1) var<storage, read> inBuf : array<".concat(aV(e[0].dtype,n.outputComponent),">;"),u=3===t.shape.length?"vec2<i32>":"i32";i.push("\n        struct Uniform {\n          outShapeStrides : ".concat(u,",\n          size            : i32,\n          numChannels     : i32,\n          alpha           : f32,\n        };\n\n        ").concat(s,"\n        @group(0) @binding(2) var<uniform> uniforms: Uniform;\n      "));var c=iV(n);return[JB,i.join("\n"),tV(t.shape),n.getUserCode(),$B(c,n)].join("\n")}var l="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((function(t,n){var i=XB(e[n].shape.length);l+="".concat(t.charAt(0).toLowerCase()+t.slice(1),"Shape : ").concat(i,", "),r=e[n].shape.length-1,a=XB(r),l+="".concat(t.charAt(0).toLowerCase()+t.slice(1),"ShapeStrides: ").concat(a,", ")}));var h=XB(t.shape.length);l+="outShape : ".concat(h,", "),r=t.shape.length-1,a=XB(r),l+="\n         outShapeStrides: ".concat(a,", "),n.size&&(l+="size : i32, ");n.uniforms&&(l+=n.uniforms);l=function(e){var t=/(\w+)\s*:\s*vec(5|6)/g;e=e.replace(t,(function(e){return"@align(16) "+e}));var n=/vec(5|6)\s*,\s*(\w+)/g;return e=e.replace(n,(function(e,t,n){return"vec".concat(t,", @align(16) ").concat(n)}))}(l+="};"),i.push(l),n.atomic?i.push("\n      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;\n    "):i.push("\n      @group(0) @binding(0) var<storage, read_write> result: array<".concat(aV(t.dtype,n.outputComponent),">;\n    "));n.variableNames.forEach((function(t,r){i.push("\n      @group(0) @binding(".concat(1+r,") var<storage, read> ").concat(t,": array<").concat(n.variableComponents?aV(e[r].dtype,n.variableComponents[r]):aV(e[r].dtype,n.outputComponent),">;\n        "))})),""!==l&&i.push("\n      @group(0) @binding(".concat(1+n.variableNames.length,") var<uniform> uniforms: Uniforms;\n      "));var d=function(e,t){var n=t.x,r=t.y,a=void 0===r?[]:r,i=t.z,o=void 0===i?[]:i,s=e.length,u=n.length+a.length+o.length;if(u!==s)return"";if(n.length===s){var c=XB(s);return"fn getOutputCoords() -> ".concat(c,"{\n    let globalIndex = getGlobalIndex();\n    return getCoordsFromIndex(globalIndex);\n  }\n  ")}for(var l="",h=[n,a,o],d=0;d<h.length;d++){var f=h[d];if(0!==f.length)if(1===f.length)l+="let d".concat(f[0]," = i32(globalId[").concat(d,"]);");else{var p=GB(f,"uniforms.outShape");l+="var index".concat(d," = i32(globalId[").concat(d,"]);");for(var m=0;m<p.length;m++)l+="let d".concat(f[m]," = index").concat(d," / ").concat(p[m],";"),m===p.length-1?l+="let d".concat(f[m+1]," = ")+"index".concat(d," - d").concat(f[m]," * ").concat(p[m],";"):l+="index".concat(d," = index").concat(d," - d").concat(f[m]," * ").concat(p[m],";")}}for(var v=[],g=0;g<u;g++)v.push("d".concat(g));var y=XB(u),b="fn getOutputCoords() -> ".concat(y," {\n  ").concat(l,"\n");0===v.length?b+="return ".concat(y,"(0); }"):b+="return ".concat(y,"(").concat(v.join(","),"); }");return b}(t.shape,n.dispatchLayout),f=[JB,i.join("\n")+eV,tV(t.shape),d,nV(t.shape.length)];n.atomic||f.push(function(e,t,n){var r=e.length,a=aV(t,n),i="fn setOutputAtIndex(flatIndex : i32, value : ".concat(ZB(n),") {\n      result[flatIndex] = ").concat(a,"(value);\n    }\n\n    fn setOutputAtIndexI32(flatIndex : i32, value : ").concat(ZB(n,"i32"),") {\n      result[flatIndex] = ").concat(a,"(value);\n    }\n    ");if(r>=2){var o=["d0","d1","d2","d3","d4","d5"].slice(0,r),s=XB(r);i+="\n      fn setOutputAtCoords(".concat(o.map((function(e){return"".concat(e," : i32")})).join(", "),", value : ").concat(ZB(n),") {\n        let flatIndex = getOutputIndexFromCoords(").concat(s,"(").concat(o.join(", "),"));\n        setOutputAtIndex(flatIndex").concat(1===n?"":" / ".concat(n),", value);\n      }\n      fn setOutputAtCoordsI32(").concat(o.map((function(e){return"".concat(e," : i32")})).join(", "),", value : ").concat(ZB(n,"i32"),") {\n        let flatIndex = getOutputIndexFromCoords(").concat(s,"(").concat(o.join(", "),"));\n        setOutputAtIndexI32(flatIndex").concat(1===n?"":" / ".concat(n),", value);\n      }\n    ")}return i}(t.shape,t.dtype,n.outputComponent));n.variableNames.forEach((function(t,n){f.push("".concat(tV(e[n].shape,t)))}));var p=e.map((function(e,r){return function(e,t,n,r){var a=function(e,t){var n=e.name,r=e.shape.length,a=XB(r),i="get"+n.charAt(0).toUpperCase()+n.slice(1),o=["d0","d1","d2","d3","d4","d5"].slice(0,r),s=o.map((function(e){return"".concat(e," : i32")})).join(", ");if(r<1)return"\n      fn ".concat(i,"() -> ").concat(ZB(t)," {\n        return ").concat(ZB(t),"(").concat(n,"[0]);\n      }\n    ");var u="uniforms.".concat(n.charAt(0).toLowerCase()+n.slice(1),"Shape"),c="".concat(r,"D");0===r&&(c="1D");return"\n    fn ".concat(i,"(").concat(s,") -> ").concat(ZB(t)," {\n      return ").concat(ZB(t),"(").concat(n,"[getIndexFromCoords").concat(c,"(").concat(a,"(").concat(o.join(","),"),\n        ").concat(u,")").concat(1===t?"":" / ".concat(t),"]);\n    }\n   ")}(e,n),i=e.shape;i.length<=t.length&&(a+=function(e,t,n,r){var a=e.name,i=a.charAt(0).toUpperCase()+a.slice(1),o="get"+i+"ByOutput",s=e.shape.length,u=t.length,c=XB(u);if(tC(e.shape,t)&&r)return"\n    fn ".concat(o,"Index(globalIndex : i32) -> ").concat(ZB(n)," {\n      return ").concat(ZB(n),"(").concat(a,"[globalIndex]);\n    }\n\n    fn ").concat(o,"Coords(coords : ").concat(c,") -> ").concat(ZB(n)," {\n      return ").concat(ZB(n),"(").concat(a,"[").concat(u>1?"getOutputIndexFromCoords(coords)":"coords").concat(1===n?"":" / ".concat(n),"]);\n    }\n    ");var l=aA(e.shape,t),h=u-s,d="";if(0===s)return"\n    fn ".concat(o,"Index(globalIndex : i32) -> ").concat(ZB(n),"{\n      return get").concat(i,"();\n    }\n\n    fn ").concat(o,"Coords(coords : ").concat(c,") -> ").concat(ZB(n),"{\n      return get").concat(i,"();\n    }\n  ");d=u<2&&l.length>=1?"coords = 0;":l.map((function(e){return"coords.".concat(YB(e+h)," = 0;")})).join("\n");var f="";if(u<2&&s>0)f="coords";else if(u>1){var p=XB(s),m=e.shape.map((function(e,t){return"coords.".concat(YB(t+h))})).join(", ");f="".concat(p,"(").concat(m,")")}else f="coords";var v="uniforms.".concat(a.charAt(0).toLowerCase()+a.slice(1),"Shape"),g="".concat(s,"D");return"\n  fn ".concat(o,"Index(globalIndex : i32) -> ").concat(ZB(n)," {\n    var coords = getCoordsFromIndex(globalIndex);\n    ").concat(d,"\n    return ").concat(ZB(n),"(").concat(a,"[getIndexFromCoords").concat(g,"(").concat(f,", ").concat(v,")").concat(1===n?"":" / ".concat(n),"]);\n  }\n\n  fn ").concat(o,"Coords(coordsIn : ").concat(c,") -> ").concat(ZB(n)," {\n    var coords = coordsIn;\n    ").concat(d,"\n    return ").concat(ZB(n),"(").concat(a,"[getIndexFromCoords").concat(g,"(").concat(f,", ").concat(v,")").concat(1===n?"":" / ".concat(n),"]);\n  }\n")}(e,t,n,r));return a}(e,t.shape,n.variableComponents?n.variableComponents[r]:n.outputComponent,n.dispatchLayout.x.length===t.shape.length)})).join("\n");f.push(p),f.push(n.getUserCode());var m=iV(n);f.push($B(m,n));var v=f.join("\n");return v}(n,{dtype:r.dtype,shape:r.shape},t),o=e.createShaderModule({code:i,label:t.constructor.name}),s=RC().get("WEBGPU_PRINT_SHADER");if(""!==s){var u=(s=s.toLowerCase()).split(",");("all"===s||u.some((function(e){return t.shaderKey.toLowerCase().includes(e)})))&&(console.group(t.shaderKey),console.debug(i),console.groupEnd())}return a?e.createComputePipelineAsync({compute:{module:o,entryPoint:"_start"},label:t.constructor.name,layout:"auto"}):e.createComputePipeline({compute:{module:o,entryPoint:"_start"},label:t.constructor.name,layout:"auto"})},ZB=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"f32";switch(e){case 1:return"".concat(t);case 2:return"vec2<".concat(t,">");case 3:return"vec3<".concat(t,">");case 4:return"vec4<".concat(t,">");default:throw new Error("".concat(e,"-component ").concat(t," is not supported."))}};function XB(e){if(e<=1)return"i32";if(2===e)return"vec2<i32>";if(3===e)return"vec3<i32>";if(4===e)return"vec4<i32>";if(5===e)return"vec5";if(6===e)return"vec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function YB(e){if(0===e)return"x";if(1===e)return"y";if(2===e)return"z";if(3===e)return"w";if(4===e)return"u";if(5===e)return"v";throw Error("Index ".concat(e," is not yet supported"))}function QB(){var e;switch(arguments.length){case 0:e="\n        fn main()\n      ";break;case 1:e="\n        fn main(".concat(arguments.length<=0?void 0:arguments[0]," : i32)\n      ");break;default:throw Error("Unreachable")}return e}function $B(e,t){var n;return n="\n     ".concat(function(e){return"\n  @compute @workgroup_size(".concat(e.workgroupSize[0],", ").concat(e.workgroupSize[1],", ").concat(e.workgroupSize[2],")\n")}(t),"\n      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,\n                @builtin(global_invocation_id) GlobalId : vec3<u32>,\n                @builtin(local_invocation_index) LocalIndex: u32,\n                @builtin(workgroup_id) WorkgroupId : vec3<u32>,\n                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {\n        localId = LocalId;\n        localIndex = LocalIndex;\n        globalId = GlobalId;\n        numWorkgroups = NumWorkgroups;\n        workgroupId = WorkgroupId;\n        ").concat(e?"main(getGlobalIndex());":"main();",";\n      }\n    "),n}var JB="\n  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};\n  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};\n\n  // Checks whether coordinates lie within the bounds of the shape.\n  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {\n    return all(coord >= vec2<i32>(0)) && all(coord < shape);\n  }\n  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {\n    return all(coord >= vec3<i32>(0)) && all(coord < shape);\n  }\n  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {\n    return all(coord >= vec4<i32>(0)) && all(coord < shape);\n  }\n\n  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {\n    return coord;\n  }\n  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {\n    return dot(coords, vec2<i32>(shape.y, 1));\n  }\n  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {\n    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));\n  }\n  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n    return dot(coords, vec4<i32>(\n        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n  }\n  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {\n    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);\n    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;\n  }\n  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {\n    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);\n    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;\n  }\n\n  // NaN defination in IEEE 754-1985 is :\n  //   - sign = either 0 or 1.\n  //   - biased exponent = all 1 bits.\n  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).\n  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers\n  fn isnan(val: f32) -> bool {\n    let floatToUint: u32 = bitcast<u32>(val);\n    return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n  }\n  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {\n    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);\n    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);\n  }\n",eV="\n  fn isinf(val: f32) -> bool {\n    return abs(val) == uniforms.INFINITY;\n  }\n";function tV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.length,r=""!==t?"get".concat(t.charAt(0).toUpperCase()+t.slice(1),"CoordsFromIndex"):"getCoordsFromIndex",a=""!==t?"".concat(t.charAt(0).toLowerCase()+t.slice(1),"ShapeStrides"):"outShapeStrides";if(n<=1)return"fn ".concat(r,"(index : i32) -> i32 { return index; }");for(var i,o=gC(e),s=XB(n),u=[],c=0;c<n;c++)u.push("d".concat(c));return 1===o.length?"    fn ".concat(r,"(index : i32) -> vec2<i32> {\n      let d0 = index / uniforms.").concat(a,"; let d1 = index - d0 * uniforms.").concat(a,";\n      return vec2<i32>(d0, d1);\n    }"):(i="var index2 = index;"+o.map((function(e,t){var n="let ".concat(u[t]," = index2 / uniforms.").concat(a,".").concat(YB(t)),r=t===o.length-1?"let ".concat(u[t+1]," = index2 - ").concat(u[t]," * uniforms.").concat(a,".").concat(YB(t)):"index2 = index2 - ".concat(u[t]," * uniforms.").concat(a,".").concat(YB(t));return"".concat(n,"; ").concat(r,";")})).join(""),"\n    fn ".concat(r,"(index : i32) -> ").concat(s," {\n      ").concat(i,"\n      return ").concat(s,"(").concat(u.join(","),");\n    }\n  "))}function nV(e){var t="";switch(e){case 0:case 1:t+="\n        fn getOutputIndexFromCoords(coords : i32) -> i32 {\n          return coords;\n        }\n        ";break;case 2:t+="\n        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {\n          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));\n        }\n        ";break;case 3:t+="\n        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {\n          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));\n        }\n        ";break;case 4:t+="\n        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n          return dot(coords, vec4<i32>(\n            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));\n        }\n        ";break;case 5:t+="\n        fn getOutputIndexFromCoords(coords : vec5) -> i32 {\n          return coords.x * uniforms.outShapeStrides.x +\n              coords.y * uniforms.outShapeStrides.y +\n              coords.z * uniforms.outShapeStrides.z +\n              coords.w * uniforms.outShapeStrides.w +\n              coords.u;\n        }\n        ";break;case 6:t+="\n        fn getOutputIndexFromCoords(coords : vec6) -> i32 {\n          return coords.x * uniforms.outShapeStrides.x +\n              coords.y * uniforms.outShapeStrides.y +\n              coords.z * uniforms.outShapeStrides.z +\n              coords.w * uniforms.outShapeStrides.w +\n              coords.u * uniforms.outShapeStrides.u +\n              coords.v;\n        }\n        ";break;default:YS(!1,(function(){return"Unsupported ".concat(e,"D shape")}))}return t}function rV(e){return 1===e.dispatch[1]&&1===e.dispatch[2]}function aV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if("float32"===e)return ZB(t,"f32");if("int32"===e||"bool"===e)return ZB(t,"i32");throw new Error("type ".concat(e," is not supported."))}function iV(e){return(!e.dispatchLayout.hasOwnProperty("y")||0===e.dispatchLayout.y.length)&&(!e.dispatchLayout.hasOwnProperty("z")||0===e.dispatchLayout.z.length)}var oV,sV=function(e){for(var t=1,n=0;n<e.length;n++)t*=e[n];return t};function uV(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=[Math.ceil(sV(e.x.map((function(e){return t[e]})))/(n[0]*r[0])),e.y?Math.ceil(sV(e.y.map((function(e){return t[e]})))/(n[1]*r[1])):1,e.z?Math.ceil(sV(e.z.map((function(e){return t[e]})))/(n[2]*r[2])):1];return[a[0],a[1],a[2]]}function cV(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return[8,8,1];var n=sV(e.x.map((function(e){return t[e]}))),r=sV(e.y.map((function(e){return t[e]})));return n<=4?[4,16,1]:r<=4?[16,4,1]:[16,16,1]}function lV(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return[4,4,1];var n=sV(e.x.map((function(e){return t[e]}))),r=sV(e.y.map((function(e){return t[e]})));return n<=4?[1,2,1]:r<=4?[2,1,1]:[2,2,1]}function hV(e){return{x:e.map((function(e,t){return t}))}}function dV(e){if("float32"===e||"int32"===e||"bool"===e||"string"===e)return 4;if("complex64"===e)return 8;throw new Error("Unknown dtype ".concat(e))}function fV(){return("undefined"!==typeof window||"undefined"!==typeof WorkerGlobalScope)&&!!navigator.gpu}function pV(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&YS("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGPU backend."}))}))}!function(e){e[e.MatMulReduceProgram=0]="MatMulReduceProgram",e[e.MatMulSplitKProgram=1]="MatMulSplitKProgram",e[e.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",e[e.MatMulPackedProgram=3]="MatMulPackedProgram",e[e.MatMulMax=4]="MatMulMax"}(oV||(oV={}));var mV,vV=RC().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),gV=function(e){be(n,e);var t=we(n);function n(e,r){var a;if(Se(this,n),(a=t.call(this)).commandQueueOwnedIds=new WeakSet,a.dispatchCountInPass=0,a.disposed=!1,a.downloadWaitMs=0,a.tensorDataPendingDisposal=[],a.queryResolveBuffer=null,a.querySet=null,a.querySetCount=2,a.stagingPendingDisposal=[],a.uniformPendingDisposal=[],a.uploadWaitMs=0,a.hasReadSyncWarned=!1,a.hasTimestampQueryWarned=!1,!fV())throw new Error("WebGPU is not supported on this device");return a.pipelineCache={},a.device=e,a.queue=e.queue,a.commandEncoder=null,a.computePassEncoder=null,a.adapterInfo=new zB(r),a.supportTimestampQuery=a.device.features.has("timestamp-query"),a.thresholdToIncreaseWorkgroups=a.adapterInfo.intelGPUGeneration>=12?16:8,a.bufferManager=new BB(a.device),a.textureManager=new UB(a.device),a.tensorMap=new GS(xe(a),NR()),RC().getBool("WEBGPU_USE_PROFILE_TOOL")&&(a.dummyCanvas=document.createElement("canvas"),a.dummyCanvas.width=1,a.dummyCanvas.height=1,a.dummyContext=a.dummyCanvas.getContext("webgpu"),a.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(a.dummyCanvas)),a}return Te(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"floatPrecision",value:function(){return 32}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.tensorMap.has(e))return!0;var n=this.tensorMap.get(e);return t?n.refCount=0:n.refCount--,!(n.refCount>0)&&(null!=n.complexTensorInfos&&(this.disposeData(n.complexTensorInfos.real.dataId),this.disposeData(n.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}},{key:"memory",value:function(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}},{key:"releaseResource",value:function(e){var t=this.tensorMap.get(e);t&&t.resource&&(t.external||(t.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(t.resource):t.resource instanceof GPUTexture&&this.textureManager.releaseTexture(t.resource)),t.resource=null)}},{key:"refCount",value:function(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}},{key:"incRef",value:function(e){this.tensorMap.get(e).refCount++}},{key:"decRef",value:function(e){this.tensorMap.has(e)&&this.tensorMap.get(e).refCount--}},{key:"write",value:function(e,t,n){if("complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.tensorMap.set(r,{dtype:n,shape:t,values:e,refCount:1}),r}},{key:"move",value:function(e,t,n,r,a){if("complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:r,shape:n,values:t,refCount:a})}},{key:"submitQueue",value:function(){var e=this;this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach((function(t){e.releaseResource(t),e.tensorMap.delete(t)})),this.uniformPendingDisposal.forEach((function(t){return e.bufferManager.releaseBuffer(t)})),this.stagingPendingDisposal.forEach((function(t){return e.bufferManager.releaseBuffer(t,!1)})),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}},{key:"ensureCommandEncoderReady",value:function(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}},{key:"endComputePassEncoder",value:function(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}},{key:"checkCompileCompletionAsync",value:function(){var e=N(T().mark((function e(){var t,n=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(Object.values(this.pipelineCache));case 3:t=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error(e.t0.message);case 9:Object.keys(this.pipelineCache).map((function(e,r){n.pipelineCache[e]=t[r]}));case 10:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"getBufferData",value:function(){var e=N(T().mark((function e(t){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!RC().getBool("WEBGPU_ENGINE_COMPILE_ONLY")){e.next=3;break}return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),e.abrupt("return",null);case 3:return n=t.size,r=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(t,0,r,0,n),this.submitQueue(),e.next=11,r.mapAsync(GPUMapMode.READ);case 11:return a=r.getMappedRange().slice(0),r.unmap(),null!=r&&this.bufferManager.releaseBuffer(r),RC().getBool("WEBGPU_USE_PROFILE_TOOL")&&(YS(void 0!==this.dummyContext,(function(){return"Fail to get context for profiling tool"})),this.dummyContext.getCurrentTexture()),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.tensorMap.get(e);return n.values=t,n.values}},{key:"readSync",value:function(e){var t=this,n=this.tensorMap.get(e),r=n.values,a=n.complexTensorInfos;if(null!=r||"string"===n.dtype)return r;if("complex64"===n.dtype){var i=xC(GF(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)).buffer,"float32");return this.convertAndCacheOnCPU(e,i),i}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));var o=["opaque","premultiplied"],s=n.resource,u=s.size;YS(u%4===0,(function(){return"Because there is 4 bytes for one pixel, buffer size must be multiple of 4."}));var c=u/4,l=new ArrayBuffer(u),h=256,d=256,f=o.map((function(e){return new OffscreenCanvas(h,d)})),p=new OffscreenCanvas(h,d);this.endComputePassEncoder(),f.map((function(e,n){var r=e.getContext("webgpu");return r.configure({device:t.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:o[n]}),r.getCurrentTexture()})).map((function(e,n){for(var r=function(r,a,i){t.ensureCommandEncoderReady(),t.commandEncoder.copyBufferToTexture({buffer:s,bytesPerRow:1024,offset:i},{texture:e},{width:r,height:a}),t.submitQueue();var u=p.getContext("2d",{willReadFrequently:!0});u.clearRect(0,0,r,a),u.drawImage(f[n],0,0);for(var c=u.getImageData(0,0,r,a).data,h=o[n],d=new Uint8ClampedArray(l,i,r*a*4),m=0;m<d.length;m+=4)if("premultiplied"===h)d[m+3]=c[m+3];else{var v=c[m];d[m]=c[m+2],d[m+1]=c[m+1],d[m+2]=v}},a=Math.floor(c/65536),i=h,u=d,m=0,v=0;v<a;v++)r(i,u,m),m+=262144;var g=c%65536;(u=Math.floor(g/h))>0&&(r(i,u,m),m+=1024*u),(i=g%h)>0&&r(i,1,m)}));var m=xC(l,n.dtype);return this.convertAndCacheOnCPU(e,m),m}},{key:"read",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tensorMap.has(t)){e.next=2;break}throw new Error("Tensor ".concat(t," was not registered!"));case 2:if(n=this.tensorMap.get(t),null==(r=n.values)){e.next=6;break}return e.abrupt("return",r);case 6:if("complex64"!==n.dtype){e.next=15;break}return e.next=9,Promise.all([this.read(n.complexTensorInfos.real.dataId),this.read(n.complexTensorInfos.imag.dataId)]);case 9:i=e.sent,o=i[0],s=i[1],a=GF(o,s),e.next=19;break;case 15:return e.next=17,this.getBufferData(n.resource);case 17:u=e.sent,a=xC(u,n.dtype);case 19:return this.convertAndCacheOnCPU(t,a),e.abrupt("return",a);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copyBuffer",value:function(e){var t=e.size,n=e.usage,r=this.bufferManager.acquireBuffer(t,n);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,t),this.submitQueue(),r}},{key:"createTensorFromGPUData",value:function(e,t,n){var r=e.buffer;if("complex64"===n)throw new Error("Cannot write to a complex64 dtype. ");var a={id:this.nextDataId()};this.tensorMap.set(a,{dtype:n,shape:t,values:null,refCount:1,external:e.zeroCopy});var i=this.tensorMap.get(a),o=dV(i.dtype)*JS(i.shape);if(e.buffer.size<o)throw new Error("GPUBuffer size(".concat(e.buffer.size,") is smaller than tensor size(").concat(o,")!"));if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return!0!==e.zeroCopy&&(r=this.copyBuffer(r)),i.resource=r,NR().makeTensorFromDataId(a,t,n,this)}},{key:"readToGPU",value:function(e){var t=this.tensorMap.get(e),n=t.values,r=t.dtype,a=t.shape,i=t.resource;if("complex64"===r)throw new Error("Does not support reading buffer for complex64 dtype.");if(null==i)throw null!=n?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var o=i,s=o.size,u=o.usage,c=this.bufferManager.acquireBuffer(s,u);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,c,0,s),this.submitQueue();var l=this.makeTensorInfo(a,r),h=NR().makeTensorFromTensorInfo(l);return this.tensorMap.get(l.dataId).resource=c,{tensorRef:h,buffer:c}}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return gE(e)}));return IR(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return IR(e.shape,e.dtype,t)}},{key:"time",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.supportTimestampQuery||this.hasTimestampQueryWarned||(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --disable-dawn-features=disallow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0),n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),i=bE(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=bE(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},e.next=14,Promise.all(i);case 14:return u=e.sent,s.kernelMs=XS(u),s.getExtraProfileInfo=function(){return u.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",s);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"makeTensorInfo",value:function(e,t,n){return"string"===t&&null!=n&&n.length>0&&fC(n[0])&&(n=n.map((function(e){return vE(e)}))),{dataId:this.write(n,e,t),shape:e,dtype:t}}},{key:"tensorToBinding",value:function(e){if(!e)return null;var t=this.tensorMap.get(e.dataId).resource;return t instanceof GPUBuffer?{buffer:t}:t instanceof GPUTexture?t.createView():t}},{key:"uploadToGPU",value:function(e){var t=this.tensorMap.get(e);if(null==t.resource){var n,r=dV(t.dtype)*JS(t.shape),a=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(t.values){if("unmapped"===(n=this.bufferManager.acquireBuffer(r,a,!0)).mapState){var i=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),o=i.getMappedRange();"int32"===t.dtype||"bool"===t.dtype?new Int32Array(o).set(t.values):new Float32Array(o).set(t.values),i.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,n,0,r),this.stagingPendingDisposal.push(i)}else{var s=n.getMappedRange();"int32"===t.dtype||"bool"===t.dtype?new Int32Array(s).set(t.values):new Float32Array(s).set(t.values),n.unmap()}t.values=null}else n=this.bufferManager.acquireBuffer(r,a);t.resource=n}}},{key:"makeUniforms",value:function(e){var t=0,n=0,r=[],a=1;e.forEach((function(e){var i;switch(0===e.data.length&&(e.data=[1]),e.data.length){case 1:i=4;break;case 2:i=8;break;case 3:case 4:case 5:case 6:i=16;break;default:YS(!1,(function(){return"Unsupported ".concat(e.data.length,"D shape")}))}5!==n&&6!==n||(i=16),i>a&&(a=i),t=Math.ceil(t/i)*i,n=e.data.length,r.push(t),t+=4*e.data.length})),t=Math.ceil(t/a)*a;var i=new ArrayBuffer(t);e.forEach((function(e,t){var n=r[t];"int32"===e.type?new Int32Array(i,n,e.data.length).set(e.data):"uint32"===e.type?new Uint32Array(i,n,e.data.length).set(e.data):new Float32Array(i,n,e.data.length).set(e.data)}));var o=this.bufferManager.acquireBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(o,0,i,0,t),this.uniformPendingDisposal.push(o),{offset:0,size:t,buffer:o}}},{key:"runWebGPUProgram",value:function(e,t,n,r,a){var i=this;if(a||(a=this.makeTensorInfo(e.outputShape,n)),0===JS(a.shape))return this.tensorMap.get(a.dataId).values=cC(a.dtype,0),a;this.uploadToGPU(a.dataId),e.dispatch=function(e,t){var n=e.limits.maxComputeWorkgroupsPerDimension,r=t.dispatchLayout,a=t.dispatch;if(a.every((function(e){return e<=n})))return a;YS(a[0]>n&&void 0===r.y&&void 0===r.z,(function(){return"Dispatch size exceeds WebGPU limits in Y or Z dimension."}));var i=Math.ceil(Math.sqrt(a[0]));return i>n?(YS((i=Math.ceil(Math.cbrt(a[0])))<=n,(function(){return"Total dispatch size exceeds WebGPU maximum."})),[i,i,i]):[i,i,1]}(this.device,e);var o=t.map((function(t,n){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return i.uploadToGPU(t.dataId),{dtype:i.tensorMap.get(t.dataId).dtype,shape:t.shape,name:e.variableNames[n]}}));e.shaderKey=function(e,t,n){var r=e.shaderKey;if(null!=e.pixelsOpType)return r;var a=[],i=[];t.forEach((function(e){a.push(e.shape),i.push(e.dtype)})),a.push(n.shape),i.push(n.dtype);var o=t.map((function(e){return aA(e.shape,n.shape)})),s=t.map((function(e){return tC(e.shape,n.shape)})).join("_"),u=o.map((function(e){return e.join("_")})).join(";"),c=rV(e)?"flatDispatch":"";return r+"_"+(e.workgroupSize?e.workgroupSize.join(","):"")+a.map((function(e){return e.length})).join(",")+i.join(",")+e.variableNames.join(",")+u+s+c}(e,o,a);var s=RC().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=qB(this.device,e,o,a,s)),e.pipeline=this.pipelineCache[e.shaderKey],s||this.recordAndSubmit(e,a,t,r),a}},{key:"recordAndSubmit",value:function(e,t,n,r){var a=this;if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");var i=[],o=[],s="int32";if(null==e.pixelsOpType){i.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),o=n.concat(t).map((function(e){return e.shape}));var u="int32";o.map((function(e){i.push({type:u,data:e});var t=gC(e);i.push({type:u,data:t})}))}else{var c=gC(t.shape);i.push({type:s,data:c})}if(e.size){var l=JS(e.outputShape);i.push({type:s,data:[e.outputComponent?l/e.outputComponent:l]})}r&&(i=[].concat((0,ke.Z)(i),(0,ke.Z)(r)));var h=[this.tensorToBinding(t)].concat((0,ke.Z)(n.map((function(e){return a.tensorToBinding(e)}))),[this.makeUniforms(i)]);n.forEach((function(e){a.commandQueueOwnedIds.add(e.dataId)})),this.commandQueueOwnedIds.add(t.dataId);var d=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:h.map((function(e,t){return{binding:t,resource:e}}))}),f=null!=this.activeTimers;this.ensureCommandEncoderReady();var p={};f&&this.supportTimestampQuery?(this.endComputePassEncoder(),null==this.querySet&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),p.timestampWrites=[{querySet:this.querySet,queryIndex:0,location:"beginning"},{querySet:this.querySet,queryIndex:1,location:"end"}],this.computePassEncoder=this.commandEncoder.beginComputePass(p)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(p)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,d),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(f||RC().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===HB.DRAW)&&(this.endComputePassEncoder(),f?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}},{key:"getQueryTime",value:function(){var e=N(T().mark((function e(){var t,n,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.supportTimestampQuery){e.next=2;break}return e.abrupt("return",0);case 2:return null==this.queryResolveBuffer&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0),t=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,8*this.querySetCount),this.submitQueue(),e.next=9,t.mapAsync(GPUMapMode.READ);case 9:return n=new BigUint64Array(t.getMappedRange()),r=Number(n[1]-n[0])/1e6,t.unmap(),this.bufferManager.releaseBuffer(t),e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vV;return RC().getBool("WEBGPU_CPU_FORWARD")&&e.every((function(e){return null==t.tensorMap.get(e.dataId).resource&&JS(e.shape)<n}))}},{key:"numDataIds",value:function(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}},{key:"dispose",value:function(){this.disposed||(null!=this.querySet&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}]),n}(HS);gV.nextDataId=0,fV()&&PR("webgpu",N(T().mark((function e(){var t,n,r,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={powerPreference:RC().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e.next=3,navigator.gpu.requestAdapter(t);case 3:return n=e.sent,r={},a=[],n.features.has("timestamp-query")&&a.push("timestamp-query"),n.features.has("bgra8unorm-storage")&&a.push(["bgra8unorm-storage"]),r.requiredFeatures=a,i=n.limits,r.requiredLimits={maxComputeWorkgroupStorageSize:i.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:i.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:i.maxStorageBufferBindingSize,maxBufferSize:i.maxBufferSize,maxComputeWorkgroupSizeX:i.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:i.maxComputeInvocationsPerWorkgroup},e.next=13,n.requestDevice(r);case 13:return o=e.sent,e.next=16,n.requestAdapterInfo();case 16:return s=e.sent,e.abrupt("return",new gV(o,s));case 18:case"end":return e.stop()}}),e)}))),3),function(e){e[e.ADD=0]="ADD",e[e.ATAN2=1]="ATAN2",e[e.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",e[e.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",e[e.DIV=4]="DIV",e[e.ELU_DER=5]="ELU_DER",e[e.EQUAL=6]="EQUAL",e[e.FLOOR_DIV=7]="FLOOR_DIV",e[e.GREATER=8]="GREATER",e[e.GREATER_EQUAL=9]="GREATER_EQUAL",e[e.LESS=10]="LESS",e[e.LESS_EQUAL=11]="LESS_EQUAL",e[e.LOGICAL_AND=12]="LOGICAL_AND",e[e.LOGICAL_OR=13]="LOGICAL_OR",e[e.MAX=14]="MAX",e[e.MIN=15]="MIN",e[e.MOD=16]="MOD",e[e.MUL=17]="MUL",e[e.NOT_EQUAL=18]="NOT_EQUAL",e[e.POW=19]="POW",e[e.PRELU=20]="PRELU",e[e.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",e[e.SUB=22]="SUB"}(mV||(mV={}));var yV,bV="let resultTemp = a + b;",xV="let resultTemp = atan2(a, b);",wV="let resultTemp = areal * breal - aimag * bimag;",kV="let resultTemp = areal * bimag + aimag * breal;",SV="let resultTemp = a / b;",CV="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",IV="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a == b);\n",TV="\n  let remainder =\n      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));\n  let quotient = (a - remainder) / b;\n  let resultTemp =\n      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));\n",_V="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a > b);\n",EV="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a >= b);\n",NV="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a < b);\n",RV="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a <= b);\n",AV="return f32(a >= 1.0 && b >= 1.0);",OV="return (vec4<f32>(a >= vec4<f32>(1.0)) *\n  vec4<f32>(b >= vec4<f32>(1.0)));",DV="return f32(a >= 1.0 || b >= 1.0);",PV="return min(vec4<f32>(a >= vec4<f32>(1.0)) +\n  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));",MV="let resultTemp = max(a, b);",LV="let resultTemp = min(a, b);",FV="\n  let isNaN = b == 0.;\n  var resultTemp = a % b;\n  resultTemp = select((resultTemp + b) % b, resultTemp,\n      (a < 0. && b < 0.) || (a >= 0. && b > 0.));\n",zV="\n  let isNaN = !vec4<bool>(b);\n  var resultTemp = vec4<f32>(a % b);\n  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {\n    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];\n  }\n  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {\n    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];\n  }\n  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {\n    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];\n  }\n  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {\n    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];\n  }\n",BV="let resultTemp = a * b;",VV="\n  var resultTemp = f32(a != b);\n  let valueForNaN = 1.0;\n",UV="\n  var resultTemp = vec4<f32>(a != b);\n  let valueForNaN = 1.0;\n",WV="\n  let isNaN = a < 0.0 && floor(b) < b;\n  if (b == 0.0) {\n    return 1.0;\n  }\n  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),\n      round(abs(b) % 2.0) != 1.0);\n",jV="\n  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);\n  let isModRound1 = vec4<f32>(isModRound1Bool);\n  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);\n  var resultTemp = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  let isExpZero = b == vec4<f32>(0.0);\n  if (isExpZero.r) {\n    resultTemp.r = 1.0;\n  }\n  if (isExpZero.g) {\n    resultTemp.g = 1.0;\n  }\n  if (isExpZero.b) {\n    resultTemp.b = 1.0;\n  }\n  if (isExpZero.a) {\n    resultTemp.a = 1.0;\n  }\n  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);\n",GV="if (a < 0.0) { return b * a; }  return a;",HV="\n  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));\n  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);\n",KV="let resultTemp = (a - b) * (a - b);",qV="let resultTemp = a - b;";function ZV(e,t){var n;do{switch(e){case mV.ATAN2:n=xV;break;case mV.MAX:n=MV;break;case mV.MIN:n=LV;break;case mV.MOD:n=t?zV:FV;break;case mV.NOT_EQUAL:n=t?UV:VV;break;case mV.POW:n=t?jV:WV;break;default:continue}var r=void 0,a=void 0,i=void 0;return t?(r="isnanVec4",a="vec4<f32>",i="vec4<bool>"):(r="isnan",a="f32",i="bool"),"\n      let aIsNaN = ".concat(r,"(a);\n      let aPostLegalization = select(a, ").concat(a,"(42), aIsNaN);\n      let bIsNaN = ").concat(r,"(b);\n      let bPostLegalization = select(b, ").concat(a,"(42), bIsNaN);\n      let isNaN = false;\n      let valueForNaN = uniforms.NAN;\n      {\n        let a = aPostLegalization;\n        let b = bPostLegalization;\n        ").concat(n,"\n        return select(\n            resultTemp, ").concat(a,"(valueForNaN),\n            ").concat(i,"(isNaN) | aIsNaN | bIsNaN);\n      }\n    ")}while(0);switch(e){case mV.ADD:n=bV;break;case mV.COMPLEX_MULTIPLY_IMAG:n=kV;break;case mV.COMPLEX_MULTIPLY_REAL:n=wV;break;case mV.DIV:n=SV;break;case mV.ELU_DER:n=CV;break;case mV.EQUAL:n=IV;break;case mV.FLOOR_DIV:n=TV;break;case mV.GREATER:n=_V;break;case mV.GREATER_EQUAL:n=EV;break;case mV.LESS:n=NV;break;case mV.LESS_EQUAL:n=RV;break;case mV.LOGICAL_AND:return t?OV:AV;case mV.LOGICAL_OR:return t?PV:DV;case mV.MUL:n=BV;break;case mV.PRELU:return t?HV:GV;case mV.SQUARED_DIFFERENCE:n=KV;break;case mV.SUB:n=qV}return"\n    ".concat(n,"\n    return resultTemp;\n  ")}!function(e){e[e.ABS=0]="ABS",e[e.ACOS=1]="ACOS",e[e.ACOSH=2]="ACOSH",e[e.ASIN=3]="ASIN",e[e.ASINH=4]="ASINH",e[e.ATAN=5]="ATAN",e[e.ATANH=6]="ATANH",e[e.CEIL=7]="CEIL",e[e.COS=8]="COS",e[e.COSH=9]="COSH",e[e.ELU=10]="ELU",e[e.ERF=11]="ERF",e[e.EXP=12]="EXP",e[e.EXPM1=13]="EXPM1",e[e.FLOOR=14]="FLOOR",e[e.IS_FINITE=15]="IS_FINITE",e[e.IS_INF=16]="IS_INF",e[e.IS_NAN=17]="IS_NAN",e[e.LINEAR=18]="LINEAR",e[e.LOG=19]="LOG",e[e.LOG1P=20]="LOG1P",e[e.LOGICAL_NOT=21]="LOGICAL_NOT",e[e.NEG=22]="NEG",e[e.RELU=23]="RELU",e[e.RELU6=24]="RELU6",e[e.LEAKYRELU=25]="LEAKYRELU",e[e.RECIPROCAL=26]="RECIPROCAL",e[e.ROUND=27]="ROUND",e[e.RSQRT=28]="RSQRT",e[e.SELU=29]="SELU",e[e.SIGMOID=30]="SIGMOID",e[e.SIGN=31]="SIGN",e[e.SIN=32]="SIN",e[e.SINH=33]="SINH",e[e.SOFTPLUS=34]="SOFTPLUS",e[e.SQRT=35]="SQRT",e[e.SQUARE=36]="SQUARE",e[e.STEP=37]="STEP",e[e.TAN=38]="TAN",e[e.TANH=39]="TANH",e[e.TO_INT=40]="TO_INT"}(yV||(yV={}));var XV="return abs(a);",YV="\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  return acos(a);\n",QV="\n  if (a < 1.) {\n    return uniforms.NAN;\n  }\n  return acosh(a);\n",$V="\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  return asin(a);\n",JV="return asinh(a);",eU="\n  if (isnan(a)) {\n    return uniforms.NAN;\n  }\n  return atan(a);\n",tU="\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  if (a == 1.) {\n    return uniforms.INFINITY;\n  }\n  if (a == -1.) {\n    return -uniforms.INFINITY;\n  }\n  return atanh(a);\n",nU="return ceil(a);",rU="return cos(a);",aU="\n  let e2x = exp(-a);\n  return (e2x + 1.0 / e2x) / 2.0;\n",iU="return exp(a) - 1.0;",oU="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",sU="\n  var resFloat = exp(a) - vec4<f32>(1.0);\n  if (a.r >= 0.0) {\n    resFloat.r = a.r;\n  }\n  if (a.g >= 0.0) {\n    resFloat.g = a.g;\n  }\n  if (a.b >= 0.0) {\n    resFloat.b = a.b;\n  }\n  if (a.a >= 0.0) {\n    resFloat.a = a.a;\n  }\n  return resFloat;\n",uU='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  let p = '.concat(zF,";\n  let a1 = ").concat(BF,";\n  let a2 = ").concat(VF,";\n  let a3 = ").concat(UF,";\n  let a4 = ").concat(WF,";\n  let a5 = ").concat(jF,";\n\n  let sign = sign(a);\n  let absA = abs(a);\n  let t = 1.0 / (1.0 + p * absA);\n  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));\n"),cU="return exp(a);",lU="return floor(a);",hU="return f32(!isnan(a) && !isinf(a));",dU="return f32(isinf(a));",fU="return f32(isnan(a));",pU="return a;",mU="if (a < 0.0) { return uniforms.NAN; }\n  return log(a);",vU="\n  if (isnan(a)) { return a; }\n  return log(1.0 + a);\n",gU="return f32(!(a >= 1.0));",yU="return -a;",bU="if (a < 0.0) { return uniforms.alpha * a; } return a;",xU="\n  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));\n  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);\n",wU="return 1.0 / a;",kU="return select(a, 0.0, a < 0.0);",SU="return clamp(a, 0.0, 6.0);",CU="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",IU="\n  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));\n",TU="return round(a);",_U="return inverseSqrt(a);",EU="\n  if (a >= 0.0) {\n    return ".concat(FF," * a;\n  } else {\n    return ").concat(LF," * (exp(a) - 1.0);\n  }\n"),NU="return 1.0 / (1.0 + exp(-1.0 * a));",RU="return sign(a);",AU="return sin(a);",OU="\n  let e2x = exp(a);\n  return (e2x - 1.0 / e2x) / 2.0;\n",DU="\n  let epsilon = 1.1920928955078125e-7;\n  let threshold = log(epsilon) + 2.0;\n\n  let too_large = a > -threshold;\n  let too_small = a < threshold;\n  let exp_a = exp(a);\n\n  if (too_large) {\n    return a;\n  } else if (too_small) {\n    return exp_a;\n  } else {\n    return log(exp_a + 1.0);\n  }\n",PU="return sqrt(a);",MU="return a * a;",LU="\n  if (isnan(a)) {\n    return a;\n  }\n\n  return select(uniforms.stepAlpha, 1.0, a > 0.0);\n",FU="return tan(a);",zU="\n  let e2x = exp(-2.0 * abs(a));\n  return sign(a) * (1.0 - e2x) / (1.0 + e2x);\n",BU="return f32(i32((a)));";function VU(e,t){switch(e){case yV.ABS:return XV;case yV.ACOS:return YV;case yV.ACOSH:return QV;case yV.ASIN:return $V;case yV.ASINH:return JV;case yV.ATAN:return eU;case yV.ATANH:return tU;case yV.COS:return rU;case yV.COSH:return aU;case yV.CEIL:return nU;case yV.ELU:return t?sU:oU;case yV.ERF:return uU;case yV.EXP:return cU;case yV.EXPM1:return iU;case yV.FLOOR:return lU;case yV.IS_FINITE:return hU;case yV.IS_INF:return dU;case yV.IS_NAN:return fU;case yV.LINEAR:return pU;case yV.LOG:return mU;case yV.LOG1P:return vU;case yV.LOGICAL_NOT:return gU;case yV.NEG:return yU;case yV.LEAKYRELU:return t?xU:bU;case yV.RECIPROCAL:return wU;case yV.RELU:return t?IU:kU;case yV.RELU6:return t?CU:SU;case yV.ROUND:return TU;case yV.RSQRT:return _U;case yV.SELU:return EU;case yV.SIGMOID:return NU;case yV.SIGN:return RU;case yV.SIN:return AU;case yV.SINH:return OU;case yV.SOFTPLUS:return DU;case yV.SQRT:return PU;case yV.SQUARE:return MU;case yV.STEP:return LU;case yV.TAN:return FU;case yV.TANH:return zU;case yV.TO_INT:return BU;default:throw new Error("BinaryType ".concat(e," is not implemented!"))}}function UU(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;if(null===e)return"";var a="";if("linear"===e)a=VU(yV.LINEAR);else if("relu"===e)a=VU(yV.RELU,n);else if("elu"===e)a=VU(yV.ELU,n);else if("relu6"===e)a=VU(yV.RELU6,n);else if("prelu"===e)a=ZV(mV.PRELU,n);else if("sigmoid"===e)a=VU(yV.SIGMOID,n);else{if("leakyrelu"!==e)throw new Error("Activation ".concat(e," has not been implemented for the WebGPU backend."));a=VU(yV.LEAKYRELU,n)}var i=ZB(n?4:1);return t?"\n      fn activation(a : ".concat(i,", coords : vec").concat(r,"<i32>) -> ").concat(i," {\n        let b = getPreluActivationWeightsByOutputCoords(coords);\n        ").concat(a,"\n      }"):"\n      fn activation(a : ".concat(i,", coords : vec").concat(r,"<i32>) -> ").concat(i," {\n        ").concat(a,"\n      }")}function WU(e,t){return"\n      ".concat(e?"value = value + getBiasByOutputCoords(coords);":"","\n      ").concat(t?"value = activation(value, coords);":"","\n      ")}function jU(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;YS(e&&1===a||!e,(function(){return"transposeA ".concat(e," is not compatible with component size ").concat(a)}));var i="\n      ".concat(e?"value = getA(batch, col, row);":"value = getA(batch, row, col);","\n\n    "),o=t?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return"\n  fn mm_readA(batch: i32, row: i32, col: i32) -> ".concat(ZB(a)," {\n    var value = ").concat(ZB(a),"(0.0);\n    ").concat(n&&r?i:"\n    ".concat(e?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])","\n    {\n      ").concat(i,"\n    }\n    "),"\n    return value;\n  }\n\n  fn mm_readB(batch: i32, row: i32, col: i32) -> ").concat(ZB(a)," {\n    var value = ").concat(ZB(a),"(0.0);\n    ").concat(o,"\n    return value;\n  }\n  ")}function GU(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return"\n  ".concat(jU(n,r,a,i,arguments.length>6&&void 0!==arguments[6]&&arguments[6],o),"\n  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ").concat(ZB(o),") {\n    ").concat(a&&i?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)","\n    {\n      var value = valueIn;\n      let coords = vec3<i32>(batch, row, col);\n      ").concat(WU(e,t),"\n      setOutputAtCoords(coords[0], coords[1], coords[2], value);\n    }\n  }\n  ")}function HU(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=t[1]*e[1],u=t[0]*e[0],c=n?s:r,l=n?r:s,h=c/t[0],d=r/t[1],f=e[1],p=e[0];return YS((n&&4===h&&4===e[1]||!n&&(3===h||4===h))&&c%t[0]===0&&r%t[1]===0&&4===e[0],(function(){return"If transposeA ".concat(n," is true, innerElementSize ").concat(h," and workPerThread[1] ").concat(e[1]," must be 4.\n          Otherwise, innerElementSize ").concat(h," must be 3 or 4.\n      tileAWidth ").concat(c," must be divisible by workgroupSize[0]").concat(t[0],". tileInner ").concat(r," must be divisible by workgroupSize[1] ").concat(t[1],". colPerThread ").concat(e[0]," must be 4.")})),"\n  var<workgroup> mm_Asub : array<array<vec".concat(h,"<f32>, ").concat(c/h,">, ").concat(l,">;\n  var<workgroup> mm_Bsub : array<array<vec4<f32>, ").concat(u/e[0],">, ").concat(r,">;\n\n  ").concat(QB()," {\n    let localRow = i32(localId.y);\n    let tileRow = localRow * ").concat(f,";\n    let tileCol = i32(localId.x);\n\n    let globalRow = i32(globalId.y) * ").concat(f,";\n    let globalCol = i32(globalId.x) * ").concat(p,";\n    let batch = ").concat(a?"0":"i32(globalId.z)",";\n    let batchA = ").concat(a||!o?"batch":"batch % uniforms.aShape[0]",";\n    let batchB = ").concat(a||!o?"batch":"batch % uniforms.bShape[0]",";\n    let globalRowStart = i32(workgroupId.y) * ").concat(s,";\n\n    let numTiles = ").concat(a?"".concat(Math.ceil(i/r)):"(uniforms.dimInner - 1) / ".concat(r," + 1"),";\n    var kStart = ").concat(a?"i32(globalId.z) * ".concat(i):"0",";\n\n    var acc: array<vec4<f32>, ").concat(f,">;\n\n    // Loop over shared dimension.\n    let tileRowB = localRow * ").concat(d,";\n    for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        for (var innerRow = 0; innerRow < ").concat(f,"; innerRow++) {\n            let inputRow = tileRow + innerRow;\n            let inputCol = tileCol;\n            ").concat(function(e,t){return e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          kStart + inputRow,\n          globalRowStart + inputCol * ".concat(t,");\n        "):"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          globalRow + innerRow,\n          kStart + inputCol * ".concat(t,");\n        ")}(n,h),"\n        }\n\n        // Load one tile of B into local memory.\n        for (var innerRow = 0; innerRow < ").concat(d,"; innerRow++) {\n            let inputRow = tileRowB + innerRow;\n            let inputCol = tileCol;\n            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);\n        }\n        kStart = kStart + ").concat(r,";\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        ").concat(function(e,t,n,r){if(e)return"\n      for (var k = 0; k < ".concat(r,"; k++) {\n        let BCached0 = mm_Bsub[k][tileCol];\n        let ACached0 = mm_Asub[k][localRow];\n        for (var i = 0; i < ").concat(n,"; i++) {\n          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);\n        }\n      }");for(var a="",i="",o=0;o<t;o++)a+="let BCached".concat(o," = mm_Bsub[k * ").concat(t," + ").concat(o,"][tileCol];"),i+="acc[i] = fma(BCached".concat(o,", vec4<f32>(ACached[").concat(o,"]), acc[i]);");return"\n      for (var k = 0; k < ".concat(r/t,"; k++) {\n        ").concat(a,"\n        for (var i = 0; i < ").concat(n,"; i++) {\n          let ACached = mm_Asub[tileRow + i][k];\n          ").concat(i,"\n        }\n      }")}(n,h,f,r),"\n        workgroupBarrier();\n    }\n\n    for (var innerRow = 0; innerRow < ").concat(f,"; innerRow++) {\n        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n    }\n  }")}var KU=function(e){return e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          kStart + inputRow,\n          globalRowStart + inputCol);\n        ":"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          globalRowStart + inputRow,\n          kStart + inputCol);\n        "};function qU(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=e[1]*t[1],c=e[0]*t[0],l=n?u:r,h=n?r:u;YS(h%t[1]===0&&l%t[0]===0&&r%t[1]===0,(function(){return"tileAHight ".concat(h," must be divisible by workgroupSize[1]").concat(t[1],", tileAWidth ").concat(l," must be divisible by workgroupSize[0]").concat(t[0],", tileInner ").concat(r," must be divisible by workgroupSize[1]").concat(t[1])}));var d=h/t[1],f=l/t[0],p=r/t[1],m=e[1],v=e[0],g=o?"\n      let localRow = i32(localId.y);\n      let localCol = i32(localId.x);\n      let globalRowStart = i32(workgroupId.y) * ".concat(u,";\n      let globalColStart = i32(workgroupId.x) * ").concat(c,";\n\n      // Loop over shared dimension.\n      for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(h,"; inputRow = inputRow + ").concat(t[1],") {\n          for (var inputCol = localCol; inputCol < ").concat(l,"; inputCol = inputCol + ").concat(t[0],") {\n            ").concat(KU(n),"\n          }\n        }\n        // Load one tile of B into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(r,"; inputRow = inputRow + ").concat(t[1],") {\n              for (var inputCol = localCol; inputCol < ").concat(c,"; inputCol = inputCol + ").concat(t[0],") {\n            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,\n              kStart + inputRow,\n              globalColStart + inputCol);\n          }\n        }\n        kStart = kStart + ").concat(r,";\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        var BCached : array<f32, ").concat(v,">;\n        for (var k = 0; k < ").concat(r,"; k++) {\n          for (var inner = 0; inner < ").concat(v,"; inner++) {\n            BCached[inner] = mm_Bsub[k][localCol + inner * ").concat(t[0],"];\n          }\n          for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n            let ACached = ").concat(n?"mm_Asub[k][localRow + innerRow * ".concat(t[1],"];"):"mm_Asub[localRow + innerRow * ".concat(t[1],"][k];"),"\n            for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n              acc[innerRow][innerCol] =\n                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);\n            }\n          }\n        }\n        workgroupBarrier();\n      }\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        let gRow = globalRowStart + localRow + innerRow * ").concat(t[1],";\n        for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n          let gCol = globalColStart + localCol + innerCol * ").concat(t[0],";\n          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n        }\n      }\n      "):"\n  let tileRow = i32(localId.y) * ".concat(m,";\n  let tileCol = i32(localId.x) * ").concat(v,";\n\n  let globalRow = i32(globalId.y) * ").concat(m,";\n  let globalCol = i32(globalId.x) * ").concat(v,";\n  let globalRowStart = i32(workgroupId.y) * ").concat(u,";\n\n  let tileRowA = i32(localId.y) * ").concat(d,";\n  let tileColA = i32(localId.x) * ").concat(f,";\n  let tileRowB = i32(localId.y) * ").concat(p,";\n  // Loop over shared dimension.\n  for (var t = 0; t < numTiles; t++) {\n    // Load one tile of A into local memory.\n    for (var innerRow = 0; innerRow < ").concat(d,"; innerRow++) {\n      for (var innerCol = 0; innerCol < ").concat(f,"; innerCol++) {\n        let inputRow = tileRowA + innerRow;\n        let inputCol = tileColA + innerCol;\n        ").concat(KU(n),"\n      }\n    }\n\n    // Load one tile of B into local memory.\n    for (var innerRow = 0; innerRow < ").concat(p,"; innerRow++) {\n      for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n        let inputRow = tileRowB + innerRow;\n        let inputCol = tileCol + innerCol;\n        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,\n          kStart + inputRow,\n          globalCol + innerCol);\n      }\n    }\n    kStart = kStart + ").concat(r,";\n    workgroupBarrier();\n\n    // Compute acc values for a single thread.\n    var BCached : array<f32, ").concat(v,">;\n    for (var k = 0; k < ").concat(r,"; k++) {\n      for (var inner = 0; inner < ").concat(v,"; inner++) {\n        BCached[inner] = mm_Bsub[k][tileCol + inner];\n      }\n\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        ").concat(function(e){return e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];"}(n),"\n        for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n          acc[innerRow][innerCol] =\n              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);\n        }\n      }\n    }\n\n    workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n    for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n      mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n          acc[innerRow][innerCol]);\n    }\n  }\n  ");return"\n    var<workgroup> mm_Asub : array<array<f32, ".concat(l,">, ").concat(h,">;\n    var<workgroup> mm_Bsub : array<array<f32, ").concat(c,">, ").concat(r,">;\n\n    ").concat(QB()," {\n      let batch = ").concat(a?"0":"i32(globalId.z)",";\n      let batchA = ").concat(a||!s?"batch":"batch % uniforms.aShape[0]",";\n      let batchB = ").concat(a||!s?"batch":"batch % uniforms.bShape[0]",";\n      let numTiles = ").concat(a?"".concat(Math.ceil(i/r)):"(uniforms.dimInner - 1) / ".concat(r," + 1"),";\n      var kStart = ").concat(a?"i32(globalId.z) * ".concat(i):"0",";\n\n      var acc : array<array<f32, ").concat(v,">, ").concat(m,">;\n\n      // Without this initialization strange values show up in acc.\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        for (var innerCol = 0; innerCol < ").concat(v,"; innerCol++) {\n          acc[innerRow][innerCol] = 0.0;\n        }\n      }\n      ").concat(g,"\n    }\n  ")}var ZU=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Se(this,e),this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]};var c=r?t[1]:t[2];if(this.isVec4=(c%4===0&&!r||n[1]%4===0&&r)&&n[2]%4===0&&!a,this.outputComponent=this.isVec4?4:1,this.isVectorA=1===n[1]&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{var l=function(e,t,n){var r=[8,8,1],a=[4,4,1];return arguments.length>3&&void 0!==arguments[3]&&arguments[3]||(e<=8&&(a[1]=1),t<=16&&n<=16&&(r[0]=4)),{workgroupSize:r,elementsPerThread:a}}(n[1],c,n[2],r);this.workgroupSize=l.workgroupSize,this.elementsPerThread=l.elementsPerThread}this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);var h=null!=i,d=null!=s;h&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=u,this.transposeA=r,this.transposeB=a,this.addBias=h,this.activation=o,this.hasPreluActivationWeights=d;var f=this.getShapeFit(n[1],n[2],c),p=(0,U.Z)(f,3);this.fitAOuter=p[0],this.fitBOuter=p[1],this.fitInner=p[2],this.shaderKey="matMulPacked_".concat(this.elementsPerThread,"_").concat(r,"_").concat(a,"_").concat(this.activation,"_").concat(this.fitAOuter,"_").concat(this.fitBOuter,"_").concat(this.fitInner,"_").concat(this.isVec4,"_").concat(this.isVectorA,"_").concat(this.sequentialAccessByThreads)}return Te(e,[{key:"getShapeFit",value:function(e,t,n){var r=this.workgroupSize[1]*this.elementsPerThread[1],a=this.workgroupSize[0]*this.elementsPerThread[0];return!this.isVec4&&this.isVectorA?this.tileInner=4*this.workgroupSize[0]:this.tileInner=a,[e%r===0,t%a===0,n%this.tileInner===0]}},{key:"getUserCode",value:function(){var e="\n      ".concat(UU(this.activation,this.hasPreluActivationWeights,this.isVec4),"\n      ").concat(GU(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1),"\n      ").concat(this.isVec4?HU(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];YS(1===e[1]&&1===e[2],(function(){return"A linear work group size is required. But got ".concat(e,".")}));var n=4*e[0];return"\n    var<workgroup> mm_Asub : array<vec4<f32>, ".concat(e[0],">;\n\n    ").concat(QB()," {\n      let tileCol = i32(localId.x);\n      let globalCol = i32(globalId.x);\n      let globalRow = i32(globalId.y);\n\n      let numTiles = (uniforms.dimInner - 1) / ").concat(n," + 1;\n      let batch = i32(globalId.z);\n      let batchA = batch % uniforms.aShape[0];\n      let batchB = batch % uniforms.bShape[0];\n      // Without this initialization strange values show up in acc.\n      var acc = 0.0;\n\n      // Loop over shared dimension.\n      for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        let colA = t * ").concat(n," + tileCol * 4;\n        mm_Asub[tileCol] = vec4<f32>(").concat(function(e){return e?"\n      mm_readA(batchA, colA, globalRow),\n      mm_readA(batchA, colA + 1, globalRow),\n      mm_readA(batchA, colA + 2, globalRow),\n      mm_readA(batchA, colA + 3, globalRow)\n  ":"\n      mm_readA(batchA, globalRow, colA),\n      mm_readA(batchA, globalRow, colA + 1),\n      mm_readA(batchA, globalRow, colA + 2),\n      mm_readA(batchA, globalRow, colA + 3)\n  "}(t),");\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        for (var k = 0; k < ").concat(n/4,"; k++) {\n          let rowB = t * ").concat(n," + k * 4;\n          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),\n                              mm_readB(batchB, rowB + 1, globalCol),\n                              mm_readB(batchB, rowB + 2, globalCol),\n                              mm_readB(batchB, rowB + 3, globalCol));\n\n          let ACached = mm_Asub[k];\n          acc = acc + dot(ACached, BCached);\n        }\n\n        workgroupBarrier();\n      }\n\n      mm_write(batch, globalRow, globalCol, acc);\n    }\n  ")}(this.workgroupSize,this.transposeA):qU(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0),"\n    ");return e}}]),e}();var XU=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;Se(this,e),this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=t,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize);var s=null!=a,u=null!=o;s&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.transposeA=n,this.transposeB=r,this.addBias=s,this.activation=i,this.hasPreluActivationWeights=u,this.shaderKey="matMulReduce_".concat(this.activation,"_").concat(n,"_").concat(r)}return Te(e,[{key:"getUserCode",value:function(){var e;return"\n      ".concat(UU(this.activation,this.hasPreluActivationWeights),"\n      ").concat(GU(this.addBias,this.activation,this.transposeA,this.transposeB),"\n      ").concat((e=this.workgroupSize[0],"\n    var<workgroup> sumValues : array<f32, ".concat(e,">;\n    ").concat(QB()," {\n      let coords = getOutputCoords();\n      let batch = coords[0];\n      let batchA = batch % uniforms.aShape[0];\n      let batchB = batch % uniforms.bShape[0];\n      let row = coords[1];\n      let col = coords[2];\n      var sum = 0.0;\n      let Length = uniforms.dimInner;\n      for (var k = i32(localId.x); k < Length; k = k + ").concat(e,") {\n        let dataA = mm_readA(batchA, row, k);\n        let dataB = mm_readB(batchB, k, col);\n        sum = sum + dataA * dataB;\n      }\n      sumValues[localId.x] = sum;\n      workgroupBarrier();\n\n      for(var currentSize = ").concat(e/2,"u; currentSize > 1u;\n          currentSize = currentSize / 2u) {\n        if (localId.x < currentSize)\n        {\n          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];\n        }\n        workgroupBarrier();\n      }\n\n      if (localId.x == 0u) {\n        sum = sumValues[0] + sumValues[1];\n        mm_write(batch, row, col, sum);\n      }\n    }\n  ")),"\n    ")}}]),e}();var YU=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Se(this,e),this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];var c=null!=o;c&&this.variableNames.push("bias");var l=null!=u;l&&this.variableNames.push("preluActivationWeights"),this.transposeA=a,this.transposeB=i,this.addBias=c,this.activation=s,this.hasPreluActivationWeights=l,this.shaderKey="matMulSmallOutputSize_".concat(this.activation,"_").concat(a,"_").concat(i)}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(UU(this.activation,this.hasPreluActivationWeights),"\n      ").concat(GU(this.addBias,this.activation,this.transposeA,this.transposeB),"\n      ").concat(function(e){var t=e[1],n=e[0],r=t>n?t:n;return"\n  var<workgroup> mm_Asub : array<array<f32, ".concat(r,">, ").concat(t,">;\n  var<workgroup> mm_Bsub : array<array<f32, ").concat(n,">, ").concat(r,">;\n\n  // If the output size is small for matrix multiplication, avoid to use vec4\n  // and handle some elements per thread to optimally utilize the ALU.\n  // Read data from global memory to registers firstly, then store them into\n  // shared memory, so it is instruction-Level parallelism for arithmetic\n  // operations and others handle IO operations between barrier api, makes ALU\n  // and load/store units work simultaneously, could improves the performance.\n  ").concat(QB()," {\n    let tileRow = i32(localId.y);\n    let tileCol = i32(localId.x);\n    let globalRow = i32(globalId.y);\n    let globalCol = i32(globalId.x);\n    let batch = i32(globalId.z);\n    let batchA = batch % uniforms.aShape[0];\n    let batchB = batch % uniforms.bShape[0];\n\n    // uniforms.dimInner should be greater than 0.\n    let numTiles = (uniforms.dimInner - 1) / ").concat(r," + 1;\n    var acc = 0.0;\n\n    var globalColA = tileCol;\n    var globalRowB = 0;\n    var regA = mm_readA(batchA, globalRow, globalColA);\n    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);\n    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);\n    globalColA = globalColA + ").concat(r,";\n    globalRowB = globalRowB + ").concat(r,";\n\n    for (var t = 0; t < numTiles; t = t + 1) {\n      mm_Asub[tileRow][tileCol] = regA;\n      mm_Bsub[2 * tileRow][tileCol] = regB0;\n      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;\n\n      workgroupBarrier();\n\n      regA = mm_readA(batchA, globalRow, globalColA);\n      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);\n      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);\n      globalColA = globalColA + ").concat(r,";\n      globalRowB = globalRowB + ").concat(r,";\n\n      for (var k = 0; k < ").concat(r,"; k = k + 1) {\n        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];\n      }\n      workgroupBarrier();\n    }\n\n    mm_write(batch, globalRow, globalCol, acc);\n  }\n  ")}(this.workgroupSize),"\n    ")}}]),e}(),QU=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Se(this,e),this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,YS(1===t[0],(function(){return"MatMulSplitKProgram only supports batch = 1."})),this.outputShape=t,this.dispatchLayout={x:[2],y:[1],z:[0,3]};var i=(r&&this.outputShape[1]%4===0||!r&&n%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=i?4:1,i||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=uV(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],n],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=a,this.shaderKey="matMulSplitK_".concat(r,"_").concat(a,"_").concat(this.elementsPerThread,"_").concat(this.outputComponent)}return Te(e,[{key:"getUserCode",value:function(){var e=this.outputComponent;return"\n      ".concat(jU(!1,this.transposeB,!1,!1,!1,e),"\n      fn mm_write(batch: i32, row : i32, col : i32, value : ").concat(ZB(e),") {\n        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n          let coords = vec3<i32>(batch, row, col);\n          let flatIndex = getOutputIndexFromCoords(coords);\n          // The problem is that we should initialize output to zero before using.\n          // Otherwise, the original value will be added to the result.\n          for (var i = 0; i < ").concat(e,"; i = i + 1) {\n            ").concat(KB("&result[flatIndex + i]","".concat(e>1?"value[i]":"value"),"float32"),"\n          }\n        }\n      }\n      ").concat(4===e?HU(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):qU(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner),"\n    ")}}]),e}(),$U=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Se(this,e),this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=null!=n,this.hasPreluActivationWeights=null!=a,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey="biasActivation_".concat(r)}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(UU(this.activation,this.hasPreluActivationWeights),"\n    ").concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        var value = getXByOutputIndex(index);\n        ").concat(WU(this.addBias,this.activation),"\n        setOutputAtIndex(index, value);\n      }\n    }\n    ")}}]),e}(),JU=function(){function e(t){Se(this,e),this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        setOutputAtIndex(index, uniforms.value);\n      }\n    }\n  ")}}]),e}();function eW(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||pC(a))){var o=lC(i,JS(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new JU(r),u=[{type:"float32",data:[a]}];return t.runWebGPUProgram(s,[],i,u)}var tW={kernelName:BI,backendName:"webgpu",kernelFunc:eW};function nW(e){var t=e.inputs,n=e.attrs,r=t.x,a=n.shape,i=JS(r.shape),o=oC(a,i),s=JS(o);return YS(i===s,(function(){return"The new shape (".concat(o,") has ").concat(s," elements and the old ")+"shape (".concat(r.shape,") has ").concat(i," elements. The new shape and old ")+"shape must have the same number of elements."})),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}var rW={kernelName:GT,backendName:"webgpu",kernelFunc:nW};function aW(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,d=e.activation,f=void 0===d?null:d,p=t.shape.length,m=n.shape.length,v=r?t.shape[p-2]:t.shape[p-1],g=a?n.shape[m-1]:n.shape[m-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[m-2]:n.shape[m-1],x=t.shape.slice(0,-2),w=n.shape.slice(0,-2),k=JS(x),S=JS(w),C=iA(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);YS(v===g,(function(){return"Error in matMul: inner shapes (".concat(v,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var I,T,_=r?[k,v,y]:[k,y,v],E=a?[S,b,g]:[S,g,b],N=nW({inputs:{x:t},backend:i,attrs:{shape:_}}),R=nW({inputs:{x:n},backend:i,attrs:{shape:E}}),A=[N,R],O=Math.max(k,S),D=[N,R],P=[{type:"int32",data:[y]},{type:"int32",data:[b]},{type:"int32",data:[v]}],M=[O,y,b],L=RC().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(L<0){var F=RC().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),z=F>0?F:i.thresholdToIncreaseWorkgroups,B=O*Math.ceil(y/32)*Math.ceil(b/32);L=B<=z||y<=8&&B<=2*z?O*y*b<=128?oV.MatMulReduceProgram:1===O&&g>=2e3?oV.MatMulSplitKProgram:oV.MatMulSmallOutputSizeProgram:oV.MatMulPackedProgram}switch(L){case oV.MatMulReduceProgram:I=new XU(M,r,a,s,f,c);break;case oV.MatMulSplitKProgram:if(T=eW({backend:i,attrs:{shape:M,value:0,dtype:t.dtype}}),I=new QU(M,g,r,a),s||f){T=i.runWebGPUProgram(I,D,t.dtype,P,T);var V=new $U(T.shape,s,f,c),U=null,W=[T];s&&W.push(s),c&&W.push(c),"leakyrelu"===f&&(U=[{type:"float32",data:[h]}],V.uniforms+=" alpha : f32,");var j=i.runWebGPUProgram(V,W,T.dtype,U);A.push(T);var G=nW({inputs:{x:j},backend:i,attrs:{shape:C}});A.push(j);var H,K=ye(A);try{for(K.s();!(H=K.n()).done;){var q=H.value;i.disposeData(q.dataId)}}catch(N8){K.e(N8)}finally{K.f()}return G}break;case oV.MatMulSmallOutputSizeProgram:I=new YU(_,E,M,r,a,s,f,c);break;case oV.MatMulPackedProgram:var Z=i.adapterInfo.isIntel();I=new ZU(_,M,r,a,s,f,c,Z);break;default:throw new Error("Unsupported MatMulProgramType ".concat(L,"."))}s&&D.push(s),c&&D.push(c),"leakyrelu"===f&&(P.push({type:"float32",data:[h]}),I.uniforms+=" alpha : f32,");var X=nW({inputs:{x:T=i.runWebGPUProgram(I,D,t.dtype,P,T)},backend:i,attrs:{shape:C}});A.push(T);for(var Y=0,Q=A;Y<Q.length;Y++){var $=Q[Y];i.disposeData($.dataId)}return X}var iW={kernelName:U_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return aW({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},oW=function(){function e(t,n,r){Se(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=iA(n,r),this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="binaryOpComplex_".concat(t),this.op=t}return Te(e,[{key:"getUserCode",value:function(){var e=ZV(this.op,!1);return"\n      fn binaryOpComplex(\n          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {\n        ".concat(e,"\n      }\n\n      ").concat(QB("index")," {\n        if(index < uniforms.size) {\n          let areal = getARealByOutputIndex(index);\n          let aimag = getAImagByOutputIndex(index);\n          let breal = getBRealByOutputIndex(index);\n          let bimag = getBImagByOutputIndex(index);\n          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));\n        }\n      }\n    ")}}]),e}(),sW=function(){function e(t,n,r){if(Se(this,e),this.size=!0,this.variableNames=["A","B"],this.outputShape=iA(n,r),this.dispatchLayout=hV(this.outputShape),this.op=t,this.useSharedMemoryWithA=n.length<=1&&r.length>1&&n[0]<128,this.useSharedMemoryWithB=r.length<=1&&n.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:n[0],this.shaderKey="binary_".concat(t,"_").concat(this.lastDimensionSize),this.type="shared",this.workgroupSize=[256,1,1];else{var a=n.length>0&&n[n.length-1]%4===0,i=r.length>0&&r[r.length-1]%4===0;a&&i?(this.outputComponent=4,this.variableComponents=[4,4]):a&&(eC(r)||1===r[r.length-1])||i&&(eC(n)||1===n[n.length-1])?(this.outputComponent=4,this.variableComponents=a?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey="binary_".concat(t,"_").concat(this.variableComponents),this.workgroupSize=[128,1,1]}this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}return Te(e,[{key:"getUserCode",value:function(){var e,t=4===this.outputComponent?"vec4<f32>":"f32",n="\n    fn binaryOperation(a : ".concat(t,", b : ").concat(t,") -> ").concat(t," {\n      ").concat(ZV(this.op,4===this.outputComponent),"\n    };\n    ");if("shared"===this.type){var r=this.lastDimensionSize>1?"coords[".concat(this.outputShape.length-1,"]"):"0",a=this.useSharedMemoryWithB?"let a = getAByOutputIndex(index);\n          let b = sharedBuf[".concat(r,"];"):"let a = sharedBuf[".concat(r,"];\n          let b = getBByOutputIndex(index);");e="\n        ".concat(n,"\n        var<workgroup> sharedBuf : array<f32, ").concat(this.lastDimensionSize,">;\n        ").concat(QB("index")," {\n          // Fill in the shared memory buffer.\n          let localIndex = i32(localId.x);\n          if(localIndex < ").concat(this.lastDimensionSize,") {\n            sharedBuf[localIndex] = f32(").concat(this.useSharedMemoryWithB?"B":"A","[localIndex]);\n          }\n          workgroupBarrier();\n\n          if(index < uniforms.size) {\n            let coords = getCoordsFromIndex(index);\n            ").concat(a,"\n            setOutputAtIndex(index, binaryOperation(a, b));\n          }\n        }\n        ")}else e="\n       ".concat(n,"\n       ").concat(QB("index")," {\n         if (index < uniforms.size) {\n           let coords = getCoordsFromIndex(index * ").concat(this.outputComponent,");\n           let a = ").concat(t,"(getAByOutputCoords(coords));\n           let b = ").concat(t,"(getBByOutputCoords(coords));\n           setOutputAtIndex(index, binaryOperation(a, b));\n         }\n       }\n       ");return e}}]),e}();function uW(e){var t=e.inputs.x;return e.backend.incRef(t.dataId),{dataId:t.dataId,shape:t.shape,dtype:t.dtype}}var cW={kernelName:ZI,backendName:"webgpu",kernelFunc:uW};function lW(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.tensorMap.get(i.dataId),s=uW({inputs:{x:r},backend:n}),u=uW({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var hW={kernelName:sI,backendName:"webgpu",kernelFunc:lW},dW=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Se(this,e),this.variableNames=["A"],this.size=!0;this.workgroupSize=[128,1,1],this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=n,""!==r&&(this.uniforms=r),this.shaderKey="unary_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){return"\n      fn unaryOperation(a : f32) -> f32 {\n        ".concat(VU(this.op,!1),"\n      }\n      ").concat(QB("index")," {\n        if (index < uniforms.size) {\n          let a = getAByOutputIndex(index);\n          setOutputAtIndex(index, unaryOperation(a));\n        }\n      }\n      ")}}]),e}();function fW(e){var t=e.opType,n=e.cpuKernelImpl,r=e.dtype;return function(e){var a=e.inputs,i=e.backend,o=a.x,s=i,u=r||o.dtype;if(s.shouldExecuteOnCPU([o])&&null!=n){var c=s.tensorMap.get(o.dataId),l=n(c.values,u);return s.makeTensorInfo(o.shape,u,l)}var h=new dW(o.shape,t);return s.runWebGPUProgram(h,[o],u)}}function pW(e){var t=e.opType,n=e.cpuKernelImpl,r=e.supportsComplex,a=void 0!==r&&r,i=e.dtype;return function(e){var r=e.inputs,o=e.backend,s=r.a,u=r.b,c=o;if(a&&"complex64"===s.dtype){var l,h,d=c.tensorMap.get(s.dataId),f=c.tensorMap.get(u.dataId);if(t!==mV.MUL){var p=[[d.complexTensorInfos.real,f.complexTensorInfos.real],[d.complexTensorInfos.imag,f.complexTensorInfos.imag]].map((function(e){var n=(0,U.Z)(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:s.shape},o={dataId:a.dataId,dtype:a.dtype,shape:u.shape},l=new sW(t,s.shape,u.shape);return c.runWebGPUProgram(l,[i,o],UE(r.dtype,a.dtype))})),m=(0,U.Z)(p,2);l=m[0],h=m[1]}else{var v=new oW(mV.COMPLEX_MULTIPLY_REAL,s.shape,u.shape),g=new oW(mV.COMPLEX_MULTIPLY_IMAG,s.shape,u.shape),y=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:s.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:f.complexTensorInfos.real.dataId,dtype:f.complexTensorInfos.real.dtype,shape:u.shape},{dataId:f.complexTensorInfos.imag.dataId,dtype:f.complexTensorInfos.imag.dtype,shape:u.shape}];l=c.runWebGPUProgram(v,y,"float32"),h=c.runWebGPUProgram(g,y,"float32")}var b=lW({inputs:{real:l,imag:h},backend:c});return c.disposeData(l.dataId),c.disposeData(h.dataId),b}var x=i||UE(s.dtype,u.dtype);if(("string"===s.dtype||"string"===u.dtype||c.shouldExecuteOnCPU([s,u]))&&null!=n){var w=c.tensorMap.get(s.dataId).values,k=c.tensorMap.get(u.dataId).values,S="string"===s.dtype?lz(w):w,C="string"===s.dtype?lz(k):k,I=n(s.shape,u.shape,S,C,x),T=(0,U.Z)(I,2),_=T[0],E=T[1];return c.makeTensorInfo(E,x,_)}var N=new sW(t,s.shape,u.shape);return c.runWebGPUProgram(N,[s,u],x)}}function mW(e){return function(t,n,r,a,i){var o=iA(t,n),s=o.length,u=gC(o),c=cC(i,JS(o)),l=t.length,h=n.length,d=gC(t),f=gC(n),p=aA(t,o),m=aA(n,o);if(p.length+m.length===0)for(var v=0;v<c.length;++v)c[v]=e(r[v%r.length],a[v%a.length]);else for(var g=function(){var t=IC(y,s,u),n=t.slice(-l);p.forEach((function(e){return n[e]=0}));var i=CC(n,l,d),o=t.slice(-h);m.forEach((function(e){return o[e]=0}));var v=CC(o,h,f);c[y]=e(r[i],a[v])},y=0;y<c.length;++y)g();return[c,o]}}function vW(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&YS("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}function gW(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}function yW(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return gW({inputs:{real:yW(e,t,"float32"),imag:yW(e,t,"float32")},backend:e});var r=kC(JS(t),n);return e.makeTensorInfo(t,n,r)}function bW(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function xW(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}function wW(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=pE([0],n),i=mW((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),o=(0,U.Z)(i,2),s=o[0];return[o[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function kW(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return bW({inputs:{x:a},backend:n});var o=yW(n,a.shape,a.dtype),s=kW({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=gW({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=xW({inputs:{input:a},backend:n}),l=kW({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!hC(a.dtype,i)){var h=bW({inputs:{x:a},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:i}}var d=wW(n.data.get(a.dataId).values,a.shape,a.dtype,i),f=(0,U.Z)(d,3),p=f[0],m=f[1],v=f[2];return n.makeTensorInfo(p,m,v)}function SW(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;vW([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,h="string"===o.dtype?lz(c):c,d="string"===o.dtype?lz(l):l,f=r||o.dtype,p=t(o.shape,s.shape,h,d,f),m=(0,U.Z)(p,2),v=m[0],g=m[1];return u.makeTensorInfo(g,f,v)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=kW({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),h=l.complexTensorInfos.real,d=l.complexTensorInfos.imag,f=u.data.get(h.dataId).values,p=u.data.get(d.dataId).values,m=kW({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(m.dataId),g=v.complexTensorInfos.real,y=v.complexTensorInfos.imag,b=u.data.get(g.dataId).values,x=u.data.get(y.dataId).values,w=n(o.shape,s.shape,f,p,b,x),k=(0,U.Z)(w,3),S=k[0],C=k[1],I=k[2],T=u.makeTensorInfo(I,"float32",S),_=u.makeTensorInfo(I,"float32",C),E=gW({inputs:{real:T,imag:_},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(T),u.disposeIntermediateTensorInfo(_),E}var N=u.data.get(o.dataId).values,R=u.data.get(s.dataId).values,A=r||o.dtype,O=t(o.shape,s.shape,N,R,A),D=(0,U.Z)(O,2),P=D[0],M=D[1];return u.makeTensorInfo(M,A,P)}}function CW(e){return function(t,n,r,a,i,o){var s=iA(t,n),u=JS(s),c=s.length,l=gC(s),h=cC("float32",u),d=cC("float32",u),f=aA(t,s),p=aA(n,s),m=GF(r,a),v=GF(i,o),g=t.length,y=gC(t),b=n.length,x=gC(n);if(f.length+p.length===0)for(var w=0;w<h.length;w++){var k=w%m.length,S=w%v.length,C=e(m[2*k],m[2*k+1],v[2*S],v[2*S+1]);h[w]=C.real,d[w]=C.imag}else for(var I=function(){var t=IC(T,c,l),n=t.slice(-g);f.forEach((function(e){return n[e]=0}));var r=CC(n,g,y),a=t.slice(-b);p.forEach((function(e){return a[e]=0}));var i=CC(a,b,x),o=e(m[2*r],m[2*r+1],v[2*i],v[2*i+1]);h[T]=o.real,d[T]=o.imag},T=0;T<h.length;T++)I();return[h,d,s]}}var IW=mW((function(e,t){return e+t})),TW=CW((function(e,t,n,r){return{real:e+n,imag:t+r}}));SW(zC,IW,TW);function _W(e){return function(t,n,r){for(var a=lC(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function EW(e,t,n){return NW(e,_W(t),n)}function NW(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;vW(s,e);var u,c=o,l=c.data.get(s.dataId).values;if("string"===s.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=lz(l)}else u=l;var h=n||s.dtype,d=t(u,h,i);return c.makeTensorInfo(s.shape,h,d)}}var RW=_W((function(e){return Math.ceil(e)}));NW(iI,RW);function AW(e,t,n,r){var a=lC(n,JS(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=JS(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?lz(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}var OW=mW((function(e,t){return e===t?1:0})),DW=(SW(PI,OW,null,"bool"),_W((function(e){return Math.exp(e)}))),PW=(NW(MI,DW,"float32"),_W((function(e){return Math.expm1(e)}))),MW=(NW(FI,PW),_W((function(e){return Math.floor(e)}))),LW=(NW(UI,MW),mW((function(e,t){return Math.floor(e/t)})));SW(WI,LW,null,"int32");function FW(e,t,n,r,a,i,o,s,u){for(var c=IR([r,i],n),l=0;l<r;l++){for(var h=[],d=0,f=0;f<a;f++){var p=e[l*a+f];d+=p*o[f],h.push(p)}if(d<0||d>=u/i)throw new Error("Invalid indices: ".concat(h," does not index into ").concat(s));for(var m=0;m<i;m++)c.values[l*i+m]=t.get.apply(t,(0,ke.Z)(t.indexToLoc(d*i+m)))}return c}function zW(e,t,n){for(var r=IR(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var BW=mW((function(e,t){return e>=t?1:0})),VW=(SW(qI,BW,null,"bool"),mW((function(e,t){return e>t?1:0}))),UW=(SW(KI,VW,null,"bool"),mW((function(e,t){return e<=t?1:0}))),WW=(SW(nT,UW,null,"bool"),mW((function(e,t){return e<t?1:0}))),jW=(SW(tT,WW,null,"bool"),_W((function(e){return Math.log(e)})));NW(aT,jW);function GW(e,t,n,r){for(var a=cC(r,JS(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];(Number.isNaN(c)||c>s)&&(s=c)}a[i]=s}return a}var HW=mW((function(e,t){return Math.max(e,t)})),KW=(SW(dT,HW),mW((function(e,t){return Math.min(e,t)}))),qW=(SW(xT,KW),mW((function(e,t){return e*t}))),ZW=CW((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}}));SW(CT,qW,ZW);function XW(e,t,n){var r=fE(-1,n);return qW([],t,r,e,n)}var YW=mW((function(e,t){return e!==t?1:0}));SW(TT,YW,null,"bool");function QW(e,t,n,r,a){for(var i=t.length,o=JS(t),s=gC(t),u=gC(a),c=cC(n,JS(a)),l=0;l<o;++l){for(var h=IC(l,i,s),d=new Array(h.length),f=0;f<d.length;f++)d[f]=h[r[f]];c[CC(d,i,u)]=e[l]}return c}function $W(e,t,n,r){for(var a=xD(e,r),i=(0,U.Z)(a,2),o=i[0],s=i[1],u=UE(t,"int32"),c=kC(JS(o),u),l=JS(s),h=0;h<c.length;++h){for(var d=h*l,f=1,p=0;p<l;++p)f*=n[d+p];c[h]=f}return{outVals:c,outShape:o,outDtype:u}}function JW(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return kC(0,r);var a=kC(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var ej=_W((function(e){return 1/Math.sqrt(e)}));NW($T,ej);function tj(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],h=e.values,d=t.values;if(0===r)return IR(n,t.dtype);var f=u instanceof RE?u:IR(l,t.dtype);"string"===typeof u||"number"===typeof u?f.values.fill(u):"boolean"===typeof u&&f.values.fill(+u);for(var p=0;p<i;p++){for(var m=[],v=0,g=0;g<o;g++){var y=h[p*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/a)throw new Error("Invalid indices: ".concat(m," does not index into ").concat(n));for(var b=0;b<a;b++)c?f.values[v*a+b]+=d[p*a+b]:f.values[v*a+b]=0===t.rank?d[0]:d[p*a+b]}return f}function nj(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}function rj(e,t,n,r,a){var i=qA(r,t,n),o=JS(n),s=gC(r);if(i){var u=ZA(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c=IR(r,a,"string"===a?lz(e):e),l=IR(n,a),h=0;h<l.size;++h){var d=l.indexToLoc(h),f=d.map((function(e,n){return e+t[n]}));l.set.apply(l,[c.get.apply(c,(0,ke.Z)(f))].concat((0,ke.Z)(d)))}return"string"===a?l.values.map((function(e){return vE(e)})):l.values}function aj(e,t,n,r){for(var a=IR(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat((0,ke.Z)(o)))}return a}var ij=function(){function e(t,n,r,a,i,o){Se(this,e),this.separator=vE(t),this.nGramWidths=n,this.leftPad=vE(r),this.rightPad=vE(a),this.padWidth=i,this.preserveShort=o}return Te(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,s=function(){var s=o.getPadWidth(i),c=Math.max(0,s-u),l=Math.max(0,s-(a-(u+1))),h=i-(c+l),d=t+(c>0?0:u-s),f=0;f+=c*o.leftPad.length;for(var p=0;p<h;++p)f+=e[d+p].length;f+=l*o.rightPad.length,f+=(c+l+h-1)*o.separator.length,n[r+u]=new Uint8Array(f);for(var m=n[r+u],v=0,g=function(e){return e.forEach((function(e){return m[v++]=e}))},y=0;y<c;++y)g(o.leftPad),g(o.separator);for(var b=0;b<h-1;++b)g(e[d+b]),g(o.separator);if(h>0){g(e[d+h-1]);for(var x=0;x<l;++x)g(o.separator),g(o.rightPad)}else{for(var w=0;w<l-1;++w)g(o.rightPad),g(o.separator);g(o.rightPad)}},u=0;u<a;++u)s()}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var s=t[o]>=i;if(!(s=s&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var u=a-1,c=lC("int32",a);if(0===r||0===a){for(var l=new Array(r),h=0;h<=u;++h)c[h]=0;return[l,c]}c[0]=0;for(var d=function(){var e=t[f]-t[f-1],r=0;n.nGramWidths.forEach((function(t){r+=n.getNumNGrams(e,t)})),n.preserveShort&&e>0&&0===r&&(r=1),c[f]=c[f-1]+r},f=1;f<=u;++f)d();for(var p=new Array(c[u]),m=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var s=t[r+1]-t[r],u=n.getNumNGrams(s,o);n.createNGrams(e,a,p,i,u,o),i+=u})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return 1;var s=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,s)}},v=0;v<u;++v)m(v);return[p,c]}}]),e}();function oj(e,t,n,r,a,i,o,s){return new ij(n,r,a,i,o,s).compute(e,t)}var sj=mW((function(e,t){return e-t})),uj=CW((function(e,t,n,r){return{real:e-n,imag:t-r}}));SW(__,sj,uj);function cj(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=IR(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}var lj=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function hj(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);hj(e,t,Math.max(n,Math.floor(t-i*s/a+u)),Math.min(r,Math.floor(t+(a-i)*s/a+u)))}var c=e[t],l=n,h=r;for(ZS(e,n,t),lj(e[r],c)>0&&ZS(e,n,r);l<h;){for(ZS(e,l,h),l++,h--;lj(e[l],c)<0;)l+=1;for(;lj(e[h],c)>0;)h-=1}0===lj(e[n],c)?ZS(e,n,h):ZS(e,h+=1,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function dj(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=cC(n,o*r),c=cC("int32",o*r),l=function(){var t=h*s,n=e.subarray(t,t+s),i=new Array(n.length);n.forEach((function(e,t){return i[t]={value:e,index:t}})),r<i.length&&(hj(i,r),i=i.slice(0,r)),a&&i.sort(lj);for(var o=h*r,l=u.subarray(o,o+r),d=c.subarray(o,o+r),f=0;f<r;f++)l[f]=i[f].value,d[f]=i[f].index},h=0;h<o;h++)l();var d=t.slice();return d[d.length-1]=r,[IR(d,n,u),IR(d,"int32",c)]}function fj(e,t,n,r){for(var a=sC(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u=new Map,c=new Int32Array(n[a]),l=new RE(i,r,e),h=[],d=1===i[0]&&1===i[2],f=0;f<n[a];f++){var p=void 0;if(d)p=e[f].toString();else{for(var m=[],v=0;v<i[0];v++)for(var g=0;g<i[2];g++)m.push(l.get(v,f,g));p=m.join(",")}var y=u.get(p);if(null!=y)c[f]=y;else{var b=u.size;u.set(p,b),c[f]=b,h.push(f)}}var x=i.slice();x[1]=u.size;var w=new RE(x,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)w.set(l.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=x[1],{outputValues:w.values,outputShape:k,indices:c}}var pj=IW,mj=wW,vj=RW,gj=AW,yj=OW,bj=DW,xj=PW,wj=MW,kj=LW,Sj=FW,Cj=zW,Ij=BW,Tj=VW,_j=UW,Ej=WW,Nj=jW,Rj=GW,Aj=HW,Oj=KW,Dj=qW,Pj=XW,Mj=YW,Lj=$W,Fj=JW,zj=ej,Bj=tj,Vj=nj,Uj=rj,Wj=aj,jj=oj,Gj=sj,Hj=cj,Kj=dj,qj=QW,Zj=fW({opType:yV.ABS,cpuKernelImpl:Vj}),Xj={kernelName:MC,backendName:"webgpu",kernelFunc:Zj},Yj=fW({opType:yV.ACOS}),Qj={kernelName:LC,backendName:"webgpu",kernelFunc:Yj},$j=fW({opType:yV.ACOSH}),Jj={kernelName:FC,backendName:"webgpu",kernelFunc:$j},eG=pW({opType:mV.ADD,cpuKernelImpl:pj,supportsComplex:!0}),tG={kernelName:zC,backendName:"webgpu",kernelFunc:eG},nG=function(){function e(t){Se(this,e),this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t[0],this.variableNames=t.map((function(e,t){return"T".concat(t)})),this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}return Te(e,[{key:"getUserCode",value:function(){var e=[];this.variableNames.forEach((function(t){e.push("let v".concat(t," = get").concat(t,"ByOutputCoords(coords);"))}));var t=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");return"\n      ".concat(QB("index")," {\n        for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if (flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            ").concat(e.join("\n        "),"\n            setOutputAtIndex(flatIndex, ").concat(t,");\n          }\n        }\n      }\n    ")}}]),e}();var rG={kernelName:BC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;if(1===r.length)return uW({inputs:{x:r[0]},backend:n});var a=r.map((function(e){return e.dtype})).reduce((function(e,t){return UE(e,t)})),i=r.map((function(e){return e.shape})),o=new nG(i);return n.runWebGPUProgram(o,r,a)}},aG=function(){function e(t,n){Se(this,e),this.variableNames=["A"],this.workgroupSize=[16,16,1];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}return Te(e,[{key:"getUserCode",value:function(){var e=this;YS(this.workgroupSize[0]===this.workgroupSize[1],(function(){return"Must be a square tile, current tile shape is ".concat(e.workgroupSize[0]," x ").concat(e.workgroupSize[1])}));var t=this.workgroupSize[0];return"\n      var<workgroup> tile : array<array<f32, ".concat(this.workgroupSize[0]+1,">, ").concat(this.workgroupSize[0],">;\n      ").concat(QB()," {\n        var x = i32(workgroupId.x) * ").concat(t," + i32(localId.x);\n        var y = i32(workgroupId.y) * ").concat(t," + i32(localId.y);\n        let width = uniforms.outShape[0];\n        let height = uniforms.outShape[1];\n        if (x < width && y < height) {\n          tile[localId.y][localId.x] = f32(A[y * width + x]);\n        }\n        workgroupBarrier();\n\n        x = i32(workgroupId.y) * ").concat(t," + i32(localId.x);\n        y = i32(workgroupId.x) * ").concat(t," + i32(localId.y);\n        if (x < height && y < width) {\n          setOutputAtIndex((y * height + x), tile[localId.x]\n            [localId.y]);\n        }\n      }\n    ")}}]),e}(),iG=function(){function e(t,n){Se(this,e),this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=n,this.shaderKey="transpose_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){var e=XB(this.outputShape.length),t=oG(this.newDim);return"\n      ".concat(QB("index")," {\n        for(var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if(flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            setOutputAtIndex(flatIndex, A[getIndexFromCoords").concat(this.outputShape.length,"D(\n              ").concat(e,"(").concat(t,"), uniforms.aShape)]);\n          }\n        }\n      }\n    ")}}]),e}();function oG(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=new Array(t),r=0;r<e.length;r++)n[e[r]]="coords.".concat(YB(r));return n.join()}function sG(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.perm,o=n,s=a.shape.length,u=new Array(s),c=0;c<u.length;c++)u[c]=a.shape[i[c]];if(n.shouldExecuteOnCPU([a])){var l=o.tensorMap.get(a.dataId).values,h=qj(l,a.shape,a.dtype,i,u);return n.makeTensorInfo(u,a.dtype,h)}if(2===a.shape.length&&tC(i,[1,0])){var d=new aG(a.shape,i);return o.runWebGPUProgram(d,[a],a.dtype)}var f=new iG(a.shape,i);return o.runWebGPUProgram(f,[a],a.dtype)}var uG={kernelName:D_,backendName:"webgpu",kernelFunc:sG},cG=function(){function e(t,n,r){Se(this,e),this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[t.batchSize,t.inSize];var a=xD(this.inputShape,[1]),i=(0,U.Z)(a,1)[0];this.outputShape=0===i.length?[1]:i,t.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:t.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=n,this.shaderKey="reduce_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){var e="",t="0.0",n=this.workgroupSize[0];"min"===this.reduceType||"max"===this.reduceType?(e="\n         if (isnan(candidate)) {\n          bestValue = uniforms.NAN;\n         } else if (!isnan(bestValue) && candidate ".concat("min"===this.reduceType?"<":">"," bestValue)\n           {  bestValue = candidate; }"),t="f32(x[offset])"):"sum"===this.reduceType||"mean"===this.reduceType?e=" bestValue = bestValue + candidate; ":"prod"===this.reduceType?(e=" bestValue = bestValue * candidate; ",t="1.0"):"all"===this.reduceType?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",t="1.0"):"any"===this.reduceType&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",t="0.0");var r="mean"===this.reduceType?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);",a="\n         var<workgroup> xBestValues : array<f32, ".concat(n,">;\n       ");return"\n       fn DIV_CEIL(a : u32, b : u32) -> u32 {\n        return ((a - 1u) / b + 1u);\n       }\n\n       ".concat(a,"\n       fn getOffset(outputIndex : i32) -> i32 {\n         let outputCoords = getCoordsFromIndex(outputIndex);\n         let offset = ").concat(1===this.outputShape.length?"outputCoords":"outputCoords[0]"," * uniforms.reduceSize;\n          return offset;\n       }\n       ").concat(QB("index")," {\n         let outputIndex = index / ").concat(n,";\n         let offset = getOffset(outputIndex);\n         var bestValue = ").concat(t,";\n         let Length = uniforms.reduceSize;\n         let WorkPerThread = DIV_CEIL(u32(Length), ").concat(n,"u);\n         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;\n             k = k + ").concat(n,") {\n           let candidate = f32(x[offset + k]);\n           ").concat(e,"\n         }\n         xBestValues[localId.x] = bestValue;\n         workgroupBarrier();\n\n         var reduceSize = min(u32(Length), ").concat(n,"u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (localId.x < currentSize) {\n            let candidate = xBestValues[localId.x + interval];\n            ").concat(e,"\n            xBestValues[localId.x] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (localId.x == 0u && outputIndex < uniforms.size) {\n          ").concat(r,"\n        }\n       }\n     ")}}]),e}();function lG(e,t,n,r,a){var i=e.shape.length,o=[],s=sC(t,e.shape),u=s,c=SD(u,i),l=e;null!=c&&(l=sG({inputs:{x:e},attrs:{perm:c},backend:a}),u=ID(u.length,i),o.push(l)),kD(r,u,i);var h,d=xD(l.shape,u),f=(0,U.Z)(d,2),p=f[0],m=f[1],v=p;if(n&&(v=wD(p,s)),"max"!==r&&"prod"!==r||!a.shouldExecuteOnCPU([l])){var g=JS(m),y={windowSize:g,inSize:g,batchSize:JS(l.shape)/g,outSize:1},b="mean"===r?"float32":WE(e.dtype),x=[{type:"int32",data:[g]}],w=new cG(y,r,a.device.limits.maxComputeWorkgroupSizeX),k=a.runWebGPUProgram(w,[l],b,x);o.push(k),h=nW({inputs:{x:k},attrs:{shape:v},backend:a})}else{var S=a.tensorMap.get(l.dataId).values;switch(r){case"max":var C=Rj(S,JS(m),v,e.dtype);h=a.makeTensorInfo(v,e.dtype,C);break;case"prod":var I=Lj(l.shape,l.dtype,S,u),T=I.outVals,_=I.outShape,E=I.outDtype;h=a.makeTensorInfo(_,E,T);break;default:throw new Error("".concat(r," CPU implementation is not yet supported."))}}return o.forEach((function(e){return a.disposeData(e.dataId)})),h}var hG={kernelName:VC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.keepDims;return lG(a,r.axis,i,"all",n)}};var dG={kernelName:UC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.keepDims;return lG(a,r.axis,i,"any",n)}},fG=function(){function e(t,n,r){Se(this,e),this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;var a=[n];this.op="min"===r?"<":">";var i=xD(t,a),o=(0,U.Z)(i,2),s=o[0],u=o[1];this.outputShape=0===s.length?[1]:s,this.dispatchLayout=hV(this.outputShape),JS(u)<32?(this.type="plain",this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=uV(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=t,this.shaderKey="argMinMax_".concat(this.op,"_").concat(this.type)}return Te(e,[{key:"getUserCode",value:function(){var e=this,t=this.workgroupSize[0],n=function(){return 1===e.inputShape.length?"uniforms.xShape":"uniforms.xShape.".concat(YB(e.inputShape.length-1))},r=function(){var t="";if(1===e.outputShape.length)1!==e.inputShape.length&&(t+="outputCoords,");else for(var n=0;n<e.outputShape.length;n++)t+="outputCoords.".concat(YB(n),",");return t};if("shared"===this.type){var a="\n      var<workgroup> xBestIndices : array<i32, ".concat(t,">;\n      var<workgroup> xBestValues : array<f32, ").concat(t,">;\n    ");return"\n      fn DIV_CEIL(a : u32, b : u32) -> u32 {\n        return ((a - 1u) / b + 1u);\n      }\n\n      ".concat(a,"\n\n      ").concat(QB("index")," {\n        let outputIndex = index / ").concat(t,";\n        let reduceLength = ").concat(n(),";\n\n        var bestIndex = i32(localId.x);\n        var bestValue = uniforms.infinityValue;\n        let outputCoords = getCoordsFromIndex(outputIndex);\n        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;\n            k = k + ").concat(t,") {\n          let candidate = getX(").concat(r()," k);\n          if (!isnan(candidate) && candidate ").concat(this.op," bestValue) {\n            bestValue = candidate;\n            bestIndex = k;\n          }\n        }\n        xBestValues[localId.x] = bestValue;\n        xBestIndices[localId.x] = bestIndex;\n        workgroupBarrier();\n\n        var reduceSize = min(u32(reduceLength), ").concat(t,"u);\n        for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n            currentSize = reduceSize / 2u) {\n          let interval = DIV_CEIL(reduceSize, 2u);\n          if (localId.x < currentSize) {\n            let candidate = xBestValues[localId.x + interval];\n            if (candidate ").concat(this.op," bestValue) {\n              bestValue = candidate;\n              xBestValues[localId.x] = bestValue;\n              xBestIndices[localId.x] = xBestIndices[localId.x + interval];\n            }\n          }\n          reduceSize = interval;\n          workgroupBarrier();\n        }\n\n        if (localId.x == 0u && outputIndex < uniforms.size) {\n          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);\n        }\n      }\n    ")}return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let outputCoords = getCoordsFromIndex(index);\n          var bestIndex = 0;\n          var bestValue = getX(").concat(r()," 0);\n          let reduceLength = ").concat(n(),";\n          for (var i = 1; i < reduceLength; i++) {\n            let candidate = getX(").concat(r()," i);\n            if (candidate ").concat(this.op," bestValue) {\n              bestValue = candidate;\n              bestIndex = i;\n            }\n          }\n          setOutputAtIndexI32(index, bestIndex);\n        }\n      }\n      ")}}]),e}();var pG={kernelName:WC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=sC(r.axis,a.shape),o=SD(i,a.shape.length),s=a,u=[];null!=o&&(s=sG({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=ID(i.length,s.shape.length)),kD("argMax",[i[0]],s.shape.length);var c=new fG(s.shape,i[0],"max"),l=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=n.runWebGPUProgram(c,[s],"int32",l);return u.forEach((function(e){return n.disposeData(e.dataId)})),h}};var mG={kernelName:jC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=sC(r.axis,a.shape),o=SD(i,a.shape.length),s=a,u=[];null!=o&&(s=sG({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=ID(i.length,s.shape.length)),kD("argMin",[i[0]],s.shape.length);var c=new fG(s.shape,i[0],"min"),l=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=n.runWebGPUProgram(c,[s],"int32",l);return u.forEach((function(e){return n.disposeData(e.dataId)})),h}},vG=fW({opType:yV.ASIN}),gG={kernelName:GC,backendName:"webgpu",kernelFunc:vG},yG=fW({opType:yV.ASINH}),bG={kernelName:HC,backendName:"webgpu",kernelFunc:yG},xG=fW({opType:yV.ATAN}),wG={kernelName:KC,backendName:"webgpu",kernelFunc:xG},kG=pW({opType:mV.ATAN2}),SG={kernelName:ZC,backendName:"webgpu",kernelFunc:kG},CG=fW({opType:yV.ATANH}),IG={kernelName:qC,backendName:"webgpu",kernelFunc:CG},TG=function(){function e(t){Se(this,e),this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let batch = coords[0];\n          let d = coords[3];\n\n          let xRCCorner = coords.yz * uniforms.strides;\n          let xRCorner = xRCCorner.x;\n          let xCCorner = xRCCorner.y;\n\n          let value = getX(batch, xRCorner, xCCorner, d);\n          setOutputAtIndex(index, value);\n        }\n      }\n    ")}}]),e}(),_G=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Se(this,e),this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=a,this.includeBatchIndex=i,this.shaderKey="pool2D_".concat(n,"_").concat(r,"_").concat(a,"_").concat(i)}return Te(e,[{key:"getUserCode",value:function(){var e;if("avg"===this.poolType)e="resultValue = resultValue + value; count = count + 1.0;";else if(this.computePositions){var t=this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC";e="let currMaxValue = mix(value, maxValue, maxValueFound);\n      if (value >= currMaxValue) {\n        maxValue = value;\n        maxValueFound = 1.0;\n        maxPosition = ".concat(t,";\n      }")}else e="resultValue = max(value, resultValue);";var n="resultValue";return"avg"===this.poolType&&(n="resultValue / max(count, 1.0)"),"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n          let batch = coords[0];\n          let d = coords[3];\n          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;\n          let xRCorner = xRCCorner.x;\n          let xCCorner = xRCCorner.y;\n\n          ").concat(this.computePositions?"var maxValue = 0.0;\n            var maxValueFound = 0.0;\n            var maxPosition = 0;":"var resultValue = ".concat("avg"===this.poolType?"0.0":"-1.0 / pow(10.0, -20.0)",";"),"\n\n          var count = 0.0;\n          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {\n            let xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= uniforms.convDims.x) {\n              continue;\n            }\n\n            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {\n              let xC = xCCorner + wC;\n              if (xC < 0 || xC >= uniforms.convDims.y) {\n                continue;\n              }\n\n              let value = getX(batch, xR, xC, d);\n              ").concat(e,"\n            }\n          }\n\n          ").concat(this.computePositions?"setOutputAtIndexI32(index, maxPosition);":"setOutputAtIndex(index, ".concat(n,");"),"\n        }\n      }\n    ")}}]),e}(),EG=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Se(this,e),this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=a,this.includeBatchIndex=i,this.shaderKey="pool3D_".concat(n,"_").concat(r,"_").concat(a,"_").concat(i)}return Te(e,[{key:"getUserCode",value:function(){var e;if("avg"===this.poolType)e="resultValue += value; count += 1.0;";else if(this.computePositions){var t=this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC";e="let currMaxValue = mix(value, maxValue, maxValueFound);\n      if (value >= currMaxValue) {\n        maxValue = value;\n        maxValueFound = 1.0;\n        maxPosition = ".concat(t,";\n      }")}else e="resultValue = max(value, resultValue);";var n="resultValue";return"avg"===this.poolType&&(n="resultValue / max(count, 1.0)"),"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let batch = coords.x;\n          let ch = coords.u;\n\n          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;\n          let xDCorner = xCorner.x;\n          let xRCorner = xCorner.y;\n          let xCCorner = xCorner.z;\n\n          ").concat(this.computePositions?"var maxValue = 0.0;\n            var maxValueFound = 0.0;\n            var maxPosition = 0;":"var resultValue = ".concat("avg"===this.poolType?"0.0":"-1.0 / pow(10.0, -20.0)",";"),"\n\n          var count = 0.0;\n          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {\n            let xD = xDCorner + wD;\n            if (xD < 0 || xD >= uniforms.convDims.x) {\n              continue;\n            }\n\n            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {\n              let xR = xRCorner + wR;\n              if (xR < 0 || xR >= uniforms.convDims.y) {\n                continue;\n              }\n\n              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {\n                let xC = xCCorner + wC;\n                if (xC < 0 || xC >= uniforms.convDims.z) {\n                  continue;\n                }\n\n                let value = getX(batch, xD, xR, xC, ch);\n                ").concat(e,"\n              }\n            }\n          }\n\n          ").concat(this.computePositions?"setOutputAtIndexI32(index, maxPosition);":"setOutputAtIndex(index, ".concat(n,");"),"\n        }\n      }\n    ")}}]),e}();function NG(e){var t=e.inputs,n=e.backend,r=e.attrs;return lG(t.x,r.reductionIndices,r.keepDims,"max",n)}var RG={kernelName:hT,backendName:"webgpu",kernelFunc:NG};function AG(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.keepDims;return lG(a,r.axis,i,"mean",n)}var OG={kernelName:yT,backendName:"webgpu",kernelFunc:AG};function DG(e,t,n,r){if(1===t.filterWidth&&1===t.filterHeight&&tC(t.inShape,t.outShape))return uW({inputs:{x:e},backend:r});if(t.filterWidth===t.inWidth&&t.filterHeight===t.inHeight&&1===t.batchSize&&"VALID"===t.padInfo.type){var a,i=e.shape.length,o=nW({inputs:{x:e},backend:r,attrs:{shape:[e.shape[i-3]*e.shape[i-2],e.shape[i-1]]}});"avg"===n?a=AG({inputs:{x:o},backend:r,attrs:{axis:0,keepDims:!1}}):(YS("max"===n,(function(){return"Invalid pool type ".concat(n)})),a=NG({inputs:{x:o},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));var s=nW({inputs:{x:a},backend:r,attrs:{shape:t.outShape}});return r.disposeData(o.dataId),r.disposeData(a.dataId),s}var u,c=[{type:"int32",data:[t.strideHeight,t.strideWidth]}];return 1===t.filterHeight&&1===t.filterWidth?u=new TG(t):("avg"===n?u=new _G(t,"avg"):(YS("max"===n,(function(){return"Invalid pool type ".concat(n)})),u=new _G(t,"max")),c.push({type:"int32",data:[t.padInfo.top,t.padInfo.left]},{type:"int32",data:[t.dilationHeight,t.dilationWidth]},{type:"int32",data:[t.inHeight,t.inWidth]},{type:"int32",data:[t.effectiveFilterHeight,t.effectiveFilterWidth]})),r.runWebGPUProgram(u,[e],e.dtype,c)}var PG={kernelName:XC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;return DG(a,hO(a.shape,i,o,1,s,u),"avg",n)}};var MG={kernelName:QC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=dO(a.shape,i,o,[1,1,1],s,c,u),h=new EG(l,"avg"),d=[{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.padInfo.front,l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.inDepth,l.inHeight,l.inWidth]},{type:"int32",data:[l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[a],a.dtype,d)}},LG=function(){function e(t){Se(this,e),this.variableNames=["dy"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32, avgMultiplier : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d = coords[3];\n\n        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;\n        let dyRCorner = dyRCCorner.x;\n        let dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            let dyValue = getDy(batch, idyR, idyC, d);\n\n            dotProd = dotProd + dyValue * uniforms.avgMultiplier;\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}(),FG=function(){function e(t){Se(this,e),this.variableNames=["dy"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,\n       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let ch = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyDCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {\n          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);\n\n          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {\n            continue;\n          }\n          let idyD = i32(dyD);\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              dotProd += dyValue * uniforms.avgMultiplier;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}();var zG={kernelName:$C,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=dO(i.shape,o,s,1,u,c),h=new FG(l),d=1/(l.filterDepth*l.filterHeight*l.filterWidth),f=[{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.effectiveFilterDepth-1-l.padInfo.front,l.effectiveFilterHeight-1-l.padInfo.top,l.effectiveFilterWidth-1-l.padInfo.left]},{type:"int32",data:[l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth]},{type:"int32",data:[l.outDepth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]},{type:"float32",data:[d]}];return n.runWebGPUProgram(h,[a],i.dtype,f)}};var BG={kernelName:YC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;pV([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=hO(o.shape,s,u,1,c),h=new LG(l),d=1/(l.filterHeight*l.filterWidth),f=[{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.effectiveFilterHeight-1-l.padInfo.top,l.effectiveFilterWidth-1-l.padInfo.left]},{type:"int32",data:[l.dilationHeight,l.dilationWidth]},{type:"int32",data:[l.effectiveFilterHeight,l.effectiveFilterWidth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]},{type:"float32",data:[d]}];return n.runWebGPUProgram(h,[a],o.dtype,f)}};var VG={kernelName:JC,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return aW({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},UG=function(){function e(t,n){Se(this,e),this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.rank=n.length,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=t,this.uniforms="start : ".concat(XB(t.length),", "),this.shaderKey="slice"}return Te(e,[{key:"getUserCode",value:function(){var e,t=XB(this.rank),n=function(e){if(1===e)return"sourceLoc";if(e<=6)return WG.slice(0,e).map((function(e){return"sourceLoc.".concat(e)})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);return e=1===this.start.length?this.outputShape.map((function(e,t){return"sourceLoc = uniforms.start + coords;"})):this.outputShape.map((function(e,t){return"sourceLoc.".concat(WG[t]," = uniforms.start.").concat(YB(t)," + coords.").concat(WG[t],";")})),"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          var sourceLoc : ").concat(t,";\n          let coords = getCoordsFromIndex(index);\n          ").concat(e.join("\n"),"\n          setOutputAtIndex(index, getSource(").concat(n,"));\n        }\n      }\n    ")}}]),e}(),WG=["x","y","z","w","u","v"];function jG(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=XA(a,r.begin,r.size),o=(0,U.Z)(i,2),s=o[0],u=o[1];if(HA(a,s,u),n.shouldExecuteOnCPU([a])||"string"===a.dtype){var c=n.tensorMap.get(a.dataId),l=Uj(c.values,s,u,a.shape,a.dtype);return n.makeTensorInfo(u,a.dtype,l)}if(0===JS(u))return n.makeTensorInfo(u,a.dtype,[]);var h=new UG(s,u),d=[{type:"int32",data:s}];return n.runWebGPUProgram(h,[a],a.dtype,d)}var GG={kernelName:a_,backendName:"webgpu",kernelFunc:jG},HG={kernelName:eI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;YS(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=RF(a.shape,i,s),c=AF(u.length,i.length),l=OF(a.shape,i,s),h=DF(o,i.length),d=PF(l,o,i.length),f=[],p=nW({inputs:{x:a},backend:n,attrs:{shape:u}}),m=sG({inputs:{x:p},backend:n,attrs:{perm:c}}),v=nW({inputs:{x:m},backend:n,attrs:{shape:l}}),g=jG({inputs:{x:v},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(v),f.forEach((function(e){return n.disposeData(e.dataId)})),g}},KG="\n  fn bincount_write(index: i32, value: f32) {\n    ".concat(KB("&result[index]","value","float32"),"\n  }\n"),qG=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Se(this,e),this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=t,this.rank=t.length,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=n,this.hasWeights&&this.variableNames.push("w"),this.shaderKey="bincount_".concat(this.hasWeights,"_").concat(this.binaryOutput,"_").concat(this.rank)}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(this.binaryOutput?"\n  fn bincount_write(index: i32, value: f32) {\n    atomicStore(&result[index], bitcast<i32>(value));\n  }\n":KG,"\n  ").concat(QB("index")," {\n    ").concat(1===this.rank?"if (index < uniforms.xShape) {\n      let indexVal = i32(getX(index));\n      if (indexVal < uniforms.binCountSize) {\n        let value = ".concat(this.binaryOutput?1:this.hasWeights?"getW(index)":"1.",";\n        bincount_write(indexVal, value);\n      }\n    }"):"let coord = getCoordsFromIndex(index);\n    if (coordsInBounds2D(coord, uniforms.xShape)) {\n      let indexVal = i32(getX(coord[0], coord[1]));\n      if (indexVal < uniforms.binCountSize) {\n        let value = ".concat(this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1.",";\n        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);\n      }\n    }"),"\n  }\n  ")}}]),e}();var ZG={kernelName:tI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=JS(a.shape),u=JS(i.shape)>0,c=[o],l=i.dtype,h=eW({backend:n,attrs:{shape:c,value:0,dtype:l}}),d=new qG([s],u),f=[{type:"int32",data:[o]}],p=u?[a,i]:[a];return n.runWebGPUProgram(d,p,l,f,h)}},XG=function(){function e(t){Se(this,e),this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}return Te(e,[{key:"getUserCode",value:function(){return"\n  ".concat(QB("index")," {\n    if (index < uniforms.size) {\n      var s0 = 1.0;\n      var s1 = 1.0;\n      let indexS0 = index - uniforms.size + uniforms.s0Size;\n      let indexS1 = index - uniforms.size + uniforms.s1Size;\n      if (indexS0 >= 0) {\n        s0 = getS0(indexS0);\n      }\n      if (indexS1 >= 0) {\n        s1 = getS1(indexS1);\n      }\n\n      if (s0 == 1.0) {\n        setOutputAtIndex(index, s1);\n      } else if (s1 == 1.0) {\n        setOutputAtIndex(index, s0);\n      } else if (s0 != s1) {\n        setOutputAtIndex(index, uniforms.NAN);\n      } else {\n        setOutputAtIndex(index, s0);\n      }\n    }\n  }\n  ")}}]),e}();var YG={kernelName:rI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1;if(n.shouldExecuteOnCPU([r,a])){var i=n.tensorMap.get(r.dataId),o=n.tensorMap.get(a.dataId),s=i.values,u=o.values,c=iA(Array.from(s),Array.from(u));return n.makeTensorInfo([c.length],"int32",Int32Array.from(c))}var l=JS(r.shape),h=JS(a.shape),d=Math.max(l,h),f=new XG(d),p=[{type:"int32",data:[l]},{type:"int32",data:[h]}];return n.runWebGPUProgram(f,[r,a],"int32",p)}},QG=pW({opType:mV.NOT_EQUAL,dtype:"bool",cpuKernelImpl:Mj}),$G={kernelName:TT,backendName:"webgpu",kernelFunc:QG};function JG(e){var t=e.inputs,n=e.backend,r=t.input;return uW({inputs:{x:n.tensorMap.get(r.dataId).complexTensorInfos.real},backend:n})}var eH={kernelName:UT,backendName:"webgpu",kernelFunc:JG};var tH={kernelName:aI,backendName:"webgpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return uW({inputs:{x:i},backend:r});var s=pP(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=lW({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeData(u.dataId),c}if("complex64"===i.dtype){var l=JG({inputs:{input:i},backend:r}),h=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeData(l.dataId),h}if(!hC(i.dtype,o)){var d=uW({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var f=r.tensorMap.get(i.dataId).values,p=mj(f,i.shape,i.dtype,o),m=(0,U.Z)(p,3),v=m[0],g=m[1],y=m[2];return r.makeTensorInfo(v,g,y)}if("int32"===o)return function(e,t){var n=new dW(e.shape,yV.TO_INT),r=t.runWebGPUProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var b=r.makeTensorInfo([],"bool",cC("bool",1)),x=QG({inputs:{a:i,b:b},backend:r});return r.disposeData(b.dataId),x}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},nH=fW({opType:yV.CEIL,cpuKernelImpl:vj}),rH={kernelName:iI,backendName:"webgpu",kernelFunc:nH},aH=function(){function e(t){Se(this,e),this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if(index < uniforms.size) {\n          let value = getAByOutputIndex(index);\n          var clampedValue = clamp(\n              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));\n          clampedValue = select(clampedValue, value, isnanVec4(value));\n          setOutputAtIndex(index, clampedValue);\n        }\n      }\n    ")}}]),e}(),iH=function(){function e(t){Se(this,e),this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if(index < uniforms.size) {\n          let value = getAByOutputIndex(index);\n          if (isnan(value)) {\n            setOutputAtIndex(index, value);\n            return;\n          }\n          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));\n        }\n      }\n    ")}}]),e}();var oH={kernelName:oI,backendName:"webgpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=[{type:"float32",data:[a.clipValueMin]},{type:"float32",data:[a.clipValueMax]}];return t=JS(i.shape)%4===0?new aH(i.shape):new iH(i.shape),r.runWebGPUProgram(t,[i],i.dtype,o)}},sH=function(){function e(t){Se(this,e),this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let re = abs(getRealByOutputIndex(index));\n        let im = abs(getImagByOutputIndex(index));\n        let mx = max(re, im);\n\n        // The length function in wgsl may be not underflow-safe on some GPUs.\n        // So the safe solution is to ensure underflow-safety in all cases.\n        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));\n      }\n    }\n  ")}}]),e}();function uH(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var cH={kernelName:uI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.tensorMap.get(r.dataId),i=new sH(r.shape),o=[uH(r,a.complexTensorInfos.real),uH(r,a.complexTensorInfos.imag)];return n.runWebGPUProgram(i,o,o[0].dtype)}},lH=function(){function e(t){Se(this,e),this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=TF(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)})),this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=t.length-1;for(var n=0;n<this.offsetLength;n++)this.uniforms+="offset".concat(n," : i32,");this.shaderKey="concat"}return Te(e,[{key:"getUserCode",value:function(){var e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(var t=1;t<this.offsetLength;t++)e.push("else if (yC < uniforms.offset".concat([t],"){ ")+"setOutputAtCoords(coords.x, coords.y, getT".concat(t,"(yR, yC - uniforms.offset").concat(t-1,")); }"));var n=this.offsetLength,r=this.offsetLength-1;e.push("else { setOutputAtCoords(coords.x, coords.y, getT".concat(n,"(yR, yC - uniforms.offset").concat(r,")); }"))}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return"\n      ".concat(QB("index")," {\n        for(var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if(flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            let yR = coords.x;\n            let yC = coords.y;\n\n            ").concat(e.join("\n        "),"\n          }\n        }\n      }\n    ")}}]),e}();function hH(e){var t=e.inputs,n=e.backend,r=t.input;return uW({inputs:{x:n.tensorMap.get(r.dataId).complexTensorInfos.imag},backend:n})}var dH={kernelName:YI,backendName:"webgpu",kernelFunc:hH};function fH(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return JG({inputs:{input:e},backend:n})})),i=e.map((function(e){return hH({inputs:{input:e},backend:n})})),o=fH(a,t,n),s=fH(i,t,n),u=lW({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeData(e.dataId)})),i.forEach((function(e){return n.disposeData(e.dataId)})),n.disposeData(o.dataId),n.disposeData(s.dataId),u}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=JS(e.shape.slice(t));return nW({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),h=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),d=TF(l.map((function(e){return e.shape})),1),f=1===l[0].shape[0],p=gj(h,d,r,f),m=TF(e.map((function(e){return e.shape})),t),v=n.makeTensorInfo(m,r,p);return l.forEach((function(e){return n.disposeData(e.dataId)})),v}var g=n.device.limits.maxStorageBuffersPerShaderStage-1;if(e.length>g){for(var y=[],b=0;b<e.length;b+=g){var x=e.slice(b,b+g);y.push(fH(x,t,n))}for(var w=fH(y,t,n),k=0,S=y;k<S.length;k++){var C=S[k];n.disposeData(C.dataId)}return w}var I=function(e,t,n){var r=TF(e.map((function(e){return e.shape})),t),a=e.map((function(e){return nW({inputs:{x:e},backend:n,attrs:{shape:[JS(e.shape.slice(0,t)),JS(e.shape.slice(t))]}})}));return{tensors2D:a,outShape:r}}(e,t,n),T=I.tensors2D,_=I.outShape,E=T.map((function(e){return e.shape})),N=new lH(E),R=[],A=new Array(E.length-1);if(A.length>0){A[0]=E[0][1],R.push({type:"int32",data:[A[0]]});for(var O=1;O<A.length;O++)A[O]=A[O-1]+E[O][1],R.push({type:"int32",data:[A[O]]})}var D=n.runWebGPUProgram(N,T,T[0].dtype,R);T.forEach((function(e){return n.disposeData(e.dataId)}));var P=nW({inputs:{x:D},backend:n,attrs:{shape:_}});return n.disposeData(D.dataId),P}function pH(e){var t=e.inputs,n=e.backend,r=sC(e.attrs.axis,t[0].shape)[0];IF(t.map((function(e){return e.shape})),r);var a=TF(t.map((function(e){return e.shape})),r);if(0===JS(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return JS(e.shape)>0}));return 1===i.length?uW({inputs:{x:i[0]},backend:n}):fH(i,r,n)}var mH={kernelName:cI,backendName:"webgpu",kernelFunc:pH};var vH=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Se(this,e),this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=t.outShape,this.isChannelsLast="channelsLast"===t.dataFormat,this.isVec4=((t.inChannels%4===0||t.inChannels%3===0)&&this.isChannelsLast||t.outWidth%4===0&&!this.isChannelsLast)&&t.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=cV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=lV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&t.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),i&&(this.variableNames.push("bias"),this.variableComponents.push(4)),s&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=u,this.addBias=i,this.activation=o,this.hasPreluActivationWeights=s,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=n%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=a%this.tileInner===0,this.shaderKey="conv2DMM_".concat(this.elementsPerThread,"_").concat(this.activation,"}_").concat(this.fitAOuter,"_").concat(this.fitBOuter,"_").concat(this.fitInner,"_").concat(this.isVec4,"_").concat(this.innerElementSize,"_").concat(this.isChannelsLast,"_").concat(this.sequentialAccessByThreads)}return Te(e,[{key:"getUserCode",value:function(){var e=this.isVec4?HU(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):qU(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),t=this.isVec4?[this.innerElementSize,4,4]:[1,1,1],n="\n    ".concat(function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:4,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:4,l=e?"\n      let coord = vec4<i32>(batch, xRow, xCol, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, xRow, xCol);\n      ",h=e?"\n      let coords = vec4<i32>(\n        batch,\n        row / outWidth,\n        row % outWidth,\n        col);\n      ":"\n      let coords = vec4<i32>(\n        batch,\n        row,\n        col / outWidth,\n        col % outWidth);\n      ",d=e?"uniforms.xShape[1]":"uniforms.xShape[2]",f=e?"uniforms.xShape[2]":"uniforms.xShape[3]",p=e?"row":"col",m=e?"col":"row",v="\n      let inChannels = uniforms.wShape[2];\n      let outWidth = ".concat(e?"uniforms.outShape[2]":"uniforms.outShape[3]",";\n      let outRow = ").concat(p," / outWidth;\n      let outCol = ").concat(p," % outWidth;\n\n      let WRow = ").concat(m," / (uniforms.filterDims[1] * inChannels);\n      let WCol = ").concat(m," / inChannels % uniforms.filterDims[1];\n      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];\n      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];\n      let xCh = ").concat(m," % inChannels;\n      var resData = ").concat(ZB(s),"(0.0);\n      // The bounds checking is always needed since we use it to pad zero for\n      // the 'same' padding type.\n      if (xRow >= 0 && xRow < ").concat(d," && xCol >= 0 && xCol < ").concat(f,") {\n        ").concat(l,"\n        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);\n        ").concat(function(e){switch(e){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = x[xIndex / 4];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(s),"\n      }\n      return resData;"),g=e?t&&r?"\n      ".concat(v):"\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ".concat(v,"\n      }\n      return ").concat(ZB(s),"(0.0);"):r&&n?"\n      ".concat(v):"\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ".concat(v,"\n      }\n      return ").concat(ZB(s),"(0.0);"),y="".concat(function(e){switch(e){case 1:return"return W[row * uniforms.wShape[3] + col];";case 4:return"return W[(row * uniforms.wShape[3] + col) / 4];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(u)),b=ZB(c),x=ZB(e?s:u),w=ZB(e?u:s);return"\n      ".concat(UU(i,o,4===c,4),"\n      fn mm_readA(batch: i32, row : i32, col : i32) -> ").concat(x," {\n        ").concat(e?g:y,"\n      }\n\n      fn mm_readB(batch: i32, row : i32, col : i32) -> ").concat(w," {\n        ").concat(e?y:g,"\n      }\n\n      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ").concat(b,") {\n        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n        {\n        var value = valueIn;\n        let outWidth = ").concat(e?"uniforms.outShape[2]":"uniforms.outShape[3]",";\n        ").concat(h,"\n        ").concat(WU(a,i),"\n        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }")}(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,t[0],t[1],t[2]),"\n    ").concat(e,"\n  ");return n}}]),e}(),gH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Se(this,e),this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=t.outShape,this.isChannelsLast="channelsLast"===t.dataFormat,this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n,this.activation=r,this.hasPreluActivationWeights=a,n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.shaderKey="conv2dnaive_".concat(this.activation,"_").concat(this.isChannelsLast)}return Te(e,[{key:"getUserCode",value:function(){return"\n       ".concat(UU(this.activation,this.hasPreluActivationWeights,!1,4),"\n       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{\n         let coords = vec4<i32>(batch, row, col, chan);\n         if (coordsInBounds4D(coords, uniforms.xShape)) {\n           return  getX(batch, row, col, chan);\n         } else {\n          return 0.0;\n         }\n       }\n       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{\n         let coords = vec4<i32>(row, col, xChannel, outChannel);\n         if(coordsInBounds4D(coords, uniforms.wShape)) {\n           return getW(row, col, xChannel, outChannel);\n          } else {\n            return 0.0;\n          }\n       }\n       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {\n         let coords = ").concat(this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);","\n         if (coordsInBounds4D(coords, uniforms.outShape)) {\n           var value = valueIn;\n           ").concat(WU(this.addBias,this.activation),"\n           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);\n         }\n       }\n       ").concat(QB("index")," {\n         let coords = getOutputCoords();\n         let batch = coords[0];\n         let outChannel = ").concat(this.isChannelsLast?"coords[3];":"coords[1];","\n         let outRow = ").concat(this.isChannelsLast?"coords[1];":"coords[2];","\n         let outCol = ").concat(this.isChannelsLast?"coords[2];":"coords[3];","\n         var acc : f32 = 0.0;\n         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {\n           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {\n             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];\n             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];\n             for (var xChannel = 0; xChannel < ").concat(this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"," xChannel = xChannel + 1) {\n               ").concat(this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);","\n               let f = readFilt(row, col, xChannel, outChannel);\n               acc = acc + v * f;\n             }\n           }\n         }\n         writeResult(batch, outRow, outCol, outChannel, acc);\n       }\n     ")}}]),e}(),yH=function(){function e(t,n){Se(this,e),this.variableNames=["x"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,\n       inChannels : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=n,this.shaderKey="im2col_".concat(this.isChannelsLast)}return Te(e,[{key:"getUserCode",value:function(){var e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,n=this.isChannelsLast?"coords[1]":"coords[2]",r=this.isChannelsLast?"coords[2]":"coords[1]",a=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return"\n    ".concat(QB("index")," {\n      let coords = getCoordsFromIndex(index);\n      if(index < uniforms.size) {\n        let batch = coords[0];\n        let row = ").concat(n,";\n        let col = ").concat(r,";\n        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];\n        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);\n        var value = 0.0;\n        if(xRow < uniforms.xShape[").concat(e,"] && xRow >= 0) {\n          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -\n              uniforms.pads[1];\n          let xCol = offsetX + uniforms.dilations[1] * ((col %\n              uniforms.itemsPerBlockRow) / uniforms.inChannels);\n          let ch = col % uniforms.inChannels;\n          if(xCol < uniforms.xShape[").concat(t,"] && xCol >= 0) {\n            value = ").concat(a,";\n          }\n        }\n        setOutputAtIndex(index, value);\n      }\n    }\n   ")}}]),e}();function bH(e,t){var n=e.length;return n>=3?[].concat((0,ke.Z)(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function xH(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,d=void 0===h?null:h,f=null!=o,p=null!=u,m="channelsLast"===r.dataFormat,v=m&&r.filterHeight===r.inHeight&&r.filterWidth===r.inWidth&&"VALID"===r.padInfo.type,g=RC().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!g&&(v||1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type)))return function(e){var t,n,r=e.x,a=e.filter,i=e.convInfo,o=e.backend,s=e.bias,u=void 0===s?null:s,c=e.preluActivationWeights,l=void 0===c?null:c,h=e.leakyreluAlpha,d=void 0===h?0:h,f=e.activation,p=void 0===f?null:f,m="channelsLast"===i.dataFormat,v=!m,g=[];if(m&&i.filterHeight===i.inHeight&&i.filterWidth===i.inWidth&&"VALID"===i.padInfo.type){var y=i.inHeight*i.inWidth*i.inChannels;t=nW({inputs:{x:r},backend:o,attrs:{shape:[1,i.batchSize,y]}}),n=nW({inputs:{x:a},backend:o,attrs:{shape:[1,y,i.outChannels]}})}else t=nW({inputs:{x:r},backend:o,attrs:{shape:m?[i.batchSize,i.inHeight*i.inWidth,i.inChannels]:[i.batchSize,i.inChannels,i.inHeight*i.inWidth]}}),n=nW({inputs:{x:a},backend:o,attrs:{shape:[1,i.inChannels,i.outChannels]}});if(g.push(t),g.push(n),null!=l){var b=bH(l.shape,m);null!=b&&(l=nW({inputs:{x:l},backend:o,attrs:{shape:b}}),g.push(l))}if(null!=u){var x=bH(u.shape,m);null!=x&&(u=nW({inputs:{x:u},backend:o,attrs:{shape:x}}),g.push(u))}var w=aW({a:m?t:n,b:m?n:t,transposeA:v,transposeB:!1,backend:o,bias:u,activation:p,preluActivationWeights:l,leakyreluAlpha:d}),k=nW({inputs:{x:w},backend:o,attrs:{shape:i.outShape}});g.push(w);for(var S=0,C=g;S<C.length;S++){var I=C[S];o.disposeData(I.dataId)}return k}({x:t,filter:n,convInfo:r,backend:a,bias:o,activation:d,preluActivationWeights:u,leakyreluAlpha:l});var y,b=RC().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),x=b>0?b:a.thresholdToIncreaseWorkgroups,w=r.batchSize*Math.ceil(r.outHeight*r.outWidth/32)*Math.ceil(r.outChannels/32);if(RC().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||w<=x)return function(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,d=void 0===h?null:h,f=r.filterWidth,p=r.filterHeight,m=r.inChannels,v=r.strideWidth,g=r.strideHeight,y=r.padInfo,b=r.outWidth,x=r.outHeight,w=r.dilationWidth,k=r.dilationHeight,S="channelsLast"===r.dataFormat,C=f*p*m,I=x*b,T=S?[r.batchSize,I,C]:[r.batchSize,C,I],_=new yH(T,S),E=[{type:"int32",data:[y.top,y.left]},{type:"int32",data:[g,v]},{type:"int32",data:[k,w]},{type:"int32",data:[b]},{type:"int32",data:[m*f]},{type:"int32",data:[m]}],N=a.runWebGPUProgram(_,[t],t.dtype,E),R=[];R.push(N);var A=nW({inputs:{x:n},backend:a,attrs:{shape:[1,C,-1]}});if(R.push(A),null!=u){var O=bH(u.shape,S);null!=O&&(u=nW({inputs:{x:u},backend:a,attrs:{shape:O}}),R.push(u))}if(null!=o){var D=bH(o.shape,S);null!=D&&(o=nW({inputs:{x:o},backend:a,attrs:{shape:D}}),R.push(o))}var P=aW({a:S?N:A,b:S?A:N,transposeA:!S,transposeB:!1,backend:a,bias:o,activation:d,preluActivationWeights:u,leakyreluAlpha:l}),M=nW({inputs:{x:P},backend:a,attrs:{shape:r.outShape}});R.push(P);for(var L=0,F=R;L<F.length;L++){var z=F[L];a.disposeData(z.dataId)}return M}({x:t,filter:n,convInfo:r,backend:a,bias:o,preluActivationWeights:u,leakyreluAlpha:l,activation:d});var k=[r.padInfo.top,r.padInfo.left],S=[{type:"int32",data:[r.filterHeight,r.filterWidth]},{type:"int32",data:[].concat(k)},{type:"int32",data:[r.strideHeight,r.strideWidth]},{type:"int32",data:[r.dilationHeight,r.dilationWidth]}];if(g)y=new gH(r,f,d,p);else{var C=m?r.outHeight*r.outWidth:r.outChannels,I=m?r.outChannels:r.outHeight*r.outWidth,T=r.filterHeight*r.filterWidth*r.inChannels;S.push({type:"int32",data:[C]},{type:"int32",data:[I]},{type:"int32",data:[T]});var _=a.adapterInfo.isIntel();y=new vH(r,C,I,T,f,d,p,_)}var E=[],N=[t,n];f&&(m||1!==o.shape.length||(o=nW({inputs:{x:o},backend:a,attrs:{shape:[o.shape[0],1,1]}}),E.push(o)),N.push(o)),p&&(m||1!==u.shape.length||(u=nW({inputs:{x:u},backend:a,attrs:{shape:[u.shape[0],1,1]}}),E.push(u)),N.push(u)),"leakyrelu"===d&&(S.push({type:"float32",data:[l]}),y.uniforms+=" alpha : f32,");for(var R=a.runWebGPUProgram(y,N,t.dtype,S),A=0,O=E;A<O.length;A++){var D=O[A];a.disposeData(D.dataId)}return R}var wH={kernelName:lI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=t.filter,o=n.strides,s=n.pad,u=n.dataFormat,c=n.dilations,l=n.dimRoundingMode,h=SO(u);return xH({x:a,filter:i,convInfo:fO(a.shape,i.shape,o,c,s,l,!1,h),backend:r})}},kH=function(){function e(t){Se(this,e),this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=t.inShape,this.isChannelsLast="channelsLast"===t.dataFormat,this.isVec4=this.isChannelsLast&&t.outChannels%4===0&&t.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey="conv2DDerInput_".concat(this.isChannelsLast,"_").concat(this.isVec4,"_").concat(this.workPerThread)}return Te(e,[{key:"getUserCode",value:function(){var e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,n=this.isChannelsLast?3:1,r="\n    ".concat(QB()," {\n      let batch = i32(globalId.z) / uniforms.outShape[1];\n      let r = i32(globalId.z) % uniforms.outShape[1];\n      let c = i32(globalId.y) * ").concat(this.workPerThread,";\n      let d1 = i32(globalId.x) * 4;\n\n      let dyCorner = vec2<i32>(r, c) - uniforms.pads;\n\n      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n      // ? = to be determined. : = across all values in that axis.\n      var dotProd: array<vec4<f32>, ").concat(this.workPerThread,">;\n      for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n        dotProd[i] = vec4<f32>(0.0);\n      }\n      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {\n        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);\n        let wRPerm = uniforms.filterDims.x - 1 - wR;\n        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||\n            fract(dyR) > 0.0) {\n          continue;\n        }\n        let idyR = i32(dyR);\n\n        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {\n          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);\n          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);\n          let wCPerm = uniforms.filterDims.y - 1 - wC;\n          var bDyCVal = true;\n          var bDyCVal2 = true;\n          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||\n              fract(dyC) > 0.0) {\n            bDyCVal = false;\n          }\n          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||\n              fract(dyC2) > 0.0) {\n            bDyCVal2 = false;\n          }\n\n          let idyC = i32(dyC);\n          let idyC2 = i32(dyC2);\n          if (bDyCVal && bDyCVal2) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[0] = dotProd[0] + tmpval;\n              xValue = getDy(batch, idyR, idyC2, d2);\n              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),\n                                                  dot(xValue, wValue1),\n                                                  dot(xValue, wValue2),\n                                                  dot(xValue, wValue3));\n            }\n          } else if (bDyCVal) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[0] = dotProd[0] + tmpval;\n            }\n          } else if (bDyCVal2) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC2, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[1] = dotProd[1] + tmpval;\n            }\n          }\n        }\n      }\n\n      for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n        let coords = vec4<i32>(batch, r, c + i, d1);\n        if (coordsInBounds4D(coords, uniforms.outShape)) {\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);\n        }\n      }\n    }\n    ");return this.isVec4?"\n    ".concat(r,"\n    "):"\n    ".concat(QB("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d1 = coords[").concat(n,"];\n\n        let dyCorner = vec2<i32>(coords[").concat(e,"], coords[").concat(t,"]) - uniforms.pads;\n        let dyRCorner = dyCorner.x;\n        let dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {\n          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);\n          let wRPerm = uniforms.filterDims.x - 1 - wR;\n          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||\n              wRPerm < 0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {\n            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);\n            let wCPerm = uniforms.filterDims.y - 1 - wC;\n            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||\n                fract(dyC) > 0.0 || wCPerm < 0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {\n              let xValue = ").concat(this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)",";\n              let wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd = dotProd + xValue * wValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}]),e}(),SH=function(){function e(t){Se(this,e),this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.filterShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast="channelsLast"===t.dataFormat,this.shaderKey="conv2DDerFilter_".concat(this.isChannelsLast)}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wR = coords[0];\n        let wC = coords[1];\n        let d1 = coords[2];\n        let d2 = coords[3];\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b = b + 1) {\n          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {\n            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];\n            if (xR < 0 || xR >= uniforms.inHeight) {\n              continue;\n            }\n\n            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {\n              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];\n\n              if (xC < 0 || xC >= uniforms.inWidth) {\n                continue;\n              }\n\n              if (").concat(this.isChannelsLast,") {\n                let dyValue = getDy(b, yR, yC, d2);\n                let xValue = getX(b, xR, xC, d1);\n                dotProd = dotProd + xValue * dyValue;\n              } else {\n                let dyValue = getDy(b, d2, yR, yC);\n                let xValue = getX(b, d1, xR, xC);\n                dotProd = dotProd + xValue * dyValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}]),e}(),CH=function(){function e(t){Se(this,e),this.variableNames=["x","dy"],this.uniforms="pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,\n       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.filterShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wF = coords.x;\n        let wR = coords.y;\n        let wC = coords.z;\n        let d1 = coords.w;\n        let d2 = coords.u;\n\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b++) {\n          for (var yF = 0; yF < uniforms.outDepth; yF++) {\n            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];\n            if (xF < 0 || xF >= uniforms.inDepth) {\n              continue;\n            }\n\n            for (var yR = 0; yR < uniforms.outHeight; yR++) {\n              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];\n              if (xR < 0 || xR >= uniforms.inHeight) {\n                continue;\n              }\n\n              for (var yC = 0; yC < uniforms.outWidth; yC++) {\n                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];\n                if (xC < 0 || xC >= uniforms.inWidth) {\n                  continue;\n                }\n\n                let dyValue = getDy(b, yF, yR, yC, d2);\n                let xValue = getX(b, xF, xR, xC, d1);\n                dotProd += xValue * dyValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}]),e}(),IH=function(){function e(t){Se(this,e),this.variableNames=["dy","W"],this.uniforms="filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,\n      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let d1 = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyFCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        var dotProd = 0.0;\n        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {\n          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);\n          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {\n            continue;\n          }\n          let idyF = i32(dyF);\n\n          let wFPerm = uniforms.filterDims[0] - 1 - wF;\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            let wRPerm = uniforms.filterDims[1] - 1 - wR;\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let wCPerm = uniforms.filterDims[2] - 1 - wC;\n\n              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {\n                let xValue = getDy(batch, idyF, idyR, idyC, d2);\n                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}]),e}();var TH={kernelName:hI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,h=SO(u),d=fO(a.shape,l,o,1,s,c,!1,h),f=new SH(d),p=[{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]}];return n.runWebGPUProgram(f,[a,i],a.dtype,p)}};var _H=function(){function e(t){Se(this,e),this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=t.inShape,YS("channelsLast"===t.dataFormat,(function(){return"TODO: NCHW is unimplemented"})),this.isVec4=t.inChannels%4===0&&t.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=cV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=lV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey="conv2DDerInputMM_".concat(this.isVec4,"_").concat(this.elementsPerThread)}return Te(e,[{key:"getUserCode",value:function(){var e=this.isVec4?HU(this.elementsPerThread,this.workgroupSize):qU(this.elementsPerThread,this.workgroupSize),t="\n    ".concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t="\n      let outRow = row / uniforms.outShape[2];\n      let outCol = row % uniforms.outShape[2];\n\n      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);\n      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];\n      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);\n      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);\n      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {\n        return ".concat(ZB(e),"(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {\n        return ").concat(ZB(e),"(0.0);\n      }\n      let coord = vec4<i32>(\n          batch,\n          i32(xR),\n          i32(xC),\n          col % uniforms.outBackprop[3]);\n      return x[getIndexFromCoords4D(coord, uniforms.xShape)/").concat(e,"];"),n="if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ".concat(t,"\n      }\n      return ").concat(ZB(e),"(0.0);");return"\n  fn mm_readA(batch: i32, row : i32, col : i32) -> ".concat(ZB(e)," {\n    ").concat(n,"\n  }\n\n  fn mm_readB(batch: i32, row : i32, col : i32) -> ").concat(ZB(e)," {\n    let coordX = uniforms.filterDims.x - 1 -\n        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);\n    let coordY = uniforms.filterDims.y - 1 -\n        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&\n        coordX >= 0 && coordY >= 0) {\n      let rowInner = row % uniforms.outBackprop[3];\n      let coord = vec4<i32>(coordX, coordY, col, rowInner);\n      ").concat(function(e){switch(e){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];\n            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];\n            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];\n            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error("innerElementSize ".concat(e," is not supported."))}}(e),"\n    }\n    return ").concat(ZB(e),"(0.0);\n  }\n\n  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ").concat(ZB(e),") {\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outCoord = vec4<i32>(\n          batch,\n          row / uniforms.outShape[2],\n          row % uniforms.outShape[2],\n          col);\n      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/").concat(e,"] = value;\n    }\n  }")}(this.isVec4?4:1),"\n    ").concat(e,"\n    ");return t}}]),e}();var EH={kernelName:dI,backendName:"webgpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.dy,o=n.filter,s=a.inputShape,u=a.strides,c=a.pad,l=a.dataFormat,h=a.dimRoundingMode,d=SO(l),f=fO(s,o.shape,u,1,c,h,!1,d),p=[{type:"int32",data:[f.filterHeight,f.filterWidth]},{type:"int32",data:[f.filterHeight-1-f.padInfo.top,f.filterWidth-1-f.padInfo.left]},{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.batchSize,f.outHeight,f.outWidth,f.outChannels]}];if(RC().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||"channelsLast"!==f.dataFormat)t=new kH(f);else{t=new _H(f);var m=f.inHeight*f.inWidth,v=f.inChannels,g=f.filterHeight*f.filterWidth*f.outChannels;p.push({type:"uint32",data:[m]},{type:"uint32",data:[v]},{type:"uint32",data:[g]})}return r.runWebGPUProgram(t,[i,o],"float32",p)}},NH=function(){function e(t){Se(this,e),this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let batch = coords.x;\n        let d2 = coords.u;\n\n        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;\n        let xFCorner = xFRCCorner.x;\n        let xRCorner = xFRCCorner.y;\n        let xCCorner = xFRCCorner.z;\n\n        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;\n        let inputDepthVec4Remainder = uniforms.xShape.u % 4;\n\n        var dotProd = 0.0;\n        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {\n          let xF = xFCorner + wF * uniforms.dilations[0];\n          if (xF < 0 || xF >= uniforms.xShape.y) {\n            continue;\n          }\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let xR = xRCorner + wR * uniforms.dilations[1];\n            if (xR < 0 || xR >= uniforms.xShape.z) {\n              continue;\n            }\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let xC = xCCorner + wC * uniforms.dilations[2];\n              if (xC < 0 || xC >= uniforms.xShape.w) {\n                continue;\n              }\n\n              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {\n                let xValues = vec4<f32>(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                let wValues = vec4<f32>(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (inputDepthVec4Remainder == 1) {\n                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2);\n              } else if (inputDepthVec4Remainder == 2) {\n                let xValues = vec2<f32>(\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)\n                );\n                let wValues = vec2<f32>(\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (inputDepthVec4Remainder == 3) {\n                let xValues = vec3<f32>(\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)\n                );\n                let wValues = vec3<f32>(\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }")}}]),e}();var RH={kernelName:fI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=pO(a.shape,i.shape,o,u,s),l=[c.padInfo.front,c.padInfo.top,c.padInfo.left],h=[{type:"int32",data:[c.filterDepth,c.filterHeight,c.filterWidth]},{type:"int32",data:[].concat(l)},{type:"int32",data:[c.strideDepth,c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationDepth,c.dilationHeight,c.dilationWidth]}],d=new NH(c),f=UE(a.dtype,i.dtype);return n.runWebGPUProgram(d,[a,i],f,h)}};var AH={kernelName:pI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=pO(a.shape,u,o,1,s),l=new CH(c),h=[{type:"int32",data:[c.padInfo.front,c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideDepth,c.strideHeight,c.strideWidth]},{type:"int32",data:[c.batchSize]},{type:"int32",data:[c.outDepth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"int32",data:[c.inDepth]},{type:"int32",data:[c.inHeight]},{type:"int32",data:[c.inWidth]}];return n.runWebGPUProgram(l,[a,i],i.dtype,h)}};var OH,DH={kernelName:mI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.pad,u=pO(r.inputShape,i.shape,o,1,s),c=new IH(u),l=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[u.filterDepth-1-u.padInfo.front,u.filterHeight-1-u.padInfo.top,u.filterWidth-1-u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.outChannels]}];return n.runWebGPUProgram(c,[a,i],a.dtype,l)}},PH=fW({opType:yV.COS}),MH={kernelName:vI,backendName:"webgpu",kernelFunc:PH},LH=fW({opType:yV.COSH}),FH={kernelName:gI,backendName:"webgpu",kernelFunc:LH},zH=function(){function e(t,n,r,a){Se(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;var i=(0,U.Z)(n,1)[0];this.outputShape=[i,r[0],r[1],t],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId="bilinear"===a?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey="cropAndResize_".concat(this.methodId,"_").concat(this.cropHeightBiggerThan1,"_").concat(this.cropWidthBiggerThan1)}return Te(e,[{key:"getUserCode",value:function(){var e="f32(uniforms.imageShape[1] - 1)",t="f32(uniforms.imageShape[2] - 1)",n=this.cropHeightBiggerThan1?["(".concat(e," / f32(uniforms.outShape[1] - 1))"),"(y2-y1) * height_ratio","y1*".concat(e," + f32(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(e)],r=(0,U.Z)(n,3),a=r[0],i=r[1],o=r[2],s=this.cropWidthBiggerThan1?["(".concat(t," / f32(uniforms.outShape[2] - 1))"),"(x2-x1) * width_ratio","x1*".concat(t," + f32(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(t)],u=(0,U.Z)(s,3),c=u[0],l=u[1],h=u[2];return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let height_ratio = f32(").concat(a,");\n        let width_ratio = f32(").concat(c,");\n        let b = coords[0];\n        let y = coords[1];\n        let x = coords[2];\n        let d = coords[3];\n        // get box vals\n        let y1 = getBoxes(b, 0);\n        let x1 = getBoxes(b, 1);\n        let y2 = getBoxes(b, 2);\n        let x2 = getBoxes(b, 3);\n        // get image in batch index\n        let bInd = i32(round(getBoxInd(b)));\n        if(bInd < 0 || bInd >= uniforms.outShape[0]) {\n          return;\n        }\n        let height_scale = ").concat(i,";\n        let width_scale = ").concat(l,";\n        let in_y = ").concat(o,";\n        if( in_y < 0.0 || in_y > ").concat(e," ) {\n          setOutputAtIndex(index, uniforms.extrapolationValue);\n          return;\n        }\n        let in_x = ").concat(h,";\n        if( in_x < 0.0 || in_x > ").concat(t," ) {\n          setOutputAtIndex(index, uniforms.extrapolationValue);\n          return;\n        }\n        let sourceFracIndexCR = vec2<f32>(in_x,in_y);\n        if(").concat(this.methodId," == 1) {\n          // Compute the four integer indices.\n          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);\n          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));\n          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);\n          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);\n          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);\n          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);\n          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);\n          let top = topLeft + (topRight - topLeft) * fracCR.x;\n          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          let newValue = top + (bottom - top) * fracCR.y;\n          setOutputAtIndex(index, newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          let sourceNearestCR = vec2<i32>(floor(\n            sourceFracIndexCR + vec2<f32>(0.5,0.5)));\n          let newValue = getImage(\n            bInd, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    }\n    ")}}]),e}(),BH={kernelName:xI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new zH(a.shape[3],i.shape,s,u),h=[{type:"float32",data:[c]}];return n.runWebGPUProgram(l,[a,i,o],"float32",h)}};!function(e){e.Prod="*",e.Sum="+"}(OH||(OH={}));var VH=function(){function e(t,n,r,a){Se(this,e),this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=n,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=a,this.op=t,this.shaderKey="cum_".concat(this.op,"_").concat(this.exclusive,"_").concat(this.reverse)}return Te(e,[{key:"getUserCode",value:function(){var e=this.outputShape.length,t=this.op===OH.Prod?"1.0":"0.0",n=this.exclusive?t:"getX(".concat(UH(e,"coords",this.op),")"),r=this.outputShape[this.outputShape.length-1],a="",i="";return this.exclusive?(a=this.reverse?"end != ".concat(r-1):"end != 0",i=this.reverse?"end + 1":"end - 1"):(a=this.reverse?"end + pow2 < ".concat(r):"end >= pow2",i=this.reverse?"end + pow2":"end - pow2"),"\n      ".concat(QB("index")," {\n       if (index < uniforms.size) {\n         var coords = getCoordsFromIndex(index);\n\n         let end = ").concat(WH(e,"coords",this.op),";\n         var val = ").concat(n,";\n         let pow2 = i32(pow(2.0, uniforms.index));\n         if (").concat(a,") {\n           let idx = ").concat(i,";\n           ").concat(WH(e,"coords",this.op)," = idx;\n           val ").concat(this.op,"= getX(").concat(UH(e,"coords",this.op),");\n         }\n         setOutputAtIndex(index, val);\n       }\n      }\n    ")}}]),e}();function UH(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function WH(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function jH(e,t,n,r,a,i){var o=t.shape.length,s=SD([r],o),u=t;null!=s&&(u=sG({inputs:{x:t},backend:n,attrs:{perm:s}}));var c=ID(1,o)[0];if(c!==o-1)throw new Error("WebGPU cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=u.shape[c],h=uW({inputs:{x:u},backend:n}),d=0;d<=Math.ceil(Math.log2(l))-1;d++){var f=new VH(e,u.shape,!1,i),p=h,m=[{type:"float32",data:[d]}];h=n.runWebGPUProgram(f,[h],h.dtype,m),n.disposeData(p.dataId)}if(a){var v=new VH(e,u.shape,a,i),g=h;h=n.runWebGPUProgram(v,[h],h.dtype,[{type:"float32",data:[0]}]),n.disposeData(g.dataId)}if(null!=s){var y=sG({inputs:{x:h},backend:n,attrs:{perm:CD(s)}});return n.disposeData(h.dataId),n.disposeData(u.dataId),y}return h}var GH={kernelName:yI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return jH(OH.Prod,a,n,i,o,s)}};var HH={kernelName:bI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return jH(OH.Sum,a,n,i,o,s)}};var KH={kernelName:wI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput,u=1===a.shape.length,c=JS(i.shape)>0,l=i.dtype,h=u?[a.shape[0]]:[a.shape[0],a.shape[1]],d=eW({backend:n,attrs:{shape:u?[o]:[a.shape[0],o],value:0,dtype:l}}),f=new qG(h,c,s),p=[{type:"int32",data:[o]}],m=c?[a,i]:[a];return n.runWebGPUProgram(f,m,l,p,d)}},qH=function(){function e(t,n){Se(this,e),this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthToSpace_".concat(n),this.dataFormat=n}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let h = ").concat(this.getHeightCoordString(),";\n          let w = ").concat(this.getWidthCoordString(),";\n          let d = ").concat(this.getDepthCoordString(),";\n\n          let in_h = h / uniforms.blockSize;\n          let offset_h = h % uniforms.blockSize;\n          let in_w = w / uniforms.blockSize;\n          let offset_w = w % uniforms.blockSize;\n          let offset_d = (offset_h * uniforms.blockSize + offset_w) *\n            ").concat(this.getOutputDepthSize(),";\n          let in_d = d + offset_d;\n\n          let rlt = ").concat(this.getInputSamplingString(),";\n          setOutputAtIndex(index, rlt);\n        }\n      }")}},{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?"uniforms.outShape[3]":"uniforms.outShape[1]"}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var ZH={kernelName:kI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=[{type:"int32",data:[i]}],d=new qH("NHWC"===o?[s,u,c,l]:[s,l,u,c],o);return n.runWebGPUProgram(d,[a],a.dtype,h)}},XH=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Se(this,e),this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=t,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.addBias=a,this.activation=i,this.hasPreluActivation=o,this.filterHeight=n,this.filterWidth=r,this.shaderKey="depthwiseNCHW_".concat(this.activation,"_").concat(this.filterHeight,"_").concat(this.filterWidth)}return Te(e,[{key:"getUserCode",value:function(){var e=this.filterWidth*this.filterHeight,t=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],n=this.workgroupSize[1]+this.filterHeight-1,r=this.workgroupSize[0]+this.filterWidth-1;return"\n      ".concat(UU(this.activation,this.hasPreluActivation,!1,4),"\n\n      var<workgroup> mm_Asub : array<array<f32, ").concat(r,">, ").concat(n,">;\n      var<workgroup> mm_Bsub : array<array<f32, ").concat(this.filterWidth,">, ").concat(this.filterHeight,">;\n      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {\n        var value = 0.0;\n        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])\n        {\n          value = getX(batch, channel, row, col);\n        }\n        return value;\n      }\n\n      ").concat(QB()," {\n        let coords = getOutputCoords();\n        let batch = coords[0];\n        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;\n        let channelMul = uniforms.wShape[3];\n        let d1 = coords[1] / channelMul;\n        let q = coords[1] % channelMul;\n\n        let inputRowStart = xRCCorner.x;\n        let inputColStart = xRCCorner.y;\n\n        let localRow = i32(localId.y);\n        let localCol = i32(localId.x);\n\n        // Load one tile of X into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(n,"; inputRow = inputRow + ").concat(this.workgroupSize[1],") {\n          for (var inputCol = localCol; inputCol < ").concat(r,"; inputCol = inputCol + ").concat(this.workgroupSize[0],") {\n            let rowOffset = inputRow - localRow;\n            let colOffset = inputCol - localCol;\n            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);\n          }\n        }\n\n        // Load one tile of W into local memory.\n        var wIndex = i32(localIndex);\n        ").concat(e<t?"if (wIndex < ".concat(e,")"):"for(; wIndex < ".concat(e,"; wIndex = wIndex + ").concat(t,")"),"\n\n        {\n          let wRow = wIndex / ").concat(this.filterWidth,";\n          let wCol = wIndex % ").concat(this.filterWidth,";\n          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);\n        }\n\n        workgroupBarrier();\n\n        var value = 0.0;\n        for (var wR = 0; wR < ").concat(this.filterHeight,"; wR = wR + 1) {\n          for (var wC = 0; wC < ").concat(this.filterWidth,"; wC = wC + 1) {\n            let xVal = mm_Asub[localRow + wR][localCol + wC];\n            let wVal = mm_Bsub[wR][wC];\n            value = fma(xVal, wVal, value);\n          }\n        }\n        ").concat(WU(this.addBias,this.activation),"\n        if (coordsInBounds4D(coords, uniforms.outShape)) {\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }\n    ")}}]),e}(),YH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Se(this,e),this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=t.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;var i=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=hV(i),this.dispatch=uV(this.dispatchLayout,i,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),YS("channelsLast"===t.dataFormat,(function(){return"TODO: NCHW is unimplemented"})),n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.convInfo=t,this.addBias=n,this.activation=r,this.hasPreluActivation=a,this.shaderKey="depthwiseVec4_".concat(r,"_").concat(this.convInfo.filterHeight,"_").concat(this.convInfo.filterWidth,"_").concat(this.convInfo.strideHeight,"_").concat(this.convInfo.strideWidth,"_").concat(this.workPerThread)}return Te(e,[{key:"getUserCode",value:function(){var e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,t=this.convInfo.strideHeight,n=this.convInfo.strideWidth;return"\n      ".concat(UU(this.activation,this.hasPreluActivation,!0,4),"\n      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {\n        var value = vec4<f32>(0.0);\n        if (col >=0 && col < uniforms.inDims[1]) {\n          value = getX(batch, row, col, channel);\n        }\n        return value;\n      }\n\n      ").concat(QB("index")," {\n        let width0 = uniforms.outShape[3] / ").concat(this.outputComponent,";\n        let d1 = (index % width0) * ").concat(this.outputComponent,";\n        var index1 = index / width0;\n        let width1 = uniforms.virtualWidth / ").concat(this.workPerThread,";\n        let c = (index1 % width1) * ").concat(this.workPerThread,";\n        index1 = index1 / width1;\n        let r = index1 % uniforms.outShape[1];\n        let batch = index1 / uniforms.outShape[1];\n\n        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(").concat(t,", ").concat(n,") - uniforms.pads;\n\n        let xRCorner = xRCCorner.x;\n        let xCCorner = xRCCorner.y;\n        var xVals : array<vec4<f32>, ").concat(e,">;\n        var dotProd : array<vec4<f32>, ").concat(this.workPerThread,">;\n        for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n          dotProd[i] = vec4<f32>(0.0);\n        }\n\n        // Use constant instead of uniform can give better performance.\n        for (var wR = 0; wR < ").concat(this.convInfo.filterHeight,"; wR = wR + 1) {\n          let xR = xRCorner + wR;\n          if (xR >=0 && xR < uniforms.inDims[0]) {\n            for (var i = 0; i < ").concat(e,"; i++) {\n              xVals[i] = readX(batch, xR, xCCorner + i, d1);\n            }\n            for (var wC = 0; wC < ").concat(this.convInfo.filterWidth,"; wC = wC + 1) {\n              let wValue = getW(wR, wC, d1, 0);\n              for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n                dotProd[i] = fma(xVals[i * ").concat(n," + wC], wValue, dotProd[i]);\n              }\n            }\n          }\n        }\n\n        for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let coords = vec4<i32>(batch, r, c + i, d1);\n          if (coordsInBounds4D(coords, uniforms.outShape)) {\n            var value = dotProd[i];\n            ").concat(WU(this.addBias,this.activation),"\n            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n          }\n        }\n      }\n    ")}}]),e}(),QH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Se(this,e),this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,\n      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast="channelsLast"===t.dataFormat,n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.convInfo=t,this.addBias=n,this.activation=r,this.hasPreluActivation=a,this.shaderKey="depthwise_".concat(this.activation,"_").concat(this.isChannelsLast)}return Te(e,[{key:"getUserCode",value:function(){var e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return"\n      ".concat(UU(this.activation,this.hasPreluActivation,!1,4),"\n\n      ").concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let batch = coords[0];\n          let xRCCorner = vec2<i32>(coords.").concat(this.isChannelsLast?"yz":"zw",") * uniforms.strides - uniforms.pads;\n          let d2 = coords[").concat(this.isChannelsLast?3:1,"];\n          let channelMul = uniforms.wShape[3];\n          let d1 = d2 / channelMul;\n          let q = d2 % channelMul;\n\n          let inputRowStart = xRCCorner.x;\n          let inputColStart = xRCCorner.y;\n          let inputRowEnd = inputRowStart + uniforms.filterHeight *\n              uniforms.dilations[0];\n          let inputColEnd = inputColStart + uniforms.filterWidth *\n              uniforms.dilations[1];\n\n          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get\n          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all\n          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.\n          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.\n          var value = 0.0;\n\n          // Extract if checking out of for loop for performance.\n          if (inputRowStart >= 0 && inputColStart >= 0 &&\n            inputRowEnd < uniforms.inDims[0] &&\n                inputColEnd < uniforms.inDims[1]) {\n              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {\n                let xR = inputRowStart + wR * uniforms.dilations[0];\n\n                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {\n                  let xC = inputColStart + wC * uniforms.dilations[1];\n\n                  let xVal = ").concat(e,";\n                  let wVal = getW(wR, wC, d1, q);\n                  value = value + xVal * wVal;\n                }\n              }\n            } else {\n              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {\n                let xR = inputRowStart + wR * uniforms.dilations[0];\n\n                if (xR < 0 || xR >= uniforms.inDims[0]) {\n                  continue;\n                }\n\n                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {\n                  let xC = inputColStart + wC * uniforms.dilations[1];\n\n                  if (xC < 0 || xC >= uniforms.inDims[1]) {\n                    continue;\n                  }\n\n                  let xVal = ").concat(e,";\n                  let wVal = getW(wR, wC, d1, q);\n                  value = value + xVal * wVal;\n                }\n              }\n            }\n            ").concat(WU(this.addBias,this.activation),"\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }\n    ")}}]),e}();var $H={kernelName:SI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode,h=SO(u),d=c;null==d&&(d=[1,1]);var f,p=fO(a.shape,i.shape,o,d,s,l,!0,h),m=[{type:"int32",data:[p.padInfo.top,p.padInfo.left]},{type:"int32",data:[p.inHeight,p.inWidth]}],v="channelsLast"===p.dataFormat;return!v&&p.inHeight>16&&p.inWidth>16&&1===p.strideHeight&&1===p.strideWidth&&1===p.dilationWidth&&1===p.dilationHeight&&p.inChannels===p.outChannels?f=new XH(p.outShape,p.filterHeight,p.filterWidth):v&&p.outHeight>4&&p.outWidth>4&&p.strideWidth<=2&&p.inChannels===p.outChannels&&1===p.dilationHeight&&1===p.dilationWidth&&p.inChannels%4===0?(f=new YH(p),m.push({type:"int32",data:[f.virtualWidth]})):(f=new QH(p),m.push({type:"int32",data:[p.filterHeight]},{type:"int32",data:[p.filterWidth]},{type:"int32",data:[p.strideHeight,p.strideWidth]},{type:"int32",data:[p.dilationHeight,p.dilationWidth]})),n.runWebGPUProgram(f,[a,i],a.dtype,m)}},JH=function(){function e(t){Se(this,e),this.variableNames=["x","dy"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,\n      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.filterShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wR = coords[0];\n        let wC = coords[1];\n        let d1 = coords[2];\n        let dm = coords[3];\n        let d2 = d1 * uniforms.channelMul + dm;\n\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b++) {\n          for (var yR = 0; yR < uniforms.outHeight; yR++) {\n            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];\n\n            if (xR < 0 || xR >= uniforms.inHeight) {\n              continue;\n            }\n\n            for (var yC = 0; yC < uniforms.outWidth; yC++) {\n              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];\n\n              if (xC < 0 || xC >= uniforms.inWidth) {\n                continue;\n              }\n\n              let dyValue = getDy(b, yR, yC, d2);\n              let xValue = getX(b, xR, xC, d1);\n              dotProd += xValue * dyValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}(),eK=function(){function e(t){Se(this,e),this.variableNames=["dy","W"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32, channelMul : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d1 = coords[3];\n        let dyCorner = coords.yz - uniforms.pads;\n        let dyRCorner = dyCorner.x;\n        let dyCCorner = dyCorner.y;\n\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n\n          let idyR = i32(dyR);\n          let wRPerm = uniforms.filterDims[0] - 1 - wR;\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n\n            let idyC = i32(dyC);\n            let wCPerm = uniforms.filterDims[1] - 1 - wC;\n\n            for (var dm = 0; dm < uniforms.channelMul; dm++) {\n              let d2 = d1 * uniforms.channelMul + dm;\n              let xValue = getDy(batch, idyR, idyC, d2);\n              let wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}();var tK={kernelName:CI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,h=fO(a.shape,l,o,s,u,c,!0),d=new JH(h),f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outChannels/h.inChannels]}];return n.runWebGPUProgram(d,[a,i],"float32",f)}};var nK={kernelName:II,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=fO(r.inputShape,i.shape,o,s,u,c,!0),h=new eK(l),d=[{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.filterHeight-1-l.padInfo.top,l.filterWidth-1-l.padInfo.left]},{type:"int32",data:[l.filterHeight,l.filterWidth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]},{type:"int32",data:[l.outChannels/l.inChannels]}];return n.runWebGPUProgram(h,[a,i],a.dtype,d)}},rK=function(){function e(t){Se(this,e),this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t,t],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);\n          setOutputAtIndex(index, value);\n        }\n      }\n    ")}}]),e}();var aK={kernelName:TI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat((0,ke.Z)(r.shape),(0,ke.Z)(r.shape)),i=JS(r.shape),o=nW({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new rK(i),u=n.runWebGPUProgram(s,[o],o.dtype),c=nW({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeData(o.dataId),n.disposeData(u.dataId),c}},iK=function(){function e(t){Se(this,e),this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.outShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}return Te(e,[{key:"getUserCode",value:function(){return"\n       ".concat(QB("index")," {\n         if (index < uniforms.size) {\n           let neg_infinity = -3.4e38;\n           let coords = getOutputCoords();\n           let batch = coords.x;\n           let d1 = coords.w;\n           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;\n           let hBeg = outTopLeftCorner.x;\n           let wBeg = outTopLeftCorner.y;\n\n           var curVal = neg_infinity;\n           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {\n             let hIn = hBeg + h * uniforms.dilations[0];\n\n             if (hIn >= 0 && hIn < uniforms.xShape[1]) {\n               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {\n                 let wIn = wBeg + w * uniforms.dilations[1];\n\n                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {\n                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);\n                   if (val > curVal) {\n                     curVal = val;\n                   }\n                 }\n               }\n             }\n           }\n\n           setOutputAtIndex(index, curVal);\n         }\n       }\n     ")}}]),e}();var oK={kernelName:_I,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=lO(a.shape,i.shape,o,s,"NHWC",u),l=[c.padInfo.top,c.padInfo.left],h=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[].concat(l)},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]}],d=new iK(c);return n.runWebGPUProgram(d,[a,i],a.dtype,h)}},sK=function(){function e(t,n){if(Se(this,e),this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(t.outShape),this.dispatch=uV(this.dispatchLayout,t.outShape,this.workgroupSize),"float32"!==n&&"int32"!==n)throw new Error("Dilation2DBackpropInput only supports float32 and int32\n          types, does not support ".concat(n," type."));this.type=n,this.shaderKey="dilation2DBackpropInput"}return Te(e,[{key:"getUserCode",value:function(){return"\n       ".concat(QB("index")," {\n         if (index < uniforms.dySize) {\n           let coords = getDyCoordsFromIndex(index);\n           let b = coords[0];\n           let r = coords[1];\n           let c = coords[2];\n           let d = coords[3];\n\n           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;\n           var curVal = -3.4e38;  // neg_infinity\n           var xRMax = 0;\n           var xCMax = 0;\n\n           // In the case of multiple argmax branches, we only back-propagate\n           // along the last branch, i.e., the one with largest value of\n           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling\n           // backward routines.\n           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n             let xR = dyCorner.x + wR * uniforms.dilations[0];\n\n             if (xR >= 0 && xR < uniforms.xShape[1]) {\n               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n                 let xC = dyCorner.y + wC * uniforms.dilations[1];\n\n                 if (xC >= 0 && xC < uniforms.xShape[2]) {\n                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);\n                   if (val > curVal) {\n                     curVal = val;\n                     xRMax = xR;\n                     xCMax = xC;\n                   }\n                 }\n               }\n             }\n           }\n\n           let flatIndexIn = d + uniforms.xShape[3] *\n               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));\n           let value = getDy(b, r, c, d);\n           ").concat(KB("&result[flatIndexIn]","value",this.type),"\n         }\n       }\n     ")}}]),e}(),uK=function(){function e(t,n,r){if(Se(this,e),this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=t.filterShape,this.dispatchLayout=hV(t.outShape),this.dispatch=uV(this.dispatchLayout,t.outShape,this.workgroupSize),"float32"!==r&&"int32"!==r)throw new Error("Dilation2DBackpropFilter only supports float32 and int32\n          types, does not support ".concat(r," type."));this.type=r,this.shaderKey="dilation2DBackpropFilter"}return Te(e,[{key:"getUserCode",value:function(){return"\n       ".concat(QB("index")," {\n         if (index < uniforms.dySize) {\n           let coords = getDyCoordsFromIndex(index);\n           let b = coords[0];\n           let r = coords[1];\n           let c = coords[2];\n           let d = coords[3];\n\n           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;\n           var curVal = -3.4e38;  // neg_infinity\n           var wRMax = 0;\n           var wCMax = 0;\n\n           // In the case of multiple argmax branches, we only back-propagate\n           // along the last branch, i.e., the one with largest value of\n           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling\n           // backward routines.\n           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n             let xR = dyCorner.x + wR * uniforms.dilations[0];\n\n             if (xR >= 0 && xR < uniforms.xShape[1]) {\n               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n                 let xC = dyCorner.y + wC * uniforms.dilations[1];\n\n                 if (xC >= 0 && xC < uniforms.xShape[2]) {\n                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);\n                   if (val > curVal) {\n                     curVal = val;\n                     wRMax = wR;\n                     wCMax = wC;\n                   }\n                 }\n               }\n             }\n           }\n\n           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);\n           let value = getDy(b, r, c, d);\n           ").concat(KB("&result[flatIndexIn]","value",this.type),"\n         }\n       }\n     ")}}]),e}();var cK={kernelName:"Dilation2DBackpropFilter",backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=lO(a.shape,i.shape,s,u,"NHWC",c),h=i.dtype,d=new uK(l,i.shape,h),f=[{type:"int32",data:[l.filterHeight,l.filterWidth]},{type:"int32",data:[l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.dilationHeight,l.dilationWidth]},{type:"int32",data:[JS(l.outShape)]}],p=eW({backend:n,attrs:{shape:i.shape,value:0,dtype:h}});return n.runWebGPUProgram(d,[a,i,o],h,f,p)}};var lK={kernelName:"Dilation2DBackpropInput",backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=lO(a.shape,i.shape,s,u,"NHWC",c),h=a.dtype,d=new sK(l,h),f=[{type:"int32",data:[l.filterHeight,l.filterWidth]},{type:"int32",data:[l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.dilationHeight,l.dilationWidth]},{type:"int32",data:[JS(l.outShape)]}],p=eW({backend:n,attrs:{shape:l.inShape,value:0,dtype:h}});return n.runWebGPUProgram(d,[a,i,o],h,f,p)}},hK=function(){function e(t,n,r){Se(this,e),this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=HB.DRAW,this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=n,this.textureFormat=r,this.shaderKey="draw_".concat(n,"_").concat(r)}return Te(e,[{key:"getUserCode",value:function(){var e,t="float32"===this.type?"value":"value / 255.0";return e="\n      if (uniforms.numChannels == 1) {\n        rgba[0] = ".concat(t,";\n        rgba[1] = ").concat(t,";\n        rgba[2] = ").concat(t,";\n      } else {\n        rgba[d] = ").concat(t,";\n      }"),"\n       @group(0) @binding(0) var outImage : texture_storage_2d<".concat(this.textureFormat,", write>;\n       ").concat(QB("index")," {\n         if (index < uniforms.size) {\n           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);\n           for (var d = 0; d < uniforms.numChannels; d = d + 1) {\n             let value = f32(inBuf[index * uniforms.numChannels + d]);\n             ").concat(e,"\n           }\n           rgba.x = rgba.x * rgba.w;\n           rgba.y = rgba.y * rgba.w;\n           rgba.z = rgba.z * rgba.w;\n           let coords = getCoordsFromIndex(index);\n           textureStore(outImage, vec2<i32>(coords.yx), rgba);\n         }\n       }\n      ")}}]),e}();var dK={kernelName:EI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=r.canvas,o=r.options,s=a.shape.slice(0,2),u=(0,U.Z)(s,2),c=u[0],l=u[1],h=(o||{}).imageOptions,d=(null===h||void 0===h?void 0:h.alpha)||1,f=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",p=[c,l],m=new hK(p,a.dtype,f);i.width=l,i.height=c;var v,g="webgpu",y=i.getContext(g);y||(y=(v=new OffscreenCanvas(l,c)).getContext(g));var b=3===a.shape.length?a.shape[2]:1;y.configure({device:n.device,format:f,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});var x="int32",w=n.makeTensorInfo(p,x),k=n.tensorMap.get(w.dataId);k.resource=y.getCurrentTexture(),k.external=!0;var S=[{type:"uint32",data:[b]},{type:"float32",data:[d]}];if(n.runWebGPUProgram(m,[a],x,S,w),v){var C=i.getContext("2d");if(!C)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");C.drawImage(v,0,0)}return n.disposeData(w.dataId),a}},fK=pW({opType:mV.MUL,cpuKernelImpl:Dj,supportsComplex:!0}),pK={kernelName:CT,backendName:"webgpu",kernelFunc:fK};function mK(e){var t=e.inputs,n=e.backend,r=e.attrs;return lG(t.x,r.axis,r.keepDims,"sum",n)}var vK={kernelName:h_,backendName:"webgpu",kernelFunc:mK};var gK={kernelName:RI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=QF(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;JF(i.length,s,r);for(var u=ez(o,s),c=u.path,l=u.steps,h=l.length,d=null,f=i.length,p=[],m=0;m<h;++m){var v,g=ye(l[m]);try{for(g.s();!(v=g.n()).done;){var y=v.value,b=$F(f,s[y]),x=b.permutationIndices,w=b.expandDims,k=void 0;tz(x)?k=r[y]:(k=sG({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),p.push(k));for(var S=k.shape.slice(),C=0;C<w.length;++C)S.splice(w[C],0,1);tC(k.shape,S)||(k=nW({inputs:{x:k},backend:n,attrs:{shape:S}}),p.push(k)),null===d?d=k:(d=fK({inputs:{a:k,b:d},backend:n}),p.push(d))}}catch(N8){g.e(N8)}finally{g.f()}m<h-1&&(c[m]>=0&&(d=mK({inputs:{x:d},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(var I=0,T=p;I<T.length;I++){var _=T[I];_!==d&&n.disposeData(_.dataId)}return d}},yK=fW({opType:yV.ELU}),bK={kernelName:AI,backendName:"webgpu",kernelFunc:yK},xK={kernelName:OI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=new sW(mV.ELU_DER,r.shape,a.shape);return n.runWebGPUProgram(i,[r,a],r.dtype)}},wK=pW({opType:mV.EQUAL,dtype:"bool",cpuKernelImpl:yj}),kK={kernelName:PI,backendName:"webgpu",kernelFunc:wK},SK=fW({opType:yV.ERF}),CK={kernelName:DI,backendName:"webgpu",kernelFunc:SK},IK=fW({opType:yV.EXP,cpuKernelImpl:bj,dtype:"float32"}),TK={kernelName:MI,backendName:"webgpu",kernelFunc:IK};function _K(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(YS(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),nW({inputs:{x:i},backend:r,attrs:{shape:s}})}var EK={kernelName:LI,backendName:"webgpu",kernelFunc:_K},NK=fW({opType:yV.EXPM1,cpuKernelImpl:xj}),RK={kernelName:FI,backendName:"webgpu",kernelFunc:NK},AK=function(){function e(t,n){Se(this,e),this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=t,this.shaderKey="fft_".concat(t)}return Te(e,[{key:"getUserCode",value:function(){var e="real"===this.component?"return real * expR - imag * expI;":"return real * expI + imag * expR;";return"\n    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {\n      ".concat(e,"\n    }\n\n    fn mulMatDFT(batch: i32, index: i32) -> f32 {\n      let indexRatio = f32(index) / f32(uniforms.realShape[1]);\n      let exponentMultiplierTimesIndexRatio =\n          uniforms.exponentMultiplier * indexRatio;\n\n      var result = 0.0;\n\n      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {\n        // x = (-2|2 * PI / N) * index * i;\n        let x = exponentMultiplierTimesIndexRatio * f32(i);\n        let expR = cos(x);\n        let expI = sin(x);\n        let real = getReal(batch, i);\n        let imag = getImag(batch, i);\n\n        result = result +\n            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;\n      }\n\n      return result;\n    }\n\n    ").concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));\n      }\n    }\n  ")}}]),e}();function OK(e,t,n){var r=n.tensorMap.get(e.dataId),a=JS(e.shape),i=e.shape[e.shape.length-1],o=[],s=nW({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}});o.push(s);var u=s.shape,c=new AK("real",u),l=new AK("imag",u),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],d=[{type:"float32",data:[t?2*Math.PI:-2*Math.PI]},{type:"float32",data:[t?u[1]:1]}],f=n.runWebGPUProgram(c,h,"float32",d);o.push(f);var p=n.runWebGPUProgram(l,h,"float32",d);o.push(p);var m=lW({inputs:{real:f,imag:p},backend:n});o.push(m);var v=nW({inputs:{x:m},backend:n,attrs:{shape:e.shape}});return o.forEach((function(e){return n.disposeData(e.dataId)})),v}var DK,PK={kernelName:zI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend;return OK(t.input,!1,n)}},MK=function(){function e(t){Se(this,e),this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let coordX = uniforms.xShape[2] - coords[2] - 1;\n          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);\n          setOutputAtIndex(index, outputValue);\n        }\n      }\n    ")}}]),e}(),LK={kernelName:VI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new MK(r.shape);return a.runWebGPUProgram(i,[r],r.dtype)}},FK=fW({opType:yV.FLOOR,cpuKernelImpl:wj}),zK={kernelName:UI,backendName:"webgpu",kernelFunc:FK},BK=pW({opType:mV.FLOOR_DIV,cpuKernelImpl:kj,dtype:"int32"}),VK={kernelName:WI,backendName:"webgpu",kernelFunc:BK},UK=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Se(this,e),this.pixelsOpType=HB.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[n,1,1]),this.importVideo=r,this.shaderKey="fromPixels_".concat(this.importVideo)}return Te(e,[{key:"getUserCode",value:function(){var e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)",t=this.importVideo?"texture_external":"texture_2d<f32>";return"\n      @binding(1) @group(0) var src: ".concat(t,";\n      ").concat(QB("index")," {\n        let flatIndex = index * uniforms.numChannels;\n        if (flatIndex < uniforms.size) {\n          let coords = getCoordsFromIndex(flatIndex);\n          let values = ").concat(e,";\n          for (var i = 0; i < uniforms.numChannels; i = i + 1) {\n            result[flatIndex + i] = i32(floor(255.0 * values[i]));\n          }\n        }\n      }\n  ")}}]),e}(),WK={kernelName:B_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels;if(null==a)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u="undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&a instanceof OffscreenCanvas,c="undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap,l=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],h=(0,U.Z)(l,2),d=h[0],f=h[1],p=[f,d,i],m=o||s;if(c||u||m){var v;if(m){var g=RC().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=DK&&g===jK||(jK=g,DK=document.createElement("canvas").getContext("2d",{willReadFrequently:jK})),DK.canvas.width=d,DK.canvas.height=f,DK.drawImage(a,0,0,d,f),a=DK.canvas}var y=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,b=n.textureManager.acquireTexture(p[1],p[0],"rgba8unorm",y);n.queue.copyExternalImageToTexture({source:a},{texture:b},[p[1],p[0]]),v=b;var x=JS(p),w=gC(p),k=new UK(p,i,false),S=[{type:"uint32",data:[x]},{type:"uint32",data:[i]},{type:"uint32",data:(0,ke.Z)(w)}],C=n.makeTensorInfo([f,d],"int32");n.tensorMap.get(C.dataId).resource=v;var I=n.runWebGPUProgram(k,[C],"int32",S);return n.disposeData(C.dataId),I}var T=a.data,_=T;if(null!=i&&4!==i){_=new Uint8Array(a.width*a.height*i);for(var E=T.length,N=0,R=0;R<E;R++)R%4<i&&(_[N++]=T[R])}var A=n.makeTensorInfo(p,"int32",new Int32Array(_));return n.uploadToGPU(A.dataId),A}},jK=RC().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var GK=function(){function e(t,n,r,a,i){Se(this,e),this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],iA(t,n),iA(t,r),this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),null!=a&&(iA(t,a),this.variableNames.push("offset")),null!=i&&(iA(t,i),this.variableNames.push("scale")),this.offsetShape=a,this.scaleShape=i,this.shaderKey="batchNorm"}return Te(e,[{key:"getUserCode",value:function(){var e="0.0";null!=this.offsetShape&&(e="getOffsetByOutputIndex(index)");var t="1.0";return null!=this.scaleShape&&(t="getScaleByOutputIndex(index)"),"\n      ".concat(QB("index")," {\n        if (index < uniforms.size)\n        {\n          let xValue = getXByOutputIndex(index);\n          let meanValue = getMeanByOutputIndex(index);\n          let varianValue = getVarianceByOutputIndex(index);\n          let offsetValue = ").concat(e,";\n          let scaleValue = ").concat(t,";\n          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));\n          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));\n        }\n      }\n  ")}}]),e}(),HK={kernelName:jI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance,c=n.varianceEpsilon,l=r,h=[a,s,u],d=null;null!=o&&(d=o.shape,h.push(o));var f=null;null!=i&&(f=i.shape,h.push(i));var p=new GK(a.shape,s.shape,u.shape,d,f),m=[{type:"float32",data:[c]}];return l.runWebGPUProgram(p,h,a.dtype,m)}};var KK={kernelName:W_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,d=r.dimRoundingMode,f=r.activation,p=r.leakyreluAlpha,m=SO(l);return xH({x:a,filter:i,convInfo:fO(a.shape,i.shape,u,h,c,d,!1,m),backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:p,activation:f})}};var qK={kernelName:j_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,h=r.dimRoundingMode,d=r.activation,f=r.leakyreluAlpha,p=l;null==p&&(p=[1,1]),YS(wO(u,p),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(p,"'")}));var m=fO(a.shape,i.shape,u,p,c,h,!0),v=[a,i],g=null!=o,y=null!=s;g&&v.push(o),y&&v.push(s);var b,x=[{type:"int32",data:[m.padInfo.top,m.padInfo.left]},{type:"int32",data:[m.inHeight,m.inWidth]}];return m.outHeight>4&&m.outWidth>4&&m.strideWidth<=2&&m.inChannels===m.outChannels&&1===m.dilationHeight&&1===m.dilationWidth&&m.inChannels%4===0?(b=new YH(m,g,d,y),x.push({type:"int32",data:[b.virtualWidth]})):(b=new QH(m,g,d,y),x.push({type:"int32",data:[m.filterHeight]},{type:"int32",data:[m.filterWidth]},{type:"int32",data:[m.strideHeight,m.strideWidth]},{type:"int32",data:[m.dilationHeight,m.dilationWidth]})),"leakyrelu"===d&&(x.push({type:"float32",data:[f]}),b.uniforms+=" alpha : f32,"),n.runWebGPUProgram(b,v,"float32",x)}},ZK=function(){function e(t,n){Se(this,e),this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gathernd_".concat(t),this.sliceDim=t,this.uniforms="sliceDim : i32, strides : ".concat(XB(t),",")}return Te(e,[{key:"getUserCode",value:function(){var e;return e=this.sliceDim>1?"uniforms.strides[j]":"uniforms.strides","\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          var flattenIndex = 0;\n          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {\n            let indexTemp = i32(round(getIndices(coords[0], j)));\n            let strideNum = ").concat(e,";\n            flattenIndex = flattenIndex + indexTemp * strideNum;\n          }\n\n          setOutputAtIndex(index, getA(flattenIndex, coords[1]));\n        }\n      }\n      ")}}]),e}();var XK={kernelName:HI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=JS(r.shape),u=MF(r,a),c=(0,U.Z)(u,4),l=c[0],h=c[1],d=c[2],f=c[3],p=nW({inputs:{x:a},backend:n,attrs:{shape:[h,o]}}),m=nW({inputs:{x:r},backend:n,attrs:{shape:[JS(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var v=n.readSync(a.dataId),g=n.bufferSync(r),y=Sj(v,g,r.dtype,h,o,d,f,r.shape,s);return n.makeTensorInfo(l,r.dtype,y.values)}var b=new ZK(o,[h,d]),x=[{type:"int32",data:[o]},{type:"int32",data:f}],w=n.runWebGPUProgram(b,[m,p],m.dtype,x),k=nW({inputs:{x:w},backend:n,attrs:{shape:l}});return n.disposeData(p.dataId),n.disposeData(m.dataId),n.disposeData(w.dataId),k}},YK=function(){function e(t,n){Se(this,e),this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.slice(),this.aShape=t,this.outputShape=n,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}return Te(e,[{key:"getUserCode",value:function(){var e=function(e){for(var t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[],r=0;r<e.length;r++)2===r?n.push("indexZ"):n.push("".concat(t[r]));return n.join()}(this.aShape);return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          let indexZ = i32(getIndices(resRC.x, resRC.z));\n          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);\n          setOutputAtIndex(index, inBounds * getA(").concat(e,"));\n        }\n      }\n    ")}}]),e}();function QK(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=cz(a,i,sC(o,a.shape)[0],s),c=JS(i.shape),l=[],h=nW({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=nW({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});l.push(h),l.push(d);var f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])){var p=n.tensorMap.get(d.dataId).values,m=IR(d.shape,d.dtype,p),v=n.tensorMap.get(h.dataId).values,g=IR(h.shape,h.dtype,v),y=Cj(g,m,f);return l.forEach((function(e){return n.disposeData(e.dataId)})),n.makeTensorInfo(u.outputShape,y.dtype,y.values)}var b=new YK(h.shape,f),x=n.runWebGPUProgram(b,[h,d],h.dtype);l.push(x);var w=nW({inputs:{x:x},backend:n,attrs:{shape:u.outputShape}});return l.forEach((function(e){return n.disposeData(e.dataId)})),w}var $K={kernelName:GI,backendName:"webgpu",kernelFunc:QK},JK=pW({opType:mV.GREATER,cpuKernelImpl:Tj,dtype:"bool"}),eq={kernelName:KI,backendName:"webgpu",kernelFunc:JK},tq=pW({opType:mV.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:Ij}),nq={kernelName:qI,backendName:"webgpu",kernelFunc:tq};var rq={kernelName:XI,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend;return OK(t.input,!0,n)}},aq=fW({opType:yV.IS_FINITE,dtype:"bool"}),iq={kernelName:QI,backendName:"webgpu",kernelFunc:aq},oq=fW({opType:yV.IS_INF,dtype:"bool"}),sq={kernelName:$I,backendName:"webgpu",kernelFunc:oq},uq=fW({opType:yV.IS_NAN,dtype:"bool"}),cq={kernelName:JI,backendName:"webgpu",kernelFunc:uq};var lq={kernelName:eT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=[{type:"float32",data:[r.alpha]}],o=new dW(a.shape,yV.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(o,[a],"float32",i)}},hq=pW({opType:mV.LESS,dtype:"bool",cpuKernelImpl:Ej}),dq={kernelName:tT,backendName:"webgpu",kernelFunc:hq},fq=pW({opType:mV.LESS_EQUAL,dtype:"bool",cpuKernelImpl:_j}),pq={kernelName:nT,backendName:"webgpu",kernelFunc:fq},mq=function(){function e(t){Se(this,e),this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);\n        }\n      }\n    ")}}]),e}();var vq={kernelName:rT,backendName:"webgpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=(a-r)/(i-1),s=new mq(i),u=[{type:"float32",data:[r]},{type:"float32",data:[o]}];return t.runWebGPUProgram(s,[],"float32",u)}},gq=fW({opType:yV.LOG,cpuKernelImpl:Nj}),yq={kernelName:aT,backendName:"webgpu",kernelFunc:gq},bq=fW({opType:yV.LOG1P}),xq={kernelName:iT,backendName:"webgpu",kernelFunc:bq},wq=pW({opType:mV.LOGICAL_AND,dtype:"bool"}),kq={kernelName:oT,backendName:"webgpu",kernelFunc:wq},Sq=fW({opType:yV.LOGICAL_NOT}),Cq={kernelName:sT,backendName:"webgpu",kernelFunc:Sq},Iq=pW({opType:mV.LOGICAL_OR}),Tq={kernelName:uT,backendName:"webgpu",kernelFunc:Iq},_q="\n  var powValue = 0.0;\n  let basis = uniforms.bias + uniforms.alpha * sum;\n  if (uniforms.beta == 0.5) {\n    powValue = inverseSqrt(basis);\n  } else if (uniforms.beta == 1.0) {\n    powValue = 1.0 / basis;\n  } else {\n    powValue = exp(log(basis) * (-uniforms.beta));\n  }\n",Eq=function(){function e(t){Se(this,e),this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let b = coords[0];\n        let r = coords[1];\n        let c = coords[2];\n        let d = coords[3];\n\n        let x = getX(b, r, c, d);\n        var sum = 0.0;\n        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {\n          let idx = d + i;\n          if (idx >= 0 && idx < uniforms.xShape[3]) {\n            let z = getX(b, r, c, idx);\n            sum = sum + z * z;\n          }\n        }\n        ").concat(_q,"\n\n        setOutputAtIndex(index, x * powValue);\n      }\n    }\n  ")}}]),e}(),Nq=function(){function e(t,n){var r=this;Se(this,e),this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,YS(n<=this.maxAllowRadius,(function(){return"Radius must be less than or equal to ".concat(r.maxAllowRadius,", current radius is ").concat(n)})),this.outputShape=t,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=uV(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}return Te(e,[{key:"getUserCode",value:function(){return"\n    var <workgroup>lrnSub: array<f32, ".concat(this.workgroupSize[0],">;\n    const elementsPerWorkgroup = ").concat(this.elementsPerWorkgroup,";\n    const maxAllowRadius = ").concat(this.maxAllowRadius,";\n\n    ").concat(QB()," {\n      let localDepth = i32(localId.x);\n      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;\n      let xDepth = workgroupDepth + localDepth - maxAllowRadius;\n      let b = i32(globalId.z) / uniforms.xShape[1];\n      let r = i32(globalId.z) - b * uniforms.xShape[1];\n      let c = i32(globalId.y);\n      let d = workgroupDepth + localDepth;\n\n      var x = 0.0;\n      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {\n        x = getX(b, r, c, xDepth);\n      }\n      lrnSub[localDepth] = x;\n      workgroupBarrier();\n\n      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {\n        var sum = 0.0;\n        let index = localDepth + maxAllowRadius;\n        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {\n          let z = lrnSub[index + i];\n          sum = sum + z * z;\n        }\n        ").concat(_q,"\n\n        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);\n      }\n    } ")}}]),e}();var Rq={kernelName:cT,backendName:"webgpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.depthRadius,s=a.bias,u=a.alpha,c=a.beta;t=o>16?new Eq(i.shape):new Nq(i.shape,o);var l=[{type:"int32",data:[o]},{type:"float32",data:[s]},{type:"float32",data:[u]},{type:"float32",data:[c]}];return r.runWebGPUProgram(t,[i],i.dtype,l)}},Aq=function(){function e(t){Se(this,e),this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let b = coords[0];\n        let r = coords[1];\n        let c = coords[2];\n\n        let MIN_DEPTH_BEGIN = 0;\n        let MAX_DEPTH_END = uniforms.outShape[3];\n        var result = 0.0;\n        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {\n          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);\n          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);\n\n          var norm = 0.0;\n          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {\n            if (k < depthBegin) {\n              continue;\n            } else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            } else {\n              break;\n            }\n          }\n\n          norm = uniforms.alpha * norm + uniforms.bias;\n\n          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {\n            if (k < depthBegin) {\n              continue;\n            } else if (k >= depthBegin && k < depthEnd) {\n              var dyi = -2.0 * uniforms.alpha * uniforms.beta\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * uniforms.beta);\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            } else {\n              break;\n            }\n          }\n        }\n\n        setOutputAtIndex(index, result);\n      }\n    }\n  ")}}]),e}();var Oq={kernelName:lT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new Aq(a.shape),d=[{type:"int32",data:[s]},{type:"float32",data:[u]},{type:"float32",data:[c]},{type:"float32",data:[l]}];return n.runWebGPUProgram(h,[a,i,o],a.dtype,d)}},Dq=pW({opType:mV.MAX,cpuKernelImpl:Aj}),Pq={kernelName:dT,backendName:"webgpu",kernelFunc:Dq};var Mq={kernelName:fT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;return DG(a,hO(a.shape,i,o,1,s,u),"max",n)}};var Lq={kernelName:mT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=dO(a.shape,i,o,[1,1,1],s,c,u),h=new EG(l,"max"),d=[{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.padInfo.front,l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.inDepth,l.inHeight,l.inWidth]},{type:"int32",data:[l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[a],a.dtype,d)}},Fq=function(){function e(t){Se(this,e),this.variableNames=["dy","maxPos"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d = coords[3];\n\n        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;\n        let dyRCorner = dyRCCorner.x;\n        let dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            let dyValue = getDy(batch, idyR, idyC, d);\n            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            let curPosValue = wR * uniforms.filterDims[1] + wC;\n            let mask = select(0.0, 1.0, maxPosValue == curPosValue);\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}(),zq=function(){function e(t){Se(this,e),this.variableNames=["dy","maxPos"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,\n      outDepth : i32, outHeight : i32, outWidth : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.inShape,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let ch = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyDCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;\n\n        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {\n          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);\n\n          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {\n            continue;\n          }\n          let idyD = i32(dyD);\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;\n              let mask = select(0.0, 1.0, maxPosValue == curPosValue);\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}]),e}();var Bq={kernelName:vT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=dO(i.shape,o,s,[1,1,1],u,c),h=new EG(l,"max",!0),d=[{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.padInfo.front,l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.inDepth,l.inHeight,l.inWidth]},{type:"int32",data:[l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth]}],f=n.runWebGPUProgram(h,[i],"int32",d),p=new zq(l);d=[{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.effectiveFilterDepth-1-l.padInfo.front,l.effectiveFilterHeight-1-l.padInfo.top,l.effectiveFilterWidth-1-l.padInfo.left]},{type:"int32",data:[l.effectiveFilterDepth,l.effectiveFilterHeight,l.effectiveFilterWidth]},{type:"int32",data:[l.outDepth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]}];var m=n.runWebGPUProgram(p,[a,f],i.dtype,d);return n.disposeData(f.dataId),m}};var Vq={kernelName:pT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;pV([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=hO(o.shape,s,u,1,c,l),d=new _G(h,"max",!0),f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}],p=n.runWebGPUProgram(d,[o],"int32",f),m=new Fq(h);f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];var v=n.runWebGPUProgram(m,[a,p],o.dtype,f);return n.disposeData(p.dataId),v}};var Uq={kernelName:gT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.filterSize,i=r.strides,o=r.pad,s=r.includeBatchInIndex,u=t.x;YS(4===u.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(u.shape.length,".")}));var c=[1,1];YS(wO(i,c),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(c,"'")}));var l=hO(u.shape,a,i,c,o),h=[{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.dilationHeight,l.dilationWidth]},{type:"int32",data:[l.inHeight,l.inWidth]},{type:"int32",data:[l.effectiveFilterHeight,l.effectiveFilterWidth]}],d=new _G(l,"max",!1),f=n.runWebGPUProgram(d,[u],u.dtype,h);return d=new _G(l,"max",!0,!0,s),[f,n.runWebGPUProgram(d,[u],"int32",h)]}};var Wq={kernelName:bT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return lG(t.x,r.axis,r.keepDims,"min",n)}},jq=pW({opType:mV.MIN,cpuKernelImpl:Oj}),Gq={kernelName:xT,backendName:"webgpu",kernelFunc:jq},Hq=function(){function e(t,n,r){var a=this;Se(this,e),this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]})),this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=t,n.map((function(e,t){a.uniforms+=" pad".concat(t," : vec2<i32>,")})),this.offset="reflect"===r?0:1,this.shaderKey="mirrorPad_".concat(r)}return Te(e,[{key:"getUserCode",value:function(){var e=this.xShape.length,t=this.xShape.map((function(e,t){return"uniforms.pad".concat(t,"[0]")})).join(","),n=this.xShape.map((function(t,n){return"uniforms.pad".concat(n,"[0] + uniforms.xShape").concat(e>1?"[".concat(n,"]"):"")})).join(","),r=1===e?"start":"start[i]",a=1===e?"end":"end[i]",i=1===e?"outC":"outC[i]",o=XB(e),s=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let start = ").concat(o,"(").concat(t,");\n          let end = ").concat(o,"(").concat(n,");\n          var outC = getCoordsFromIndex(index);\n          for (var i = 0; i < ").concat(e,"; i = i + 1) {\n            if (").concat(i," < ").concat(r,") {\n              ").concat(i," = ").concat(r," * 2 - ").concat(i," - ").concat(this.offset,";\n            } else if(").concat(i," >= ").concat(a,") {\n              ").concat(i," = (").concat(a," - 1) * 2 - ").concat(i," + ").concat(this.offset,";\n            }\n          }\n          let coords = outC - start;\n          setOutputAtIndex(index, getX(").concat(s,"));\n        }\n      }\n    ")}}]),e}(),Kq={kernelName:wT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.paddings,o=n.mode,s=r,u=i.map((function(e){return{type:"int32",data:[e[0],e[1]]}})),c=new Hq(a.shape,i,o);return s.runWebGPUProgram(c,[a],a.dtype,u)}},qq=pW({opType:mV.MOD}),Zq={kernelName:kT,backendName:"webgpu",kernelFunc:qq},Xq=function(){function e(t,n){Se(this,e),this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t,n],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}return Te(e,[{key:"getUserCode",value:function(){return"\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {\n      let HASHSCALE1 = 443.8975;\n      let p = resultUV * seed;\n      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);\n      p3 = p3 + dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let batch = coords[0];\n\n        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),\n            f32(coords[0]) / f32(uniforms.outShape[0]));\n        let r = random(uniforms.seed, resUV);\n        var cdf = 0.0;\n        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {\n          cdf = cdf + getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutputAtIndexI32(index, i);\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);\n      }\n    }\n  ")}}]),e}(),Yq=function(){function e(t){Se(this,e),this.variableNames=["logits"],this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}return Te(e,[{key:"getUserCode",value:function(){return"\n    var<workgroup> buf : array<f32, ".concat(this.workgroupSize[0],">;\n    var<workgroup> rowMaxShared : f32;\n    var<workgroup> rowSumShared : f32;\n    const blockSize = ").concat(this.workgroupSize[0],";\n    ").concat(QB("index")," {\n      let row = index / blockSize;\n      let tid = i32(localId.x);\n      let cols = uniforms.outShape[1];\n\n      var threadMax = -3.402823e+38f;\n      for (var col = tid; col < cols; col += blockSize) {\n        let value = getLogits(row, col);\n        threadMax = max(threadMax, value);\n      }\n      if (tid < cols) {\n        buf[tid] = threadMax;\n      }\n      workgroupBarrier();\n\n      var reduceSize = min(cols, blockSize);\n      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n        reduceSize = currSize + (reduceSize & 1);\n        if (tid < currSize) {\n          buf[tid] = max(buf[tid], buf[tid + reduceSize]);\n        }\n        workgroupBarrier();\n      }\n\n      if (tid == 0) {\n        rowMaxShared = buf[0];\n      }\n      workgroupBarrier();\n\n      var threadSum = 0.0;\n      for (var col = tid; col < cols; col += blockSize) {\n        let subExp = exp(getLogits(row, col) - rowMaxShared);\n        threadSum += subExp;\n      }\n      buf[tid] = threadSum;\n      workgroupBarrier();\n\n      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n        if (tid < currSize) {\n          buf[tid] = buf[tid] + buf[tid + currSize];\n        }\n        workgroupBarrier();\n      }\n\n      if (tid == 0) {\n        rowSumShared = buf[0];\n      }\n      workgroupBarrier();\n\n      for (var col = tid; col < cols; col += blockSize) {\n        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;\n        setOutputAtCoords(row, col, value);\n      }\n  }\n    ")}}]),e}();function Qq(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=nW({inputs:{x:a},backend:n,attrs:{shape:[JS(a.shape)/a.shape[i],a.shape[i]]}}),s=new Yq(o.shape),u=n.runWebGPUProgram(s,[o],a.dtype),c=nW({inputs:{x:u},backend:n,attrs:{shape:a.shape}});return n.disposeData(o.dataId),n.disposeData(u.dataId),c}var $q={kernelName:p_,backendName:"webgpu",kernelFunc:Qq};var Jq={kernelName:ST,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:Qq({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new Xq(c,i),d=[{type:"float32",data:[o]},{type:"int32",data:[l]}],f=n.runWebGPUProgram(h,[u],"int32",d);return s||n.disposeData(u.dataId),f}};var eZ={kernelName:IT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;if(n.shouldExecuteOnCPU([r])){var a=n.tensorMap.get(r.dataId),i=Pj(a.values,r.shape,r.dtype),o=(0,U.Z)(i,2),s=o[0],u=o[1];return n.makeTensorInfo(u,r.dtype,s)}var c=new dW(r.shape,yV.NEG);return n.runWebGPUProgram(c,[r],r.dtype)}};var tZ={kernelName:_T,backendName:"webgpu",kernelFunc:function(e){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=NL(n.readSync(a.dataId),n.readSync(i.dataId),o,s,u).selectedIndices;return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}};var nZ={kernelName:NT,backendName:"webgpu",kernelFunc:function(e){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=AL(n.readSync(a.dataId),n.readSync(i.dataId),o,s,u,c),h=l.selectedIndices,d=l.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},rZ=function(){function e(t,n){Se(this,e),this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t,n],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if(index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,\n                                      f32(i32(round(getX(coords.x))) == coords.y)));\n        }\n      }\n    ")}}]),e}();var aZ={kernelName:AT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue,c=JS(a.shape),l=new rZ(c,o),h=nW({inputs:{x:a},backend:n,attrs:{shape:[c]}}),d=[{type:"float32",data:[s]},{type:"float32",data:[u]}],f=n.runWebGPUProgram(l,[h],i,d);n.disposeData(h.dataId);var p=nW({inputs:{x:f},backend:n,attrs:{shape:[].concat((0,ke.Z)(a.shape),[o])}});return n.disposeData(f.dataId),p}};function iZ(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=JG({inputs:{input:r},backend:n}),i=iZ({inputs:{x:a},backend:n}),o=hH({inputs:{input:r},backend:n}),s=iZ({inputs:{x:o},backend:n}),u=lW({inputs:{real:i,imag:s},backend:n});return n.disposeData(a.dataId),n.disposeData(i.dataId),n.disposeData(o.dataId),n.disposeData(s.dataId),u}return eW({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var oZ={kernelName:F_,backendName:"webgpu",kernelFunc:iZ};var sZ={kernelName:RT,backendName:"webgpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=JG({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=hH({inputs:{input:a},backend:r}),u=iZ({inputs:{x:s},backend:r}),c=lW({inputs:{real:o,imag:u},backend:r});return r.disposeData(i.dataId),r.disposeData(o.dataId),r.disposeData(s.dataId),r.disposeData(u.dataId),c}return eW({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var uZ={kernelName:OT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return _K({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){QS(a,e.shape,"All tensors passed to stack must have matching shapes"),YS(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=pH({inputs:t.map((function(e){var t=_K({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeData(e.dataId)})),s}};function cZ(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length,r=XB(n),a=e.map((function(e,t){return"uniforms.pad".concat(t,"[0]")})).join(","),i=e.map((function(e,t){return"uniforms.pad".concat(t,"[0] + uniforms.xShape").concat(n>1?"[".concat(t,"]"):"")})).join(","),o=n>1?"".concat(r,"(").concat(a,")"):"".concat(a),s=n>1?"".concat(r,"(").concat(i,")"):"".concat(i),u=n>1?"any(paddedCoords < start)":"paddedCoords < start",c=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",l=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return"\n        let start = ".concat(o,";\n        let end = ").concat(s,";\n        if (").concat(u," || ").concat(c,") {\n          setOutputAtIndex(index, ").concat(t?0:"uniforms.constantValue",");\n        } else {\n          let coords = paddedCoords - start;\n          setOutputAtIndex(index, getX(").concat(l,"));\n        }\n  ")}var lZ=function(){function e(t,n){var r=this;Se(this,e),this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]})),this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),n.map((function(e,t){r.uniforms+=" pad".concat(t," : vec2<i32>,")})),this.xShape=t,this.shaderKey="pad"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let paddedCoords = getCoordsFromIndex(index);\n          ").concat(cZ(this.xShape),"\n        }\n      }\n    ")}}]),e}(),hZ={kernelName:DT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(i.every((function(e){return tC(e,[0,0])})))return uW({inputs:{x:a},backend:n});if(0===JS(a.shape)){var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return eW({backend:n,attrs:{shape:s,value:o,dtype:a.dtype}})}var u=[{type:"float32",data:[o]}];i.map((function(e){return u.push({type:"int32",data:[e[0],e[1]]})}));var c=new lZ(a.shape,i);return n.runWebGPUProgram(c,[a],a.dtype,u)}},dZ=pW({opType:mV.POW}),fZ={kernelName:PT,backendName:"webgpu",kernelFunc:dZ};var pZ={kernelName:MT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=new sW(mV.PRELU,r.shape,a.shape);return n.runWebGPUProgram(i,[r,a],"float32")}};var mZ={kernelName:LT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return lG(t.x,r.axis,r.keepDims,"prod",n)}},vZ={kernelName:VT,backendName:"webgpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=Fj(r,a,i,o);return t.makeTensorInfo([s.length],o,s)}},gZ=pW({opType:mV.DIV}),yZ={kernelName:NI,backendName:"webgpu",kernelFunc:gZ},bZ=fW({opType:yV.RECIPROCAL}),xZ={kernelName:WT,backendName:"webgpu",kernelFunc:bZ},wZ=fW({opType:yV.RELU}),kZ={kernelName:jT,backendName:"webgpu",kernelFunc:wZ},SZ=fW({opType:yV.RELU6}),CZ={kernelName:XT,backendName:"webgpu",kernelFunc:SZ},IZ=function(){function e(t,n,r){Se(this,e),this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t[0],n,r,t[3]],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let d = coords[3];\n          let rc = coords.yz;\n\n          let effectiveInSize = vec2<f32>(\n            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveOutSize = vec2<f32>(\n            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveInputOverOutputRatioRC =\n              effectiveInSize / effectiveOutSize;\n\n          // Fractional source index\n          let sourceFracIndexRC =\n            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *\n            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);\n\n          // Compute the four integer indices.\n          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);\n          let sourceCeilRC = vec2<i32>(\n            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));\n\n          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);\n          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);\n          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);\n          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);\n\n          let top = topLeft + (topRight - topLeft) * fracRC.y;\n          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n          let newValue = top + (bottom - top) * fracRC.x;\n\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    ")}}]),e}();var TZ={kernelName:qT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.size,s=r.halfPixelCenters,u=(0,U.Z)(o,2),c=u[0],l=u[1],h=[{type:"float32",data:[i&&c>1?1:0,i&&l>1?1:0]},{type:"float32",data:[s?.5:0]}],d=new IZ(a.shape,c,l);return n.runWebGPUProgram(d,[a],"float32",h)}},_Z=function(){function e(t,n){Se(this,e),this.variableNames=["dy"],this.uniforms="effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,\n       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey="resizeBilinearBackprop_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let b = coords[0];\n          let d = coords[3];\n          let r = coords[1];\n          let c = coords[2];\n\n          var accumulator = 0.0;\n\n          // Compute bounds for where in dy we will look\n          let startRLerp = floor(f32(r) * uniforms.invHeightScale);\n          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));\n\n          let startCLerp = floor(f32(c) * uniforms.invWidthScale);\n          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));\n\n          // Loop over dy\n          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {\n            let dyR = startDyR + dyROffset;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {\n              continue;\n            }\n\n            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {\n              let dyC = startDyC + dyCOffset;\n\n              // Guard against the window exceeding the bounds of dy\n              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {\n                continue;\n              }\n\n              let dxR = f32(dyR) * uniforms.heightScale;\n              let topDxRIndex = i32(floor(dxR));\n              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));\n              let dxRLerp = dxR - f32(topDxRIndex);\n              let inverseDxRLerp = 1.0 - dxRLerp;\n\n              let dxC = f32(dyC) * uniforms.widthScale;\n              let leftDxCIndex = i32(floor(dxC));\n              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));\n              let dxCLerp = dxC - f32(leftDxCIndex);\n              let inverseDxCLerp = 1.0 - dxCLerp;\n\n              if (r == topDxRIndex && c == leftDxCIndex) {\n                // topLeft\n                accumulator +=\n                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n              }\n\n              if (r == topDxRIndex && c == rightDxCIndex) {\n                // topRight\n                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n              }\n\n              if (r == bottomDxRIndex && c == leftDxCIndex) {\n                // bottomLeft\n                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n              }\n\n              if (r == bottomDxRIndex && c == rightDxCIndex) {\n                // bottomRight\n                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n              }\n            }\n          }\n          // End loop over dy\n\n          setOutputAtIndex(index, accumulator);\n        }\n      }\n    ")}}]),e}();var EZ={kernelName:ZT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=(0,U.Z)(a.shape,3),u=s[1],c=s[2],l=(0,U.Z)(i.shape,3),h=l[1],d=l[2],f=[o&&h>1?u-1:u,o&&d>1?c-1:c],p=[o&&h>1?h-1:h,o&&d>1?d-1:d],m=f[0]/p[0],v=f[1]/p[1],g=1/m,y=1/v,b=2*Math.ceil(g)+2,x=2*Math.ceil(y)+2,w=new _Z(a.shape,o),k=[{type:"int32",data:f},{type:"int32",data:p},{type:"float32",data:[m]},{type:"float32",data:[v]},{type:"float32",data:[g]},{type:"float32",data:[y]},{type:"int32",data:[b]},{type:"int32",data:[x]}];return n.runWebGPUProgram(w,[i],i.dtype,k)}},NZ=function(){function e(t,n,r,a){Se(this,e),this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[t[0],n,r,t[3]],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=a,this.shaderKey="resizeNearest_".concat(a)}return Te(e,[{key:"getUserCode",value:function(){var e;return e=this.halfPixelCenters?"max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":"vec2<f32>(rc) * effectiveInputOverOutputRatioRC","\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let d = coords[3];\n          let rc = coords.yz;\n\n          let effectiveInSize = vec2<f32>(\n            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveOutSize = vec2<f32>(\n            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveInputOverOutputRatioRC =\n              effectiveInSize / effectiveOutSize;\n\n          // Fractional source index\n          let sourceFracIndexRC = ").concat(e,";\n\n          // Compute the coordinators of nearest neighbor point.\n          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));\n          let sourceNearestRC = vec2<i32>(\n            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));\n          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    ")}}]),e}();var RZ={kernelName:HT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size,u=(0,U.Z)(s,2),c=u[0],l=u[1],h=[{type:"float32",data:[i&&c>1?1:0,i&&l>1?1:0]},{type:"float32",data:[i?.5:0]}],d=new NZ(a.shape,c,l,o);return n.runWebGPUProgram(d,[a],a.dtype,h)}},AZ=function(){function e(t,n){Se(this,e),this.variableNames=["dy"],this.uniforms="effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,\n       winHeight : i32, winWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey="resizeNearestNeigborBackprop_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let b = coords[0];\n          let d = coords[3];\n          let r = coords[1];\n          let c = coords[2];\n\n          var accumulator = 0.0;\n\n          // Compute bounds for where in dy we will look\n          let startRLerp = floor(f32(r) * uniforms.invHeightScale);\n          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));\n\n          let startCLerp = floor(f32(c) * uniforms.invWidthScale);\n          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));\n\n          // Loop over dy\n          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {\n            let dyR = startDyR + dyROffset;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {\n              continue;\n            }\n\n            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {\n              let dyC = startDyC + dyCOffset;\n\n              // Guard against the window exceeding the bounds of dy\n              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {\n                continue;\n              }\n\n              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *\n                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));\n\n              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *\n                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));\n\n              let sourceNearestRow =\n                  i32(min(f32(uniforms.outShape[1] - 1),\n                  ").concat(this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)","));\n\n              let sourceNearestCol =\n                  i32(min(f32(uniforms.outShape[2] - 1),\n                  ").concat(this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)","));\n\n              if (r == sourceNearestRow && c == sourceNearestCol) {\n                accumulator += getDy(b, dyR, dyC, d);\n              }\n            }\n          }\n          // End loop over dy\n\n          setOutputAtIndex(index, accumulator);\n        }\n      }\n    ")}}]),e}();var OZ={kernelName:KT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=(0,U.Z)(a.shape,3),u=s[1],c=s[2],l=(0,U.Z)(i.shape,3),h=l[1],d=l[2],f=[o&&h>1?u-1:u,o&&d>1?c-1:c],p=[o&&h>1?h-1:h,o&&d>1?d-1:d],m=1/(f[0]/p[0]),v=1/(f[1]/p[1]),g=2*Math.ceil(m)+2,y=2*Math.ceil(v)+2,b=new AZ(a.shape,o),x=[{type:"int32",data:f},{type:"int32",data:p},{type:"float32",data:[m]},{type:"float32",data:[v]},{type:"int32",data:[g]},{type:"int32",data:[y]}];return n.runWebGPUProgram(b,[i],i.dtype,x)}},DZ=function(){function e(t){Se(this,e),this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}return Te(e,[{key:"getUserCode",value:function(){return"\n      ".concat("\n      // Using uniform variables as judging conditions, so the function has\n      // coherent execution within all threads.\n      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {\n        var reverseCoords = coords;\n        if (uniforms.axis[0] == 1) {\n          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;\n        }\n        if (uniforms.axis[1] == 1) {\n          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;\n        }\n        if (uniforms.axis[2] == 1) {\n          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;\n        }\n        if (uniforms.axis[3] == 1) {\n          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;\n        }\n\n        return reverseCoords;\n      }\n    ","\n      ").concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let reverseCoords = getReverseCoords(coords);\n          setOutputAtIndex(index, getX(reverseCoords[0],\n              reverseCoords[1], reverseCoords[2], reverseCoords[3]));\n        }\n      }\n    ")}}]),e}();var PZ={kernelName:YT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length;if(0===o)return uW({inputs:{x:a},backend:n});var s=a.shape,u=[1,1,1,1];s.forEach((function(e,t){u[t+4-o]=e}));var c=sC(i,a.shape),l=[0,0,0,0];c.forEach((function(e){l[e+4-o]=1}));var h=[{type:"int32",data:l}],d=nW({inputs:{x:a},backend:n,attrs:{shape:u}}),f=new DZ(u),p=n.runWebGPUProgram(f,[d],d.dtype,h);n.disposeData(d.dataId);var m=nW({inputs:{x:p},backend:n,attrs:{shape:s}});return n.disposeData(p.dataId),m}},MZ=function(){function e(t,n){Se(this,e),this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="centerX : f32, centerY : f32, sinRadians : f32,\n          cosRadians : f32,",this.shaderKey="rotate",this.outputShape=t,"number"===typeof n?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}return Te(e,[{key:"getUserCode",value:function(){return"\n        ".concat(QB("index")," {\n          if (index < uniforms.size) {\n            let coords = getCoordsFromIndex(index);\n            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *\n                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *\n                uniforms.sinRadians;\n            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *\n                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *\n                uniforms.cosRadians;\n            let coordX = i32(round(coordXFloat + uniforms.centerX));\n            let coordY = i32(round(coordYFloat + uniforms.centerY));\n            ").concat(this.fillSnippet,"\n            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&\n                coordY < uniforms.xShape[1]) {\n              outputValue = getX(coords[0], coordY, coordX, coords[3]);\n            }\n            setOutputAtIndex(index, outputValue);\n          }\n        }\n      ")}}]),e}(),LZ={kernelName:V_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new MZ(a.shape,o),l=NF(s,a.shape[1],a.shape[2]),h=(0,U.Z)(l,2),d=[{type:"float32",data:[h[0]]},{type:"float32",data:[h[1]]},{type:"float32",data:[Math.sin(i)]},{type:"float32",data:[Math.cos(i)]}];return"number"===typeof o?d.push({type:"float32",data:[Number.parseFloat(o.toFixed(2))]}):d.push({type:"float32",data:o}),u.runWebGPUProgram(c,[a],a.dtype,d)}},FZ=fW({opType:yV.ROUND}),zZ={kernelName:QT,backendName:"webgpu",kernelFunc:FZ},BZ=fW({opType:yV.RSQRT,cpuKernelImpl:zj}),VZ={kernelName:$T,backendName:"webgpu",kernelFunc:BZ},UZ=function(){function e(t,n,r,a,i,o,s){var u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];Se(this,e),this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.type=s,this.sumDupeIndices=u,this.dispatchLayout=hV(t),this.dispatch=uV(this.dispatchLayout,t,this.workgroupSize),this.sliceDimGreaterThanOne=n>1,this.shaderKey="scatter_".concat(r,"_").concat(a,"_").concat(this.sliceDimGreaterThanOne,"_").concat(s,"_").concat(u);var c=XB(i.length);this.uniforms="sliceDim : i32, strides: ".concat(c,", updatesSize: i32,"),this.updatesRank=a,this.indicesRank=r}return Te(e,[{key:"getUserCode",value:function(){var e="";1===this.indicesRank?e="coords[0]":2===this.indicesRank&&(e="coords[0], j");var t="getIndices(".concat(e,")"),n=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides",r="",a="";1===this.dispatchLayout.x.length?(r="flattenedIndex",a="\n      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {\n        return index;\n      }\n      "):2===this.dispatchLayout.x.length&&(r="vec2<i32>(flattenedIndex, coords[1])",a="\n      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {\n        // N.B. |updates| could be a scalar tensor, conceptually representing a\n        // 2D tensor with all values equal to that. By design, its size must be\n        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|\n        // gives the other.\n        let sliceSize = uniforms.outShape[1];\n        let d0 = index / sliceSize;\n        let d1 = index - d0 * sliceSize;\n        return vec2<i32>(d0, d1);\n      }\n      ");var i=Array.from({length:this.updatesRank},(function(e,t){return"coords[".concat(t,"]")})),o="getUpdates(".concat(i.join(", "),")");return"\n    ".concat(a,"\n      ").concat(QB("index")," {\n        if (index < uniforms.updatesSize) {\n          let coords = getUpdatesCoordsFromFlatIndex(index);\n          var flattenedIndex = 0;\n          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {\n            let indexInside = i32(round(").concat(t,"));\n            flattenedIndex = flattenedIndex + indexInside * ").concat(n,";\n          }\n          let updateValue =\n              ").concat(aV(this.type),"(").concat(o,");\n          let flatIndex = getOutputIndexFromCoords(").concat(r,");\n\n          ").concat(this.sumDupeIndices?KB("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));","\n        }\n      }")}}]),e}();var WZ={kernelName:JT,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=LM(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=[d/l,l];if(0===d)return n.makeTensorInfo(o,a.dtype);var p=nW({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),m=nW({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),v=m.dtype,g=eW({backend:n,attrs:{shape:f,value:0,dtype:v}}),y=[{type:"int32",data:[u]},{type:"int32",data:h},{type:"int32",data:[JS(m.shape)]}],b=new UZ(m.shape,u,p.shape.length,m.shape.length,h,f,v),x=n.runWebGPUProgram(b,[m,p],v,y,g),w=nW({inputs:{x:x},backend:n,attrs:{shape:o}});return n.disposeData(p.dataId),n.disposeData(m.dataId),n.disposeData(x.dataId),w}},jZ=function(){function e(t,n){Se(this,e),this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=n,this.shaderKey="search_sorted_".concat(n)}return Te(e,[{key:"getUserCode",value:function(){var e="left"===this.side?"<":"<=";return"\n      fn findBound(batch: i32, value: f32) -> i32 {\n        var left = i32(0);\n        var right = uniforms.numInputs;\n        while (left < right) {\n          var mid = (left + right) / 2;\n          if (getSortedSequence(batch, mid) ".concat(e," value) {\n            left = mid + 1;\n          } else {\n            right = mid;\n          }\n        }\n        return right;\n      }\n\n      ").concat(QB("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let value = getValuesByOutputIndex(index);\n          setOutputAtIndexI32(index, findBound(coords[0], value));\n        }\n      }\n    ")}}]),e}();var GZ={kernelName:t_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=new jZ([i.shape[0],i.shape[1]],o),u=[{type:"int32",data:[a.shape[1]]}];return n.runWebGPUProgram(s,[a,i],"int32",u)}},HZ=function(){function e(t,n,r){Se(this,e),this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=t,this.rank=r,this.shaderKey="select"}return Te(e,[{key:"getUserCode",value:function(){var e,t;if(this.rank>4)throw Error("Where for rank ".concat(this.rank," is not yet supported"));if(1===this.rank)t="resRC",e="resRC";else{for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=[],i=0;i<this.outputShape.length;i++)a.push("".concat(n[i])),i<this.cRank&&r.push("".concat(n[i]));e=r.join(),t=a.join()}return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          let cVal = getC(").concat(e,");\n          if (cVal >= 1.0) {\n            setOutputAtIndex(index, getA(").concat(t,"));\n          } else {\n            setOutputAtIndex(index, getB(").concat(t,"));\n          }\n        }\n      }\n    ")}}]),e}();var KZ={kernelName:n_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new HZ(r.shape.length,a.shape,a.shape.length);return n.runWebGPUProgram(o,[r,a,i],UE(a.dtype,i.dtype))}},qZ=fW({opType:yV.SELU}),ZZ={kernelName:r_,backendName:"webgpu",kernelFunc:qZ},XZ=fW({opType:yV.SIGMOID}),YZ={kernelName:u_,backendName:"webgpu",kernelFunc:XZ},QZ=fW({opType:yV.SIGN}),$Z={kernelName:s_,backendName:"webgpu",kernelFunc:QZ},JZ=fW({opType:yV.SIN}),eX={kernelName:i_,backendName:"webgpu",kernelFunc:JZ},tX=fW({opType:yV.SINH}),nX={kernelName:o_,backendName:"webgpu",kernelFunc:tX},rX=fW({opType:yV.SOFTPLUS}),aX={kernelName:c_,backendName:"webgpu",kernelFunc:rX},iX=function(){function e(t,n,r,a,i,o){var s=this;Se(this,e),this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;for(var u=new Array(a.length),c=0;c<u.length;c++)u[c]=a[i[c]];this.outputShape=u,this.newDim=i,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=t,this.paddedXShape=n,this.uniforms+="reshapedPaddedXShape : ".concat(XB(a.length),", paddedXShapeStrides : ").concat(XB(o),", "),r.map((function(e,t){s.uniforms+=" pad".concat(t," : vec2<i32>,")})),this.shaderKey="spaceToBatchND_".concat(i)}return Te(e,[{key:"getUserCode",value:function(){var e=XB(this.outputShape.length),t=oG(this.newDim);return"\n      ".concat(tV(this.paddedXShape,"PaddedX"),"\n      ").concat(QB("index")," {\n        if(index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let switchedIndex = getIndexFromCoords").concat(this.outputShape.length,"D(").concat(e,"(").concat(t,"), uniforms.reshapedPaddedXShape);\n          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);\n          ").concat(cZ(this.xShape,!0),"\n        }\n      }\n    ")}}]),e}(),oX={kernelName:d_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;YS(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,(0,ke.Z)(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=u.map((function(e,t){return e[0]+a.shape[t]+e[1]})),h=RF(l,i,s,!1),d=AF(h.length,i.length,!1),f=OF(l,i,s,!1),p=gC(l),m=new iX(a.shape,l,u,h,d,p.length),v=[{type:"int32",data:h},{type:"int32",data:p}];u.map((function(e){return v.push({type:"int32",data:[e[0],e[1]]})}));var g=n.runWebGPUProgram(m,[a],a.dtype,v),y=nW({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeData(g.dataId),y}},sX=function(){function e(t,n,r){Se(this,e),this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=t,this.type=r,this.dispatchLayout=hV([n]),this.dispatch=uV(this.dispatchLayout,[n],this.workgroupSize),this.shaderKey="sparseSegmentSum"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.sparseSize) {\n        let indexInSegmentIds = index / uniforms.segmentSize;\n        let indexInSegment = index % uniforms.segmentSize;\n        let indexInInput = indices[indexInSegmentIds];\n        let segmentId = segmentIds[indexInSegmentIds];\n\n        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];\n        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;\n        ").concat(KB("&result[outIndex]","value",this.type),"\n      }\n    }\n  ")}}]),e}(),uX=function(){function e(t,n){Se(this,e),this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[t],this.dispatchLayout=hV(n),this.dispatch=uV(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.segmentIdsShape) {\n        let segmentId = segmentIds[index];\n        ").concat(KB("&result[segmentId]","1","int32"),"\n      }\n    }\n  ")}}]),e}(),cX=function(){function e(t,n){Se(this,e),this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.type=n,this.dispatchLayout=hV(t),this.dispatch=uV(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="sparseSegmentMean"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.size) {\n        let segmentId = index / uniforms.segmentSize;\n        let count = sameSegmentIdCount[segmentId];\n        if (count != 0) {\n          ").concat("float32"===this.type?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);","\n        }\n      }\n    }\n  ")}}]),e}();function lX(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=JS(e.shape)/e.shape[0],s=e.dtype,u=JS(t.shape),c=i.readSync(n.dataId),l=u>0?c[u-1]+1:0,h=e.shape.slice();h[0]=l;var d=u*o,f=eW({backend:i,attrs:{shape:h,value:0,dtype:s}});r=new sX(h,d,s);var p=[{type:"int32",data:[o]},{type:"int32",data:[d]}],m=i.runWebGPUProgram(r,[e,t,n],s,p,f);if(a)return m;var v=eW({backend:i,attrs:{shape:[l],value:0,dtype:"int32"}});r=new uX(l,n.shape);var g=i.runWebGPUProgram(r,[n],"int32",null,v),y=eW({backend:i,attrs:{shape:h,value:0,dtype:s}});r=new cX(h,s),p=[{type:"int32",data:[o]}];var b=i.runWebGPUProgram(r,[m,g],s,p,y);return i.disposeData(m.dataId),i.disposeData(g.dataId),b}var hX={kernelName:g_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend;return lX(t.data,t.indices,t.segmentIds,!1,n)}};var dX={kernelName:y_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend;return lX(t.data,t.indices,t.segmentIds,!0,n)}},fX=function(){function e(t,n){Se(this,e),this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}return Te(e,[{key:"getUserCode",value:function(){var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>=5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"(resRC % ".concat(t,"aShape)");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e;a++)r.push("(".concat(n[a]," % ").concat(t,"aShape[").concat(a,"])"));return r.join()}(this.rank,"uniforms.");return"\n      ".concat(QB("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          setOutputAtIndex(index, getA(").concat(e,"));\n        }\n      }\n    ")}}]),e}();function pX(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if(n.shouldExecuteOnCPU([a])||"string"===a.dtype||a.shape.length>=5){var o=n.readSync(a.dataId),s="string"===a.dtype?o.map((function(e){return gE(e)})):o,u=IR(a.shape,a.dtype,s),c=Hj(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new fX(a.shape,i);return n.runWebGPUProgram(l,[a],a.dtype)}var mX={kernelName:R_,backendName:"webgpu",kernelFunc:pX};var vX={kernelName:b_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=LM(0,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,d=u.strides,f=u.outputSize,p=!1;if("string"===i.dtype){var m=n.bufferSync(a),v=n.bufferSync(i),g=gE(n.readSync(o.dataId)[0]),y=Bj(m,v,s,f,h,l,c,d,g,p);return n.makeTensorInfo(s,y.dtype,y.values)}var b=[f/h,h],x=nW({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),w=i.shape.length?nW({inputs:{x:i},backend:n,attrs:{shape:[l,h]}}):uW({inputs:{x:i},backend:n}),k=w.dtype,S=n.makeTensorInfo([],k,kC(1,k)),C=nW({inputs:{x:o},backend:n,attrs:{shape:Array(b.length).fill(1)}}),I=pX({inputs:{x:C},backend:n,attrs:{reps:b}}),T=[{type:"int32",data:[c]},{type:"int32",data:d},{type:"int32",data:[JS([l,h])]}];switch(l){case 0:break;case 1:var _=new UZ([l,h],c,x.shape.length,w.shape.length,d,b,k,p);n.runWebGPUProgram(_,[w,x],k,T,I);break;default:var E=new UZ([l,h],c,x.shape.length,S.shape.length,d,b,k,p);n.runWebGPUProgram(E,[S,x],k,T,I);var N=new UZ([l,h],c,x.shape.length,w.shape.length,d,b,k);n.runWebGPUProgram(N,[w,x],k,T,I)}var R=nW({inputs:{x:I},backend:n,attrs:{shape:s}});return n.disposeData(x.dataId),n.disposeData(w.dataId),n.disposeData(C.dataId),n.disposeData(S.dataId),n.disposeData(I.dataId),R}};var gX={kernelName:f_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=sC(r.axis,a.shape)[0],s=rz(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=(0,ke.Z)(l);t[o]=e;var r=jG({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},yX=fW({opType:yV.SQRT}),bX={kernelName:l_,backendName:"webgpu",kernelFunc:yX},xX={kernelName:w_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new dW(r.shape,yV.SQUARE);return a.runWebGPUProgram(i,[r],r.dtype)}},wX=pW({opType:mV.SQUARED_DIFFERENCE}),kX={kernelName:x_,backendName:"webgpu",kernelFunc:wX};var SX={kernelName:z_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=new dW(a.shape,yV.STEP,"stepAlpha : f32,"),o=[{type:"float32",data:[n.alpha]}];return r.runWebGPUProgram(i,[a],a.dtype,o)}},CX=function(){function e(t){Se(this,e),this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);var n=XB(this.outputShape.length);this.uniforms="begin : ".concat(n,",  strides : ").concat(n,", "),this.shaderKey="stridedSlice"}return Te(e,[{key:"getUserCode",value:function(){var e=this,t="";if(1===this.outputShape.length)t="coords * uniforms.strides + uniforms.begin";else{var n=0;t=this.outputShape.map((function(t,r){return n++,1===e.outputShape.length?"coords * uniforms.strides[".concat(r,"] + uniforms.begin[").concat(r,"]"):"coords[".concat(n-1,"] * uniforms.strides[").concat(r,"] + uniforms.begin[").concat(r,"]")})).join(",")}return"\n       ".concat(QB("index")," {\n         if (index < uniforms.size) {\n           let coords = getCoordsFromIndex(index);\n           setOutputAtIndex(index, getX(").concat(t,"));\n         }\n       }\n     ")}}]),e}();var IX={kernelName:S_,backendName:"webgpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,h=a.ellipsisMask,d=a.newAxisMask,f=a.shrinkAxisMask,p=YA(i.shape,o,s,u,c,l,h,d,f),m=p.finalShapeSparse,v=p.finalShape,g=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,w=p.end,k=p.strides;if(g)t=nW({inputs:{x:i},backend:r,attrs:{shape:v}});else if(y||b){YS(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var S=KA(x,w,k),C=jG({inputs:{x:i},backend:r,attrs:{begin:x,size:S}});t=nW({inputs:{x:C},backend:r,attrs:{shape:v}}),r.disposeData(C.dataId)}else{if(r.shouldExecuteOnCPU([i])){var I=r.readSync(i.dataId),T=IR(i.shape,i.dtype,I),_=Wj(m,T,k,x);t=r.makeTensorInfo(v,i.dtype,_.values)}else{var E=new CX(m),N=[{type:"int32",data:x},{type:"int32",data:k}],R=r.runWebGPUProgram(E,[i],i.dtype,N);t=nW({inputs:{x:R},backend:r,attrs:{shape:v}}),r.disposeData(R.dataId)}}return t}};var TX={kernelName:C_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,h=t.dataSplits,d=n.readSync(l.dataId),f=n.readSync(h.dataId),p=jj(d,f,a,i,o,s,u,c),m=(0,U.Z)(p,2),v=m[0],g=m[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(h.shape,"int32",g)]}},_X=pW({opType:mV.SUB,cpuKernelImpl:Gj,supportsComplex:!0}),EX={kernelName:__,backendName:"webgpu",kernelFunc:_X},NX=fW({opType:yV.TAN}),RX={kernelName:E_,backendName:"webgpu",kernelFunc:NX},AX=fW({opType:yV.TANH}),OX={kernelName:N_,backendName:"webgpu",kernelFunc:AX};function DX(e){if(null==e)throw new TypeError("Cannot destructure "+e)}var PX={kernelName:e_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.tensor,i=t.indices,o=t.updates;DX(r);var s=LM(0,i,a.shape),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=[d/l,l];if(0===d)return n.makeTensorInfo(a.shape,i.dtype);var p=[],m=nW({inputs:{x:i},backend:n,attrs:{shape:[c,u]}});p.push(m);var v=nW({inputs:{x:o},backend:n,attrs:{shape:[c,l]}});p.push(v);var g=nW({inputs:{x:a},backend:n,attrs:{shape:f}});p.push(g);var y=pX({inputs:{x:g},backend:n,attrs:{reps:Array(f.length).fill(1)}}),b=new UZ([c,l],u,m.shape.length,v.shape.length,h,f,a.dtype,!1),x=[{type:"int32",data:[u]},{type:"int32",data:h},{type:"int32",data:[JS([c,l])]}],w=n.runWebGPUProgram(b,[v,m],g.dtype,x,y);p.push(w);var k=nW({inputs:{x:w},backend:n,attrs:{shape:a.shape}});return p.forEach((function(e){return n.disposeData(e.dataId)})),k}},MX=function(){function e(t){Se(this,e),this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, negativeInf : f32,\n        dir : i32, inc : i32,",this.shaderKey="swap"}return Te(e,[{key:"getUserCode",value:function(){return"\n        ".concat(QB("index")," {\n          if (index < uniforms.size) {\n            let outC = getCoordsFromIndex(index);\n            let batch = outC[0];\n            let elemIdx = outC[1];\n            // We compare elements pair-wise within a group of size 2 * inc.\n            // The comparing rule for each group alternates between ascending\n            // and descending. Within each group, we compare each pair at\n            // positions i and i+inc. To decide whether an element at position i\n            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n            // inc, it is in the first half of the group, we denote it as x0,\n            // otherwise we denote it as x1.\n            // For example, as shown in the Bitonic top K paper referenced\n            // above, Figure5(a) shows that element[1] is in the second half of\n            // the group when group size is 2, but it is in the first half of\n            // the group when group size is 4.\n            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;\n            var i = 0;\n            if (isFirstInPair) {\n              i = elemIdx;\n            } else {\n              i = elemIdx - uniforms.inc;\n            }\n\n            var i0 = 0;\n            if (uniforms.firstPass == 1) {\n              i0 = i;\n            } else {\n              i0 = i32(getIndices(batch, i));\n            }\n\n            var i1 = 0;\n            if (uniforms.firstPass == 1) {\n              i1 = i + uniforms.inc;\n            } else {\n              i1 = i32(getIndices(batch, i + uniforms.inc));\n            }\n\n            var x0 = f32(0.0);\n            var x1 = f32(0.0);\n            if (i0 < uniforms.inputSize) {\n              x0 = getX(batch, i0);\n            } else {\n              x0 = uniforms.negativeInf;\n            }\n            if (i1 < uniforms.inputSize) {\n              x1 = getX(batch, i1);\n            } else {\n              x1 = uniforms.negativeInf;\n            }\n\n            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;\n            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n            if (reverse == isGreater) {\n              // Elements in opposite order of direction\n              let iTemp = i0;\n              i0 = i1;\n              i1 = iTemp;\n            }\n            if (isFirstInPair) {\n              setOutputAtIndex(index, f32(i0));\n            } else {\n              setOutputAtIndex(index, f32(i1));\n            }\n          }\n        }\n      ")}}]),e}(),LX=function(){function e(t){Se(this,e),this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}return Te(e,[{key:"getUserCode",value:function(){return"\n        ".concat(QB("index")," {\n          if (index < uniforms.size) {\n            let outC = getCoordsFromIndex(index);\n            let batch = outC[0];\n            let elemIdx = outC[1];\n            // The output size is half of the previous size.\n            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _\n            // (k=4), we only need to output the indices at positions |, the\n            // indices at positions _ can be thrown away, see Figure5(b) After\n            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced\n            // above.\n            // For example, the paper shows we only need to output the orange\n            // bars. The output sequence should look like this | | | | | | | |.\n            // Because the sequence is halved, to map the output index back to\n            // the previous sequence to find the corresponding value, we need\n            // to double the index. When we double the index, we basically\n            // interpolate a position, so 2i looks like\n            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k\n            // position of each 2k positions by - elemIdx % k. E.g. for output\n            // at index 4,5,6,7, we want to get the corresponding element at\n            // original index 8,9,10,11, for output at index 8,9,10,11,\n            // we want to get the corresponding element at original index\n            // 16,17,18,19, so on and so forth.\n\n            var i = 0;\n            if (elemIdx < uniforms.k) {\n              i = elemIdx;\n            } else {\n              i = elemIdx * 2 - elemIdx % uniforms.k;\n            }\n            var i0 = 0;\n            if (uniforms.firstPass == 1) {\n              i0 = i;\n            } else {\n              i0 = i32(getIndices(batch, i));\n            }\n            var i1 = 0;\n            if (uniforms.firstPass == 1) {\n              i1 = i + uniforms.k;\n            } else {\n              i1 = i32(getIndices(batch, i + uniforms.k));\n            }\n\n            let x0 = getX(batch, i0);\n            var x1 = f32(0.0);\n            if (i1 < uniforms.inputSize) {\n              x1 = getX(batch, i1);\n            } else {\n              x1 = x0;\n            }\n\n            if (x0 >= x1) {\n              setOutputAtIndex(index, f32(i0));\n            } else {\n              setOutputAtIndex(index, f32(i1));\n            }\n          }\n        }\n      ")}}]),e}();function FX(e,t){null!==t&&e.disposeData(t.dataId)}function zX(e){for(var t=1;t<e;)t*=2;return t}var BX={kernelName:A_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=a.shape,u=s[s.length-1];if(n.shouldExecuteOnCPU([a])){var c=n.readSync(a.dataId),l=Kj(c,s,a.dtype,i,o),h=(0,U.Z)(l,2),d=h[0],f=h[1];return[n.makeTensorInfo(d.shape,d.dtype,d.values),n.makeTensorInfo(f.shape,f.dtype,f.values)]}if(0===i)return s[s.length-1]=0,[n.makeTensorInfo(s,a.dtype,[]),n.makeTensorInfo(s,"int32",[])];if(1===u)return[a,eW({attrs:{shape:s,dtype:"int32",value:0},backend:n})];for(var p=JS(s)/u,m=nW({inputs:{x:a},attrs:{shape:[p,u]},backend:n}),v=zX(i),g=zX(u),y=null,b=function(){return null===y?[m,m]:[m,y]},x=function(e,t,r){var a=b(),i=new MX(r),o=[{type:"int32",data:[u]},{type:"int32",data:[null===y?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[e]},{type:"int32",data:[t]}],s=y;y=n.runWebGPUProgram(i,a,"int32",o),FX(n,s)},w=1;w<v;w*=2)for(var k=2*w,S=w;S>=1;S/=2)x(k,S,[p,g]);for(var C=g;C>v;C/=2){var I=b(),T=new LX([p,C/2]),_=[{type:"int32",data:[u]},{type:"int32",data:[null===y?1:0]},{type:"int32",data:[v]}],E=y;y=n.runWebGPUProgram(T,I,"int32",_),FX(n,E);for(var N=v/2,R=2*N,A=N;A>=1;A/=2)x(R,A,y.shape)}var O=y;y=jG({inputs:{x:y},backend:n,attrs:{begin:0,size:[p,i]}}),FX(n,O);var D=QK({inputs:{x:m,indices:y},backend:n,attrs:{axis:1,batchDims:1}});FX(n,m);var P=s.slice(0,-1);P.push(i),O=y,y=nW({inputs:{x:y},attrs:{shape:P},backend:n}),FX(n,O);var M=D;return D=nW({inputs:{x:D},attrs:{shape:P},backend:n}),FX(n,M),[D,y]}},VX=function(){function e(t){Se(this,e),this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}return Te(e,[{key:"getUserCode",value:function(){return"\n          fn mapCoord(outCoord : f32, len : f32) -> f32{\n            var inCoord = outCoord;\n            if(uniforms.fillModeId == 2) {\n              if (inCoord < 0.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz2 = 2.0 * len;\n                  if (inCoord < sz2) {\n                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +\n                    inCoord;\n                  }\n                  if (inCoord < -len) {\n                    inCoord = inCoord + sz2;\n                  } else {\n                    inCoord = -inCoord - 1.0;\n                  }\n                }\n              } else if (inCoord > len - 1.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz2 = 2.0 * len;\n                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));\n                  if (inCoord >= len) {\n                    inCoord = sz2 - inCoord - 1.0;\n                  }\n                }\n              }\n              return clamp(inCoord, 0.0, len - 1.0);\n            } else if (uniforms.fillModeId == 3) {\n              if (inCoord < 0.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz = len - 1.0;\n                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);\n                }\n              } else if (inCoord > len - 1.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz = len - 1.0;\n                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));\n                }\n              }\n              return clamp(inCoord, 0.0, len - 1.0);\n            } else if (uniforms.fillModeId == 4) {\n              return clamp(outCoord, 0.0, len - 1.0);\n            }\n            return outCoord;\n          }\n          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,\n            channel : i32) -> f32 {\n            var outputValue : f32;\n            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {\n                outputValue = getImage(batch, coordY, coordX, channel);\n            } else {\n              outputValue = uniforms.fillValue;\n            }\n            return outputValue;\n          }\n\n          ".concat(QB("index")," {\n            if (index < uniforms.size) {\n              let coords = getCoordsFromIndex(index);\n              var outputValue : f32;\n              let batch = coords[0];\n              let x = coords[2];\n              let y = coords[1];\n              let channel = coords[3];\n              let xf = f32(x);\n              let yf = f32(y);\n              let a1 = getTransforms(batch, 0);\n              let a2 = getTransforms(batch, 1);\n              let a3 = getTransforms(batch, 2);\n              let b1 = getTransforms(batch, 3);\n              let b2 = getTransforms(batch, 4);\n              let b3 = getTransforms(batch, 5);\n              let c1 = getTransforms(batch, 6);\n              let c2 = getTransforms(batch, 7);\n              let projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = uniforms.fillValue;\n              } else {\n                let inX = (a1 * xf + a2 * yf + a3) / projection;\n                let inY = (b1 * xf + b2 * yf + b3) / projection;\n                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));\n                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));\n\n                if (uniforms.interpolationModeId == 1) {\n                  let coordY = i32(round(mapY));\n                  let coordX = i32(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  let yFloor = floor(mapY);\n                  let xFloor = floor(mapX);\n                  let yCeil = yFloor + 1.0;\n                  let xCeil = xFloor + 1.0;\n                  let valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);\n                  let valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutputAtIndex(index, outputValue);\n            }\n          }\n        ")}}]),e}();var UX={kernelName:O_,backendName:"webgpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.image,o=n.transforms,s=a.interpolation,u=a.fillMode,c=a.fillValue,l=a.outputShape,h=(0,U.Z)(i.shape,4),d=h[0],f=h[1],p=h[2],m=h[3],v=null!=l?l:[f,p],g=(0,U.Z)(v,2),y=g[0],b=g[1],x=new VX([d,y,b,m]),w="nearest"===s?1:2;switch(u){case"constant":default:t=1;break;case"reflect":t=2;break;case"wrap":t=3;break;case"nearest":t=4}var k=[{type:"int32",data:[w]},{type:"int32",data:[t]},{type:"float32",data:[c]}];return r.runWebGPUProgram(x,[i,o],"float32",k)}};var WX={kernelName:M_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,h=0;h<s;h++)h!==i&&(c[l++]=o.shape[h]);var d=[],f=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var m=new Array(u),v=0;v<m.length;v++){f[i]=v;var g=jG({inputs:{x:o},backend:n,attrs:{begin:f,size:p}}),y=nW({inputs:{x:g},backend:n,attrs:{shape:c}});m[v]=y,d.push(g)}return d.forEach((function(e){return n.disposeData(e.dataId)})),m}},jX=function(){function e(t,n,r){if(Se(this,e),this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=n,this.dispatchLayout=hV(t),this.dispatch=uV(this.dispatchLayout,t,this.workgroupSize),"float32"!==r&&"int32"!==r)throw new Error("UnsortedSegmentSum only supports float32 and int32\n              types, does not support ".concat(r," type."));this.type=r,this.shaderKey="unsortedSegmentSum"}return Te(e,[{key:"getUserCode",value:function(){return"\n    ".concat(QB("index")," {\n      if (index < uniforms.xSize) {\n        let coords = getXCoordsFromIndex(index);\n        let b = coords[0];\n        let inCol = coords[1];\n\n        let segmentId = i32(getSegmentIds(inCol));\n        if (segmentId >= 0) {\n          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;\n          let value = getX(b, inCol);\n\n          ").concat(KB("&result[flatIndex]","value",this.type),"\n        }\n      }\n    }\n  ")}}]),e}();for(var GX={kernelName:L_,backendName:"webgpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=SD([c],s),h=a;null!=l&&(h=sG({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(h),c=ID(1,s)[0]);var d=uz(h.shape,c,o),f=JS([h.shape[c]]),p=nW({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});u.push(p);var m=a.dtype,v=[p.shape[0],o],g=eW({backend:n,attrs:{shape:v,value:0,dtype:m}}),y=new jX(p.shape,v,m),b=[{type:"int32",data:[o]},{type:"int32",data:[JS(p.shape)]}],x=n.runWebGPUProgram(y,[p,i],m,b,g),w=nW({inputs:{x:x},backend:n,attrs:{shape:d}});u.push(x);var k=w;if(null!=l){u.push(w);var S=CD(l);k=sG({inputs:{x:k},backend:n,attrs:{perm:S}})}return u.forEach((function(e){return n.disposeData(e.dataId)})),k}},HX=0,KX=[iW,Xj,Qj,Jj,tG,rG,hG,dG,pG,mG,gG,bG,wG,SG,IG,PG,MG,zG,BG,VG,HG,ZG,YG,tH,rH,oH,hW,cH,mH,wH,TH,EH,RH,AH,DH,MH,FH,BH,GH,HH,KH,ZH,tK,nK,$H,aK,oK,cK,lK,dK,gK,bK,xK,kK,CK,TK,EK,RK,PK,tW,LK,WK,zK,VK,HK,KK,qK,XK,$K,eq,nq,cW,rq,dH,iq,sq,cq,lq,dq,pq,vq,xq,yq,kq,Cq,Tq,Rq,Oq,RG,Pq,Mq,Vq,Lq,Bq,Uq,OG,Wq,Gq,Kq,Zq,Jq,pK,eZ,tZ,nZ,$G,aZ,sZ,uZ,hZ,fZ,pZ,mZ,vZ,eH,yZ,xZ,kZ,CZ,rW,TZ,EZ,RZ,OZ,PZ,LZ,zZ,VZ,WZ,GZ,KZ,ZZ,YZ,$Z,eX,nX,GG,SX,IX,TX,$q,aX,oX,hX,dX,vX,gX,bX,xX,kX,EX,vK,RX,OX,PX,mX,BX,UX,uG,WX,GX,oZ];HX<KX.length;HX++){Y_(KX[HX])}var qX=function(e,t){return(qX=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function ZX(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}qX(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var XX=function(){return(XX=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function YX(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function QX(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function $X(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var JX=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],eY=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],tY={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},nY={left:[1,3,5,7,9,11,13,15],right:[2,4,6,8,10,12,14,16],middle:[0]},rY=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]],aY=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]];function iY(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function oY(e){return YX(this,void 0,void 0,(function(){var t,n;return QX(this,(function(r){switch(r.label){case 0:return t=document.createElement("canvas"),e instanceof DE?[4,VA(e,t)]:[3,2];case 1:return r.sent(),[3,3];case 2:t.width=iY(e.width),t.height=iY(e.height),n=t.getContext("2d"),e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0),r.label=3;case 3:return[2,t]}}))}))}function sY(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i,o;return QX(this,(function(s){switch(s.label){case 0:return e instanceof DE?(t=e.shape.slice(0,2),n=t[0],r=t[1],a=ImageData.bind,[4,VA(e)]):[3,2];case 1:return[2,new(a.apply(ImageData,[void 0,s.sent(),r,n]))];case 2:return i=document.createElement("canvas"),o=i.getContext("2d"),i.width=iY(e.width),i.height=iY(e.height),o.drawImage(e,0,0),[2,o.getImageData(0,0,i.width,i.height)]}}))}))}function uY(e){return YX(this,void 0,void 0,(function(){var t;return QX(this,(function(n){switch(n.label){case 0:return e instanceof SVGImageElement||e instanceof OffscreenCanvas?[4,oY(e)]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=e,n.label=3;case 3:return[2,WA(t,4)]}}))}))}function cY(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(e));if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got ".concat(e))}var lY={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},hY=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,this.mask]}))}))},e.prototype.toImageData=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,sY(this.mask)]}))}))},e.prototype.toTensor=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,uY(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function dY(e){return cY(e),"person"}var fY=function(){function e(e){var t,n=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new jS.Pose({locateFile:function(t,n){if(e.solutionPath){var r=e.solutionPath.replace(/\/+$/,"");return"".concat(r,"/").concat(t)}return"".concat(n,"/").concat(t)}}),e.modelType){case"lite":t=0;break;case"heavy":t=2;break;default:t=1}this.poseSolution.setOptions({modelComplexity:t,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults((function(e){if(n.height=e.image.height,n.width=e.image.width,null==e.poseLandmarks)n.poses=[];else{var t=n.translateOutput(e.poseLandmarks,e.poseWorldLandmarks);e.segmentationMask&&(t.segmentation={maskValueToLabel:dY,mask:new hY(e.segmentationMask)}),n.poses=[t]}}))}return e.prototype.translateOutput=function(e,t){var n=this,r={keypoints:e.map((function(e,t){return{x:e.x*n.width,y:e.y*n.height,z:e.z,score:e.visibility,name:eY[t]}}))};return null!=t&&(r.keypoints3D=t.map((function(e,t){return{x:e.x,y:e.y,z:e.z,score:e.visibility,name:eY[t]}}))),r},e.prototype.estimatePoses=function(e,t,n){return YX(this,void 0,void 0,(function(){var r,a;return QX(this,(function(i){switch(i.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof DE?(a=ImageData.bind,[4,VA(e)]):[3,2];case 1:return r=new(a.apply(ImageData,[void 0,i.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,i.label=3;case 3:return e=r,[4,this.poseSolution.send({image:e},n)];case 4:return i.sent(),[2,this.poses]}}))}))},e.prototype.dispose=function(){this.poseSolution.close()},e.prototype.reset=function(){this.poseSolution.reset()},e.prototype.initialize=function(){return this.poseSolution.initialize()},e}();function pY(e){return YX(this,void 0,void 0,(function(){var t,n;return QX(this,(function(r){switch(r.label){case 0:return t=function(e){if(null==e)return XX({},lY);var t=XX({},e);return t.runtime="mediapipe",null==t.enableSegmentation&&(t.enableSegmentation=lY.enableSegmentation),null==t.enableSmoothing&&(t.enableSmoothing=lY.enableSmoothing),null==t.smoothSegmentation&&(t.smoothSegmentation=lY.smoothSegmentation),null==t.modelType&&(t.modelType=lY.modelType),t}(e),[4,(n=new fY(t)).initialize()];case 1:return r.sent(),[2,n]}}))}))}function mY(e){return e instanceof DE?{height:e.shape[0],width:e.shape[1]}:{height:e.height,width:e.width}}function vY(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function gY(e){return e instanceof DE?e:WA(e)}function yY(e,t,n){return bY(n,"inputResolution"),[1/n.width*e[0][0]*t.width,1/n.height*e[0][1]*t.width,e[0][3]*t.width,1/n.width*e[1][0]*t.height,1/n.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}function bY(e,t){YS(0!==e.width,(function(){return"".concat(t," width cannot be 0.")})),YS(0!==e.height,(function(){return"".concat(t," height cannot be 0.")}))}function xY(e,t,n){var r=n.rotationVectorStartKeypointIndex,a=n.rotationVectorEndKeypointIndex,i=e.locationData,o=i.relativeKeypoints[r].x*t.width,s=i.relativeKeypoints[r].y*t.height,u=i.relativeKeypoints[a].x*t.width,c=i.relativeKeypoints[a].y*t.height,l=2*Math.sqrt((u-o)*(u-o)+(c-s)*(c-s)),h=function(e,t,n){var r,a=e.locationData,i=n.rotationVectorStartKeypointIndex,o=n.rotationVectorEndKeypointIndex;r=n.rotationVectorTargetAngle?n.rotationVectorTargetAngle:Math.PI*n.rotationVectorTargetAngleDegree/180;var s=a.relativeKeypoints[i].x*t.width,u=a.relativeKeypoints[i].y*t.height,c=a.relativeKeypoints[o].x*t.width,l=a.relativeKeypoints[o].y*t.height;return vY(r-Math.atan2(-(l-u),c-s))}(e,t,n);return{xCenter:o/t.width,yCenter:s/t.height,width:l/t.width,height:l/t.height,rotation:h}}function wY(e){if(16!==e.length)throw new Error("Array length must be 16 but got ".concat(e.length));return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}function kY(e,t,n,r,a,i,o){return e[t][a]*(e[n][i]*e[r][o]-e[n][o]*e[r][i])}function SY(e,t,n){var r=(t+1)%4,a=(t+2)%4,i=(t+3)%4,o=(n+1)%4,s=(n+2)%4,u=(n+3)%4;return kY(e,r,a,i,o,s,u)+kY(e,a,i,r,o,s,u)+kY(e,i,r,a,o,s,u)}function CY(e,t,n){void 0===n&&(n={ignoreRotation:!1});for(var r=[],a=0,i=e;a<i.length;a++){var o=i[a],s=o.x-.5,u=o.y-.5,c=n.ignoreRotation?0:t.rotation,l=Math.cos(c)*s-Math.sin(c)*u,h=Math.sin(c)*s+Math.cos(c)*u;l=l*t.width+t.xCenter,h=h*t.height+t.yCenter;var d=o.z*t.width,f=XX({},o);f.x=l,f.y=h,f.z=d,r.push(f)}return r}function IY(e,t){var n=function(e,t,n,r){var a=(r-n)/255;return{scale:a,offset:n-0*a}}(0,0,t[0],t[1]);return RR((function(){return LR(BR(e,n.scale),n.offset)}))}function TY(e,t,n){var r,a,i,o,s,u,c,l,h,d,f,p,m=t.outputTensorSize,v=t.keepAspectRatio,g=t.borderMode,y=t.outputTensorFloatRange,b=mY(e),x=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}}(b,n),w=function(e,t,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=t.height,a=t.width;bY(t,"targetSize"),bY(e,"roi");var i,o,s=r/a,u=e.height/e.width,c=0,l=0;return s>u?(i=e.width,o=e.width*s,l=(1-u/s)/2):(i=e.height/s,o=e.height,c=(1-s/u)/2),e.width=i,e.height=o,{top:l,left:c,right:c,bottom:l}}(x,m,v),k=(r=x,a=b.width,i=b.height,!1,o=r.width,s=r.height,1,u=Math.cos(r.rotation),c=Math.sin(r.rotation),l=r.xCenter,h=r.yCenter,d=1/a,f=1/i,(p=new Array(16))[0]=o*u*1*d,p[1]=-s*c*d,p[2]=0,p[3]=(-.5*o*u*1+.5*s*c+l)*d,p[4]=o*c*1*f,p[5]=s*u*f,p[6]=0,p[7]=(-.5*s*u-.5*o*c*1+h)*f,p[8]=0,p[9]=0,p[10]=o*d,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,wY(p));return{imageTensor:RR((function(){var t=gY(e),n=AM(yY(k,b,m),[1,8]),r="zero"===g?"constant":"nearest",a=bF.transform(DD(TR(t,"float32")),n,"bilinear",r,0,[m.height,m.width]);return null!=y?IY(a,y):a})),padding:w,transformationMatrix:k}}function _Y(e,t,n,r){return 1===r?.5*(e+t):e+(t-e)*n/(r-1)}function EY(e){return null!=e&&null!=e.currentTime}function NY(e){for(var t={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,o=0;o<e.length;++o){var s=e[o];n=Math.min(n,s.x),r=Math.max(r,s.x),a=Math.min(a,s.y),i=Math.max(i,s.y),t.locationData.relativeKeypoints.push({x:s.x,y:s.y})}return t.locationData.relativeBoundingBox={xMin:n,yMin:a,xMax:r,yMax:i,width:r-n,height:i-a},t}function RY(e,t,n,r){return YX(this,void 0,void 0,(function(){var r,a,i,o,s;return QX(this,(function(u){switch(u.label){case 0:return e.sort((function(e,t){return Math.max.apply(Math,t.score)-Math.max.apply(Math,e.score)})),r=AM(e.map((function(e){return[e.locationData.relativeBoundingBox.yMin,e.locationData.relativeBoundingBox.xMin,e.locationData.relativeBoundingBox.yMax,e.locationData.relativeBoundingBox.xMax]}))),a=RM(e.map((function(e){return e.score[0]}))),[4,bF.nonMaxSuppressionAsync(r,a,t,n)];case 1:return[4,(i=u.sent()).array()];case 2:return o=u.sent(),s=e.filter((function(e,t){return o.indexOf(t)>-1})),AR([r,a,i]),[2,s]}}))}))}function AY(e,t){return e.map((function(e){var n=XX(XX({},e),{x:e.x*t.width,y:e.y*t.height});return null!=e.z&&(n.z=e.z*t.width),n}))}function OY(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,k,S,C,I,T;return QX(this,(function(_){switch(_.label){case 0:if(r=IM(t,[0]),a=r.shape,i=a[0],o=a[1],s=a[2],e.length!==s)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(e.length,", heatmap length: ").concat(s));return u=[],[4,r.buffer()];case 1:for(c=_.sent(),l=0;l<e.length;l++)if(h=e[l],d=XX({},h),u.push(d),f=Math.trunc(d.x*o),p=Math.trunc(d.y*i),!(f<0||f>=o||p<0||f>=i)){for(m=Math.trunc((n.kernelSize-1)/2),v=Math.max(0,f-m),g=Math.min(o,f+m+1),y=Math.max(0,p-m),b=Math.min(i,p+m+1),x=0,w=0,k=0,S=0,C=y;C<b;++C)for(I=v;I<g;++I)T=c.get(C,I,l),x+=T,S=Math.max(S,T),w+=I*T,k+=C*T;S>=n.minConfidenceToRefine&&x>0&&(d.x=w/o/x,d.y=k/i/x)}return r.dispose(),[2,u]}}))}))}function DY(e,t){var n=t.left,r=t.top,a=t.left+t.right,i=t.top+t.bottom;return e.map((function(e){return XX(XX({},e),{x:(e.x-n)/(1-a),y:(e.y-r)/(1-i),z:e.z/(1-a)})}))}function PY(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s;return QX(this,(function(u){switch(u.label){case 0:return r=e[0],a=e[1],i=function(e,t,n){return RR((function(){var r,a,i,o;n.reverseOutputOrder?(a=IM(AO(e,[0,n.boxCoordOffset+0],[-1,1])),r=IM(AO(e,[0,n.boxCoordOffset+1],[-1,1])),o=IM(AO(e,[0,n.boxCoordOffset+2],[-1,1])),i=IM(AO(e,[0,n.boxCoordOffset+3],[-1,1]))):(r=IM(AO(e,[0,n.boxCoordOffset+0],[-1,1])),a=IM(AO(e,[0,n.boxCoordOffset+1],[-1,1])),i=IM(AO(e,[0,n.boxCoordOffset+2],[-1,1])),o=IM(AO(e,[0,n.boxCoordOffset+3],[-1,1]))),a=LR(BR(zR(a,n.xScale),t.w),t.x),r=LR(BR(zR(r,n.yScale),t.h),t.y),n.applyExponentialOnBoxSize?(i=BR(OD(zR(i,n.hScale)),t.h),o=BR(OD(zR(o,n.wScale)),t.w)):(i=BR(zR(i,n.hScale),t.h),o=BR(zR(o,n.wScale),t.h));var s=tA(r,zR(i,2)),u=tA(a,zR(o,2)),c=LR(r,zR(i,2)),l=LR(a,zR(o,2)),h=EO([IO(s,[n.numBoxes,1]),IO(u,[n.numBoxes,1]),IO(c,[n.numBoxes,1]),IO(l,[n.numBoxes,1])],1);if(n.numKeypoints)for(var d=0;d<n.numKeypoints;++d){var f=n.keypointCoordOffset+d*n.numValuesPerKeypoint,p=void 0,m=void 0;n.reverseOutputOrder?(p=IM(AO(e,[0,f],[-1,1])),m=IM(AO(e,[0,f+1],[-1,1]))):(m=IM(AO(e,[0,f],[-1,1])),p=IM(AO(e,[0,f+1],[-1,1])));var v=LR(BR(zR(p,n.xScale),t.w),t.x),g=LR(BR(zR(m,n.yScale),t.h),t.y);h=EO([h,IO(v,[n.numBoxes,1]),IO(g,[n.numBoxes,1])],1)}return h}))}(a,t,n),o=RR((function(){var e=r;return n.sigmoidScore?(null!=n.scoreClippingThresh&&(e=GO(r,-n.scoreClippingThresh,n.scoreClippingThresh)),e=RO(e)):e})),[4,MY(i,o,n)];case 1:return s=u.sent(),AR([i,o]),[2,s]}}))}))}function MY(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d,f,p;return QX(this,(function(m){switch(m.label){case 0:return r=[],[4,e.data()];case 1:return a=m.sent(),[4,t.data()];case 2:for(i=m.sent(),o=0;o<n.numBoxes;++o)if(!(null!=n.minScoreThresh&&i[o]<n.minScoreThresh||(s=o*n.numCoords,u=LY(a[s+0],a[s+1],a[s+2],a[s+3],i[o],n.flipVertically,o),(c=u.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((l=u.locationData).relativeKeypoints=[],h=n.numKeypoints*n.numValuesPerKeypoint,d=0;d<h;d+=n.numValuesPerKeypoint)f=s+n.keypointCoordOffset+d,p={x:a[f+0],y:n.flipVertically?1-a[f+1]:a[f+1]},l.relativeKeypoints.push(p);r.push(u)}return[2,r]}}))}))}function LY(e,t,n,r,a,i,o){return{score:[a],ind:o,locationData:{relativeBoundingBox:{xMin:t,yMin:i?1-n:e,xMax:r,yMax:i?1-e:n,width:r-t,height:n-e}}}}function FY(e,t){return"none"===e?t:function(e){return 1/(1+Math.exp(-e))}(t)}function zY(e,t,n,r){return YX(this,void 0,void 0,(function(){var a,i,o,s,u,c,l,h;return QX(this,(function(d){switch(d.label){case 0:return n=n||t.flipHorizontally||!1,r=r||t.flipVertically||!1,a=e.size,i=a/t.numLandmarks,[4,e.data()];case 1:for(o=d.sent(),s=[],u=0;u<t.numLandmarks;++u)c=u*i,(h={x:0,y:0}).x=n?t.inputImageWidth-o[c]:o[c],i>1&&(h.y=r?t.inputImageHeight-o[c+1]:o[c+1]),i>2&&(h.z=o[c+2]),i>3&&(h.score=FY(t.visibilityActivation,o[c+3])),s.push(h);for(l=0;l<s.length;++l)(h=s[l]).x=h.x/t.inputImageWidth,h.y=h.y/t.inputImageHeight,h.z=h.z/t.inputImageWidth/(t.normalizeZ||1);return[2,s]}}))}))}function BY(e,t,n){var r=e.width,a=e.height,i=e.rotation;if(null==n.rotation&&null==n.rotationDegree||(i=function(e,t){return null!=t.rotation?e+=t.rotation:null!=t.rotationDegree&&(e+=Math.PI*t.rotationDegree/180),vY(e)}(i,n)),0===i)e.xCenter=e.xCenter+r*n.shiftX,e.yCenter=e.yCenter+a*n.shiftY;else{var o=(t.width*r*n.shiftX*Math.cos(i)-t.height*a*n.shiftY*Math.sin(i))/t.width,s=(t.width*r*n.shiftX*Math.sin(i)+t.height*a*n.shiftY*Math.cos(i))/t.height;e.xCenter=e.xCenter+o,e.yCenter=e.yCenter+s}if(n.squareLong){var u=Math.max(r*t.width,a*t.height);r=u/t.width,a=u/t.height}else if(n.squareShort){var c=Math.min(r*t.width,a*t.height);r=c/t.width,a=c/t.height}return e.width=r*n.scaleX,e.height=a*n.scaleY,e}function VY(e,t){return e.map((function(e){var n=XX(XX({},e),{x:e.x/t.width,y:e.y/t.height});return null!=e.z&&(e.z=e.z/t.width),n}))}var UY=function(){function e(e){this.alpha=e,this.initialized=!1}return e.prototype.apply=function(e,t){var n;return this.initialized?n=null==t?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*t*Math.asinh((e-this.storedValue)/t):(n=e,this.initialized=!0),this.rawValue=e,this.storedValue=n,n},e.prototype.applyWithAlpha=function(e,t,n){return this.alpha=t,this.apply(e,n)},e.prototype.hasLastRawValue=function(){return this.initialized},e.prototype.lastRawValue=function(){return this.rawValue},e.prototype.reset=function(){this.initialized=!1},e}(),WY=function(){function e(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new UY(this.getAlpha(this.minCutOff)),this.dx=new UY(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return e.prototype.apply=function(e,t,n){if(null==e)return e;var r=Math.trunc(t);if(this.lastTimestamp>=r)return e;0!==this.lastTimestamp&&0!==r&&(this.frequency=1/(1e-6*(r-this.lastTimestamp))),this.lastTimestamp=r;var a=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*n*this.frequency:0,i=this.dx.applyWithAlpha(a,this.getAlpha(this.derivateCutOff)),o=this.minCutOff+this.beta*Math.abs(i),s=null!=this.thresholdCutOff?this.thresholdCutOff+this.thresholdBeta*Math.abs(i):null;return this.x.applyWithAlpha(e,this.getAlpha(o),s)},e.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},e}(),jY=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var r=this;if(null==e)return this.reset(),null;this.initializeFiltersIfEmpty(e);var a=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return $X([],e,!0);a=1/n}return e.map((function(e,n){var i=XX(XX({},e),{x:r.xFilters[n].apply(e.x,t,a),y:r.yFilters[n].apply(e.y,t,a)});return null!=e.z&&(i.z=r.zFilters[n].apply(e.z,t,a)),i}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new WY(t.config)})),this.yFilters=e.map((function(e){return new WY(t.config)})),this.zFilters=e.map((function(e){return new WY(t.config)})))},e}(),GY=function(){function e(e){this.config=e,this.window=[],this.lowPassFilter=new UY(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return e.prototype.apply=function(e,t,n){if(null==e)return e;var r,a=Math.trunc(t);if(this.lastTimestamp>=a)return e;if(-1===this.lastTimestamp)r=1;else{for(var i=e*n-this.lastValue*this.lastValueScale,o=a-this.lastTimestamp,s=i,u=o,c=(1+this.window.length)*(1e6/30),l=0,h=this.window;l<h.length;l++){var d=h[l];if(u+d.duration>c)break;s+=d.distance,u+=d.duration}var f=s/(1e-6*u);r=1-1/(1+this.config.velocityScale*Math.abs(f)),this.window.unshift({distance:i,duration:o}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=n,this.lastTimestamp=a,this.lowPassFilter.applyWithAlpha(e,r)},e}(),HY=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var r=this;if(null==e)return this.reset(),null;var a=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return $X([],e,!0);a=1/n}return this.initializeFiltersIfEmpty(e),e.map((function(e,n){var i=XX(XX({},e),{x:r.xFilters[n].apply(e.x,t,a),y:r.yFilters[n].apply(e.y,t,a)});return null!=e.z&&(i.z=r.zFilters[n].apply(e.z,t,a)),i}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new GY(t.config)})),this.yFilters=e.map((function(e){return new GY(t.config)})),this.zFilters=e.map((function(e){return new GY(t.config)})))},e}(),KY=function(){function e(e){if(null!=e.velocityFilter)this.keypointsFilter=new HY(e.velocityFilter);else{if(null==e.oneEuroFilter)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new jY(e.oneEuroFilter)}}return e.prototype.apply=function(e,t,n,r,a){if(void 0===r&&(r=!1),null==e)return this.keypointsFilter.reset(),null;var i=null!=a?function(e,t){return(e.width*t.width+e.height*t.height)/2}(a,n):1,o=r?AY(e,n):e,s=this.keypointsFilter.apply(o,t,i);return r?VY(s,n):s},e}(),qY=function(){function e(e){this.alpha=e.alpha}return e.prototype.apply=function(e){var t=this;if(null==e)return this.visibilityFilters=null,null;null!=this.visibilityFilters&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map((function(e){return new UY(t.alpha)})));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=XX({},a);i.score=this.visibilityFilters[r].apply(a.score),n.push(i)}return n},e}(),ZY={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},XY={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},YY={maxPoses:1,flipHorizontal:!1},QY={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},$Y={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},JY={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},eQ={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},tQ={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},nQ={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},rQ={kernelSize:7,minConfidenceToRefine:.5},aQ={alpha:.1},iQ={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},oQ={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},sQ={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},uQ={activation:"none"},cQ={combineWithPreviousRatio:.7},lQ=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,oY(this.mask)]}))}))},e.prototype.toImageData=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,sY(this.mask)]}))}))},e.prototype.toTensor=function(){return YX(this,void 0,void 0,(function(){return QX(this,(function(e){return[2,this.mask]}))}))},e.prototype.getUnderlyingType=function(){return"tensor"},e}();function hQ(e){return cY(e),"person"}var dQ=function(){function e(e,t,n,r,a,i){this.detectorModel=e,this.landmarkModel=t,this.enableSmoothing=n,this.enableSegmentation=r,this.smoothSegmentation=a,this.modelType=i,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(e){null==e.reduceBoxesInLowestLayer&&(e.reduceBoxesInLowestLayer=!1),null==e.interpolatedScaleAspectRatio&&(e.interpolatedScaleAspectRatio=1),null==e.fixedAnchorSize&&(e.fixedAnchorSize=!1);for(var t=[],n=0;n<e.numLayers;){for(var r=[],a=[],i=[],o=[],s=n;s<e.strides.length&&e.strides[s]===e.strides[n];){var u=_Y(e.minScale,e.maxScale,s,e.strides.length);if(0===s&&e.reduceBoxesInLowestLayer)i.push(1),i.push(2),i.push(.5),o.push(.1),o.push(u),o.push(u);else{for(var c=0;c<e.aspectRatios.length;++c)i.push(e.aspectRatios[c]),o.push(u);if(e.interpolatedScaleAspectRatio>0){var l=s===e.strides.length-1?1:_Y(e.minScale,e.maxScale,s+1,e.strides.length);o.push(Math.sqrt(u*l)),i.push(e.interpolatedScaleAspectRatio)}}s++}for(var h=0;h<i.length;++h){var d=Math.sqrt(i[h]);r.push(o[h]/d),a.push(o[h]*d)}var f=0,p=0;if(e.featureMapHeight.length>0)f=e.featureMapHeight[n],p=e.featureMapWidth[n];else{var m=e.strides[n];f=Math.ceil(e.inputSizeHeight/m),p=Math.ceil(e.inputSizeWidth/m)}for(var v=0;v<f;++v)for(var g=0;g<p;++g)for(var y=0;y<r.length;++y){var b={xCenter:(g+e.anchorOffsetX)/p,yCenter:(v+e.anchorOffsetY)/f,width:0,height:0};e.fixedAnchorSize?(b.width=1,b.height=1):(b.width=a[y],b.height=r[y]),t.push(b)}n=s}return t}(ZY);var o=RM(this.anchors.map((function(e){return e.width}))),s=RM(this.anchors.map((function(e){return e.height}))),u=RM(this.anchors.map((function(e){return e.xCenter}))),c=RM(this.anchors.map((function(e){return e.yCenter})));this.anchorTensor={x:u,y:c,w:o,h:s},this.prevFilteredSegmentationMask=this.enableSegmentation?AM([],[0,0]):null}return e.prototype.estimatePoses=function(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,k,S,C,I;return QX(this,(function(T){switch(T.label){case 0:return r=function(e){var t;if(null==(t=null==e?YY:XX({},e)).maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(t.maxPoses,". Should be > 0."));if(t.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return t}(t),null==e?(this.reset(),[2,[]]):(this.maxPoses=r.maxPoses,this.timestamp=null!=n?1e3*n:EY(e)?1e6*e.currentTime:null,a=mY(e),i=RR((function(){return TR(gY(e),"float32")})),null!=(o=this.regionOfInterest)?[3,2]:[4,this.detectPose(i)]);case 1:if(0===(s=T.sent()).length)return this.reset(),i.dispose(),[2,[]];u=s[0],o=this.poseDetectionToRoi(u,a),T.label=2;case 2:return[4,this.poseLandmarksByRoi(o,i)];case 3:return c=T.sent(),i.dispose(),null==c?(this.reset(),[2,[]]):(l=c.landmarks,h=c.auxiliaryLandmarks,d=c.poseScore,f=c.worldLandmarks,p=c.segmentationMask,m=this.poseLandmarkFiltering(l,h,f,a),v=m.actualLandmarksFiltered,g=m.auxiliaryLandmarksFiltered,y=m.actualWorldLandmarksFiltered,b=this.poseLandmarksToRoi(g,a),this.regionOfInterest=b,x=this.smoothSegmentation&&null!=p?this.poseSegmentationFiltering(p):p,null!=(w=null!=v?AY(v,a):null)&&w.forEach((function(e,t){e.name=eY[t]})),null!=(k=y)&&k.forEach((function(e,t){e.name=eY[t]})),S={score:d,keypoints:w,keypoints3D:k},null!==x&&(C=RR((function(){var e=DD(x,2),t=_P(e,[[0,0],[0,0],[0,1]]);return yP(t,[[0,0],[0,0],[0,2]],"symmetric")})),this.smoothSegmentation||AR(x),I={maskValueToLabel:hQ,mask:new lQ(C)},S.segmentation=I),[2,[S]])}}))}))},e.prototype.poseSegmentationFiltering=function(e){var t=this.prevFilteredSegmentationMask;return 0===t.size?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=function(e,t,n){return"webgl"===DR()?function(e,t,n){var r=n.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:e.shape,userCode:"\n  void main() {\n      ivec2 coords = getOutputCoords();\n      int height = coords[0];\n      int width = coords[1];\n\n      float prevMaskValue = getPrevMask(height, width);\n      float newMaskValue = getNewMask(height, width);\n\n      /*\n      * Assume p := newMaskValue\n      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)\n      * uncertainty alpha(p) =\n      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the\n      * uncertainty]\n      *\n      * The following polynomial approximates uncertainty alpha as a\n      * function of (p + 0.5):\n      */\n      const float c1 = 5.68842;\n      const float c2 = -0.748699;\n      const float c3 = -57.8051;\n      const float c4 = 291.309;\n      const float c5 = -624.717;\n      float t = newMaskValue - 0.5;\n      float x = t * t;\n\n      float uncertainty =\n        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));\n\n      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *\n                             (uncertainty * ".concat(r,");\n\n      setOutput(outputValue);\n    }\n")},i=MR();return RR((function(){var n=i.compileAndRun(a,[e,t]);return NR().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}))}(e,t,n):RR((function(){var r=tA(t,.5),a=UR(r),i=tA(1,gP(1,BR(a,LR(5.68842,BR(a,LR(-.748699,BR(a,LR(-57.8051,BR(a,LR(291.309,BR(a,-624.717)))))))))));return LR(t,BR(tA(e,t),BR(i,n.combineWithPreviousRatio)))}))}(t,e,cQ),AR(e)),AR(t),this.prevFilteredSegmentationMask},e.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),AR([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},e.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(AR(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=AM([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},e.prototype.detectPose=function(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l;return QX(this,(function(h){switch(h.label){case 0:return t=TY(e,JY),n=t.imageTensor,r=t.padding,a=this.detectorModel.predict(n),i=function(e){return RR((function(){var t=function(e){return RR((function(){return[AO(e,[0,0,0],[1,-1,1]),AO(e,[0,0,1],[1,-1,-1])]}))}(e),n=t[0],r=t[1];return{boxes:IM(r),logits:IM(n)}}))}(a),o=i.boxes,[4,PY([s=i.logits,o],this.anchorTensor,QY)];case 1:return 0===(u=h.sent()).length?(AR([n,a,s,o]),[2,u]):[4,RY(u,this.maxPoses,.3)];case 2:return c=h.sent(),l=function(e,t){void 0===e&&(e=[]);for(var n=t.left,r=t.top,a=t.left+t.right,i=t.top+t.bottom,o=0;o<e.length;o++){var s=e[o],u=s.locationData.relativeBoundingBox,c=(u.xMin-n)/(1-a),l=(u.yMin-r)/(1-i),h=u.width/(1-a),d=u.height/(1-i);u.xMin=c,u.yMin=l,u.width=h,u.height=d,u.xMax=c+h,u.yMax=l+d;var f=s.locationData.relativeKeypoints;f&&f.forEach((function(e){var t=(e.x-n)/(1-a),o=(e.y-r)/(1-i);e.x=t,e.y=o}))}return e}(c,r),AR([n,a,s,o]),[2,l]}}))}))},e.prototype.poseDetectionToRoi=function(e,t){return BY(xY(e,t,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),t,$Y)},e.prototype.poseLandmarksByRoi=function(e,t){return YX(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,h,d,f,p,m;return QX(this,(function(v){switch(v.label){case 0:if(n=mY(t),r=TY(t,eQ,e),a=r.imageTensor,i=r.padding,o=r.transformationMatrix,"lite"!==this.modelType&&"full"!==this.modelType&&"heavy"!==this.modelType)throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return s=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&s.push("activation_segmentation"),u=this.landmarkModel.execute(a,s),[4,this.tensorsToPoseLandmarksAndSegmentation(u)];case 1:return null==(c=v.sent())?(AR(u),AR(a),[2,null]):(l=c.landmarks,h=c.auxiliaryLandmarks,d=c.poseScore,f=c.worldLandmarks,p=c.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(n,e,i,o,l,h,f,p)]);case 2:return m=v.sent(),AR(u),AR(a),[2,XX({poseScore:d},m)]}}))}))},e.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,t,n,r,a,i,o,s){return YX(this,void 0,void 0,(function(){var u,c,l,h,d,f;return QX(this,(function(p){return u=DY(a,n),c=DY(i,n),l=CY(u,t),h=CY(c,t),d=function(e,t){for(var n=[],r=0,a=e;r<a.length;r++){var i=a[r],o=i.x,s=i.y,u=t.rotation,c=Math.cos(u)*o-Math.sin(u)*s,l=Math.sin(u)*o+Math.cos(u)*s,h=XX({},i);h.x=c,h.y=l,n.push(h)}return n}(o,t),f=null,this.enableSegmentation&&(f=RR((function(){var t=s.shape,n=t[0],a=t[1],i=function(e){var t=wY(new Array(16).fill(0));t[0][0]=SY(e,0,0),t[1][0]=-SY(e,0,1),t[2][0]=SY(e,0,2),t[3][0]=-SY(e,0,3),t[0][2]=SY(e,2,0),t[1][2]=-SY(e,2,1),t[2][2]=SY(e,2,2),t[3][2]=-SY(e,2,3),t[0][1]=-SY(e,1,0),t[1][1]=SY(e,1,1),t[2][1]=-SY(e,1,2),t[3][1]=SY(e,1,3),t[0][3]=-SY(e,3,0),t[1][3]=SY(e,3,1),t[2][3]=-SY(e,3,2),t[3][3]=SY(e,3,3);for(var n=e[0][0]*t[0][0]+e[1][0]*t[0][1]+e[2][0]*t[0][2]+e[3][0]*t[0][3],r=0;r<t.length;r++)for(var a=0;a<t.length;a++)t[r][a]/=n;return t}(r),o=AM(yY(i,{width:a,height:n},e),[1,8]),u=[1,n,a,1];return IM(bF.transform(IO(s,u),o,"bilinear","constant",0,[e.height,e.width]),[0,3])})),AR(s)),[2,{landmarks:l,auxiliaryLandmarks:h,worldLandmarks:d,segmentationMask:f}]}))}))},e.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l,h,d,f;return QX(this,(function(p){switch(p.label){case 0:return t=e[0],n=e[1],r=e[2],a=e[3],i=this.enableSegmentation?e[4]:null,[4,n.data()];case 1:return(o=p.sent()[0])<.5?[2,null]:[4,zY(t,tQ)];case 2:return[4,OY(p.sent(),r,rQ)];case 3:return s=p.sent(),u=s.slice(0,33),c=s.slice(33,35),[4,zY(a,nQ)];case 4:return l=p.sent(),h=l.slice(0,33),d=function(e,t,n){void 0===n&&(n=!0);for(var r=[],a=0;a<e.length;a++){var i=XX({},t[a]);n&&(i.score=e[a].score),r.push(i)}return r}(u,h,!0),f=this.enableSegmentation?function(e,t,n){return RR((function(){var n=IM(e,[0]),r=n.shape[2];if(1===r){var a=n;switch(t.activation){case"none":break;case"sigmoid":a=RO(a);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(t.activation,")"))}return IM(a,[2])}throw new Error("Unsupported number of tensor channels ".concat(r))}))}(i,uQ):null,[2,{landmarks:u,auxiliaryLandmarks:c,poseScore:o,worldLandmarks:d,segmentationMask:f}]}}))}))},e.prototype.poseLandmarksToRoi=function(e,t){return BY(xY(NY(e),t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),t,$Y)},e.prototype.poseLandmarkFiltering=function(e,t,n,r){var a,i,o;if(null!=this.timestamp&&this.enableSmoothing){var s=xY(NY(t),r,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});null==this.visibilitySmoothingFilterActual&&(this.visibilitySmoothingFilterActual=new qY(aQ)),a=this.visibilitySmoothingFilterActual.apply(e),null==this.visibilitySmoothingFilterAuxiliary&&(this.visibilitySmoothingFilterAuxiliary=new qY(aQ)),i=this.visibilitySmoothingFilterAuxiliary.apply(t),o=this.visibilitySmoothingFilterActual.apply(n),null==this.landmarksSmoothingFilterActual&&(this.landmarksSmoothingFilterActual=new KY(iQ)),a=this.landmarksSmoothingFilterActual.apply(a,this.timestamp,r,!0,s),null==this.landmarksSmoothingFilterAuxiliary&&(this.landmarksSmoothingFilterAuxiliary=new KY(oQ)),i=this.landmarksSmoothingFilterAuxiliary.apply(i,this.timestamp,r,!0,s),null==this.worldLandmarksSmoothingFilterActual&&(this.worldLandmarksSmoothingFilterActual=new KY(sQ)),o=this.worldLandmarksSmoothingFilterActual.apply(n,this.timestamp)}else a=e,i=t,o=n;return{actualLandmarksFiltered:a,auxiliaryLandmarksFiltered:i,actualWorldLandmarksFiltered:o}},e}();function fQ(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i,o;return QX(this,(function(s){switch(s.label){case 0:return t=function(e){var t=XX({},null==e?XY:e);if(null==t.enableSmoothing&&(t.enableSmoothing=XY.enableSmoothing),null==t.enableSegmentation&&(t.enableSegmentation=XY.enableSegmentation),null==t.smoothSegmentation&&(t.smoothSegmentation=XY.smoothSegmentation),null==t.modelType&&(t.modelType=XY.modelType),null==t.detectorModelUrl&&(t.detectorModelUrl=XY.detectorModelUrl),null==t.landmarkModelUrl)switch(t.modelType){case"lite":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;default:t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return t}(e),n="string"==typeof t.detectorModelUrl&&t.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r="string"==typeof t.landmarkModelUrl&&t.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([PB(t.detectorModelUrl,{fromTFHub:n}),PB(t.landmarkModelUrl,{fromTFHub:r})])];case 1:return a=s.sent(),i=a[0],o=a[1],[2,new dQ(i,o,t.enableSmoothing,t.enableSegmentation,t.smoothSegmentation,t.modelType)]}}))}))}var pQ,mQ,vQ,gQ=function(){function e(e){!function(e){if(e.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(e.maxTracks));if(e.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(e.maxAge));if(void 0!==e.keypointTrackerParams){if(e.keypointTrackerParams.keypointConfidenceThreshold<0||e.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(e.keypointTrackerParams.keypointConfidenceThreshold));if(e.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(e.keypointTrackerParams.minNumberOfKeypoints));for(var t=0,n=e.keypointTrackerParams.keypointFalloff;t<n.length;t++){var r=n[t];if(r<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(r))}}}(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return e.prototype.apply=function(e,t){this.filterOldTracks(t);var n=this.computeSimilarity(e);return this.assignTracks(e,n,t),this.updateTracks(t),e},e.prototype.getTracks=function(){return this.tracks.slice()},e.prototype.getTrackIDs=function(){return new Set(this.tracks.map((function(e){return e.id})))},e.prototype.filterOldTracks=function(e){var t=this;this.tracks=this.tracks.filter((function(n){return e-n.lastTimestamp<=t.maxAge}))},e.prototype.assignTracks=function(e,t,n){for(var r=Array.from(Array(t[0].length).keys()),a=[],i=0,o=Array.from(Array(e.length).keys());i<o.length;i++){var s=o[i];if(0!==r.length){for(var u=-1,c=-1,l=0,h=r;l<h.length;l++){var d=h[l],f=t[s][d];f>=this.minSimilarity&&f>c&&(u=d,c=f)}if(u>=0){var p=this.tracks[u];p=Object.assign(p,this.createTrack(e[s],n,p.id)),e[s].id=p.id;var m=r.indexOf(u);r.splice(m,1)}else a.push(s)}else a.push(s)}for(var v=0,g=a;v<g.length;v++){s=g[v];var y=this.createTrack(e[s],n);this.tracks.push(y),e[s].id=y.id}},e.prototype.updateTracks=function(e){this.tracks.sort((function(e,t){return t.lastTimestamp-e.lastTimestamp})),this.tracks=this.tracks.slice(0,this.maxTracks)},e.prototype.createTrack=function(e,t,n){var r={id:n||this.nextTrackID(),lastTimestamp:t,keypoints:$X([],e.keypoints,!0).map((function(e){return XX({},e)}))};return void 0!==e.box&&(r.box=XX({},e.box)),r},e.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracks=this.tracks.filter((function(t){return!e.includes(t.id)}))},e.prototype.reset=function(){this.tracks=[]},e}(),yQ=function(e){function t(t){return e.call(this,t)||this}return ZX(t,e),t.prototype.computeSimilarity=function(e){var t=this;return 0===e.length||0===this.tracks.length?[[]]:e.map((function(e){return t.tracks.map((function(n){return t.iou(e,n)}))}))},t.prototype.iou=function(e,t){var n=Math.max(e.box.xMin,t.box.xMin),r=Math.max(e.box.yMin,t.box.yMin),a=Math.min(e.box.xMax,t.box.xMax),i=Math.min(e.box.yMax,t.box.yMax);if(n>=a||r>=i)return 0;var o=(a-n)*(i-r);return o/(e.box.width*e.box.height+t.box.width*t.box.height-o)},t}(gQ),bQ=function(e){function t(t){var n=e.call(this,t)||this;return n.keypointThreshold=t.keypointTrackerParams.keypointConfidenceThreshold,n.keypointFalloff=t.keypointTrackerParams.keypointFalloff,n.minNumKeyoints=t.keypointTrackerParams.minNumberOfKeypoints,n}return ZX(t,e),t.prototype.computeSimilarity=function(e){if(0===e.length||0===this.tracks.length)return[[]];for(var t=[],n=0,r=e;n<r.length;n++){for(var a=r[n],i=[],o=0,s=this.tracks;o<s.length;o++){var u=s[o];i.push(this.oks(a,u))}t.push(i)}return t},t.prototype.oks=function(e,t){for(var n=this.area(t.keypoints)+1e-6,r=0,a=0,i=0;i<e.keypoints.length;++i){var o=e.keypoints[i],s=t.keypoints[i];if(!(o.score<this.keypointThreshold||s.score<this.keypointThreshold)){a+=1;var u=Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2),c=2*this.keypointFalloff[i];r+=Math.exp(-1*u/(2*n*Math.pow(c,2)))}}return a<this.minNumKeyoints?0:r/a},t.prototype.area=function(e){var t=this,n=e.filter((function(e){return e.score>t.keypointThreshold})),r=Math.min.apply(Math,$X([1],n.map((function(e){return e.x})),!1)),a=Math.max.apply(Math,$X([0],n.map((function(e){return e.x})),!1)),i=Math.min.apply(Math,$X([1],n.map((function(e){return e.y})),!1));return(a-r)*(Math.max.apply(Math,$X([0],n.map((function(e){return e.y})),!1))-i)},t}(gQ);function xQ(e){switch(e){case mQ.BlazePose:return eY.reduce((function(e,t,n){return e[t]=n,e}),{});case mQ.PoseNet:case mQ.MoveNet:return JX.reduce((function(e,t,n){return e[t]=n,e}),{});default:throw new Error("Model ".concat(e," is not supported."))}}(vQ=pQ||(pQ={})).Keypoint="keypoint",vQ.BoundingBox="boundingBox",function(e){e.MoveNet="MoveNet",e.BlazePose="BlazePose",e.PoseNet="PoseNet"}(mQ||(mQ={}));var wQ=Object.freeze({__proto__:null,getKeypointIndexBySide:function(e){switch(e){case mQ.BlazePose:return tY;case mQ.PoseNet:case mQ.MoveNet:return nY;default:throw new Error("Model ".concat(e," is not supported."))}},getAdjacentPairs:function(e){switch(e){case mQ.BlazePose:return aY;case mQ.PoseNet:case mQ.MoveNet:return rY;default:throw new Error("Model ".concat(e," is not supported."))}},getKeypointIndexByName:xQ}),kQ=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],SQ={modelType:"SinglePose.Lightning",enableSmoothing:!0},CQ={},IQ={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},TQ={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},_Q={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function EQ(e,t){var n,r,a,i;return e?t.width>t.height?(n=1,r=t.height/t.width,a=0,i=(t.width/2-t.height/2)/t.width):(n=t.width/t.height,r=1,a=(t.height/2-t.width/2)/t.height,i=0):t.width>t.height?(n=t.width/t.height,r=1,a=(t.height/2-t.width/2)/t.height,i=0):(n=1,r=t.height/t.width,a=0,i=(t.width/2-t.height/2)/t.width),{yMin:a,xMin:i,yMax:a+n,xMax:i+r,height:n,width:r}}function NQ(e,t){var n={maxTracks:e.maxTracks,maxAge:e.maxAge,minSimilarity:e.minSimilarity};return null!=t.maxTracks&&(n.maxTracks=t.maxTracks),null!=t.maxAge&&(n.maxAge=t.maxAge),null!=t.minSimilarity&&(n.minSimilarity=t.minSimilarity),n}var RQ=function(){function e(e,t){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=xQ(mQ.MoveNet),"SinglePose.Lightning"===t.modelType?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):"SinglePose.Thunder"===t.modelType&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel="MultiPose.Lightning"===t.modelType,this.multiPoseModel||(this.keypointFilter=new jY(IQ),this.cropRegionFilterYMin=new UY(.9),this.cropRegionFilterXMin=new UY(.9),this.cropRegionFilterYMax=new UY(.9),this.cropRegionFilterXMax=new UY(.9)),this.enableSmoothing=t.enableSmoothing,t.minPoseScore?this.minPoseScore=t.minPoseScore:this.minPoseScore=.25,t.multiPoseMaxDimension?this.multiPoseMaxDimension=t.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=t.enableTracking,this.multiPoseModel&&this.enableTracking&&(t.trackerType===pQ.Keypoint?this.tracker=new bQ(t.trackerConfig):t.trackerType===pQ.BoundingBox&&(this.tracker=new yQ(t.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return e.prototype.runSinglePersonPoseModel=function(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i;return QX(this,(function(o){switch(o.label){case 0:if(4!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||1!==t.shape[1]||17!==t.shape[2]||3!==t.shape[3])throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return"webgpu"===DR()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=o.sent(),o.label=3;case 3:for(t.dispose(),r={keypoints:[],score:0},a=0,i=0;i<17;++i)r.keypoints[i]={y:n[3*i],x:n[3*i+1],score:n[3*i+2]},r.keypoints[i].score>.2&&(++a,r.score+=r.keypoints[i].score);return a>0&&(r.score/=a),[2,r]}}))}))},e.prototype.runMultiPersonPoseModel=function(e){return YX(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u;return QX(this,(function(c){switch(c.label){case 0:if(3!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||56!==t.shape[2])throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return"webgpu"===DR()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=c.sent(),c.label=3;case 3:for(t.dispose(),r=[],a=n.length/56,i=0;i<a;++i)for(r[i]={keypoints:[]},o=56*i+51,r[i].box={yMin:n[o],xMin:n[o+1],yMax:n[o+2],xMax:n[o+3],width:n[o+3]-n[o+1],height:n[o+2]-n[o]},s=56*i+55,r[i].score=n[s],r[i].keypoints=[],u=0;u<17;++u)r[i].keypoints[u]={y:n[56*i+3*u],x:n[56*i+3*u+1],score:n[56*i+3*u+2]};return[2,r]}}))}))},e.prototype.estimatePoses=function(e,t,n){return void 0===t&&(t=CQ),YX(this,void 0,void 0,(function(){var r,a,i,o,s,u;return QX(this,(function(c){switch(c.label){case 0:return t=function(e){return null==e?CQ:XX({},e)}(t),null==e?(this.reset(),[2,[]]):(null==n?EY(e)&&(n=1e6*e.currentTime):n*=1e3,r=gY(e),a=mY(r),i=DD(r,0),e instanceof DE||r.dispose(),o=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(i,a,n)]);case 1:return o=c.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(i,a,n)];case 3:o=c.sent(),c.label=4;case 4:for(s=0;s<o.length;++s)for(u=0;u<o[s].keypoints.length;++u)o[s].keypoints[u].name=JX[u],o[s].keypoints[u].y*=a.height,o[s].keypoints[u].x*=a.width;return[2,o]}}))}))},e.prototype.estimateSinglePose=function(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s=this;return QX(this,(function(u){switch(u.label){case 0:return this.cropRegion||(this.cropRegion=EQ(null==this.cropRegion,t)),r=RR((function(){var t=AM([[s.cropRegion.yMin,s.cropRegion.xMin,s.cropRegion.yMax,s.cropRegion.xMax]]),n=pP([1],"int32"),r=[s.modelInputResolution.height,s.modelInputResolution.width];return TR(bF.cropAndResize(e,t,n,r,"bilinear",0),"int32")})),e.dispose(),[4,this.runSinglePersonPoseModel(r)];case 1:if(a=u.sent(),r.dispose(),a.score<this.minPoseScore)return this.reset(),[2,[]];for(i=0;i<a.keypoints.length;++i)a.keypoints[i].y=this.cropRegion.yMin+a.keypoints[i].y*this.cropRegion.height,a.keypoints[i].x=this.cropRegion.xMin+a.keypoints[i].x*this.cropRegion.width;return null!=n&&this.enableSmoothing&&(a.keypoints=this.keypointFilter.apply(a.keypoints,n,1)),o=function(e,t,n,r){for(var a={},i=0,o=JX;i<o.length;i++){var s=o[i];a[s]=[t[n[s]].y*r.height,t[n[s]].x*r.width]}if(function(e,t){return(e[t.left_hip].score>.2||e[t.right_hip].score>.2)&&(e[t.left_shoulder].score>.2||e[t.right_shoulder].score>.2)}(t,n)){var u=(a.left_hip[0]+a.right_hip[0])/2,c=(a.left_hip[1]+a.right_hip[1])/2,l=function(e,t,n,r,a){for(var i=["left_shoulder","right_shoulder","left_hip","right_hip"],o=0,s=0,u=0;u<i.length;u++)(f=Math.abs(r-n[i[u]][0]))>o&&(o=f),(p=Math.abs(a-n[i[u]][1]))>s&&(s=p);for(var c=0,l=0,h=0,d=Object.keys(n);h<d.length;h++){var f,p,m=d[h];e[t[m]].score<.2||((f=Math.abs(r-n[m][0]))>c&&(c=f),(p=Math.abs(a-n[m][1]))>l&&(l=p))}return[o,s,c,l]}(t,n,a,u,c),h=l[0],d=l[1],f=l[2],p=l[3],m=Math.max(1.9*d,1.9*h,1.2*f,1.2*p),v=[u-(m=Math.min(m,Math.max(c,r.width-c,u,r.height-u))),c-m];if(m>Math.max(r.width,r.height)/2)return EQ(null==e,r);var g=2*m;return{yMin:v[0]/r.height,xMin:v[1]/r.width,yMax:(v[0]+g)/r.height,xMax:(v[1]+g)/r.width,height:(v[0]+g)/r.height-v[0]/r.height,width:(v[1]+g)/r.width-v[1]/r.width}}return EQ(null==e,r)}(this.cropRegion,a.keypoints,this.keypointIndexByName,t),this.cropRegion=this.filterCropRegion(o),[2,[a]]}}))}))},e.prototype.estimateMultiplePoses=function(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d,f,p=this;return QX(this,(function(m){switch(m.label){case 0:return t.width>t.height?(a=this.multiPoseMaxDimension,i=Math.round(this.multiPoseMaxDimension*t.height/t.width),r=bF.resizeBilinear(e,[i,a]),s=a,u=32*Math.ceil(i/32),o=_P(r,[[0,0],[0,u-i],[0,0],[0,0]])):(a=Math.round(this.multiPoseMaxDimension*t.width/t.height),i=this.multiPoseMaxDimension,r=bF.resizeBilinear(e,[i,a]),s=32*Math.ceil(a/32),u=i,o=_P(r,[[0,0],[0,0],[0,s-a],[0,0]])),r.dispose(),e.dispose(),c=TR(o,"int32"),o.dispose(),[4,this.runMultiPersonPoseModel(c)];case 1:for(l=m.sent(),c.dispose(),l=l.filter((function(e){return e.score>=p.minPoseScore})),d=0;d<l.length;++d)for(h=0;h<l[d].keypoints.length;++h)l[d].keypoints[h].y*=u/i,l[d].keypoints[h].x*=s/a;if(this.enableTracking&&(this.tracker.apply(l,n),this.enableSmoothing)){for(d=0;d<l.length;++d)this.keypointFilterMap.has(l[d].id)||this.keypointFilterMap.set(l[d].id,new jY(IQ)),l[d].keypoints=this.keypointFilterMap.get(l[d].id).apply(l[d].keypoints,n,1);f=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach((function(e,t){f.has(t)||p.keypointFilterMap.delete(t)}))}return[2,l]}}))}))},e.prototype.filterCropRegion=function(e){if(e){var t=this.cropRegionFilterYMin.apply(e.yMin),n=this.cropRegionFilterXMin.apply(e.xMin),r=this.cropRegionFilterYMax.apply(e.yMax),a=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:t,xMin:n,yMax:r,xMax:a,height:r-t,width:a-n}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},e.prototype.dispose=function(){this.moveNetModel.dispose()},e.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},e.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},e}();function AQ(e){return void 0===e&&(e=SQ),YX(this,void 0,void 0,(function(){var t,n,r,a;return QX(this,(function(i){switch(i.label){case 0:return t=function(e){var t,n=null==e?SQ:XX({},e);if(null==n.modelType)n.modelType="SinglePose.Lightning";else if(kQ.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(kQ));if(null==n.enableSmoothing&&(n.enableSmoothing=!0),null!=n.minPoseScore&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(null!=n.multiPoseMaxDimension&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if("MultiPose.Lightning"===n.modelType&&null==n.enableTracking&&(n.enableTracking=!0),"MultiPose.Lightning"===n.modelType&&!0===n.enableTracking)if(null==n.trackerType&&(n.trackerType=pQ.BoundingBox),n.trackerType===pQ.Keypoint)null!=n.trackerConfig?n.trackerConfig=function(e){var t=NQ(TQ,e);return t.keypointTrackerParams=XX({},TQ.keypointTrackerParams),null!=e.keypointTrackerParams&&(null!=e.keypointTrackerParams.keypointConfidenceThreshold&&(t.keypointTrackerParams.keypointConfidenceThreshold=e.keypointTrackerParams.keypointConfidenceThreshold),null!=e.keypointTrackerParams.keypointFalloff&&(t.keypointTrackerParams.keypointFalloff=e.keypointTrackerParams.keypointFalloff),null!=e.keypointTrackerParams.minNumberOfKeypoints&&(t.keypointTrackerParams.minNumberOfKeypoints=e.keypointTrackerParams.minNumberOfKeypoints)),t}(n.trackerConfig):n.trackerConfig=TQ;else{if(n.trackerType!==pQ.BoundingBox)throw new Error("Tracker type not supported by MoveNet");null!=n.trackerConfig?n.trackerConfig=(t=n.trackerConfig,NQ(_Q,t)):n.trackerConfig=_Q}return n}(e),r=!0,t.modelUrl?(r="string"==typeof t.modelUrl&&t.modelUrl.indexOf("https://tfhub.dev")>-1,[4,PB(t.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=i.sent(),[3,4];case 2:return a=void 0,"SinglePose.Lightning"===t.modelType?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":"SinglePose.Thunder"===t.modelType?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":"MultiPose.Lightning"===t.modelType&&(a="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,PB(a,{fromTFHub:r})];case 3:n=i.sent(),i.label=4;case 4:return"webgl"===DR()&&RC().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new RQ(n,t)]}}))}))}var OQ={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},DQ=["MobileNetV1","ResNet50"],PQ={MobileNetV1:[8,16],ResNet50:[16]},MQ=[8,16,32],LQ={MobileNetV1:[.5,.75,1],ResNet50:[1]},FQ=[1,2,4],zQ={maxPoses:1,flipHorizontal:!1},BQ={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},VQ=[-123.15,-115.9,-103.06];function UQ(e){return Math.floor(e/2)}var WQ=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(UQ(e),e);)this.exchange(e,UQ(e)),e=UQ(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},e}();function jQ(e,t,n,r,a,i){for(var o=i.shape,s=o[0],u=o[1],c=!0,l=Math.max(n-a,0),h=Math.min(n+a+1,s),d=l;d<h;++d){for(var f=Math.max(r-a,0),p=Math.min(r+a+1,u),m=f;m<p;++m)if(i.get(d,m,e)>t){c=!1;break}if(!c)break}return c}function GQ(e){return YX(this,void 0,void 0,(function(){return QX(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))}function HQ(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+17)}}function KQ(e,t,n){var r=HQ(e.heatmapY,e.heatmapX,e.id,n),a=r.y,i=r.x;return{x:e.heatmapX*t+i,y:e.heatmapY*t+a}}function qQ(e,t,n,r){var a=n.x,i=n.y;return e.some((function(e){var n,o,s,u,c=e.keypoints;return n=i,o=a,(s=c[r].y-n)*s+(u=c[r].x-o)*u<=t}))}var ZQ=JX.reduce((function(e,t,n){return e[t]=n,e}),{}),XQ=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map((function(e){var t=e[0],n=e[1];return[ZQ[t],ZQ[n]]})),YQ=XQ.map((function(e){return e[1]})),QQ=XQ.map((function(e){return e[0]}));function $Q(e,t,n){return e<t?t:e>n?n:e}function JQ(e,t,n,r){return{y:$Q(Math.round(e.y/t),0,n-1),x:$Q(Math.round(e.x/t),0,r-1)}}function e$(e,t){return{x:e.x+t.x,y:e.y+t.y}}function t$(e,t,n,r,a,i,o,s){void 0===s&&(s=2);for(var u=r.shape,c=u[0],l=u[1],h={y:t.y,x:t.x},d=e$(h,function(e,t,n){var r=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,r+e)}}(e,JQ(h,i,c,l),o)),f=0;f<s;f++){var p=JQ(d,i,c,l),m=HQ(p.y,p.x,n,a);d=e$({x:p.x*i,y:p.y*i},{x:m.x,y:m.y})}var v=JQ(d,i,c,l),g=r.get(v.y,v.x,n);return{y:d.y,x:d.x,name:JX[n],score:g}}function n$(e,t,n,r,a,i){var o=t.shape[2],s=YQ.length,u=new Array(o),c=e.part,l=e.score,h=KQ(c,r,n);u[c.id]={score:l,name:JX[c.id],y:h.y,x:h.x};for(var d=s-1;d>=0;--d){var f=YQ[d],p=QQ[d];u[f]&&!u[p]&&(u[p]=t$(d,u[f],p,t,n,r,i))}for(d=0;d<s;++d)f=QQ[d],p=YQ[d],u[f]&&!u[p]&&(u[p]=t$(d,u[f],p,t,n,r,a));return u}function r$(e,t,n){return n.reduce((function(n,r,a){var i=r.y,o=r.x,s=r.score;return qQ(e,t,{y:i,x:o},a)||(n+=s),n}),0)/n.length}function a$(e,t,n,r,a,i,o,s){return void 0===o&&(o=.5),void 0===s&&(s=20),YX(this,void 0,void 0,(function(){var u,c,l,h,d,f,p,m,v,g,y,b;return QX(this,(function(x){switch(x.label){case 0:return[4,GQ([e,t,n,r])];case 1:for(u=x.sent(),c=u[0],l=u[1],h=u[2],d=u[3],f=[],p=function(e,t,n){for(var r=n.shape,a=r[0],i=r[1],o=r[2],s=new WQ(a*i*o,(function(e){return e.score})),u=0;u<a;++u)for(var c=0;c<i;++c)for(var l=0;l<o;++l){var h=n.get(u,c,l);h<e||jQ(l,h,u,c,1,n)&&s.enqueue({score:h,part:{heatmapY:u,heatmapX:c,id:l}})}return s}(o,0,c),m=s*s;f.length<i&&!p.empty();)v=p.dequeue(),g=KQ(v.part,a,l),qQ(f,m,g,v.part.id)||(y=n$(v,c,l,a,h,d),b=r$(f,m,y),f.push({keypoints:y,score:b}));return[2,f]}}))}))}function i$(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];switch(t.length){case 0:e="fn main() ";break;case 1:e="fn main(".concat(t[0]," : i32)");break;default:throw Error("Unreachable")}return e}var o$=function(){function e(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=hV(this.outputShape),this.dispatch=uV(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return e.prototype.getUserCode=function(){return"\n        ".concat(i$("index")," {\n          if (index < uniforms.size) {\n            let y = B[index * 2];\n            let x = B[index * 2 + 1];\n            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;\n            result[index] = A[outIndex];\n          }\n        }\n        ")},e}();var s$=function(){function e(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,2!==e.length||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var t=[e[0],1];this.dispatchLayout=hV(t),this.dispatch=uV(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return e.prototype.getUserCode=function(){return"\n    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {\n      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;\n      let outIndexX = outIndexY + uniforms.bShape.z;\n      let outY = i32(B[outIndexY]);\n      let outX = i32(B[outIndexX]);\n      return vec2<i32>(outY, outX);\n    }\n\n    ".concat(i$("index")," {\n      if (index < uniforms.size) {\n        let indexY = index * ").concat(this.supportedLastDimension,";\n        let indexX = indexY + 1;\n        let heatmapY = A[indexY];\n        let heatmapX = A[indexX];\n        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);\n        result[indexY] = f32(out[0]);\n        result[indexX] = f32(out[1]);\n      }\n    }\n    ")},e}();function u$(e){var t=e.shape,n=t[0],r=t[1],a=t[2];return RR((function(){var t,i,o=IO(e,[n*r,a]),s=rO(o,0),u=DD(zR(s,GR(r,"int32")),1),c=DD((t=s,i=r,RR((function(){var e=zR(t,GR(i,"int32"));return tA(t,BR(e,GR(i,"int32")))}))),1);return EO([u,c],1)}))}function c$(e,t,n){return RR((function(){var r=function(e,t){for(var n=[],r=0;r<JX.length;r++){var a=l$(e.get(r,0).valueOf(),e.get(r,1).valueOf(),r,t),i=a.x,o=a.y;n.push(o),n.push(i)}return AM(n,[JX.length,2])}(e,n);return LR(TR(BR(e.toTensor(),GR(t,"int32")),"float32"),r)}))}function l$(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+JX.length)}}function h$(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d;return QX(this,(function(f){switch(f.label){case 0:return r=0,a=u$(e),[4,Promise.all([e.buffer(),t.buffer(),a.buffer()])];case 1:return i=f.sent(),o=i[0],s=i[1],u=i[2],[4,(c=c$(u,n,s)).buffer()];case 2:return l=f.sent(),h=Array.from(function(e,t){for(var n=t.shape[0],r=new Float32Array(n),a=0;a<n;a++){var i=t.get(a,0),o=t.get(a,1);r[a]=e.get(i,o,a)}return r}(o,u)),d=h.map((function(e,t){return r+=e,{y:l.get(t,0),x:l.get(t,1),score:e,name:JX[t]}})),a.dispose(),c.dispose(),[2,{keypoints:d,score:r/d.length}]}}))}))}function d$(e,t,n){return YX(this,void 0,void 0,(function(){var r,a,i;return QX(this,(function(o){return r=u$(e),a=function(e,t,n){return RR((function(){var r=function(e,t){if(MR()instanceof gV)return function(e,t){var n=MR(),r=new s$(e.shape),a=n.runWebGPUProgram(r,[e,t],"float32");return NR().makeTensorFromTensorInfo(a)}(e,t);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}(e,n);return LR(TR(BR(e,GR(t,"int32")),"float32"),r)}))}(r,n,t),i=function(e,t){if(MR()instanceof gV)return function(e,t){var n=MR(),r=new o$(t.shape),a=n.runWebGPUProgram(r,[e,t],"float32");return NR().makeTensorFromTensorInfo(a)}(e,t);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}(e,r),[2,[a,i]]}))}))}function f$(e,t){return(e-1)%t==0}var p$="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",m$="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function v$(e,t){return function(e,t){return(e-1)%t==0}(e,t)?e:Math.floor(e/t)*t+1}var g$=function(){function e(e,t){this.posenetModel=e;var n=this.posenetModel.inputs[0].shape;YS(-1===n[1]&&-1===n[2],(function(){return"Input shape [".concat(n[1],", ").concat(n[2],"] ")+"must both be equal to or -1"}));var r,a,i=(r=t.inputResolution,a=t.outputStride,{height:v$(r.height,a),width:v$(r.width,a)});!function(e){YS(MQ.indexOf(e)>=0,(function(){return"outputStride of ".concat(e," is invalid. ")+"It must be either 8 or 16."}))}(t.outputStride),function(e,t){YS(f$(e.height,t),(function(){return"height of ".concat(e.height," is invalid for output stride ")+"".concat(t,".")})),YS(f$(e.width,t),(function(){return"width of ".concat(e.width," is invalid for output stride ")+"".concat(t,".")}))}(i,t.outputStride),this.inputResolution=i,this.outputStride=t.outputStride,this.architecture=t.architecture}return e.prototype.estimatePoses=function(e,t){return void 0===t&&(t=zQ),YX(this,void 0,void 0,(function(){return QX(this,(function(n){return[2,this.estimatePosesGPU(e,t,!1)]}))}))},e.prototype.estimatePosesGPU=function(e,t,n){return void 0===t&&(t=zQ),void 0===n&&(n=!1),YX(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x;return QX(this,(function(w){switch(w.label){case 0:return r=function(e){var t=e;if(null==t.maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(t.maxPoses,". Should be > 0."));if(t.maxPoses>1){if((t=XX(XX({},BQ),t)).scoreThreshold<0||t.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(t.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(t.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(t.nmsRadius,"."))}return t}(t),null==e?[2,n?[[],[]]:[]]:(this.maxPoses=r.maxPoses,a=TY(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),i=a.imageTensor,o=a.padding,s="ResNet50"===this.architecture?LR(i,VQ):IY(i,[-1,1]),u=this.posenetModel.predict(s),"ResNet50"===this.architecture?(c=IM(u[2],[0]),l=IM(u[3],[0]),h=IM(u[0],[0]),d=IM(u[1],[0])):(c=IM(u[0],[0]),l=IM(u[1],[0]),h=IM(u[2],[0]),d=IM(u[3],[0])),f=RO(l),1!==this.maxPoses?[3,5]:n?[4,d$(f,c,this.outputStride)]:[3,2]);case 1:return m=w.sent(),g=m[0],v=m[1],p=[g,v],[3,4];case 2:return[4,h$(f,c,this.outputStride)];case 3:g=w.sent(),p=[g],w.label=4;case 4:return[3,7];case 5:if(n)throw new Error("GPU renderer only supports single pose!");return[4,a$(f,c,h,d,this.outputStride,this.maxPoses,r.scoreThreshold,r.nmsRadius)];case 6:p=w.sent(),w.label=7;case 7:if(n){if(!0===r.flipHorizontal)throw new Error("flipHorizontal is not supported!");y=this.getCanvasInfo(mY(e),this.inputResolution,o)}else x=mY(e),b=function(e,t,n,r){var a=t.height,i=t.width,o=a/(n.height*(1-r.top-r.bottom)),s=i/(n.width*(1-r.left-r.right)),u=-r.top*n.height,c=-r.left*n.width;if(1===s&&1===o&&0===u&&0===c)return e;for(var l=0,h=e;l<h.length;l++)for(var d=0,f=h[l].keypoints;d<f.length;d++){var p=f[d];p.x=(p.x+c)*s,p.y=(p.y+u)*o}return e}(p,x,this.inputResolution,o),r.flipHorizontal&&(b=function(e,t){for(var n=0,r=e;n<r.length;n++)for(var a=0,i=r[n].keypoints;a<i.length;a++){var o=i[a];o.x=t.width-1-o.x}return e}(b,x));return i.dispose(),s.dispose(),AR(u),c.dispose(),l.dispose(),h.dispose(),d.dispose(),f.dispose(),[2,n?[p,y]:b]}}))}))},e.prototype.getCanvasInfo=function(e,t,n){var r=e.height,a=e.width,i=r/(t.height*(1-n.top-n.bottom)),o=a/(t.width*(1-n.left-n.right)),s=-n.top*t.height;return[-n.left*t.width,s,o,i,e.width,e.height]},e.prototype.dispose=function(){this.posenetModel.dispose()},e.prototype.reset=function(){},e}();function y$(e){return void 0===e&&(e=OQ),YX(this,void 0,void 0,(function(){var t,n,r,a,i;return QX(this,(function(o){switch(o.label){case 0:return"ResNet50"!==(t=function(e){var t=e||OQ;if(null==t.architecture&&(t.architecture="MobileNetV1"),DQ.indexOf(t.architecture)<0)throw new Error("Invalid architecture ".concat(t.architecture,". ")+"Should be one of ".concat(DQ));if(null==t.inputResolution&&(t.inputResolution={height:257,width:257}),null==t.outputStride&&(t.outputStride=16),PQ[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride ".concat(t.outputStride,". ")+"Should be one of ".concat(PQ[t.architecture]," ")+"for architecture ".concat(t.architecture,"."));if(null==t.multiplier&&(t.multiplier=1),LQ[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier ".concat(t.multiplier,". ")+"Should be one of ".concat(LQ[t.architecture]," ")+"for architecture ".concat(t.architecture,"."));if(null==t.quantBytes&&(t.quantBytes=4),FQ.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(t.quantBytes,". ")+"Should be one of ".concat(FQ," ")+"for architecture ".concat(t.architecture,"."));if("MobileNetV1"===t.architecture&&32===t.outputStride&&1!==t.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return t}(e)).architecture?[3,2]:(s=t.outputStride,u=t.quantBytes,c="model-stride".concat(s,".json"),n=4===u?m$+"float/"+c:m$+"quant".concat(u,"/")+c,[4,PB(t.modelUrl||n)]);case 1:return r=o.sent(),[2,new g$(r,t)];case 2:return a=function(e,t,n){var r={1:"100",.75:"075",.5:"050"},a="model-stride".concat(e,".json");return 4===n?p$+"float/".concat(r[t],"/")+a:p$+"quant".concat(n,"/").concat(r[t],"/")+a}(t.outputStride,t.multiplier,t.quantBytes),[4,PB(t.modelUrl||a)];case 3:return i=o.sent(),[2,new g$(i,t)]}var s,u,c}))}))}function b$(e,t){return YX(this,void 0,void 0,(function(){var n,r;return QX(this,(function(a){switch(e){case mQ.PoseNet:return[2,y$(t)];case mQ.BlazePose:if(r=void 0,null!=(n=t)){if("tfjs"===n.runtime)return[2,fQ(t)];if("mediapipe"===n.runtime)return[2,pY(t)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case mQ.MoveNet:return[2,AQ(t)];default:throw new Error("".concat(e," is not a supported model name."))}}))}))}var x$,w$,k$,S$={SINGLEPOSE_LIGHTNING:"SinglePose.Lightning",SINGLEPOSE_THUNDER:"SinglePose.Thunder",MULTIPOSE_LIGHTNING:"MultiPose.Lightning"},C$={},I$={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function T$(e,t){if(!(e in C$)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if(RC().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete C$[e]}),!1),RC().getBool("SOFTWARE_WEBGL_ENABLED")&&(I$.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",I$)||n.getContext("experimental-webgl",I$);return n.getContext("webgl2",I$)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;C$[e]=n}var r=C$[e];return null==r||r.isContextLost()?(delete C$[e],T$(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),C$[e])}function _$(e,t){return[t,e]}function E$(e){var t=JS(e);return rC(Math.ceil(t/4))}function N$(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function R$(e,t){var n,r,a,i,o,s,u,c,l,h,d=e;return 2===RC().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,a=d.RGBA16F,i=d.RGBA32F,o=d.RED,u=4,c=1,l=d.HALF_FLOAT,h=d.FLOAT,s=d.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=d.RGBA,o=e.RGBA,u=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,s=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:s,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:h}}function A$(e,t){var n=t();return RC().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(x$||(x$={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(w$||(w$={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(k$||(k$={}));function O$(e){return!!(RC().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function D$(e,t){return G$(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var P$,M$,L$=/ERROR: [0-9]+:([0-9]+):/g;function F$(e,t){var n=L$.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return aC((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(aC(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}function z$(e,t){if(A$(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function B$(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(A$(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),A$(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),A$(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function V$(e,t,n,r){A$(e,(function(){return function(e,t,n){H$(e,n),A$(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),A$(e,(function(){return e.uniform1i(n,r)}))}function U$(e,t,n){A$(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),A$(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function W$(e,t){A$(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),A$(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function j$(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function G$(e,t,n){var r=A$(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function H$(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function K$(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return JS(e.slice(0,e.length-t))}function q$(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Z$(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[K$(e)].concat((0,ke.Z)(q$(e)))),t}function X$(e){return e%2===0}function Y$(e,t){if(tC(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(X$(n)&&X$(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&X$(e[0])&&X$(t[0])}function Q$(e,t){return null!=e.getExtension(t)}function $$(e){try{if(null!=T$(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function J$(e){if(0===e)return!1;var t=T$(e);if(1!==e){if(Q$(t,"EXT_color_buffer_float"))return eJ(t);var n="EXT_color_buffer_half_float";if(Q$(t,n)){var r=t.getExtension(n);return function(e,t){var n=R$(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!Q$(t,"OES_texture_float")&&(!!Q$(t,"WEBGL_color_buffer_float")&&eJ(t))}function eJ(e){var t=R$(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function tJ(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&YS("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var nJ=RC();function rJ(){var e,t,n,r,a,i,o,s,u,c;return 2===RC().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=RC().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function aJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=gC(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function iJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=gC(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function oJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=function(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(e.map((function(e,t){return t})),t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(r[a]),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(r[a]):"index -= ".concat(e[a]," * ").concat(r[a]);return"".concat(i,"; ").concat(o,";")})).join("")}function sJ(e){var t=gC(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}nJ.registerFlag("HAS_WEBGL",(function(){return nJ.getNumber("WEBGL_VERSION")>0})),nJ.registerFlag("WEBGL_VERSION",(function(){return $$(2)?2:$$(1)?1:0})),nJ.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),nJ.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===nJ.get("WEBGL_VERSION")})),nJ.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),nJ.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),nJ.registerFlag("WEBGL_PACK",(function(){return nJ.getBool("HAS_WEBGL")})),nJ.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_CLIP",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_PACK_REDUCE",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_CONV_IM2COL",(function(){return nJ.getBool("WEBGL_PACK")})),nJ.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==P$){var t=T$(e);P$=t.getParameter(t.MAX_TEXTURE_SIZE)}return P$}(nJ.getNumber("WEBGL_VERSION"))})),nJ.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==M$){var t=T$(e);M$=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,M$)}(nJ.getNumber("WEBGL_VERSION"))})),nJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=nJ.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=T$(e);return Q$(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Q$(t,"EXT_disjoint_timer_query")?1:0}(e)})),nJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return nJ.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!tN()})),nJ.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=T$(e);if(1===e){if(!Q$(t,"OES_texture_float"))return!1}else if(!Q$(t,"EXT_color_buffer_float"))return!1;return eJ(t)}(nJ.getNumber("WEBGL_VERSION"))})),nJ.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!nJ.getBool("WEBGL_FORCE_F16_TEXTURES")&&nJ.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),nJ.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return J$(nJ.getNumber("WEBGL_VERSION"))})),nJ.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=nJ.getNumber("WEBGL_VERSION"))&&null!=T$(e).fenceSync;var e})),nJ.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return nJ.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),nJ.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),nJ.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return tN()?1:-1}),(function(e){if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),nJ.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),nJ.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),nJ.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),nJ.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),nJ.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),nJ.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return nJ.getBool("IS_TEST")})),nJ.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),nJ.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),nJ.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),nJ.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var uJ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",cJ=aA;function lJ(e,t,n){var r=[];if(e.forEach((function(e){var t=JS(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(xJ(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?dJ(e,r):hJ(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=cJ(e.shapeInfo.logicalShape,t.logicalShape),c=bJ(s),l=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+l]," = 0;")})).join("\n");var d="";d=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+l])})).join(", ");var f="return outputValue;",p=1===JS(e.shapeInfo.logicalShape),m=JS(t.logicalShape),v=1===m;if(1!==o||p||v){if(p&&!v)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=o-2,y=o-1;u.indexOf(g)>-1&&u.indexOf(y)>-1?f="return vec4(outputValue.x);":u.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(f,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&tC(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=bJ(u),h=cJ(e.shapeInfo.logicalShape,t.logicalShape),d=u-s,f=["x","y","z","w","u","v"];c=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map((function(e){return"coords.".concat(f[e+d]," = 0;")})).join("\n");var p="";p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+d])})).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),u=t.texShape,c=rJ(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),h=function(e){var t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(fJ,"\n    ").concat(pJ,"\n    ").concat(mJ,"\n  ");return t}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(tC(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,s="",u="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(tC(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=iJ(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=aJ(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=iJ(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=aJ(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=aJ(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=aJ(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(h+=vJ),[h,l,i,o,a,s,n.userCode].join("\n")}function hJ(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=(0,U.Z)(e.shapeInfo.texShape,2),i=a[0],o=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=gJ(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=(0,U.Z)(e.shapeInfo.texShape,2),c=u[0],l=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(yJ(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=gJ(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&tC(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],s=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var u=uC(n),c=u.newShape,l=u.keptDims,h=c;if(h.length<n.length){var d=wJ(e,h),f=["row","col"];return"\n      ".concat(hJ(d,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(kJ(f,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(yJ(e),"\n      }\n    ");var p=i[0],m=i[1],v=gJ(r);if(1===m)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===p)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(m,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],s=uC(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var h=wJ(e,l),d=["row","col","depth"];return"\n        ".concat(hJ(h,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(kJ(d,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(yJ(e),"\n      }\n    ");var f=e.shapeInfo.texShape,p=f[0],m=f[1],v=e.shapeInfo.flatOffset;if(m===i&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(m,".0, ").concat(p,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(m===o&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(m,".0, ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var g=gJ(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,u=uC(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=wJ(e,c),d=["row","col","depth","depth2"];return"\n      ".concat(hJ(h,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(kJ(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(yJ(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],v=p[1],g="int stride2 = ".concat(r,"Shape[3];"),y="int stride1 = ".concat(r,"Shape[2] * stride2;"),b="int stride0 = ".concat(r,"Shape[1] * stride1;");if(v===s&&null==f)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(g,"\n        ").concat(y,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(v===i&&null==f)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var x=gJ(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(g,"\n      ").concat(y,"\n      ").concat(b,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=uC(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var h=wJ(e,c),d=["row","col","depth","depth2","depth3"];return"\n      ".concat(hJ(h),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(kJ(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(yJ(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],v=p[1];if(v===s&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=gJ(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=uC(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=wJ(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(hJ(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(kJ(u,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,h=t[3]*l,d=t[2]*h,f=t[1]*d;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(f,", ").concat(d,", ").concat(h,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(yJ(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],g=m[1];if(g===f&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(d,", ").concat(h,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=gJ(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(f," + col * ").concat(d," + depth * ").concat(h," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function dJ(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=rJ();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=rJ();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=rJ();if(null!=i&&tC(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=[1,2],u=wJ(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(dJ(u,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(kJ(c,s),");\n        }\n      ")}var l=rJ();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var h=o[0],d=o[1],f=Math.ceil(n[2]/2),p=f*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(h,", ").concat(d,", ").concat(p,", ").concat(f,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=rJ();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],h=Math.ceil(i[o-1]/2),d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)"),m=2;m<o-1;m++)f="int b".concat(m,", ")+f,d*=i[o-m-1],p="b".concat(m," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(f,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var fJ="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",pJ="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",mJ="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",vJ="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function gJ(e){return"offset".concat(e)}function yJ(e){var t=e.name,n=JS(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function bJ(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function xJ(e,t,n){var r=uC(t),a=r.newShape,i=r.keptDims,o=t.length,s=e&&3===o&&1===t[0],u=s?t.slice(1):a,c=!e&&o>1&&!tC(t,n)&&a.length<o||s;return{useSqueezeShape:c,uniformShape:c?u:t,keptDims:i}}function wJ(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function kJ(e,t){return t.map((function(t){return e[t]})).join(", ")}function SJ(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=lJ(a,o,t),u=function(e,t){var n=G$(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(A$(e,(function(){return e.shaderSource(n,t)})),A$(e,(function(){return e.compileShader(n)})),RC().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw F$(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(u);return RC().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},CJ(e,t,c)))}function CJ(e,t,n){var r,a,i,o,s=[],u=[],c=null;o=e.getUniformLocation(n,"NAN",!1),1===RC().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(n,"INFINITY",!1));var l,h=!1,d=ye(t.variableNames);try{for(d.s();!(l=d.n()).done;){var f=l.value,p={name:f,uniform:e.getUniformLocation(n,f,h),offset:e.getUniformLocation(n,"offset".concat(f),h)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,"".concat(f,"Shape"),h),p.texShape=e.getUniformLocation(n,"".concat(f,"TexShape"),h)),s.push(p)}}catch(N8){d.e(N8)}finally{d.f()}if(t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",h),i=e.getUniformLocation(n,"outShapeStrides",h),a=e.getUniformLocation(n,"outTexShape",h)),t.customUniforms){var m,v=ye(t.customUniforms);try{for(v.s();!(m=v.n()).done;){var g=m.value;u.push(e.getUniformLocation(n,g.name,h))}}catch(N8){v.e(N8)}finally{v.f()}}return{variablesLocations:s,customUniformLocations:u,infLoc:c,nanLoc:o,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function IJ(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!tC(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!tC(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function TJ(e){return RC().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var _J=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=x$.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=rJ();this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?iJ(["r","c","d"],t):aJ(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),EJ=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=x$.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=rJ();this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?iJ(["r","c","d"],t):aJ(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),NJ=Te((function e(t){Se(this,e),this.variableNames=["A"],this.outTexUsage=w$.DOWNLOAD;var n=rJ();this.outputShape=t,this.userCode="\n      ".concat(uJ,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),RJ=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=w$.DOWNLOAD;var n=rJ();this.outputShape=t,this.userCode="\n      ".concat(uJ,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),AJ={R:0,G:1,B:2,A:3},OJ=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";Se(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=rJ();this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",s=0;s<r.length;s++){var u=r[s];o+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(AJ[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sJ(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),DJ=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Se(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=rJ();this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var s=0;s<=1;s++){var u=2*o+s;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sJ(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function PJ(e){var t=rJ();return function(e,t){var n=G$(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(A$(e,(function(){return e.shaderSource(n,t)})),A$(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function MJ(e){return function(e,t){var n=G$(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return A$(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),A$(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function LJ(e){return function(e,t){var n=G$(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return A$(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),A$(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function FJ(e,t,n,r,a,i){!function(e,t){var n=RC().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return G$(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return A$(e,(function(){return e.bindTexture(s,o)})),A$(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),A$(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),A$(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),A$(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===RC().getNumber("WEBGL_VERSION")?A$(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})):A$(e,(function(){return e.texStorage2D(s,1,r,t,n)})),A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function zJ(e){return e.internalFormatFloat}function BJ(e){return e.internalFormatHalfFloat}function VJ(e){return e.downloadTextureFormat}function UJ(e){return e.internalFormatPackedFloat}function WJ(e){return e.internalFormatPackedHalfFloat}function jJ(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=N$(e,t),r=(0,U.Z)(n,2);return r[0]*r[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}var GJ=function(){function e(t){Se(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=RC().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){C$[e]=t}(n,t)):this.gl=T$(n),t=this.gl,2===RC().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return A$(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return A$(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return A$(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return A$(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return A$(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return A$(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return A$(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return A$(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===RC().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=D$(this.gl,"OES_texture_float"),Q$(this.gl,s))this.textureHalfFloatExtension=D$(this.gl,s);else if(RC().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),Q$(this.gl,o))this.colorBufferHalfFloatExtension=D$(this.gl,o);else if(RC().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",Q$(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!Q$(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=MJ(this.gl),this.indexBuffer=LJ(this.gl),this.framebuffer=function(e){return G$(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=R$(this.gl,this.textureHalfFloatExtension)}return Te(e,[{key:"debug",get:function(){return RC().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;A$(t,(function(){return t.finish()})),A$(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),A$(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),A$(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),A$(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),A$(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_$(t,n),i=(0,U.Z)(a,2);return FJ(e,i[0],i[1],zJ(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_$(t,n),i=(0,U.Z)(a,2);return FJ(e,i[0],i[1],BJ(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_$(t,n),i=(0,U.Z)(a,2);return FJ(e,i[0],i[1],VJ(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===RC().getNumber("WEBGL_VERSION")?A$(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):A$(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===RC().getNumber("WEBGL_VERSION")?A$(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):A$(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),2===RC().getNumber("WEBGL_VERSION")?A$(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)})):A$(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),A$(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N$(t,n),i=(0,U.Z)(a,2);return FJ(e,i[0],i[1],WJ(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=N$(t,n),i=(0,U.Z)(a,2);return FJ(e,i[0],i[1],UJ(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(W$(this.gl,this.framebuffer),this.outputTexture=null),A$(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=_$(t,n),i=(0,U.Z)(a,2),o=i[0],s=i[1],u=new Uint8Array(t*n*4);return A$(e,(function(){return e.readPixels(0,0,o,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return jJ(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();A$(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return A$(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),A$(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),A$(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(RC().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return A$(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=PJ(n));var r=function(e){return G$(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);A$(n,(function(){return n.attachShader(r,t.vertexShader)})),A$(n,(function(){return n.attachShader(r,e)})),function(e,t){if(A$(e,(function(){return e.linkProgram(t)})),!RC().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,r);var a=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&z$(n,a),a}},{key:"buildVao",value:function(e){var t=this;this.setProgram(e),this.bindVertexArray(e.vao);var n=this.gl;A$(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),function(e,t,n){A$(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),B$(e,t,"clipSpacePos",n,3,20,0)&&B$(e,t,"uv",n,2,20,12)}(n,e,this.vertexBuffer)}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(A$(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&z$(this.gl,this.program),A$(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return G$(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),A$(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),V$(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=N$(t,n),a=(0,U.Z)(r,2),i=a[0],o=a[1];this.setOutputMatrixTextureDriver(e,i,o)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&z$(this.gl,this.program),j$(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}A$(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),A$(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=D$(this.gl,2===RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=N(T().mark((function e(t){var n=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,iC((function(){return n.disposed||n.isQueryAvailable(t,RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in RC().platform&&(r=RC().platform.setTimeoutCustom.bind(RC().platform)),iC((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),U$(this.gl,e,this.framebuffer),this.debug&&j$(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(U$(this.gl,this.outputTexture,this.framebuffer),this.debug&&j$(this.gl)):W$(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;U$(r,e,this.framebuffer),this.debug&&j$(r),this.outputTexture=e,A$(r,(function(){return r.viewport(0,0,t,n)})),A$(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),A$(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var HJ=mW((function(e,t){return e&t}));SW(nI,HJ);function KJ(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<t.length-1;++c){u*=t[c];for(var l=t[c+1],h=1;h<u+1;++h)s[c].push(h*l)}for(var d=0;d<e.length;++d){for(var f=e[d],p=e[d]+1,m=0;m<n.length;++m){var v=n[m],g=m+t.length-1;if(g>=0)for(var y=s[g],b=y[y.length-1]-v[f],x=f;x<p;++x)s[g].push(v[x+1]+b);f=v[f],p=v[p]}p!==f&&(a.push([f,p]),i+=p-f)}return{outSplits:s,valueSlices:a,numValues:i}}function qJ(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function ZJ(e,t,n,r,a){var i=t.slice();i[0]=a;var o=lC(n,JS(i)),s=e.length;return function(e,t,n,r,a,i){var o,s=qJ(t,2)[1],u=qJ(i,2)[1],c=0,l=ye(n);try{for(l.s();!(o=l.n()).done;)for(var h=o.value,d=h[0];d<h[1];++d){for(var f=0;f<r;++f)a[c*u+f]=e[d*s+f];++c}}catch(N8){l.e(N8)}finally{l.f()}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}var XJ=2147483647;var YJ=mF,QJ=function(){function e(t,n,r,a,i,o,s,u,c,l){var h;Se(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=function(e){var t,n={FIRST_DIM_SIZE:mF.FIRST_DIM_SIZE,VALUE_ROWIDS:mF.VALUE_ROWIDS,ROW_LENGTHS:mF.ROW_LENGTHS,ROW_SPLITS:mF.ROW_SPLITS,ROW_LIMITS:mF.ROW_LIMITS,ROW_STARTS:mF.ROW_STARTS},r=[],a=ye(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(N8){a.e(N8)}finally{a.f()}return r}(l),this.raggedRank=0===(h=this.rowPartitionTypes).length?0:h[0]===mF.FIRST_DIM_SIZE?h.length-1:h.length}return Te(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===YJ.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===YJ.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case YJ.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case YJ.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(YJ[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return JJ(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape;!function(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}(this.defaultValueShape,t);var n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=function(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}(this.raggedRank,n,t),a=r;a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var s=r;s<e;++s)a.push(-1);return YS(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var s=e[o+1]-e[o],u=Math.min(r,s),c=t[o];-1===c&&(u=0);for(var l=0;l<u;++l)i.push(c),c+=n;for(var h=0;h<s-u;++h)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));var u=t[s];i.push(u);for(var c=1;c<a;++c){var l=e[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));u=t[l]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case YJ.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case YJ.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(YJ[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case YJ.FIRST_DIM_SIZE:return e[0];case YJ.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case YJ.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(YJ[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=JJ(t,!1),i=lC(this.valuesDType,JS(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),s=1;s<=this.raggedRank;++s){o=this.calculateOutputIndex(s-1,o,n[s],t[s])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice(),s=JS(o=o.slice(e+1)),u=t.length,c=this.defaultValue;if(c.length!==s&&1!==c.length){var l=this.defaultValueShape;RR((function(){var e=IO(c,l),t=WO(e,o);c=t.dataSync()}))}for(var h=0,d=0,f=0,p=0;p<=u;++p){var m=p<u?t[p]:-1;if(m!==f){if(d<f){var v=a.subarray(h*s);$J(i.subarray(d*s),v,(f-d)*s)}if(p>=u){var g=n.length;m=Math.floor(g/s)}if(m>f)if(1===this.defaultValue.length)i.subarray(f*s,m*s).fill(this.defaultValue[0]),f=m;else for(;m>f;){$J(i.slice(f*s),c,s),++f}m<0?(h=p+1,d=f):(h=p,f=(d=f)+1)}else++f}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function $J(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function JJ(e,t){var n,r=[],a=ye(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(N8){a.e(N8)}finally{a.f()}return r}var e0=_W((function(e){return 1/(1+Math.exp(-e))}));EW(u_,(function(e){return 1/(1+Math.exp(-e))}));var t0=_W((function(e){return Math.sqrt(e)})),n0=(EW(l_,(function(e){return Math.sqrt(e)})),_W((function(e,t){var n=t.pattern,r=t.replaceGlobal,a=t.rewrite;return e.replace(new RegExp(n,r?"g":""),a)})));NW(k_,n0);function r0(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var s=t[0],u=e.indexOf(s);-1!==u;){var c=e.subarray(0,u);n&&0===c.length||r.push(c),u=(e=e.subarray(u+1)).indexOf(s)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}var a0=IW,i0=function(e,t,n,r,a){for(var i=JS(r),o=kC(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o},o0=function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=IR([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,s,c):t.size>0?o.set(o.get(s,c)+t.get(s,u),s,c):o.set(o.get(s,c)+1,s,c))}return o},s0=HJ,u0=wW,c0=RW,l0=AW,h0=OW,d0=DW,f0=PW,p0=MW,m0=FW,v0=zW,g0=VW,y0=BW,b0=WW,x0=UW,w0=function(e,t,n){var r=(t-e)/(n-1),a=kC(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a},k0=jW,S0=GW,C0=HW,I0=KW,T0=qW,_0=XW,E0=YW,N0=$W,R0=function(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=IC(r,t.length,gC(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var u=KJ(i,o,e,r[0]),c=u.outSplits,l=u.valueSlices,h=u.numValues,d=function(e){for(var t=[],n=function(){var n=lC("int32",e[r].length);t.push(n),e[r].forEach((function(e,t){return n[t]=e}))},r=0;r<e.length;++r)n();return t}(c),f=ZJ(n,r,a,l,h);return[d,f[0],f[1]]},A0=function(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var s=0===t.length,u=0===a.length,c=0===o.length,l=[];s||l.push(t[0]),u||l.push(a[0]),c||l.push(o[0]);for(var h=1;h<l.length;++h)if(l[h]!==l[h-1])throw new Error("starts, limits, and deltas must have the same shape");var d=0===l.length?1:l[0],f=lC("int32",d+1);f[0]=0;for(var p=0;p<d;++p){var m=s?e[0]:e[p],v=u?r[0]:r[p],g=c?i[0]:i[p];if(0===g)throw new Error("Requires delta != 0");var y=void 0;if(g>0&&v<m||g<0&&v>m)y=0;else if((y=Math.ceil(Math.abs((v-m)/g)))>XJ)throw new Error("Requires ((limit - start) / delta) <= ".concat(XJ));f[p+1]=f[p]+y}for(var b=lC(n,f[d]),x=0,w=0;w<d;++w)for(var k=f[w+1]-f[w],S=s?e[0]:e[w],C=c?i[0]:i[w],I=0;I<k;++I)b[x++]=S,S+=C;return[f,b]},O0=function(e,t,n,r,a,i,o,s,u,c){return new QJ(e,t,n,r,a,i,o,s,u,c).compute()},D0=JW,P0=ej,M0=tj,L0=e0,F0=nj,z0=rj,B0=function(e,t,n,r,a,i,o){var s=t[0],u=i[0],c=new Array(u),l=new Array(s),h=t[1];if(0===u){if(0!==s)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s));return[lC(n,0),[0,h],lC(a,0),c,l]}for(var d=!0,f=0,p=new Array(u).fill(0),m=0;m<s;++m){var v=e[m*h];if(v<0)throw new Error(az(m,v));if(v>=u)throw new Error(iz(m,v,u));++p[v],d=d&&v>=f,f=v}for(var g=!0,y=0;y<u;++y){var b=0===p[y];c[y]=b,g=g&&!b,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(g&&d){for(var x=e,w=r,k=0;k<s;++k)l[k]=k;return[x,[s,h],w,c,l]}for(var S=p[u-1],C=lC(n,S*h),I=lC(a,S),T=new Array(u).fill(0),_=0;_<s;++_){var E=e[_*h],N=T[E],R=(0===E?0:p[E-1])+N;T[E]++;for(var A=0;A<h;++A)C[R*h+A]=e[_*h+A];I[R]=r[_],l[_]=R}for(var O=0;O<u;++O){if(0===T[O]){var D=0===O?0:p[O-1];C[D*h+0]=O;for(var P=1;P<h;++P)C[D*h+P]=0;I[D]=o}}return[C,[S,h],I,c,l]},V0=function(e,t,n,r,a){for(var i,o,s=JS(r),u=t[0],c=a.length,l=[],h=1,d=-1,f=0;f<c;++f){var p=a[f];if(-1===p){if(-1!==d)throw new Error((o=f,"only one output dimension may be -1, not both ".concat(d," and ").concat(o)));d=f,l.push(1)}else{if(p<0)throw new Error((i=p,"size ".concat(f," must be non-negative, not ").concat(i)));h*=p,l.push(p)}}if(-1!==d){if(h<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var m=Math.trunc(s/h);if(h*m!==s)throw new Error(function(e,t){var n=JS(e),r=JS(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}(r,l));l[d]=m}if(JS(l)!==s)throw new Error(function(e,t){var n=JS(e),r=JS(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}(r,l));var v=r.length,g=[];if(v>0){g[v-1]=1;for(var y=v-2;y>=0;--y)g[y]=g[y+1]*r[y+1]}var b=[];if(c>0){b[c-1]=1;for(var x=c-2;x>=0;--x)b[x]=b[x+1]*l[x+1]}for(var w=lC(n,u*c),k=0;k<u;++k){for(var S=0,C=0;C<v;++C)S+=e[k*v+C]*g[C];for(var I=0;I<c;++I)w[k*c+I]=Math.trunc(S/b[I]),S%=b[I]}return[w,[u,c],l]},U0=function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=r.length,u=[t[0],e.length/t[0]],c=u[1],l=s>0?a[s-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");var h=t.slice();h[0]=l;var d=lC(n,h.reduce((function(e,t){return e*t}),1));if(0===s)return l>0&&d.fill(o),[d,h];if(l<=0)throw new Error("segment ids must be >= 0");for(var f=0,p=1,m=0,v=a[f];;){var g=0;if(p<s){if(v===(g=a[p])){++p;continue}if(v>=g)throw new Error("segment ids are not increasing")}if(v<0||v>=l)throw new Error(oz(v,l));v>m&&d.fill(o,m*c,v*c);for(var y=f;y<p;++y){var b=r[y];if(b<0||b>=u[0])throw new Error(sz(y,r[y],u[0]));for(var x=0;x<c;x++)d[v*c+x]+=e[b*c+x]}if(i)for(var w=0;w<c;w++)d[v*c+w]/=p-f;if(f=p,m=v+1,v=g,++p>s)break}return m<l&&d.fill(o,m*c,l*c),[d,h]},W0=t0,j0=n0,G0=aj,H0=oj,K0=function(e,t,n){for(var r=e.length,a=[],i=0,o=0,s=new Array(r),u=0;u<r;++u){var c=a.length;r0(e[u],t,n,a);var l=a.length-c;s[u]=l,i+=l,o=Math.max(o,l)}for(var h=lC("int32",2*i),d=new Array(i),f=[r,o],p=0,m=0;m<r;++m)for(var v=0;v<s[m];++v)h[2*p]=m,h[2*p+1]=v,d[p]=a[p],++p;return[h,d,f]},q0=function(e,t){for(var n=lC("int32",e.length),r=0;r<e.length;++r)n[r]=dE(e[r]).modulo(t).getLowBitsUnsigned();return n},Z0=sj,X0=cj,Y0=dj,Q0=QW,$0=fj;function J0(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function e1(e,t){return 1===t?[e]:J0(e,t)}var t1=function(){function e(t){if(Se(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=TJ(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=e1("rc",this.rank),r=bJ(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return Te(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),n1=Te((function e(t,n){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?oJ(["r","c","d"],"inputShape"):aJ(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sJ(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var r1=function(){function e(t){Se(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}return Te(e,[{key:"acquireTexture",value:function(e,t,n){var r=i1(t,n),a=o1(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=a1(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].pop();return this.usedTextures[a].push(s),s}return r===k$.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===k$.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===k$.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===k$.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===k$.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=i1(n,r),i=o1(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=a1(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=RC().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u&&u.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function a1(e,t,n,r,a){var i,o=function(e,t){switch(e){case k$.PACKED_2X2_FLOAT32:return UJ(t);case k$.PACKED_2X2_FLOAT16:return WJ(t);case k$.UNPACKED_FLOAT32:return zJ(t);case k$.UNPACKED_FLOAT16:return BJ(t);case k$.PACKED_4X1_UNSIGNED_BYTE:return VJ(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=N$(e[0],e[1]),u=(0,U.Z)(s,2);i=u[0]*u[1]}else{var c=_$(e[0],e[1]),l=(0,U.Z)(c,2);i=l[0]*l[1]}var h=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*h}function i1(e,t){if(e===w$.UPLOAD)return k$.PACKED_2X2_FLOAT32;if(e===w$.RENDER||null==e)return function(e){return RC().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?k$.PACKED_2X2_FLOAT32:k$.UNPACKED_FLOAT32:e?k$.PACKED_2X2_FLOAT16:k$.UNPACKED_FLOAT16}(t);if(e===w$.DOWNLOAD||e===w$.PIXELS)return k$.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function o1(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var s1=Te((function e(t,n){Se(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),u1="if (isnan(x)) return x;",c1="return x;",l1="return abs(x);";var h1="return (x >= 0.0) ? x : (exp(x) - 1.0);",d1=u1+"\n  return (x < 0.0) ? 0.0 : x;\n",f1=u1+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",p1="return x;",m1="return 1.0 / (1.0 + exp(-1.0 * x));",v1="return x;",g1="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",y1="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",b1="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",x1="return 1.0 / (1.0 + exp(-1.0 * x));",w1=Te((function e(t,n){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),k1=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length);var n=t.length,r=e1("rc",n),a=bJ(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),S1=HM,C1={};var I1=RC().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var T1=function(e){be(n,e);var t=we(n);function n(e){var r,a,i;if(Se(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!RC().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof GJ)a=e;else{var o=T$(RC().getNumber("WEBGL_VERSION"),e);a=new GJ(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var s=T$(RC().getNumber("WEBGL_VERSION"));a=new GJ(s),r.binaryCache=((i=RC().getNumber("WEBGL_VERSION"))in C1||(C1[i]={}),C1[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new r1(r.gpgpu),r.numMBBeforeWarning=null==RC().global.screen?1024:RC().global.screen.height*RC().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new GS(xe(r),NR()),r}return Te(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];var u=Z$(t),c=new OJ(u,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if((RC().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||RC().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:w$.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(RC().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:w$.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new w1(o,p1):new s1(o,p1);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,d,f=null!=this.activeTimers;(f&&(h=mE()),"complex64"===r)?d=GF(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):d=this.getValuesFromTexture(e);return f&&(this.downloadWaitMs+=mE()-h),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:function(){var e=N(T().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,x,w,k,S,C;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new w1(i,p1):new s1(i,p1),h=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),d=this.read(h.dataId),this.disposeIntermediateTensorInfo(h),e.abrupt("return",d);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!RC().getBool("DEBUG")){e.next=16;break}if(RC().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==RC().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(f=null,"complex64"!==s&&RC().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),v=this.texData.get(p.dataId),f=(m=this.gpgpu).createBufferFromTexture.apply(m,[v.texture.texture].concat((0,ke.Z)(E$(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==s){e.next=31;break}return e.next=25,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 25:y=e.sent,b=y[0],x=y[1],g=GF(b,x),e.next=32;break;case 31:null==f?g=this.getValuesFromTexture(t):(w=JS(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(f,w));case 32:return null!=p&&this.disposeIntermediateTensorInfo(p),null!=f&&A$(k=this.gpgpu.gl,(function(){return k.deleteBuffer(f)})),S=this.convertAndCacheOnCPU(t,g),C=this.pendingRead.get(t),this.pendingRead.delete(t),C.forEach((function(e){return e(S)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&NR().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",S);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.isPacked,u=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=s?new w1(a,p1):new s1(a,p1);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),h=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),h}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var d=this.decode(e,t.customTexShape),f=NR().makeTensorFromTensorInfo(d),p=this.texData.get(d.dataId);return Object.assign({tensorRef:f},p.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return gE(e)}));return IR(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return IR(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!O$(n)){if(RC().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=JS(n);if(RC().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture.texture].concat((0,ke.Z)(E$(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=RC().getBool("WEBGL_PACK")&&!0===a,h=l?Z$(n):n,d=l?new RJ(h):new NJ(h),f=this.runWebGLProgram(d,[{shape:h,dtype:r,dataId:e}],"float32"),p=this.texData.get(f.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}},{key:"timerAvailable",value:function(){return RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=bE(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=bE(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return N(T().mark((function e(){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,s.kernelMs=XS(n),s.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:mE(),endMs:null}}},{key:"endTimer",value:function(e){return RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=mE(),e)}},{key:"getQueryTime",value:function(){var e=N(T().mark((function e(t){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(RC().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e).complexTensorInfos;return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I1;return RC().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&JS(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){G_("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return S1(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new w1(e.shape,t),a=this.compileAndRun(r,[e],n);return NR().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=F0(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(RC().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,l1,e.dtype);var n=new s1(e.shape,l1),r=this.compileAndRun(n,[e]);return NR().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&fC(n[0])){var a=n.map((function(e){return vE(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return NR().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new k1(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new t1(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[K$(e.shape)].concat((0,ke.Z)(q$(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[K$(t)].concat((0,ke.Z)(q$(t))),i=new n1(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;null!=t&&YS(JS(a)<=t[0]*t[1]*4,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}));var o,s=Z$(a);o=r?new EJ(s):new _J(s);var u=[null!=t?t:E$(s)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,u,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===x$.DENSE){var c=null!=o?o:E$(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===JS(s.shape))return u.values=cC(s.dtype,0),s;var l=[],h=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&JS(t.shape)<=RC().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!Y$(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var d,f={shape:s.shape,texData:u,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=xJ(e.packedInputs,t.shape,i),s=o.useSqueezeShape,u=o.uniformShape,c=o.keptDims,l="",h="",d="";if(1===u.length&&e.packedInputs){var f=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(f[0]>1,"_").concat(f[1]>1)}else if(2!==u.length||e.packedInputs){if(u.length>2&&!e.packedInputs){var p=gC(u);d="".concat(p[0]===i[1],"_").concat(p[p.length-1]===i[1])}}else h="".concat(u[0]>1,"_").concat(u[1]>1);var m=t.shape.length,v=2===u.length&&tC(t.shape,i),g=1===JS(t.shape),y=aA(t.shape,n.shape),b=!e.packedInputs&&m===n.shape.length&&tC(i,n.texData.texShape),x=e.packedInputs||u.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(m,"_").concat(b,"_").concat(s?c:"","_").concat(u.length,"_").concat(g,"_").concat(y,"_").concat(v,"_").concat(l,"_").concat(h,"_").concat(d,"_").concat(x,"_").concat(a)}else{var w=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(w,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+"_"+r+"_"+a+"".concat(RC().getNumber("WEBGL_VERSION"))}(e,h,f),m=this.getAndSaveBinary(p,(function(){return SJ(a.gpgpu,e,h,f)})),v=null!=this.activeTimers;v&&(d=this.startTimer()),RC().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(IJ(t.inShapeInfos,n),IJ([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===RC().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(var s=0;s<n.length;++s){var u=n[s],c=t.variablesLocations[s],l=c.uniform,h=c.offset,d=c.shape,f=c.texShape;if(d){var p=xJ(t.program.packedInputs,u.shape,u.texData.texShape).uniformShape;switch(p.length){case 1:e.gl.uniform1iv(d,new Int32Array(p));break;case 2:e.gl.uniform2iv(d,new Int32Array(p));break;case 3:e.gl.uniform3iv(d,new Int32Array(p));break;case 4:e.gl.uniform4iv(d,new Int32Array(p))}}if(f&&e.gl.uniform2i(f,u.texData.texShape[0],u.texData.texShape[1]),null!=l)if(u.isUniform)if(JS(u.shape)<2)e.gl.uniform1f(l,u.uniformValues[0]);else{var m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),e.gl.uniform1fv(l,m)}else null!=u.texData.slice&&null!=h&&e.gl.uniform1i(h,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,l,s)}var v=t.outShapeLocation;if(v)switch(r.shape.length){case 1:e.gl.uniform1iv(v,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(v,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(v,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(v,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var g=gC(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(g));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(g));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(g))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(var y=0;y<t.program.customUniforms.length;++y){var b=t.program.customUniforms[y],x=t.customUniformLocations[y],w=a[y];if("float"===b.type)e.gl.uniform1fv(x,w);else if("vec2"===b.type)e.gl.uniform2fv(x,w);else if("vec3"===b.type)e.gl.uniform3fv(x,w);else if("vec4"===b.type)e.gl.uniform4fv(x,w);else if("int"===b.type)e.gl.uniform1iv(x,w);else if("ivec2"===b.type)e.gl.uniform2iv(x,w);else if("ivec3"===b.type)e.gl.uniform3iv(x,w);else{if("ivec4"!==b.type)throw Error("uniform type ".concat(b.type," is not supported yet."));e.gl.uniform4iv(x,w)}}e.executeProgram()}(this.gpgpu,m,h,f,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),v&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));var g=RC().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){var y=mE();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!RC().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===i){var b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!RC().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=RR((function(){if(!RC().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=RC().getBool("DEBUG");RC().set("DEBUG",!1);var n=e.abs(GR(1e-8)).dataSync()[0];if(RC().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=mE());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=RC().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=RC().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&RC().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?qS(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=uC(e);e=a.newShape}var i=JS(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);var s=null!=o&&Math.max.apply(Math,(0,ke.Z)(o))>r&&Math.min.apply(Math,(0,ke.Z)(o))<=(t?2:1)&&Math.min.apply(Math,(0,ke.Z)(o))>0;if(null==o||s)if(t){var u=K$(e),c=2,l=2;if(e.length){var h=q$(e),d=(0,U.Z)(h,2);c=d[0],l=d[1]}o=rC(i=u*(c/2)*(l/2)).map((function(e){return 2*e}))}else o=rC(i);return o}(n,s),t.texShape=l),null!=a){var h,d=Z$(n),f=l[1],p=l[0],m=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(s||!m){var v=N$(l[0],l[1]),g=(0,U.Z)(v,2);f=g[0],p=g[1]}h=s?new DJ(d,m):new OJ(d,m);var y=m?[p,f]:l,b=this.makeTensorInfo(y,r),x=this.texData.get(b.dataId);x.usage=m?w$.PIXELS:w$.UPLOAD,x.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),f,p,a);var w=[[p,f]],k=this.runWebGLProgram(h,[b],r,w,!0),S=this.texData.get(k.dataId);t.texShape=S.texShape,t.isPacked=S.isPacked,t.usage=S.usage,RC().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(t.texture=S.texture,t.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(b),c&&(this.uploadWaitMs+=mE()-u)}else{var C=this.acquireTexture(l,o,r,s);t.texture=C}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*dC(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=(0,U.Z)(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i,o,s,u,c=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=(0,U.Z)(r[n],2),i=a[1],t.push(this.checkCompletionAsync_(i));return e.abrupt("return",Promise.all(t));case 6:o=T().mark((function e(){var n,r,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,U.Z)(u[s],2),r=n[1],a=new Promise((function(e){try{c.checkCompletion_(r),e(!0)}catch(t){throw t}})),t.push(a);case 3:case"end":return e.stop()}}),e)})),s=0,u=Object.entries(this.binaryCache);case 8:if(!(s<u.length)){e.next=13;break}return e.delegateYield(o(),"t0",10);case 10:s++,e.next=8;break;case 13:return e.abrupt("return",Promise.all(t));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=N(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,new Promise((function(e){return CF((function(){return e()}))}));case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw F$(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.values(this.binaryCache);e<t.length;e++){var n=t[e];this.gpgpu.buildVao(n.webGLProgram);var r=CJ(this.gpgpu,n.program,n.webGLProgram),a=r.variablesLocations,i=r.customUniformLocations,o=r.infLoc,s=r.nanLoc,u=r.outShapeLocation,c=r.outShapeStridesLocation,l=r.outTexShapeLocation;n.variablesLocations=a,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=s,n.outShapeLocation=u,n.outShapeStridesLocation=c,n.outTexShapeLocation=l}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,s=NR().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var u=s.writeTexture(r,t,n,a,i,o);return NR().makeTensorFromDataId(u,t,n,s)}}]),n}(HS);T1.nextDataId=0,nN()&&PR("webgl",(function(){return new T1}),2);var _1="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",E1=Te((function e(t,n,r){Se(this,e),this.variableNames=["A","B"],this.outputShape=iA(n,r),this.enableShapeUniforms=TJ(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),N1="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",R1=Te((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Se(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=iA(n,r);var i=this.outputShape.length;this.enableShapeUniforms=TJ(i);var o="";if(a)if(0===i||1===JS(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=bJ(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=e1("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function A1(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var O1={kernelName:ZI,backendName:"webgl",kernelFunc:A1};function D1(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=A1({inputs:{x:r},backend:n}),u=A1({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var P1={kernelName:sI,backendName:"webgl",kernelFunc:D1},M1="return (a < 0.) ? b * a : a;",L1="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var F1={kernelName:eT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",fE(i,"float32")),s=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new R1(L1,a.shape,o.shape):new E1(M1,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),u}},z1="return (a < 0.) ? b * a : a;",B1="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var V1={kernelName:MT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new R1(B1,r.shape,a.shape):new E1(z1,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},U1="if (isnan(x)) return x;";function W1(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var h=c.texData.get(u.dataId),d=r(h.values,l);return c.makeTensorInfo(u.shape,l,d)}return i=RC().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new w1(u.shape,n):new s1(u.shape,t),c.runWebGLProgram(i,[u],l)}}function j1(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,h=i;if(o&&"complex64"===c.dtype){var d=h.texData.get(c.dataId),f=h.texData.get(l.dataId),p=[[d.complexTensorInfos.real,f.complexTensorInfos.real],[d.complexTensorInfos.imag,f.complexTensorInfos.imag]].map((function(e){var n=(0,U.Z)(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},s=new E1(t,c.shape,l.shape);return h.runWebGLProgram(s,[i,o],UE(r.dtype,a.dtype))})),m=(0,U.Z)(p,2),v=m[0],g=m[1],y=D1({inputs:{real:v,imag:g},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(g),y}var b,x=u||UE(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||h.shouldExecuteOnCPU([c,l]))&&null!=s){var w=h.texData.get(c.dataId).values,k=h.texData.get(l.dataId).values,S="string"===c.dtype?lz(w):w,C="string"===c.dtype?lz(k):k,I=s(c.shape,l.shape,S,C,x),T=(0,U.Z)(I,2),_=T[0],E=T[1],N=h.makeTensorInfo(E,x);return h.texData.get(N.dataId).values=_,N}return b=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new R1(n,c.shape,l.shape,a):new E1(t,c.shape,l.shape),h.runWebGLProgram(b,[c,l],x)}}function G1(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?v1:c1;if("relu"===e)return t?y1:d1;if("elu"===e)return t?g1:h1;if("relu6"===e)return t?b1:f1;if("prelu"===e)return t?B1:z1;if("leakyrelu"===e)return t?L1:M1;if("sigmoid"===e)return t?x1:m1;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var H1=Te((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Se(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=TJ(this.outputShape.length);var l=a?t[1]:t[2],h=Math.ceil(l/2),d=a?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],v="",g="";s&&(v=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),g="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var b="rc.x",x="rc.x";t[0]<n[0]?b="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(x="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(v,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(h,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(h,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(f,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(m[0],");\n          result += (").concat(p[1]," * ").concat(m[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")})),K1={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},q1=Te((function e(t,n,r){Se(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=iA(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),Z1="return a * b;";function X1(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=UE(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new q1(K1.REAL,a.shape,i.shape),l=new q1(K1.IMAG,a.shape,i.shape),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],d=r.runWebGLProgram(c,h,"float32"),f=r.runWebGLProgram(l,h,"float32"),p=D1({inputs:{real:d,imag:f},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),p}if(r.shouldExecuteOnCPU([a,i])){var m=r.texData.get(a.dataId),v=r.texData.get(i.dataId),g=T0(a.shape,i.shape,m.values,v.values,o),y=(0,U.Z)(g,2),b=y[0],x=y[1],w=r.makeTensorInfo(x,o);return r.texData.get(w.dataId).values=b,w}return t=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new R1(Z1,a.shape,i.shape):new E1(Z1,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var Y1={kernelName:CT,backendName:"webgl",kernelFunc:X1};function Q1(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=JS(a.shape),u=oC(i,s),c=JS(u);YS(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||Y$(a.shape,u)||null!==l.texture&&Y$(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[K$(e.shape)].concat((0,ke.Z)(q$(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[K$(t)].concat((0,ke.Z)(q$(t))),o=new n1(i,r),s=[r],u=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(a,u,o)}var $1={kernelName:GT,backendName:"webgl",kernelFunc:Q1},J1=Te((function e(t,n){Se(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(nC(l)?l.toPrecision(2):l,", ones);")}var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),e2=Te((function e(t,n){Se(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),h=r%4,d="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),f="vec4";"all"===n?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===n&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}));function t2(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=EF(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],c=u.inSize,l=u.windowSize,h=u.outSize,d=void 0;d="mean"===n?0===o?new J1({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},c):new J1({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h}):new e2({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},n),s=i,i=r.runWebGLProgram(d,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var n2=Te((function e(t,n){Se(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=bJ(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var r2=Te((function e(t,n){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=bJ(this.rank),o=J0("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(l,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(l,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function a2(e,t,n){var r=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new r2(e.shape,t):new n2(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function i2(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=sC(a,e.shape),s=o,u=SD(s,i),c=null!=u,l=e;c&&(l=a2(e,u,r),s=ID(s.length,i)),kD("sum",s,i);var h=xD(l.shape,s),d=(0,U.Z)(h,2),f=d[0],p=d[1],m=f;n&&(m=wD(f,o));var v=JS(p),g=Q1({inputs:{x:l},attrs:{shape:[JS(e.shape)/v,v]},backend:r}),y=t2(g,WE(e.dtype),"sum",r),b=Q1({inputs:{x:y},attrs:{shape:m},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),c&&r.disposeIntermediateTensorInfo(l),b}(t.x,r.axis,r.keepDims,n)}var o2={kernelName:h_,backendName:"webgl",kernelFunc:i2};function s2(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var h=s.texData.get(i.dataId).values,d=Q0(h,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=d}else t=a2(i,o,s);return t}var u2={kernelName:D_,backendName:"webgl",kernelFunc:s2},c2=1e3;function l2(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,d=e.activation,f=void 0===d?null:d,p=t.shape.length,m=n.shape.length,v=r?t.shape[p-2]:t.shape[p-1],g=a?n.shape[m-1]:n.shape[m-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[m-2]:n.shape[m-1],x=t.shape.slice(0,-2),w=n.shape.slice(0,-2),k=JS(x),S=JS(w),C=iA(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);YS(v===g,(function(){return"Error in matMul: inner shapes (".concat(v,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var I,T=r?[k,v,y]:[k,y,v],_=a?[S,b,g]:[S,g,b],E=Q1({inputs:{x:t},backend:i,attrs:{shape:T}}),N=Q1({inputs:{x:n},backend:i,attrs:{shape:_}}),R=[E,N],A=Math.max(k,S),O=r?E.shape[1]:E.shape[2],D=null!=s,P=null!=c,M="leakyrelu"===f,L=null!=f?G1(f,!0):null;if((1===y||1===b)&&O>c2&&!1===(D||P||M||null!=L)){var F=E,z=N;r&&(F=s2({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),R.push(F)),a&&(z=s2({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),R.push(z));var B=1===b,V=F;1!==b&&(V=Q1({inputs:{x:F},backend:i,attrs:{shape:[A,O,1]}}),R.push(V));var U=1===b?2:1,W=z;B&&(W=Q1({inputs:{x:z},backend:i,attrs:{shape:[A,1,O]}}),R.push(W));var j=X1({inputs:{a:V,b:W},backend:i});I=i2({inputs:{x:j},backend:i,attrs:{axis:U,keepDims:!0}}),R.push(j)}else{var G=UE(t.dtype,n.dtype),H=new H1(T,_,[A,y,b],r,a,D,L,P,M),K=[E,N];if(null!=s&&K.push(s),P&&K.push(c),M){var q=i.makeTensorInfo([],"float32",fE(h,"float32"));K.push(q),R.push(q)}I=i.runWebGLProgram(H,K,G)}var Z=Q1({inputs:{x:I},backend:i,attrs:{shape:C}});R.push(I);for(var X=0,Y=R;X<Y.length;X++){var Q=Y[X];i.disposeIntermediateTensorInfo(Q)}return Z}var h2={kernelName:U_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return l2({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},d2="return abs(x);";var f2={kernelName:MC,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=F0(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=RC().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new w1(a.shape,d2):new s1(a.shape,d2),r.runWebGLProgram(t,[a],a.dtype)}},p2=W1({opSnippet:u1+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),m2={kernelName:LC,backendName:"webgl",kernelFunc:p2},v2=W1({opSnippet:u1+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),g2={kernelName:FC,backendName:"webgl",kernelFunc:v2},y2="return a + b;",b2=j1({opSnippet:y2,packedOpSnippet:y2,supportsComplex:!0,cpuKernelImpl:a0}),x2={kernelName:zC,backendName:"webgl",kernelFunc:b2},w2=Te((function e(t,n){Se(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),k2=Te((function e(t,n){Se(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var S2={kernelName:BC,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return A1({inputs:{x:a[0]},backend:r});if(a.length>RC().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return UE(e,t)})),c=a.map((function(e){return e.shape})),l=RC().getBool("WEBGL_PACK")?new k2(a[0].shape,c):new w2(a[0].shape,c);return r.runWebGLProgram(l,a,u)}};var C2={kernelName:VC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=sC(i,a.shape),c=u,l=SD(c,s),h=a;null!=l&&(h=s2({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ID(c.length,s)),kD("all",c,s);var d,f=xD(h.shape,c),p=(0,U.Z)(f,2),m=p[0],v=Q1({inputs:{x:h},backend:n,attrs:{shape:[-1,JS(p[1])]}}),g=t2(v,v.dtype,"all",n);return d=Q1(o?{inputs:{x:g},backend:n,attrs:{shape:wD(m,u)}}:{inputs:{x:g},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}};var I2={kernelName:UC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=sC(i,a.shape),c=u,l=SD(c,s),h=a;null!=l&&(h=s2({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ID(c.length,s)),kD("any",c,s);var d,f=xD(h.shape,c),p=(0,U.Z)(f,2),m=p[0],v=Q1({inputs:{x:h},backend:n,attrs:{shape:[-1,JS(p[1])]}}),g=t2(v,v.dtype,"any",n);return d=Q1(o?{inputs:{x:g},backend:n,attrs:{shape:wD(m,u)}}:{inputs:{x:g},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}},T2=Te((function e(t,n,r){Se(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),_2=Te((function e(t,n,r,a){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,YS(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,h=bJ(l),d=e1("coords",l);if(1===o){var f=bJ(u=l+1);s="\n        ".concat(f," sourceLocR = ").concat(f,"(").concat(d.join(),", 0);\n        ++").concat(d[l-1],";\n        ").concat(f," sourceLocG = ").concat(f,"(").concat(d.join(),", 0);\n        ++").concat(d[l-2],";\n        ").concat(f," sourceLocA = ").concat(f,"(").concat(d.join(),", 0);\n        --").concat(d[l-1],";\n        ").concat(f," sourceLocB = ").concat(f,"(").concat(d.join(),", 0);\n        --").concat(d[l-2],";")}else u=l,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(d[l-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(d[l-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(d[l-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(d[l-2],";");var p=["x","y","z","w","u","v"].slice(0,u),m="."+p[u-1],v=p.map((function(e){return"int "+e})),g=e1("sourceLocR",u-1).concat("inIdx.r"),y=e1("sourceLocG",u-1).concat("inIdx.g"),b=e1("sourceLocB",u-1).concat("inIdx.b"),x=e1("sourceLocA",u-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",k=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),S="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),C=a?"":"\n      float getBestIndicesAChannel(".concat(v.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(v.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(C,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(d[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(d[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(S,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(k,"\n          vec4 candidate = ").concat(S,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function E2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=EF(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new T2(s,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;var h=E2(e,t,n,l);return e.disposeIntermediateTensorInfo(l),h}function N2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=EF(a[a.length-1]),o=new _2(a,i,n,null==r),s=null==r?[t]:[t,r],u=e.runWebGLProgram(o,s,"int32");if(u.shape.length===t.shape.length){var c=N2(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function R2(e,t,n,r){var a=[n];if(kD("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!RC().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=e.texData.get(t.dataId),s=t;null!==o&&o.isPacked&&(s=e.unpackTensor(t),i.push(s));var u=xD(s.shape,a),c=(0,U.Z)(u,2),l=c[0],h=JS(c[1]),d=Q1({inputs:{x:s},backend:e,attrs:{shape:[-1,h]}});i.push(d);var f=E2(e,d,r);i.push(f);var p=Q1({inputs:{x:f},backend:e,attrs:{shape:l}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),p}return N2(e,t,r)}var A2={kernelName:WC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=sC(r.axis,a.shape),o=SD(i,a.shape.length),s=a,u=[];null!=o&&(s=s2({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=ID(i.length,s.shape.length)),kD("argMax",[i[0]],s.shape.length);var c=R2(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}};var O2={kernelName:jC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=sC(r.axis,a.shape),o=SD(i,a.shape.length),s=a,u=[];null!=o&&(s=s2({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=ID(i.length,s.shape.length)),kD("argMin",[i[0]],s.shape.length);var c=R2(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},D2=W1({opSnippet:u1+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),P2={kernelName:GC,backendName:"webgl",kernelFunc:D2},M2=W1({opSnippet:u1+"return log(x + sqrt(x * x + 1.0));"}),L2={kernelName:HC,backendName:"webgl",kernelFunc:M2},F2=W1({opSnippet:u1+"\n  return atan(x);\n"}),z2={kernelName:KC,backendName:"webgl",kernelFunc:F2},B2=j1({opSnippet:_1+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+N1+"\n  return result;\n"}),V2={kernelName:ZC,backendName:"webgl",kernelFunc:B2},U2=W1({opSnippet:u1+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),W2={kernelName:qC,backendName:"webgl",kernelFunc:U2},j2=Te((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Se(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var m="avg"===n,v="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(m||(y="-1.0 / 1e-20"),r){this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(f,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?v:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var b="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(b="avgValue / max(count, 1.0)");var x=4*Math.floor(o/4),w=o%4,k="\n      if (".concat(m,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(k,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(2===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(3===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(k,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}})),G2=Te((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Se(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,h=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,v=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,x="0.0";if(b||(x="-1.0 / 1e-20"),r){this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(f,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(m,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(m," +\n                      wR * ").concat(m," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / max(count, 1.0)");var k=4*Math.floor(o/4),S=o%4,C="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(k,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(k,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}}));var H2={kernelName:XC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;tJ(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;YS(wO(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=hO(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&tC(c.inShape,c.outShape))return A1({inputs:{x:a},backend:n});var l=new j2(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var K2={kernelName:QC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=dO(a.shape,i,o,[1,1,1],s,u,c),h=new G2(l,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},q2=Te((function e(t){Se(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=u-1-t.padInfo.top,h=c-1-t.padInfo.left,d=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(h,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Z2=Te((function e(t){Se(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=h-1-t.padInfo.front,m=d-1-t.padInfo.top,v=f-1-t.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(m,", ").concat(v,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var X2={kernelName:$C,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=dO(i.shape,o,s,[1,1,1],u,c),h=new Z2(l);return n.runWebGLProgram(h,[a],i.dtype)}};var Y2={kernelName:YC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;tJ([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=hO(o.shape,s,u,1,c),h=new q2(l);return n.runWebGLProgram(h,[a],o.dtype)}};var Q2={kernelName:JC,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return l2({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},$2=Te((function e(t,n,r,a,i,o){Se(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],iA(t,n),iA(t,r);var s="0.0";null!=a&&(iA(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(iA(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),J2=Te((function e(t,n,r,a,i,o){Se(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],iA(t,n),iA(t,r);var s="vec4(0.0)";null!=a&&(iA(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(iA(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),e3={kernelName:jI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;YS(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),YS(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),YS(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],h=null;null!=s&&(h=s.shape,l.push(s));var d=null;null!=u&&(d=u.shape,l.push(u));var f=RC().getBool("WEBGL_PACK_NORMALIZATION")?new J2(a.shape,i.shape,o.shape,h,d,c):new $2(a.shape,i.shape,o.shape,h,d,c);return n.runWebGLProgram(f,l,l[0].dtype)}},t3=Te((function e(t){Se(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=bJ(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return n3.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(n3[t]," = start[").concat(t,"] + coords.").concat(n3[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),n3=["x","y","z","w","u","v"];var r3=Te((function e(t){Se(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=bJ(this.rank),r=e1("coords",this.rank),a=e1("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}));function a3(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=XA(a,r.begin,r.size),o=(0,U.Z)(i,2),s=o[0],u=o[1];if(HA(a,s,u),0===JS(u))return n.makeTensorInfo(u,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var c=n.texData.get(a.dataId),l=z0(c.values,s,u,a.shape,a.dtype);return n.makeTensorInfo(u,a.dtype,l)}var h=n.texData.get(a.dataId).isPacked,d=qA(a.shape,s,u);if(h||!d){var f=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new r3(u):new t3(u),p=[s];return n.runWebGLProgram(f,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=ZA(t,gC(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,s,u,n)}var i3={kernelName:a_,backendName:"webgl",kernelFunc:a3},o3={kernelName:eI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;YS(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=RF(a.shape,i,s),c=AF(u.length,i.length),l=OF(a.shape,i,s),h=DF(o,i.length),d=PF(l,o,i.length),f=[],p=Q1({inputs:{x:a},backend:n,attrs:{shape:u}}),m=s2({inputs:{x:p},backend:n,attrs:{perm:c}}),v=Q1({inputs:{x:m},backend:n,attrs:{shape:l}}),g=a3({inputs:{x:v},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(v),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var s3={kernelName:tI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=i0(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var u3={kernelName:nI,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=RC().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([a,i])||1===s){var u=r.texData.get(a.dataId).values,c=r.texData.get(i.dataId).values,l=s0(a.shape,i.shape,u,c,a.dtype),h=(0,U.Z)(l,2),d=h[0],f=h[1],p=r.makeTensorInfo(f,a.dtype);return r.texData.get(p.dataId).values=d,p}return t=o?new R1("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,i.shape,!1):new E1("\n  return float(int(a.r) & int(b.r));\n",a.shape,i.shape),r.runWebGLProgram(t,[a,i],a.dtype)}};var c3={kernelName:rI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=iA(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},l3=j1({opSnippet:"return float(a != b);",cpuKernelImpl:E0,dtype:"bool"}),h3={kernelName:TT,backendName:"webgl",kernelFunc:l3};function d3(e){var t=e.inputs,n=e.backend,r=t.input;return A1({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var f3={kernelName:UT,backendName:"webgl",kernelFunc:d3},p3="return float(int(x));";var m3={kernelName:aI,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return A1({inputs:{x:i},backend:r});var s=pP(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=D1({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var l=d3({inputs:{input:i},backend:r}),h=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),h}if(!hC(i.dtype,o)){var d=A1({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var f=r.texData.get(i.dataId).values,p=u0(f,i.shape,i.dtype,o),m=(0,U.Z)(p,3),v=m[0],g=m[1],y=m[2];return r.makeTensorInfo(v,g,y)}if("int32"===o)return function(e,t){var n=new s1(e.shape,p3),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var b=r.makeTensorInfo([],"bool",cC("bool",1)),x=l3({inputs:{a:i,b:b},backend:r});return r.disposeIntermediateTensorInfo(b),x}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},v3="return ceil(x);",g3=W1({opSnippet:v3,packedOpSnippet:v3,cpuKernelImpl:c0}),y3={kernelName:iI,backendName:"webgl",kernelFunc:g3},b3=Te((function e(t){Se(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),x3=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var w3={kernelName:oI,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax;t=RC().getBool("WEBGL_PACK_CLIP")?new x3(i.shape):new b3(i.shape);var u=[[o],[s]];return r.runWebGLProgram(t,[i],i.dtype,u)}},k3=Te((function e(t){Se(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function S3(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var C3={kernelName:uI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new k3(r.shape),o=[S3(r,a.complexTensorInfos.real),S3(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},I3=Te((function e(t){Se(this,e),this.outputShape=[],this.outputShape=TF(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),T3=Te((function e(t,n){Se(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=TF(t,n);var r=this.outputShape,a=r.length,i=bJ(a),o=e1("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],h=s.slice(-2),d=s.join(),f="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(d,"), vec2(").concat(h.join(),"));\n        }"),p=1;p<u.length;p++){var m=u[p-1];f+="\n        if (".concat(l," < ").concat(u[p],"  && ").concat(l," >= ").concat(u[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(_3(s,l,m),"),\n            vec2(").concat(_3(h,l,m),"));\n        }")}var v=u.length,g=u[u.length-1];f+="\n        return getChannel(\n          getT".concat(v,"(").concat(_3(s,l,g),"),\n          vec2(").concat(_3(h,l,g),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(f,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function _3(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function E3(e){var t=e.inputs,n=e.backend,r=t.input;return A1({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var N3={kernelName:YI,backendName:"webgl",kernelFunc:E3};function R3(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return d3({inputs:{input:e},backend:n})})),i=e.map((function(e){return E3({inputs:{input:e},backend:n})})),o=R3(a,t,n),s=R3(i,t,n),u=D1({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=JS(e.shape.slice(t));return Q1({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),h=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),d=TF(l.map((function(e){return e.shape})),1),f=1===l[0].shape[0],p=l0(h,d,r,f),m=TF(e.map((function(e){return e.shape})),t),v=n.makeTensorInfo(m,r,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}var g=e.filter((function(e){return JS(e.shape)>0})),y=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&g[0].shape.length>1;if(1===g.length){var b=y?new s1(e[0].shape,p1):new w1(e[0].shape,p1);return n.runWebGLProgram(b,e,r)}var x=RC().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(g.length>x){for(var w=[],k=0;k<g.length;k+=x){var S=g.slice(k,k+x);w.push(R3(S,t,n))}for(var C=R3(w,t,n),I=0,T=w;I<T.length;I++){var _=T[I];n.disposeIntermediateTensorInfo(_)}return C}if(y){var E=new T3(g.map((function(e){return e.shape})),t);return n.runWebGLProgram(E,g,r)}var N=function(e,t,n){var r=TF(e.map((function(e){return e.shape})),t),a=e.map((function(e){return Q1({inputs:{x:e},attrs:{shape:[-1,JS(e.shape.slice(t))]},backend:n})}));return{tensors2D:a,outShape:r}}(g,t,n),R=N.tensors2D,A=N.outShape,O=new I3(R.map((function(e){return e.shape}))),D=n.runWebGLProgram(O,R,r);R.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var P=Q1({inputs:{x:D},attrs:{shape:A},backend:n});return n.disposeIntermediateTensorInfo(D),P}function A3(e){var t=e.inputs,n=e.backend,r=sC(e.attrs.axis,t[0].shape)[0],a=t.map((function(e){return e.shape}));IF(a,r);var i=TF(t.map((function(e){return e.shape})),r);if(0===JS(i))return n.makeTensorInfo(i,t[0].dtype,[]);var o=t.filter((function(e){return JS(e.shape)>0}));return 1===o.length?A1({inputs:{x:o[0]},backend:n}):R3(o,r,n)}var O3={kernelName:cI,backendName:"webgl",kernelFunc:A3},D3=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Se(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),m=t.inChannels%4,v="channelsLast"===t.dataFormat,g=v?1:2,y=v?2:3,b=v?3:1,x="",w="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===m,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===m,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===m,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")})),P3=Te((function e(t){Se(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterDepth,d=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===m,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),M3=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Se(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=TJ(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",f=0;f<l;f++)d+="\n           vec4 xTexelC".concat(2*f,";\n           int xTexelC").concat(2*f,"Ready;\n           vec4 xTexelC").concat(2*f+1,";\n           int xTexelC").concat(2*f+1,"Ready;\n           vec4 xC").concat(f,";");d+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var p=0;p<l;p++)d+="\n           xTexelC".concat(2*p," = vec4(0.0);\n           xTexelC").concat(2*p,"Ready = 0;\n           xTexelC").concat(2*p+1," = vec4(0.0);\n           xTexelC").concat(2*p+1,"Ready = 0;\n           xC").concat(p," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var m=0;m<(h+1)/2;m++){var v=2*m;if(d+="\n           xC = xCCorner + ".concat(v*u,";\n           "),1===s){if(v<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(v,"Ready == 0) {\n                   xTexelC").concat(v," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(v,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(v,"Ready = 1;\n                 }\n               "),d+=1===u&&v>0?"\n                 xC".concat(v," = vec4(xTexelC").concat(v-2,".zw, xTexelC").concat(v,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(v," = vec4(previous.zw, xTexelC").concat(v,".xy);\n                   } else {\n                     xC").concat(v," = vec4(0.0, 0.0, xTexelC").concat(v,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(v,"Ready == 0) {\n                   xTexelC").concat(v," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(v,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(v,"Ready = 1;\n                 }\n\n                 xC").concat(v," = xTexelC").concat(v,";\n                 "),v+1<l)){var g=o%2===0?qS(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(g,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(v+1,"Ready == 0) {\n                     xTexelC").concat(v+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(v+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(v+1,"Ready = 1;\n                   }\n                   "),d+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(v+1," = vec4(previous.zw, xTexelC").concat(v+1,".xy);\n                     } else {\n                      xC").concat(v+1," = vec4(0.0, 0.0, xTexelC").concat(v+1,".xy);\n                     }\n                     "):"\n                     xC".concat(v+1," = vec4(xTexelC").concat(v,".zw, xTexelC").concat(v+1,".xy);\n                     ")):d+=1===g?"\n                     xC".concat(v+1," = xTexelC").concat(v,";\n                     "):"\n                     xCOffset = xC + ".concat(g,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(v+1,"Ready == 0) {\n                       xTexelC").concat(v+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(v+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(v+1,"Ready = 1;\n                     }\n\n                     xC").concat(v+1," = xTexelC").concat(v+1,";\n                     ")}}else v<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(v,"Ready == 0) {\n                   xTexelC").concat(v," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(v,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(v,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(v+1,"Ready == 0) {\n                   xTexelC").concat(v+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(v+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(v+1,"Ready = 1;\n                 }\n\n                 xC").concat(v," = vec4(xTexelC").concat(v,".zw, xTexelC").concat(v+1,".zw);\n               "),v+1<l&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(v+1," = vec4(xTexelC").concat(v+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(v,"Ready == 0) {\n                   xTexelC").concat(v," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(v,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(v,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(v+1,"Ready == 0) {\n                   xTexelC").concat(v+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(v+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(v+1,"Ready = 1;\n                 }\n\n                 xC").concat(v," = vec4(\n                   xTexelC").concat(v,".xy, xTexelC").concat(v+1,".xy);\n               "),v+1<l&&(d+="\n                   xC".concat(v+1," = vec4(xTexelC").concat(v,".zw, xTexelC").concat(v+1,".zw);\n                 "))));v<l&&(d+="\n             wTexel = getW(r, ".concat(v,", d1, d2);\n             dotProd += xC").concat(v,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(v,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),v+1<l&&(d+="\n               wTexel = getW(r, ".concat(v+1,", d1, d2);\n               dotProd += xC").concat(v+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(v+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";var y="",b="";r&&(y=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),b="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(y,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(x,"\n         ").concat(b,"\n         setOutput(result);\n       }\n     ")})),L3=Te((function e(t,n){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=TJ(this.outputShape.length);for(var r=n.dataFormat,a=rJ(),i="channelsLast"===r,o=i?1:2,s=i?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),c="",l=0;l<=1;l++)for(var h=0;h<=1;h++)c+="\n          blockIndex = rc.z + ".concat(h,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+h,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+h,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function F3(e,t){var n=e.length;return n>=3?[].concat((0,ke.Z)(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function z3(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,d=e.activation,f=void 0===d?null:d,p=n.shape,m=i.texData.get(n.dataId),v=a.inChannels,g=p[0]*p[1]*p[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[];if(null!=c){var w=F3(c.shape,b);null!=w&&(c=Q1({inputs:{x:c},backend:i,attrs:{shape:w}}),x.push(c))}if(null!=s){var k=F3(s.shape,b);null!=k&&(s=Q1({inputs:{x:s},backend:i,attrs:{shape:k}}),x.push(s))}if(!((1===g||1===y)&&v>c2)&&m.isPacked&&b&&null!=m.texture&&p[2]%2!==0&&tC(m.shape.slice(-3),p.slice(-3))){var S=p[0]*p[1]*(p[2]+1),C={dataId:n.dataId,shape:[1,S,a.inChannels],dtype:n.dtype},I=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,YS(Y$(m.shape,C.shape),(function(){return"packed reshape ".concat(m.shape," to ").concat(C.shape," isn't free")}));var T=Q1({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(T);var _=l2({a:C,b:T,backend:i,transposeA:!1,transposeB:false,bias:s,activation:f,preluActivationWeights:c,leakyreluAlpha:h}),E=i.texData.get(_.dataId);YS(E.isPacked,(function(){return"batchMatMul result is expected to be packed"})),m.shape=I,E.shape=a.outShape,(t=A1({inputs:{x:_},backend:i})).shape=a.outShape,x.push(_)}else{var N=a.outHeight*a.outWidth,R=Q1({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,N,a.inChannels]:[a.batchSize,a.inChannels,N]}}),A=Q1({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),O=l2({a:b?R:A,b:b?A:R,transposeA:!b,transposeB:false,backend:i,bias:s,activation:f,preluActivationWeights:c,leakyreluAlpha:h});t=Q1({inputs:{x:O},backend:i,attrs:{shape:a.outShape}}),x.push(R),x.push(A),x.push(O)}for(var D=0,P=x;D<P.length;D++){var M=P[D];i.disposeIntermediateTensorInfo(M)}return t}function B3(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,d=void 0===h?null:h,f=r.filterWidth,p=r.filterHeight,m=r.inChannels,v=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=f*p*m,x=g*v,w=[r.batchSize,b,x],k=[];if(null!=u){var S=F3(u.shape,y);null!=S&&(u=Q1({inputs:{x:u},backend:a,attrs:{shape:S}}),k.push(u))}if(null!=o){var C=F3(o.shape,y);null!=C&&(o=Q1({inputs:{x:o},backend:a,attrs:{shape:C}}),k.push(o))}var I=Q1({inputs:{x:n},backend:a,attrs:{shape:[1,b,JS(n.shape)/b]}});k.push(I);var T=new L3(w,r),_=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],E=a.runWebGLProgram(T,[t],"float32",_),N=Q1({inputs:{x:E},backend:a,attrs:{shape:w}});k.push(E),k.push(N);var R=null!=o,A=null!=u,O="leakyrelu"===d,D=d?G1(d,!0):null,P=new H1(y?N.shape:I.shape,y?I.shape:N.shape,y?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],!0,!1,R,D,A,O),M=y?[N,I]:[I,N];if(o&&M.push(o),A&&M.push(u),O){var L=a.makeTensorInfo([],"float32",fE(l,"float32"));M.push(L),k.push(L)}var F=a.runWebGLProgram(P,M,"float32"),z=Q1({inputs:{x:F},backend:a,attrs:{shape:r.outShape}});k.push(F);for(var B=0,V=k;B<V.length;B++){var U=V[B];a.disposeIntermediateTensorInfo(U)}return z}var V3={kernelName:lI,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,h=a.dimRoundingMode,d=SO(c),f=fO(i.shape,o.shape,s,l,u,h,!1,d);if(1!==f.filterHeight||1!==f.filterWidth||1!==f.dilationHeight||1!==f.dilationWidth||1!==f.strideHeight||1!==f.strideWidth||"SAME"!==f.padInfo.type&&"VALID"!==f.padInfo.type)if(f.strideWidth<=2&&"channelsLast"===d&&RC().getBool("WEBGL_EXP_CONV")){var p=new M3(f),m=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];t=r.runWebGLProgram(p,[i,o],"float32",m)}else if(RC().getBool("WEBGL_CONV_IM2COL"))t=B3({x:i,filter:o,convInfo:f,backend:r});else{var v=new D3(f);t=r.runWebGLProgram(v,[i,o],"float32")}else t=z3({x:i,filter:o,convInfo:f,backend:r});var g=Q1({inputs:{x:t},backend:r,attrs:{shape:f.outShape}});return r.disposeIntermediateTensorInfo(t),g}},U3=Te((function e(t){Se(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),W3=Te((function e(t){Se(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,h=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(h,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),j3=Te((function e(t){Se(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),G3=Te((function e(t){Se(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var H3={kernelName:hI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,h=SO(u),d=fO(a.shape,l,o,1,s,c,!1,h),f=new U3(d);return n.runWebGLProgram(f,[a,i],"float32")}},K3=Te((function e(t){Se(this,e),this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=TJ(this.outputShape.length);var n=t.filterHeight,r=t.filterWidth,a=n-1-t.padInfo.top,i=r-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}));var q3={kernelName:dI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,h=SO(c),d=fO(o,i.shape,s,1,u,l,!1,h);if(RC().getBool("WEBGL_PACK")&&"channelsLast"===h){var f=[[d.strideHeight,d.strideWidth]],p=new K3(d);return n.runWebGLProgram(p,[a,i],"float32",f)}var m=new W3(d);return n.runWebGLProgram(m,[a,i],"float32")}};var Z3={kernelName:fI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=pO(a.shape,i.shape,o,u,s),l=new P3(c);return n.runWebGLProgram(l,[a,i],"float32")}};var X3={kernelName:pI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=pO(a.shape,u,o,1,s),l=new j3(c);return n.runWebGLProgram(l,[a,i],"float32")}};var Y3,Q3={kernelName:mI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=pO(r.inputShape,i.shape,s,1,o),c=new G3(u);return n.runWebGLProgram(c,[a,i],"float32")}},$3=W1({opSnippet:U1+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(N1,"\n  return result;\n")}),J3={kernelName:vI,backendName:"webgl",kernelFunc:$3},e4=W1({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),t4={kernelName:gI,backendName:"webgl",kernelFunc:e4},n4=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=(0,U.Z)(t,4),s=o[0],u=o[1],c=o[2],l=o[3],h=(0,U.Z)(n,1)[0],d=(0,U.Z)(r,2),f=d[0],p=d[1];this.outputShape=[h,f,p,l];var m="bilinear"===a?1:0,v="".concat(u-1,".0"),g="".concat(c-1,".0"),y=f>1?["".concat((u-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(v," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(v)],b=(0,U.Z)(y,3),x=b[0],w=b[1],k=b[2],S=p>1?["".concat((c-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],C=(0,U.Z)(S,3),I=C[0],T=C[1],_=C[2];this.userCode="\n      const float height_ratio = float(".concat(x,");\n      const float width_ratio = float(").concat(I,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(w,";\n        float width_scale = ").concat(T,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(v," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(_,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),r4={kernelName:xI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new n4(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(Y3||(Y3={}));var a4=Te((function e(t,n,r,a){Se(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===Y3.Prod?"1.0":"0.0",s=r?o:"getX(".concat(i4(i,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1],c="",l="";r?(c=a?"end != ".concat(u-1):"end != 0",l=a?"end + 1":"end - 1"):(c=a?"end + pow2 < ".concat(u):"end >= pow2",l=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(bJ(i)," coords = getOutputCoords();\n        int end = ").concat(o4(i,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(o4(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(i4(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function i4(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function o4(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function s4(e,t,n,r,a,i){var o=t.shape.length,s=SD([r],o),u=t;null!=s&&(u=s2({inputs:{x:t},backend:n,attrs:{perm:s}}));var c=ID(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=u.shape[c],h=A1({inputs:{x:u},backend:n}),d=0;d<=Math.ceil(Math.log2(l))-1;d++){var f=new a4(e,u.shape,!1,i),p=[[d]],m=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(m)}if(a){var v=new a4(e,u.shape,a,i),g=h;h=n.runWebGLProgram(v,[h],h.dtype),n.disposeIntermediateTensorInfo(g)}if(null!=s){var y=s2({inputs:{x:h},backend:n,attrs:{perm:CD(s)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(u),y}return h}var u4={kernelName:yI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return s4(Y3.Prod,a,n,i,o,s)}};var c4={kernelName:bI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return s4(Y3.Sum,a,n,i,o,s)}};var l4={kernelName:wI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=i0(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var h=n.bufferSync(a),d=n.bufferSync(i),f=o0(h,d,o,s);return n.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},h4=function(){function e(t,n,r){Se(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return Te(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var d4={kernelName:kI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=new h4("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(h,[a],a.dtype)}},f4=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Se(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=TJ(this.outputShape.length);var o=t.filterHeight,s=t.filterWidth,u=t.outChannels/t.inChannels,c="",l="";r&&(c=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),l="result = activation(result);");var h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(h,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")})),p4=Te((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Se(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=TJ(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,d=h,f="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",p=0;p<h;p++)f+="\n          vec4 xTexelC".concat(2*p,";\n          int xTexelC").concat(2*p,"Ready;\n          vec4 xTexelC").concat(2*p+1,";\n          int xTexelC").concat(2*p+1,"Ready;\n          vec4 xC").concat(p,";");f+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(var m=0;m<h;m++)f+="\n          xTexelC".concat(2*m," = vec4(0.0);\n          xTexelC").concat(2*m,"Ready = 0;\n          xTexelC").concat(2*m+1," = vec4(0.0);\n          xTexelC").concat(2*m+1,"Ready = 0;\n          xC").concat(m," = vec4(0.0);");f+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var v=0;v<(d+1)/2;v++){var g=2*v;if(f+="\n          xC = xCCorner + ".concat(g*c,";\n          "),1===u){if(g<h&&(s%2===1?(f+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n              "),f+=1===c&&g>0?"\n                xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                  } else {\n                    xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                  }\n                  ")):f+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xC").concat(g," = xTexelC").concat(g,";\n                "),g+1<h)){var y=s%2===0?qS(c):c;c%2===0&&s%2===1||c%2!==0&&s%2!==1?(f+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                    xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(g+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(g+1,"Ready = 1;\n                  }\n                  "),f+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                    } else {\n                     xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                    }\n                    "):"\n                    xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                    ")):f+=1===y?"\n                    xC".concat(g+1," = xTexelC").concat(g,";\n                    "):"\n                    xCOffset = xC + ".concat(y,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                      xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(g+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(g+1,"Ready = 1;\n                    }\n\n                    xC").concat(g+1," = xTexelC").concat(g+1,";\n                    ")}}else g<h&&(s%2===1?(f+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n              "),g+1<h&&(f+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                "))):(f+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(\n                  xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n              "),g+1<h&&(f+="\n                  xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                "))));g<h&&(f+="\n            wTexel = getW(r, ".concat(g,", d1, q);\n            dotProd += xC").concat(g," * vec4(wTexel.xz, wTexel.xz);\n          "),g+1<h&&(f+="\n              wTexel = getW(r, ".concat(g+1,", d1, q);\n              dotProd += xC").concat(g+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}f+="\n    }\n  ",f+="\n      }\n    ";var b="",x="";r&&(b=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),x="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(f,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}));var m4={kernelName:SI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),YS(wO(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var h,d=fO(a.shape,i.shape,o,l,s,c,!0);h=RC().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new p4(d):new f4(d);var f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[a,i],"float32",f)}},v4=Te((function e(t){Se(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),g4=Te((function e(t){Se(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var y4={kernelName:CI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,h=fO(a.shape,l,o,s,u,c,!0),d=new v4(h);return n.runWebGLProgram(d,[a,i],"float32")}};var b4={kernelName:II,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=fO(r.inputShape,i.shape,o,s,u,c,!0),h=new g4(l);return n.runWebGLProgram(h,[a,i],"float32")}},x4=Te((function e(t){Se(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var w4={kernelName:TI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat((0,ke.Z)(r.shape),(0,ke.Z)(r.shape)),i=JS(r.shape),o=Q1({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new x4(i),u=n.runWebGLProgram(s,[o],o.dtype),c=Q1({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},k4=Te((function e(t){Se(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,h=a.top,d=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var S4={kernelName:_I,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=lO(i.shape,o.shape,s,u,"NHWC",c),h=new k4(l),d=Q1({inputs:{x:t=r.runWebGLProgram(h,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),d}};var C4={kernelName:RI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=QF(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;JF(i.length,s,r);for(var u=ez(o,s),c=u.path,l=u.steps,h=l.length,d=null,f=i.length,p=[],m=0;m<h;++m){var v,g=ye(l[m]);try{for(g.s();!(v=g.n()).done;){var y=v.value,b=$F(f,s[y]),x=b.permutationIndices,w=b.expandDims,k=void 0;tz(x)?k=r[y]:(k=s2({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),p.push(k));for(var S=k.shape.slice(),C=0;C<w.length;++C)S.splice(w[C],0,1);tC(k.shape,S)||(k=Q1({inputs:{x:k},backend:n,attrs:{shape:S}}),p.push(k)),null===d?d=k:(d=X1({inputs:{a:k,b:d},backend:n}),p.push(d))}}catch(N8){g.e(N8)}finally{g.f()}m<h-1&&(c[m]>=0&&(d=i2({inputs:{x:d},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(var I=0,T=p;I<T.length;I++){var _=T[I];_!==d&&n.disposeIntermediateTensorInfo(_)}return d}},I4=W1({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),T4={kernelName:AI,backendName:"webgl",kernelFunc:I4},_4={kernelName:OI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=RC().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new R1("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new E1("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},E4=j1({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:h0}),N4={kernelName:PI,backendName:"webgl",kernelFunc:E4},R4=W1({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(zF,";\n  float a1 = ").concat(BF,";\n  float a2 = ").concat(VF,";\n  float a3 = ").concat(UF,";\n  float a4 = ").concat(WF,";\n  float a5 = ").concat(jF,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),A4={kernelName:DI,backendName:"webgl",kernelFunc:R4},O4=W1({opSnippet:U1+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:d0,dtype:"float32"}),D4={kernelName:MI,backendName:"webgl",kernelFunc:O4};function P4(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(YS(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),Q1({inputs:{x:i},backend:r,attrs:{shape:s}})}var M4={kernelName:LI,backendName:"webgl",kernelFunc:P4},L4="return exp(x) - 1.0;",F4=W1({opSnippet:L4,packedOpSnippet:L4,cpuKernelImpl:f0}),z4={kernelName:FI,backendName:"webgl",kernelFunc:F4},B4=Te((function e(t,n,r){Se(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function V4(e,t,n){var r=n.texData.get(e.dataId),a=JS(e.shape),i=e.shape[e.shape.length-1],o=Q1({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new B4("real",s,t),c=new B4("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(u,l,"float32"),d=n.runWebGLProgram(c,l,"float32"),f=D1({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);var p=Q1({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),p}var U4={kernelName:zI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return V4(t.input,!1,n)}},W4=Te((function e(t,n){Se(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function j4(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||pC(a))){var o=lC(i,JS(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new W4(r,a),u=[[a]];return t.runWebGLProgram(s,[],i,u)}var G4,H4={kernelName:BI,backendName:"webgl",kernelFunc:j4},K4=Te((function e(t){Se(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),q4={kernelName:VI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new K4(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},Z4="return floor(x);",X4=W1({opSnippet:Z4,packedOpSnippet:Z4,cpuKernelImpl:p0}),Y4={kernelName:UI,backendName:"webgl",kernelFunc:X4},Q4=j1({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),$4={kernelName:WI,backendName:"webgl",kernelFunc:Q4},J4=Te((function e(t){Se(this,e),this.variableNames=["A"];var n=rJ(),r=(0,U.Z)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),e5=Te((function e(t){Se(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=rJ(),r=(0,U.Z)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),t5={kernelName:B_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=(0,U.Z)(u,2),l=c[0],h=c[1],d=[h,l],f=[h,l,i];if(s||o){var p=RC().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=G4&&p===n5||(n5=p,G4=document.createElement("canvas").getContext("2d",{willReadFrequently:n5})),G4.canvas.width=l,G4.canvas.height=h,G4.drawImage(a,0,0,l,h),a=G4.canvas}var m=n.makeTensorInfo(d,"int32");n.texData.get(m.dataId).usage=w$.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(m.dataId),a);var v=RC().getBool("WEBGL_PACK")?new e5(f):new J4(f),g=n.runWebGLProgram(v,[m],"int32");return n.disposeData(m.dataId),g}},n5=RC().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var r5={kernelName:W_,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,h=a.dataFormat,d=a.dilations,f=a.dimRoundingMode,p=a.activation,m=a.leakyreluAlpha,v=SO(h),g=fO(i.shape,o.shape,c,d,l,f,!1,v),y=[],b=null!=s,x=null!=u,w="leakyrelu"===p,k=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=Q1({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(s,h)),x&&e.push(t(u,h)),w){var n=r.makeTensorInfo([],"float32",fE(m,"float32"));e.push(n),y.push(n)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===v&&RC().getBool("WEBGL_EXP_CONV")){var S=p?G1(p,!0):null,C=new M3(g,b,S,x,w),I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=k();t=r.runWebGLProgram(C,T,"float32",I)}else if(RC().getBool("WEBGL_CONV_IM2COL"))t=B3({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:m});else{var _=p?G1(p,!1):null,E=new D3(g,b,_,x,w),N=k();t=r.runWebGLProgram(E,N,"float32")}else t=z3({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:m});var R=Q1({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),R}};var a5={kernelName:j_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,h=r.dimRoundingMode,d=r.activation,f=r.leakyreluAlpha,p=[],m=l;null==m&&(m=[1,1]),YS(wO(u,m),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(m,"'")}));var v,g=fO(a.shape,i.shape,u,m,c,h,!0),y=RC().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=d?G1(d,y):null,x=[a,i],w=null!=o,k=null!=s,S="leakyrelu"===d;if(w&&x.push(o),k&&x.push(s),S){var C=n.makeTensorInfo([],"float32",fE(f,"float32"));x.push(C),p.push(C)}v=y?new p4(g,w,b,k,S):new f4(g,w,b,k,S);var I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=n.runWebGLProgram(v,x,"float32",I);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),T}},i5=Te((function e(t,n,r,a){Se(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=bJ(r.length),o="\n    int index;",s=0;s<this.sliceDim;s++)o+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var o5={kernelName:HI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=JS(r.shape),u=MF(r,a),c=(0,U.Z)(u,4),l=c[0],h=c[1],d=c[2],f=c[3],p=Q1({inputs:{x:a},backend:n,attrs:{shape:[h,o]}}),m=Q1({inputs:{x:r},backend:n,attrs:{shape:[JS(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var v=n.readSync(a.dataId),g=n.bufferSync(r),y=m0(v,g,r.dtype,h,o,d,f,r.shape,s);return n.makeTensorInfo(l,r.dtype,y.values)}var b=new i5(o,f,[h,d],r.shape),x=n.runWebGLProgram(b,[m,p],m.dtype),w=Q1({inputs:{x:x},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),w}},s5=Te((function e(t,n){Se(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=bJ(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function u5(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=sC(o,a.shape)[0];if(RC().get("DEBUG"))for(var c=n.readSync(i.dataId),l=a.shape[u],h=function(){var e=c[d];YS(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},d=0;d<c.length;++d)h();var f=cz(a,i,u,s),p=JS(i.shape),m=[],v=Q1({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Q1({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,p/f.batchSize]}});m.push(v),m.push(g);var y=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var b=n.bufferSync(g),x=n.bufferSync(v),w=v0(x,b,y);return m.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}var k=new s5(v.shape,y),S=n.runWebGLProgram(k,[v,g],v.dtype);m.push(S);var C=Q1({inputs:{x:S},backend:n,attrs:{shape:f.outputShape}});return m.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}var c5={kernelName:GI,backendName:"webgl",kernelFunc:u5},l5=j1({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:g0,dtype:"bool"}),h5={kernelName:KI,backendName:"webgl",kernelFunc:l5},d5=j1({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:y0}),f5={kernelName:qI,backendName:"webgl",kernelFunc:d5};var p5={kernelName:XI,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return V4(t.input,!0,n)}},m5=W1({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),v5={kernelName:QI,backendName:"webgl",kernelFunc:m5},g5=W1({opSnippet:"return float(isinf(x));",dtype:"bool"}),y5={kernelName:$I,backendName:"webgl",kernelFunc:g5},b5=W1({opSnippet:"return float(isnan(x));",dtype:"bool"}),x5={kernelName:JI,backendName:"webgl",kernelFunc:b5},w5=j1({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:b0,dtype:"bool"}),k5={kernelName:tT,backendName:"webgl",kernelFunc:w5},S5=j1({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:x0,dtype:"bool"}),C5={kernelName:nT,backendName:"webgl",kernelFunc:S5};var I5={kernelName:rT,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=w0(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},T5=W1({opSnippet:U1+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:k0}),_5={kernelName:aT,backendName:"webgl",kernelFunc:T5},E5=W1({opSnippet:U1+"\n  return log(1.0 + x);\n"}),N5={kernelName:iT,backendName:"webgl",kernelFunc:E5},R5=j1({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),A5={kernelName:oT,backendName:"webgl",kernelFunc:R5},O5=W1({opSnippet:"return float(!(x >= 1.0));"}),D5={kernelName:sT,backendName:"webgl",kernelFunc:O5},P5=j1({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),M5={kernelName:uT,backendName:"webgl",kernelFunc:P5},L5=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),F5=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),z5={kernelName:cT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=RC().getBool("WEBGL_PACK_NORMALIZATION")?new F5(a.shape,i,o,s,u):new L5(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},B5=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),V5={kernelName:lT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new B5(a.shape,s,u,c,l);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function U5(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=sC(i,a.shape),c=u,l=SD(c,s),h=null!=l,d=n.shouldExecuteOnCPU([a]),f=a;if(h){if(d){for(var p=n.texData.get(f.dataId).values,m=new Array(s),v=0;v<m.length;v++)m[v]=a.shape[l[v]];var g=Q0(p,a.shape,a.dtype,l,m);f=n.makeTensorInfo(m,a.dtype),n.texData.get(f.dataId).values=g}else f=a2(a,l,n);c=ID(c.length,s)}kD("max",c,s);var y,b=xD(f.shape,c),x=(0,U.Z)(b,2),w=x[0],k=x[1],S=w;if(o&&(S=wD(w,u)),d){var C=n.texData.get(f.dataId).values,I=S0(C,JS(k),S,a.dtype);y=n.makeTensorInfo(S,a.dtype),n.texData.get(y.dataId).values=I}else y=function(e,t,n,r){var a=JS(t),i=Q1({inputs:{x:e},attrs:{shape:[JS(e.shape)/a,a]},backend:r}),o=t2(i,e.dtype,"max",r),s=Q1({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(f,k,S,n);return h&&n.disposeIntermediateTensorInfo(f),y}var W5={kernelName:hT,backendName:"webgl",kernelFunc:U5},j5=j1({opSnippet:_1+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+N1+"\n  return result;\n",cpuKernelImpl:C0}),G5={kernelName:dT,backendName:"webgl",kernelFunc:j5};var H5={kernelName:fT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;tJ(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;YS(wO(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=hO(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&tC(c.inShape,c.outShape))return A1({inputs:{x:a},backend:n});var l=new j2(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var K5={kernelName:mT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=dO(a.shape,i,o,[1,1,1],s,c,u),h=new G2(l,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},q5=Te((function e(t){Se(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Z5=Te((function e(t){Se(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,h=u-1-t.padInfo.front,d=c-1-t.padInfo.top,f=l-1-t.padInfo.left,p=u*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(d,", ").concat(f,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var X5={kernelName:vT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=dO(i.shape,o,s,[1,1,1],u,c),h=new G2(l,"max",!0),d=n.runWebGLProgram(h,[i],i.dtype),f=new Z5(l),p=n.runWebGLProgram(f,[a,d],i.dtype);return n.disposeIntermediateTensorInfo(d),p}};var Y5={kernelName:pT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;tJ([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=hO(o.shape,s,u,1,c,l),d=new j2(h,"max",!0),f=n.runWebGLProgram(d,[o],o.dtype),p=new q5(h),m=n.runWebGLProgram(p,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),m}};var Q5={kernelName:gT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;YS(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];YS(wO(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var h=hO(a.shape,i,o,l,s),d=function(e,t,n,r){var a=new j2(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new j2(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,h,c),f=(0,U.Z)(d,2);return[f[0],f[1]]}};var $5={kernelName:yT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=sC(o,a.shape),l=c,h=SD(l,u),d=null!=h,f=s.shouldExecuteOnCPU([a]),p=[],m=a;if(d){if(f){for(var v=s.texData.get(m.dataId).values,g=new Array(u),y=0;y<g.length;y++)g[y]=a.shape[h[y]];var b=Q0(v,a.shape,a.dtype,h,g);m=s.makeTensorInfo(g,a.dtype),s.texData.get(m.dataId).values=b}else m=a2(a,h,s);p.push(m),l=ID(l.length,u)}kD("sum",l,u);var x=xD(m.shape,l),w=(0,U.Z)(x,2),k=w[0],S=w[1],C=k;i&&(C=wD(k,c));for(var I=function(e,t,n,r){var a=JS(t),i=Q1({inputs:{x:e},attrs:{shape:[JS(e.shape)/a,a]},backend:r}),o=t2(i,"float32","mean",r),s=Q1({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(m,S,C,s),T=0,_=p;T<_.length;T++){var E=_[T];s.disposeIntermediateTensorInfo(E)}return I}};var J5={kernelName:bT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=sC(i,a.shape),c=u,l=SD(c,s),h=a;null!=l&&(h=s2({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ID(c.length,a.shape.length)),kD("min",c,s);var d,f=xD(h.shape,c),p=(0,U.Z)(f,2),m=p[0],v=Q1({inputs:{x:h},backend:n,attrs:{shape:[-1,JS(p[1])]}}),g=t2(v,v.dtype,"min",n);return d=Q1(o?{inputs:{x:g},backend:n,attrs:{shape:wD(m,u)}}:{inputs:{x:g},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}},e6=j1({opSnippet:_1+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+N1+"\n  return result;\n",cpuKernelImpl:I0}),t6={kernelName:xT,backendName:"webgl",kernelFunc:e6},n6=Te((function e(t,n,r){Se(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=bJ(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),r6=Te((function e(t,n,r){Se(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=bJ(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=e1("rc",a),c=e1("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===r?0:1,f="";if(1===a){var p="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ")}else{var m="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(m,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(m,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(m,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(m,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")})),a6={kernelName:wT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new r6(a.shape,i,o):new n6(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},i6=j1({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+N1+"\n  return result;\n"}),o6={kernelName:kT,backendName:"webgl",kernelFunc:i6},s6=Te((function e(t,n,r){Se(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),u6=j1({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),c6={kernelName:NI,backendName:"webgl",kernelFunc:u6},l6="return a - b;",h6=j1({opSnippet:l6,packedOpSnippet:l6,supportsComplex:!0,cpuKernelImpl:Z0}),d6={kernelName:__,backendName:"webgl",kernelFunc:h6};function f6(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=sC([r.dim],a.shape),o=U5({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=wD(o.shape,i),u=Q1({inputs:{x:o},backend:n,attrs:{shape:s}}),c=h6({inputs:{a:a,b:u},backend:n}),l=O4({inputs:{x:c},backend:n}),h=i2({inputs:{x:l},backend:n,attrs:{axis:i,keepDims:!1}}),d=Q1({inputs:{x:h},backend:n,attrs:{shape:s}}),f=u6({inputs:{a:l,b:d},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),f}var p6={kernelName:p_,backendName:"webgl",kernelFunc:f6};var m6={kernelName:ST,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:f6({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new s6(c,l,i),d=[[o]],f=n.runWebGLProgram(h,[u],"int32",d);return s||n.disposeIntermediateTensorInfo(u),f}},v6=u1+"\n  return -x;\n";var g6={kernelName:IT,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=_0(i.values,a.shape,a.dtype),s=(0,U.Z)(o,2),u=s[0],c=s[1];return r.makeTensorInfo(c,a.dtype,u)}return t=RC().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new w1(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new s1(a.shape,v6),r.runWebGLProgram(t,[a],a.dtype)}},y6=NL;var b6={kernelName:_T,backendName:"webgl",kernelFunc:function(e){G_("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),h=y6(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},x6=RL;var w6={kernelName:ET,backendName:"webgl",kernelFunc:function(e){G_("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),h=n.readSync(i.dataId),d=x6(l,h,o,s,u,c),f=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},k6=AL;var S6={kernelName:NT,backendName:"webgl",kernelFunc:function(e){G_("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),h=n.readSync(i.dataId),d=k6(l,h,o,s,u,c),f=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},C6=Te((function e(t,n,r,a){Se(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),I6={kernelName:AT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue,c=JS(a.shape),l=new C6(c,o,s,u),h=Q1({inputs:{x:a},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(l,[h],i);n.disposeIntermediateTensorInfo(h);var f=Q1({inputs:{x:d},backend:n,attrs:{shape:[].concat((0,ke.Z)(a.shape),[o])}});return n.disposeIntermediateTensorInfo(d),f}};function T6(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=d3({inputs:{input:r},backend:n}),i=T6({inputs:{x:a},backend:n}),o=E3({inputs:{input:r},backend:n}),s=T6({inputs:{x:o},backend:n}),u=D1({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return j4({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var _6={kernelName:F_,backendName:"webgl",kernelFunc:T6};var E6={kernelName:RT,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=d3({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=E3({inputs:{input:a},backend:r}),u=T6({inputs:{x:s},backend:r}),c=D1({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return j4({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var N6={kernelName:OT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return P4({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){QS(a,e.shape,"All tensors passed to stack must have matching shapes"),YS(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=t.map((function(e){var t=P4({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),u=A3({inputs:s,backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}},R6=Te((function e(t,n,r){Se(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=bJ(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),A6=Te((function e(t,n,r){Se(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=bJ(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=e1("rc",a),c=e1("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],f=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",m=0,v=1===a?2:4;m<v;m++)p+="\n        ".concat(d[m],"\n        if (").concat(f,") {\n          result[").concat(m,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(m,"] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")})),O6=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===JS(a.shape)){var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return j4({backend:n,attrs:{shape:s,value:o,dtype:a.dtype}})}var u=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new A6(a.shape,i,o):new R6(a.shape,i,o),c=[[o]];return n.runWebGLProgram(u,[a],a.dtype,c)},D6={kernelName:DT,backendName:"webgl",kernelFunc:O6},P6=j1({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+N1+"\n  return result;\n"}),M6={kernelName:PT,backendName:"webgl",kernelFunc:P6};var L6={kernelName:LT,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],l=sC(o,i.shape),h=l,d=SD(h,u),f=i;if(null!=d&&(f=s2({inputs:{x:i},backend:r,attrs:{perm:d}}),h=ID(h.length,u),c.push(f)),kD("prod",h,u),r.shouldExecuteOnCPU([f])){var p=r.texData.get(f.dataId).values,m=N0(f.shape,f.dtype,p,h),v=m.outVals,g=m.outShape,y=m.outDtype;t=r.makeTensorInfo(g,y,v)}else{var b=xD(f.shape,h),x=(0,U.Z)(b,2),w=x[0],k=JS(x[1]),S=Q1({inputs:{x:f},backend:r,attrs:{shape:[-1,k]}}),C=t2(S,WE(i.dtype),"prod",r);t=Q1({inputs:{x:C},backend:r,attrs:{shape:w}}),c.push(S),c.push(C)}if(s){c.push(t);var I=wD(t.shape,l);t=Q1({inputs:{x:t},backend:r,attrs:{shape:I}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var F6={kernelName:FT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=r.outputRaggedRank,u=a.map((function(e){return n.readSync(e.dataId)})),c=a.map((function(e){return e.shape})),l=n.readSync(i.dataId),h=n.readSync(o.dataId),d=R0(u,c,l,i.shape,i.dtype,h,o.shape,s),f=(0,U.Z)(d,3),p=f[0],m=f[1],v=f[2],g=p.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),y=n.makeTensorInfo(v,i.dtype,m);return g.concat([y])}};var z6={kernelName:zT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=A0(o,r.shape,r.dtype,s,a.shape,u,i.shape),l=(0,U.Z)(c,2),h=l[0],d=l[1];return[n.makeTensorInfo([h.length],"int32",h),n.makeTensorInfo([d.length],r.dtype,d)]}};var B6={kernelName:BT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.readSync(a.dataId),l=n.readSync(i.dataId),h=n.readSync(o.dataId),d=s.map((function(e){return n.readSync(e.dataId)})),f=s.map((function(e){return e.shape})),p=O0(c,a.shape,l,i.shape,i.dtype,h,o.shape,d,f,u),m=(0,U.Z)(p,2),v=m[0],g=m[1];return n.makeTensorInfo(v,i.dtype,g)}},V6=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=D0(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},U6={kernelName:VT,backendName:"webgl",kernelFunc:V6},W6=W1({opSnippet:"return 1.0 / x;"}),j6={kernelName:WT,backendName:"webgl",kernelFunc:W6},G6=W1({opSnippet:u1+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),H6={kernelName:jT,backendName:"webgl",kernelFunc:G6},K6=W1({opSnippet:u1+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),q6={kernelName:XT,backendName:"webgl",kernelFunc:K6},Z6=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["A"],this.outputShape=[];var o=(0,U.Z)(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),X6=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=(0,U.Z)(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],",\n          ").concat(d[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var Y6={kernelName:qT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size,u=(0,U.Z)(s,2),c=u[0],l=u[1],h=RC().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new X6(a.shape,c,l,i,o):new Z6(a.shape,c,l,i,o);return n.runWebGLProgram(h,[a],"float32")}},Q6=Te((function e(t,n,r){Se(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,U.Z)(n,3),i=a[1],o=a[2],s=(0,U.Z)(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=l[0]/h[0],f=l[1]/h[1],p=1/d,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var $6={kernelName:ZT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new Q6(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},J6=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["A"],this.outputShape=[];var o=(0,U.Z)(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";h=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),e9=Te((function e(t,n,r,a,i){Se(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=(0,U.Z)(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";h=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],",\n          ").concat(d[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var t9={kernelName:HT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size,u=(0,U.Z)(s,2),c=u[0],l=u[1],h=RC().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new e9(a.shape,c,l,i,o):new J6(a.shape,c,l,i,o);return n.runWebGLProgram(h,[a],a.dtype)}},n9=Te((function e(t,n,r){Se(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,U.Z)(n,3),i=a[1],o=a[2],s=(0,U.Z)(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=l[0]/h[0],f=l[1]/h[1],p=1/d,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var r9={kernelName:KT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new n9(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},a9=Te((function e(t,n){Se(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=bJ(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),i9=Te((function e(t,n){Se(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=e1("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=bJ(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var o9={kernelName:YT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=sC(i,a.shape);if(0===o)return A1({inputs:{x:a},backend:n});var u=RC().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new i9(a.shape,s):new a9(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},s9=Te((function e(t,n){Se(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),u9={kernelName:V_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new s9(a.shape,o),l=NF(s,a.shape[1],a.shape[2]),h=(0,U.Z)(l,2),d=[[h[0],h[1],Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(c,[a],a.dtype,d)}},c9=W1({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),l9={kernelName:QT,backendName:"webgl",kernelFunc:c9},h9=W1({opSnippet:"return inversesqrt(x);",cpuKernelImpl:P0}),d9={kernelName:$T,backendName:"webgl",kernelFunc:h9},f9=Te((function e(t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Se(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var u=bJ(i.length),c=bJ(o.length),l="";1===r?l="i":2===r&&(l="i, j");var h="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var f="getUpdates(".concat(d,")"),p="";s&&(p="coords[0], coords[1]");var m="getDefaultValue(".concat(p,")"),v=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(v,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(f,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(m,", sum, float(found)));\n        }\n      ")})),p9=Te((function e(t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Se(this,e),this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;var u=bJ(i.length),c=bJ(o.length),l="";1===r?l="i":2===r&&(l="i, j");var h="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var f="getUpdates(".concat(d,")"),p="";s&&(p="coords[0], coords[1]");var m="getDefaultValue(".concat(p,")"),v=n>1?"strides[j]":"strides",g=n>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(n,"; j+=2) {\n              ivec4 index = round(").concat(h,");\n              flattenedIndex += index.xz * ").concat(v,";\n              if (j + 1 < ").concat(n,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(f,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(m,", sum, found));\n        }\n      ")}));var m9={kernelName:JT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=LM(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=[d/l,l];if(0===d)return n.makeTensorInfo(o,a.dtype);var p,m=Q1({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),v=Q1({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));p=RC().getBool("WEBGL_PACK")?new p9(c,u,m.shape.length,v.shape.length,h,f):new f9(c,u,m.shape.length,v.shape.length,h,f);var y=n.runWebGLProgram(p,[v,m,g],v.dtype),b=Q1({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},v9=Te((function e(t,n,r,a){Se(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===RC().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var g9={kernelName:t_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=new v9(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}},y9=Te((function e(t,n,r){var a,i;if(Se(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=bJ(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var b9={kernelName:n_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new y9(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],UE(a.dtype,i.dtype))}},x9=W1({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(LF,";\n  float scale = ").concat(FF,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),w9={kernelName:r_,backendName:"webgl",kernelFunc:x9},k9=W1({opSnippet:U1+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:L0}),S9={kernelName:u_,backendName:"webgl",kernelFunc:k9},C9=W1({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),I9={kernelName:s_,backendName:"webgl",kernelFunc:C9},T9=W1({opSnippet:U1+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(N1,"\n  return result;\n")}),_9={kernelName:i_,backendName:"webgl",kernelFunc:T9},E9=W1({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),N9={kernelName:o_,backendName:"webgl",kernelFunc:E9},R9=W1({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),A9={kernelName:c_,backendName:"webgl",kernelFunc:R9},O9={kernelName:d_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;YS(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,(0,ke.Z)(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],h=O6({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),d=RF(h.shape,i,s,!1),f=AF(d.length,i.length,!1),p=OF(h.shape,i,s,!1),m=Q1({inputs:{x:h},backend:n,attrs:{shape:d}}),v=s2({inputs:{x:m},backend:n,attrs:{perm:f}}),g=Q1({inputs:{x:v},backend:n,attrs:{shape:p}});return l.push(h),l.push(m),l.push(v),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var D9={kernelName:m_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],h=B0(s,r.shape,r.dtype,u,a.dtype,c,l),d=(0,U.Z)(h,5),f=d[0],p=d[1],m=d[2],v=d[3],g=d[4];return[n.makeTensorInfo(p,r.dtype,f),n.makeTensorInfo([p[0]],a.dtype,m),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(e){return Number(e)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};var P9={kernelName:v_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),c=V0(s,r.shape,r.dtype,o,u),l=(0,U.Z)(c,3),h=l[0],d=l[1],f=l[2];return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}};var M9={kernelName:g_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=U0(o,r.shape,r.dtype,s,u,!0),l=(0,U.Z)(c,2),h=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,h)}};var L9={kernelName:y_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=U0(o,r.shape,r.dtype,s,u),l=(0,U.Z)(c,2),h=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,h)}};var F9={kernelName:b_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=LM(0,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,d=u.strides,f=u.outputSize;if("string"===i.dtype){var p=n.bufferSync(a),m=n.bufferSync(i),v=gE(n.readSync(o.dataId)[0]),g=M0(p,m,s,f,h,l,c,d,v,false);return n.makeTensorInfo(s,g.dtype,g.values)}var y=new f9(l,c,a.shape.length,i.shape.length,d,[f,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),x=Q1({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(b),x}};var z9={kernelName:f_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=sC(r.axis,a.shape)[0],s=rz(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=(0,ke.Z)(l);t[o]=e;var r=a3({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},B9="return sqrt(x);",V9=W1({opSnippet:B9,packedOpSnippet:B9,cpuKernelImpl:W0}),U9={kernelName:l_,backendName:"webgl",kernelFunc:V9},W9={kernelName:w_,backendName:"webgl",kernelFunc:W1({opSnippet:"return x * x;"})},j9="return (a - b) * (a - b);",G9=j1({opSnippet:j9,packedOpSnippet:j9}),H9={kernelName:x_,backendName:"webgl",kernelFunc:G9};var K9={kernelName:k_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;if("string"!==a.dtype)throw new Error("Input must be of datatype string");var i=lz(n.readSync(a.dataId)),o=j0(i,"string",r);return n.makeTensorInfo(a.shape,"string",o)}};var q9={kernelName:z_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=u1+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new s1(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},Z9=Te((function e(t,n,r){Se(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=bJ(r.length),o=bJ(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var X9={kernelName:S_,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,h=a.ellipsisMask,d=a.newAxisMask,f=a.shrinkAxisMask,p=YA(i.shape,o,s,u,c,l,h,d,f),m=p.finalShapeSparse,v=p.finalShape,g=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,w=p.end,k=p.strides;if(g)t=Q1({inputs:{x:i},backend:r,attrs:{shape:v}});else if(y||b){YS(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var S=KA(x,w,k),C=a3({inputs:{x:i},backend:r,attrs:{begin:x,size:S}});t=Q1({inputs:{x:C},backend:r,attrs:{shape:v}}),r.disposeIntermediateTensorInfo(C)}else{if(r.shouldExecuteOnCPU([i])){var I=r.readSync(i.dataId),T=IR(i.shape,i.dtype,I),_=G0(m,T,k,x);t=r.makeTensorInfo(v,i.dtype,_.values)}else{var E=new Z9(x,k,m);t=r.runWebGLProgram(E,[i],i.dtype)}}var N=Q1({inputs:{x:t},backend:r,attrs:{shape:v}});return r.disposeIntermediateTensorInfo(t),N}};var Y9={kernelName:C_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,h=t.dataSplits,d=n.readSync(l.dataId),f=n.readSync(h.dataId),p=H0(d,f,a,i,o,s,u,c),m=(0,U.Z)(p,2),v=m[0],g=m[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(h.shape,"int32",g)]}};var Q9={kernelName:I_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=n.readSync(a.dataId),s=n.readSync(i.dataId)[0],u=K0(o,s,r),c=(0,U.Z)(u,3),l=c[0],h=c[1],d=c[2],f=h.length;return[n.makeTensorInfo([f,2],"int32",l),n.makeTensorInfo([f],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var $9={kernelName:T_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=q0(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},J9=W1({opSnippet:"return tan(x);"}),e8={kernelName:E_,backendName:"webgl",kernelFunc:J9},t8=W1({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),n8={kernelName:N_,backendName:"webgl",kernelFunc:t8};var r8={kernelName:e_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.tensor,i=t.indices,o=t.updates;DX(r);var s=LM(0,i,a.shape),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=[d/l,l];if(0===d)return n.makeTensorInfo(a.shape,i.dtype);var p=Q1({inputs:{x:i},backend:n,attrs:{shape:[c,u]}}),m=Q1({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),v=Q1({inputs:{x:a},backend:n,attrs:{shape:f}}),g=new f9(c,u,p.shape.length,m.shape.length,h,f,!1,!0),y=n.runWebGLProgram(g,[m,p,v],v.dtype),b=Q1({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),b}},a8=Te((function e(t,n){Se(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=bJ(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function i8(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),s="string"===a.dtype?o.map((function(e){return gE(e)})):o,u=IR(a.shape,a.dtype,s),c=X0(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new a8(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var o8={kernelName:R_,backendName:"webgl",kernelFunc:i8},s8=Te((function e(t){Se(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),u8=Te((function e(t){Se(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function c8(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function l8(e){for(var t=1;t<e;)t*=2;return t}var h8={kernelName:A_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=RC().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=RC().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([a])||l<s||i>u){var h=n.readSync(a.dataId),d=Y0(h,c,a.dtype,i,o),f=(0,U.Z)(d,2),p=f[0],m=f[1];return[n.makeTensorInfo(p.shape,p.dtype,p.values),n.makeTensorInfo(m.shape,m.dtype,m.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===l)return[a,j4({attrs:{shape:c,dtype:"int32",value:0},backend:n})];var v=n.texData.get(a.dataId),g=null!==v&&v.isPacked,y=g?n.unpackTensor(a):a,b=JS(c)/l,x=Q1({inputs:{x:y},attrs:{shape:[b,l]},backend:n});g&&c8(n,y);for(var w=l8(i),k=l8(l),S=null,C=function(){return null===S?[x,x]:[x,S]},I=function(e,t,r){var a=C(),i=new s8(r),o=[[l],[null===S?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=S;S=n.runWebGLProgram(i,a,"int32",o),c8(n,s)},T=1;T<w;T*=2)for(var _=2*T,E=T;E>=1;E/=2)I(_,E,[b,k]);for(var N=k;N>w;N/=2){var R=C(),A=new u8([b,N/2]),O=[[l],[null===S?1:0],[w]],D=S;S=n.runWebGLProgram(A,R,"int32",O),c8(n,D);for(var P=w/2,M=2*P,L=P;L>=1;L/=2)I(M,L,S.shape)}var F=S;S=a3({inputs:{x:S},backend:n,attrs:{begin:0,size:[b,i]}}),c8(n,F);var z=u5({inputs:{x:x,indices:S},backend:n,attrs:{axis:1,batchDims:1}});c8(n,x);var B=c.slice(0,-1);B.push(i),F=S,S=Q1({inputs:{x:S},attrs:{shape:B},backend:n}),c8(n,F);var V=z;return z=Q1({inputs:{x:z},attrs:{shape:B},backend:n}),c8(n,V),[z,S]}},d8=Te((function e(t,n,r,a,i,o){Se(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var f8={kernelName:O_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,c=r.outputShape,l=(0,U.Z)(a.shape,4),h=l[0],d=l[1],f=l[2],p=l[3],m=null!=c?c:[d,f],v=(0,U.Z)(m,2),g=v[0],y=v[1],b=new d8(d,f,o,s,u,[h,g,y,p]);return n.runWebGLProgram(b,[a,i],"float32")}};var p8={kernelName:P_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;tJ(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=$0(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var m8={kernelName:M_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,h=0;h<s;h++)h!==i&&(c[l++]=o.shape[h]);var d=[],f=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var m=new Array(u),v=0;v<m.length;v++){f[i]=v;var g=a3({inputs:{x:o},backend:n,attrs:{begin:f,size:p}}),y=Q1({inputs:{x:g},backend:n,attrs:{shape:c}});m[v]=y,d.push(g)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},v8=Te((function e(t,n){Se(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var g8={kernelName:L_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=SD([c],s),h=a;null!=l&&(h=s2({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(h),c=ID(1,s)[0]);var d=uz(h.shape,c,o),f=JS([h.shape[c]]),p=Q1({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});u.push(p);var m=function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=function(e,t){var n,r=!1;for(e<=_F?(n=e,r=!0):n=vC(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=vC(e,n+1);return n}(c,o),h=new v8({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),d=n.compileAndRun(h,[t,a],i);if(u.push(d),d.shape[1]===o)return d;var f=V6({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=i8({inputs:{x:f},backend:n,attrs:{reps:[c/l]}});return u.push(f),u.push(p),e(d,r,p,i,o)}(p,"unsortedSegmentSum",i,WE(a.dtype),o),v=Q1({inputs:{x:m},backend:n,attrs:{shape:d}}),g=v;if(null!=l){u.push(v);var y=CD(l);g=s2({inputs:{x:g},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},y8=0,b8=[h2,f2,m2,g2,x2,S2,C2,I2,A2,O2,P2,L2,z2,V2,W2,H2,K2,X2,Y2,Q2,e3,o3,s3,u3,c3,m3,y3,w3,P1,C3,O3,V3,H3,q3,Z3,X3,Q3,J3,t4,r4,u4,c4,l4,d4,m4,y4,b4,w4,S4,C4,T4,_4,N4,A4,D4,M4,z4,U4,H4,q4,Y4,$4,t5,r5,a5,o5,c5,h5,f5,O1,p5,N3,v5,y5,x5,F1,k5,C5,I5,_5,N5,A5,D5,M5,z5,V5,W5,G5,H5,K5,X5,Y5,Q5,$5,J5,t6,a6,o6,m6,Y1,g6,b6,w6,S6,h3,I6,E6,N6,D6,M6,V1,L6,F6,z6,B6,U6,f3,c6,j6,H6,q6,$1,Y6,$6,t9,r9,o9,u9,l9,d9,m9,g9,b9,w9,S9,I9,_9,N9,i3,p6,A9,O9,D9,P9,M9,L9,F9,z9,U9,W9,H9,K9,q9,X9,Y9,Q9,$9,d6,o2,e8,n8,r8,o8,h8,f8,u2,p8,m8,g8,_6];y8<b8.length;y8++){Y_(b8[y8])}var x8=function(e){be(n,e);var t=we(n);function n(e){var r;return Se(this,n),(r=t.call(this,e)).videoRef=S.createRef(),r.canvasRef=S.createRef(),r.model=mQ.MoveNet,r.width=window.innerWidth>900?640:320,r.height=window.innerWidth>900?480:240,r.trainingType=new URL(decodeURI(window.location.href)).searchParams.get("classification"),r.state={count:JSON.parse(localStorage.getItem("userTrainingData"))[j()().format("YYYY/MM/DD")].training[r.trainingType],buttonText:"\u4e2d\u65ad\u3059\u308b"},r.flag=!1,r}return Te(n,[{key:"componentDidMount",value:function(){var e=N(T().mark((function e(){var t,n,r,a,i,o,s,u,c,l,h,d,f,p=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.videoRef.current,n=this.canvasRef.current,r=function(e,t,n,r,a,i){var o=Math.atan2(t-r,e-n),s=Math.atan2(i-r,a-n),u=Math.abs(Math.round(180*(s-o)/Math.PI));return u>180&&(u=360-u),u},a=function(e,t,n){var a=null,i=0,o=0,s=0,u=parseInt(localStorage.getItem("count"));p.setState({count:u}),p.state.count!==e?"PectoralTraining"===t?(o=(n.keypoints[6].score+n.keypoints[8].score+n.keypoints[10].score)/3,(s=(n.keypoints[5].score+n.keypoints[7].score+n.keypoints[9].score)/3)<=o?(i=o,a=r(n.keypoints[6].x,n.keypoints[6].y,n.keypoints[8].x,n.keypoints[8].y,n.keypoints[10].x,n.keypoints[10].y)):(i=s,a=r(n.keypoints[5].x,n.keypoints[5].y,n.keypoints[7].x,n.keypoints[7].y,n.keypoints[9].x,n.keypoints[9].y)),!1===p.flag&&a>160&&i>.6?p.flag=!0:!0===p.flag&&a<90&&i>.6&&(localStorage.setItem("count",u+1),p.flag=!1,console.log("count",u+1))):"AbsTraining"===t?(o=(n.keypoints[6].score+n.keypoints[12].score+n.keypoints[14].score)/3,(s=(n.keypoints[5].score+n.keypoints[11].score+n.keypoints[13].score)/3)<=o?(i=o,a=r(n.keypoints[6].x,n.keypoints[6].y,n.keypoints[12].x,n.keypoints[12].y,n.keypoints[14].x,n.keypoints[14].y)):(i=s,a=r(n.keypoints[5].x,n.keypoints[5].y,n.keypoints[11].x,n.keypoints[11].y,n.keypoints[13].x,n.keypoints[13].y)),!1===p.flag&&a>130&&i>.6?p.flag=!0:!0===p.flag&&a<60&&i>.6&&(localStorage.setItem("count",u+1),p.flag=!1,console.log("count",u+1))):"LegTraining"===t&&(o=(n.keypoints[12].score+n.keypoints[14].score+n.keypoints[16].score)/3,(s=(n.keypoints[11].score+n.keypoints[13].score+n.keypoints[15].score)/3)<=o?(i=o,a=r(n.keypoints[12].x,n.keypoints[12].y,n.keypoints[14].x,n.keypoints[14].y,n.keypoints[16].x,n.keypoints[16].y)):(i=s,a=r(n.keypoints[11].x,n.keypoints[11].y,n.keypoints[13].x,n.keypoints[13].y,n.keypoints[15].x,n.keypoints[15].y)),!1===p.flag&&a>160&&i>.6?p.flag=!0:!0===p.flag&&a<100&&i>.6&&(localStorage.setItem("count",u+1),p.flag=!1,console.log("count",u+1))):p.setState({buttonText:"\u5b8c\u4e86!"})},i=function(){var e=N(T().mark((function e(){var t,n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={modelType:S$.SINGLEPOSE_LIGHTNING},e.next=3,b$(p.model,t);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=N(T().mark((function e(){var t,n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 2:return t=e.sent,(n=p.videoRef.current).srcObject=t,e.abrupt("return",new Promise((function(e){n.onloadedmetadata=function(){e(n)}})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m="webgpu",JE.setBackend(m),e.next=9,JE.ready();case 9:s=i(),u=JSON.parse(localStorage.getItem("userTrainingData")),c=j()().format("YYYY/MM/DD"),localStorage.setItem("count",this.state.count),l=function(){var e=N(T().mark((function e(t,n,r){var i,s,l;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.getContext("2d"),e.next=3,o();case 3:s=e.sent,t.play(),l=function(){var e=N(T().mark((function e(t,n,r){var i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r;case 2:return e.next=4,e.sent.estimatePoses(t);case 4:i=e.sent,n.clearRect(0,0,p.width,p.height),0!==i.length&&(h(t,n),d(i[0],n),f(i[0],n),a(u[c].target[p.trainingType],p.trainingType,i[0])),requestAnimationFrame((function(){return l(t,n,r)}));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),l(s,i,r);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),h=function(e,t){t.drawImage(e,0,0,p.width,p.height)},d=function(e,t){var n=wQ.getKeypointIndexBySide(p.model);t.fillStyle="Red",t.strokeStyle="white",t.lineWidth=2;for(var r=p.width/640,a=p.height/480,i=0;i<e.keypoints.length;i++)if(n.right.includes(i)?t.fillStyle="Orange":n.left.includes(i)?t.fillStyle="Green":t.fillStyle="Red",e.keypoints[i].score>=.3){var o=new Path2D;o.arc(r*e.keypoints[i].x,a*e.keypoints[i].y,5,0,2*Math.PI),t.fill(o),t.stroke(o)}},f=function(e,t){var r="Green";t.fillStyle=r,t.strokeStyle=r,t.lineWidth=4;var a=n.width/640,i=n.height/480;wQ.getAdjacentPairs(p.model).forEach((function(n){var r=(0,U.Z)(n,2),o=r[0],s=r[1],u=e.keypoints[o],c=e.keypoints[s],l=null!=u.score?u.score:1,h=null!=c.score?c.score:1;l>=.3&&h>=.3&&(t.beginPath(),t.moveTo(a*u.x,i*u.y),t.lineTo(a*c.x,i*c.y),t.stroke())}))},l(t,n,s);case 18:case"end":return e.stop()}var m}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=JSON.parse(localStorage.getItem("userTrainingData")),n=localStorage.getItem("UserId");return(0,M.jsx)("div",{className:"Main",children:(0,M.jsxs)("div",{className:"CameraWrapper",children:[(0,M.jsx)("canvas",{ref:this.canvasRef,width:this.width,height:this.height,className:"canvas"}),(0,M.jsx)("video",{ref:this.videoRef,autoPlay:!0,playsInline:!0,width:this.width,height:this.height}),(0,M.jsxs)("div",{className:"TrainingCounter",children:[(0,M.jsxs)("div",{className:"CounterHeader",children:[(0,M.jsx)("h2",{children:"\u30ab\u30a6\u30f3\u30c8"}),(0,M.jsx)("h2",{children:"\u76ee\u6a19"})]}),(0,M.jsxs)("div",{className:"CounterBox",children:[(0,M.jsx)("h2",{children:this.state.count}),(0,M.jsx)("h2",{children:t[j()().format("YYYY/MM/DD")].target[this.trainingType]})]})]}),(0,M.jsx)("div",{className:"TrainingButton",onClick:N(T().mark((function r(){return T().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t[j()().format("YYYY/MM/DD")].training[e.trainingType]=e.state.count,localStorage.setItem("userTrainingData",JSON.stringify(t)),r.next=4,um(dp(hp(k8,"TrainingData"),n),{TrainingData:t});case 4:window.location.href="/";case 5:case"end":return r.stop()}}),r)}))),children:this.state.buttonText})]})})}}]),n}(S.Component);x8.contextType=S.useContext,x8.contextType=H;var w8=x8;zt("firebase","10.3.0","app");var k8=function(e,t){var n="object"==typeof e?e:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t,t=Nt.get(e);if(!t&&e===_t&&Me())return Ft();if(!t)throw Mt.create("no-app",{appName:e});return t}(),r="string"==typeof e?e:t||"(default)",a=Dt(n,"firestore").getImmediate({identifier:r});if(!a._initialized){var i=Pe("firestore");i&&sp.apply(void 0,[a].concat((0,ke.Z)(i)))}return a}(Ft({apiKey:"AIzaSyCqQZh3zE_1UH4rKx88PyjMRieV9t-7A3g",authDomain:"vol-9-hackathon.firebaseapp.com",projectId:"vol-9-hackathon",storageBucket:"vol-9-hackathon.appspot.com",messagingSenderId:"204890033321",appId:"1:204890033321:web:b3f60102c800c8c49e2db8",measurementId:"G-Z8G55SP15Z"})),S8=!1;var C8=function(){var e=(0,S.useContext)(H).setUserTrainingData,t=function(){var e=localStorage.length>=2;return e?"yes"===localStorage.getItem("Login"):e}(),n=localStorage.getItem("UserId"),r=j()(Date.now()).format("YYYY/MM/DD").toString(),a=function(){for(var e=0,t=0,n=0,r=0,a=0,i=0,o=JSON.parse(localStorage.getItem("userTrainingData")),s=1;s<3;s++){var u=j()().add(-s,"day").format("YYYY/MM/DD").toString();void 0!==o[u]&&(a++,e+=o[u].target.AbsTraining+o[u].training.AbsTraining,t+=o[u].target.LegTraining+o[u].training.LegTraining,n+=o[u].target.PectoralTraining+o[u].target.PectoralTraining,o[u].target.AbsTraining===o[u].training.AbsTraining&&r++,o[u].target.LegTraining===o[u].training.LegTraining&&r++,o[u].target.PectoralTraining===o[u].training.PectoralTraining&&r++)}return r===3*a?i=10:r>2*a&&(i=5),{target:{AbsTraining:0!==a?e/(2*a)|0+i:30,LegTraining:0!==a?t/(2*a)|0+i:30,PectoralTraining:0!==a?n/(2*a)|0+i:30},training:{AbsTraining:0,LegTraining:0,PectoralTraining:0}}};return(0,S.useEffect)((function(){var i=function(){var e=N(T().mark((function e(t){var n,a,i,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=dp(k8,"TrainingData",t),e.next=3,im(n);case 3:if(!(a=e.sent).exists()){e.next=9;break}return i=a.data().TrainingData,e.abrupt("return",i);case 9:return o={TrainingData:(0,_.Z)({},r,{target:{AbsTraining:30,LegTraining:30,PectoralTraining:30},training:{AbsTraining:0,LegTraining:0,PectoralTraining:0}})},s=hp(k8,"TrainingData"),e.next=13,um(dp(s,t),o);case 13:return e.abrupt("return",o.TrainingData);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return N(T().mark((function o(){var s;return T().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!t||S8){o.next=11;break}return o.next=3,i(n);case 3:if(void 0!==(s=o.sent)[r]){o.next=8;break}return s[r]=a(),o.next=8,um(dp(hp(k8,"TrainingData"),n),{TrainingData:s});case 8:e(s),localStorage.setItem("userTrainingData",JSON.stringify(s)),S8=!0;case 11:case"end":return o.stop()}}),o)})))}),[t,n,r,e]),(0,M.jsx)(M.Fragment,{children:t?(0,M.jsxs)(DS,{children:[(0,M.jsx)(le,{}),(0,M.jsxs)("div",{className:"App",children:[(0,M.jsx)(V,{}),(0,M.jsxs)(OS,{children:[(0,M.jsx)(TS,{exact:!0,path:"/",children:(0,M.jsx)(bm,{val:"\u3066\u3059\u3068"})}),(0,M.jsx)(TS,{path:"/calendar",children:(0,M.jsx)(ce,{})}),(0,M.jsx)(TS,{path:"/graph",children:(0,M.jsx)(Lk,{})}),(0,M.jsx)(TS,{path:"/setting",children:(0,M.jsx)(WS,{})}),(0,M.jsx)(TS,{path:"/training",children:(0,M.jsx)(w8,{})})]})]}),(0,M.jsx)(xm,{})]}):(0,M.jsx)(hm,{})})},I8=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))},T8=function(e,t){var n=t.type,r=t.payload;switch(n){case"push":return[].concat((0,ke.Z)(e),[r]);case"update":return e.map((function(e){return e.id===r.id?r:e}));case"delete":return e.filter((function(e){return e.id!==r.id}));default:throw new Error}},_8=function(){var e=localStorage.getItem("savedEvents");return e?JSON.parse(e):[]},E8=function(e){var t=(0,S.useState)(j()().month()),n=(0,U.Z)(t,2),r=n[0],a=n[1],i=(0,S.useState)(j()()),o=(0,U.Z)(i,2),s=o[0],u=o[1],c=(0,S.useState)(null),l=(0,U.Z)(c,2),h=l[0],d=l[1],f=(0,S.useState)(!1),p=(0,U.Z)(f,2),m=p[0],v=p[1],g=(0,S.useState)({}),y=(0,U.Z)(g,2),b=y[0],x=y[1],w=(0,S.useState)(""),k=(0,U.Z)(w,2),C=k[0],I=k[1],T=(0,S.useState)(0),_=(0,U.Z)(T,2),E=_[0],N=_[1],R=(0,S.useReducer)(T8,[],_8),A=(0,U.Z)(R,2),O=A[0],D=A[1];return(0,S.useEffect)((function(){localStorage.setItem("savedEvents",JSON.stringify(O))}),[O]),(0,S.useEffect)((function(){m||d(null)}),[m]),(0,M.jsx)(H.Provider,{value:{monthIndex:r,setMonthIndex:a,daySelected:s,setDaySelected:u,showEventModal:m,setShowEventModal:v,selectedEvent:h,setSelectedEvent:d,savedEvents:O,dispatchCalEvent:D,userTrainingData:b,setUserTrainingData:x,trainingType:C,setTrainingType:I,trainingCount:E,setTrainingCount:N},children:e.children})};C.createRoot(document.getElementById("root")).render((0,M.jsx)(S.StrictMode,{children:(0,M.jsx)(E8,{children:(0,M.jsx)(C8,{})})})),I8()}()}();
//# sourceMappingURL=main.c1a7a781.js.map